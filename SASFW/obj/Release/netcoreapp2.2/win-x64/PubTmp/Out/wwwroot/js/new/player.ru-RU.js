/* VimeoPlayer - v2.71.32 - 2018-05-09 - https://player.vimeo.com/NOTICE.txt */
var VimeoPlayer=function(){"use strict";function e(e,t){return t={exports:{}},e(t,t.exports),t.exports}function t(e){e=e.toLowerCase();var t=new RegExp(e).test(Ui);return"safari"===e?t&&new RegExp("version").test(Ui):t}function n(e){var t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(var r in i){var o=i[r];if(void 0!==t.style[o])return o}return e}function i(){var e=navigator,t=!1,n=[0,0,0],i=null,r="Shockwave Flash",o="application/x-shockwave-flash",a="ShockwaveFlash.ShockwaveFlash";if("undefined"!=typeof e.plugins&&"object"==typeof e.plugins[r])i=e.plugins[r].description,!i||"undefined"!=typeof e.mimeTypes&&e.mimeTypes[o]&&!e.mimeTypes[o].enabledPlugin||(t=!0,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),n[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),n[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),n[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if("undefined"!=typeof window.ActiveXObject)try{var s=new ActiveXObject(a);s&&(i=s.GetVariable("$version"),i&&(t=!0,i=i.split(" ")[1].split(","),n=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(e){}return{installed:t,version:n.join("."),major:n[0],minor:n[1],revision:n[2]}}function r(){return(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"'))}function o(){if(!t("safari"))return[];var e=Ui.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}function a(){if(!t("chrome"))return[];var e=Ui.split(" ").find(function(e){return Yi?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}function s(){return!!(Xi&&Qi||Xi&&Ji)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function u(){return!($i.iOS||$i.iPad||$i.browser.ie)&&(!t("safari")||(o()[0]>11||11==o()[0]&&(o()[2]>1||o()[1]>0)))}function c(e){var t=vr.call(e,mr),n=e[mr];try{e[mr]=void 0;var i=!0}catch(e){}var r=pr.call(e);return i&&(t?e[mr]=n:delete e[mr]),r}function l(e){return _r.call(e)}function d(e){return null==e?void 0===e?Tr:Er:xr&&xr in Object(e)?kr(e):Sr(e)}function f(e){return null!=e&&"object"==typeof e}function h(e){return"symbol"==typeof e||Cr(e)&&Pr(e)==Or}function v(e,t){if(Ir(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Mr(e))||(Fr.test(e)||!Dr.test(e)||null!=t&&e in Object(t))}function p(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function m(e){if(!jr(e))return!1;var t=qr(e);return t==Ur||t==Hr||t==Vr||t==Wr}function g(e){return!!$r&&$r in e}function y(e){if(null!=e){try{return Zr.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function _(e){if(!io(e)||no(e))return!1;var t=to(e)?fo:ao;return t.test(ro(e))}function b(e,t){return null==e?void 0:e[t]}function w(e,t){var n=mo(e,t);return po(n)?n:void 0}function k(){this.__data__=wo?wo(null):{},this.size=0}function S(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function E(e){var t=this.__data__;if(Eo){var n=t[e];return n===To?void 0:n}return Ao.call(t,e)?t[e]:void 0}function T(e){var t=this.__data__;return Po?void 0!==t[e]:Oo.call(t,e)}function x(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Io&&void 0===t?Mo:t,this}function A(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function L(){this.__data__=[],this.size=0}function P(e,t){return e===t||e!==e&&t!==t}function C(e,t){for(var n=e.length;n--;)if(Wo(e[n][0],t))return n;return-1}function O(e){var t=this.__data__,n=Go(t,e);if(n<0)return!1;var i=t.length-1;return n==i?t.pop():Yo.call(t,n,1),--this.size,!0}function R(e){var t=this.__data__,n=$o(t,e);return n<0?void 0:t[n][1]}function I(e){return Jo(this.__data__,e)>-1}function M(e,t){var n=this.__data__,i=ea(n,e);return i<0?(++this.size,n.push([e,t])):n[i][1]=t,this}function D(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function F(){this.size=0,this.__data__={hash:new fa,map:new(va||ha),string:new fa}}function B(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function N(e,t){var n=e.__data__;return ga(t)?n["string"==typeof t?"string":"hash"]:n.map}function q(e){var t=_a(this,e).delete(e);return this.size-=t?1:0,t}function j(e){return wa(this,e).get(e)}function V(e){return Sa(this,e).has(e)}function U(e,t){var n=Ta(this,e),i=n.size;return n.set(e,t),this.size+=n.size==i?0:1,this}function H(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var i=e[t];this.set(i[0],i[1])}}function W(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(Ma);var n=function(){var i=arguments,r=t?t.apply(this,i):i[0],o=n.cache;if(o.has(r))return o.get(r);var a=e.apply(this,i);return n.cache=o.set(r,a)||o,a};return n.cache=new(W.Cache||Ia),n}function z(e){var t=Ba(e,function(e){return n.size===Na&&n.clear(),e}),n=t.cache;return t}function G(e,t){for(var n=-1,i=null==e?0:e.length,r=Array(i);++n<i;)r[n]=t(e[n],n,e);return r}function K(e){if("string"==typeof e)return e;if(Ya(e))return Ka(e,K)+"";if(Xa(e))return Ja?Ja.call(e):"";var t=e+"";return"0"==t&&1/e==-$a?"-0":t}function Y(e){return null==e?"":es(e)}function X(e,t){return ns(e)?e:is(e,t)?[e]:rs(os(e))}function $(e){if("string"==typeof e||ss(e))return e;var t=e+"";return"0"==t&&1/e==-us?"-0":t}function Q(e,t){t=ls(t,e);for(var n=0,i=t.length;null!=e&&n<i;)e=e[ds(t[n++])];return n&&n==i?e:void 0}function J(e,t,n){var i=null==e?void 0:hs(e,t);return void 0===i?n:i}function Z(e){var t=bs.call(e,ks),n=e[ks];try{e[ks]=void 0;var i=!0}catch(e){}var r=ws.call(e);return i&&(t?e[ks]=n:delete e[ks]),r}function ee(e){return Es.call(e)}function te(e){return null==e?void 0===e?xs:Ts:As&&As in Object(e)?Z(e):ee(e)}function ne(e,t){return function(n){return e(t(n))}}function ie(e){return null!=e&&"object"==typeof e}function re(e){if(!ie(e)||te(e)!=Ps)return!1;var t=Ls(e);if(null===t)return!0;var n=Is.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Rs.call(n)==Ms}function oe(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}function ae(e,t,n){function i(){h===f&&(h=f.slice())}function r(){return d}function o(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return i(),h.push(e),function(){if(t){t=!1,i();var n=h.indexOf(e);h.splice(n,1)}}}function a(e){if(!re(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"==typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(v)throw new Error("Reducers may not dispatch actions.");try{v=!0,d=l(d,e)}finally{v=!1}for(var t=f=h,n=0;n<t.length;n++){var i=t[n];i()}return e}function s(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");l=e,a({type:Fs.INIT})}function u(){var e,t=o;return e={subscribe:function(e){function n(){e.next&&e.next(r())}if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");n();var i=t(n);return{unsubscribe:i}}},e[Ds]=function(){return this},e}var c;if("function"==typeof t&&"undefined"==typeof n&&(n=t,t=void 0),"undefined"!=typeof n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(ae)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var l=e,d=t,f=[],h=f,v=!1;return a({type:Fs.INIT}),c={dispatch:a,subscribe:o,getState:r,replaceReducer:s},c[Ds]=u,c}function se(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function ue(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,i,r){var o=e(n,i,r),a=o.dispatch,s=[],u={getState:o.getState,dispatch:function(e){return a(e)}};return s=t.map(function(e){return e(u)}),a=se.apply(void 0,s)(o.dispatch),Bs({},o,{dispatch:a})}}}function ce(e){return Object.assign({muted:!1,timeout:250,inline:!1},e)}function le(e,t){var n=e.muted,i=e.timeout,r=e.inline,o=t(),a=o.element,s=o.source,u=void 0,c=void 0,l=void 0;return a.muted=n,n===!0&&a.setAttribute("muted","muted"),r===!0&&a.setAttribute("playsinline","playsinline"),a.src=s,new Vi(function(e){u=a.play(),c=setTimeout(function(){l(!1,new Error("Timeout "+i+" ms has been reached"))},i),l=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;clearTimeout(c),e({result:t,error:n})},void 0!==u?u.then(function(){return l(!0)}).catch(function(e){return l(!1,e)}):l(!0)})}function de(e){return e=ce(e),le(e,function(){return{element:document.createElement("video"),source:URL.createObjectURL(Mu)}})}function fe(e){return e=ce(e),le(e,function(){return{element:document.createElement("audio"),source:URL.createObjectURL(Iu)}})}function he(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var u=0,c=t[a].length;u<c;u++)if(t[a][u].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function ve(e){return function(t){return null==e?void 0:e[t]}}function pe(e){return e=Hu(e),e&&Gu.test(e)?e.replace(zu,Wu):e}function me(e){return e=e.replace("#",""),"string"==typeof e&&(3===e.length||6===e.length)&&!isNaN(parseInt(e,16))}function ge(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}function ye(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length&&t[0]instanceof ye){var i=t[0];return this.red=i.red,this.green=i.green,this.blue=i.blue,this.alpha=i.alpha,this.hue=i.hue,this.saturation=i.saturation,this.lightness=i.lightness,this}if(1===t.length){if("string"==typeof t[0]&&t[0].indexOf("rgb")>=0)return this.rgba=ge(t[0]),this;if(!me(""+t[0]))throw new Error("Invalid hex value");return this.hex=t[0],this}if(3===t.length||4===t.length){for(var r=0;r<3;r++)if(isNaN(parseInt(t[r],10))||parseInt(t[r],10)<0||parseInt(t[r],10)>255)throw new Error("Invalid rgb value");if(t[3]&&parseFloat(t[3])<0||parseFloat(t[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:t[0],green:t[1],blue:t[2],alpha:parseFloat(t[3])||1},this}throw new Error("Invalid color")}function _e(e){return"string"==typeof e||!Xu(e)&&$u(e)&&Yu(e)==Qu}function be(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function we(e){for(var t=this,n=function n(i){return i.length>=e.length?e.apply(t,i):function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return n([].concat(i,t))}},i=arguments.length,r=Array(i>1?i-1:0),o=1;o<i;o++)r[o-1]=arguments[o];return n(r)}function ke(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.styleSheets[0];try{n.insertRule?n.insertRule(e+"{"+t+"}",(n.cssRules||n.rules).length):n.addRule(e,t)}catch(e){}}function Se(e){if(e&&e.detail>0)try{document.activeElement.blur()}catch(e){}}function Ee(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.activeElement,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{e.blur()}catch(e){t&&t(e)}}function Te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.activeElement,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{e.focus()}catch(e){t&&t(e)}}function xe(e){var t=e.getBoundingClientRect();return document.msFullscreenElement&&window.parent!==window&&e.offsetWidth<e.clientWidth&&(t={bottom:100*t.bottom,left:100*t.left,top:100*t.top,right:100*t.right,width:100*t.width,height:100*t.height}),t}function Ae(e){try{return new URL(e).origin}catch(e){}var t=document.createElement("a");return t.href=e,t.origin?t.origin:t.protocol.replace(":","")+"://"+t.host}function Le(e){var t=e.width,n=e.height,i=e.elementWidth,r=e.elementHeight,o=e.threshold,a=void 0===o?10:o,s=1,u=t/n,c=i-r*u,l=r-i/u;if(c>0&&c<a||l>0&&l<a){var d=i/(i-c),f=r/(r-l);s=Math.max(d,f)}return{extraWidth:c,extraHeight:l,scaleFactor:s}}function Pe(e,t,n){return e>n?n:t>e?t:e}function Ce(e){if(e===!0)return Vi.resolve(null);var t=!1;return new Vi(function(n,i){var r=function(){t||!function(){t=!0;var i=(new Date).getTime()-e.startTime;setTimeout(function(){return n(i)},100)}()};e.link.addEventListener("load",r,!1)})}function Oe(e,t,n){var i=n.width,r=n.height,o=n.scrollbars,a=void 0===o?"yes":o,s=n.resizable,u=void 0===s?"yes":s,c=n.toolbar,l=void 0===c?"no":c,d=(window.screenY||window.screenTop||0)+window.outerHeight/2-r/2,f=(window.screenX||window.screenLeft||0)+window.outerWidth/2-i/2;window.chrome&&window.navigator.userAgent.toLowerCase().indexOf("mac os x")!==-1&&(r+=27),window.safari&&(r+=47);var h="scrollbars="+a+",resizable="+u+",toolbar="+l;return window.open(e,t,"width="+i+",height="+r+",left="+f+",top="+d+","+h)}function Re(e){if(!e)return{};if(Number.isInteger(parseInt(e,10)))return{id:parseInt(e,10),params:{}};if("string"==typeof e)return 0!==e.indexOf("https://")?{}:{url:e,params:{}};var t=["portrait","title","byline","color","autoplay","loop","video_version"],n=Object.keys(e).filter(function(e){return t.indexOf(e)!==-1}).reduce(function(t,n){return t[n]=e[n],t},{});return"url"in e?0!==e.url.indexOf("https://")?{}:{url:e.url,params:n}:"id"in e&&Number.isInteger(parseInt(e.id,10))?{id:parseInt(e.id,10),params:n}:{}}function Ie(e){var t=e.match(/\ba?t=([0-9hms:]+)/);null!==t&&(e=t[1]);var n=!1,i=0,r=0,o=0;if(t=e.match(/^([0-9]+)$/),t&&t.length&&(n=!0,o=t[1]),n===!1&&(t=e.match(/^(?:([0-9]+)h)?(?:([0-9]+)m)?(?:([0-9]+)s)?/),null!==t&&""!==t[0])){n=!0;var a=t,s=rc(a,4),u=s[1];i=void 0===u?0:u;var c=s[2];r=void 0===c?0:c;var l=s[3];o=void 0===l?0:l}if(n===!1&&(t=e.match(/^([0-9:]+)/),null!==t)){n=!0;var d=e.split(":").reverse(),f=rc(d,3);o=f[0];var h=f[1];r=void 0===h?0:h;var v=f[2];i=void 0===v?0:v}return n?60*parseInt(i,10)*60+60*parseInt(r,10)+parseInt(o,10):null}function Me(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.method,i=void 0===n?"GET":n,r=t.withCredentials,o=void 0===r||r,a=t.allowErrorStatuses,s=void 0!==a&&a,u=t.jwt,c=void 0!==u&&u;return new Vi(function(t,n){var r=new XMLHttpRequest;r.open(i,e,!0),o&&(r.withCredentials=!0),c&&r.setRequestHeader("Authorization","jwt "+c),r.onload=function(){if(r.status>=400&&!s){var e={403:"Forbidden",404:"Not Found",500:"Internal Server Error"};return e[r.status]?void n(new Error(e[r.status])):void n(new Error("Request returned non-200 status code: "+r.status))}t(r.responseText)},r.onerror=function(){return n(new Error("The request failed."))},r.send()})}function De(e){for(var t,n,i=(e||document).querySelectorAll("[tabindex]"),r=[],o=0,a=0,s=i.length;a<s;a++)t=i[a],n=window.getComputedStyle(t,""),t.tabIndex>0&&"none"!==n.display&&n.opacity>0&&"hidden"!==n.visibility&&(r[o++]=t);var u=r.shift();u&&(u.focus(),u.blur())}function Fe(e,t){if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t||3);return Math.round(e*n)/n}function Be(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^16*Math.random()>>e/4).toString(16)})}function Ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2;t=Object.keys(t).map(function(e){return t[e]});var i=e.cloneNode();i.style.visibility="hidden",i.style.padding=0,e.parentElement.appendChild(i);var r=t.map(function(e){return i.innerText=e,i.clientWidth}),o=Math.max.apply(Math,r),a=window.getComputedStyle(e),s=parseFloat(a.fontSize);return e.parentElement.removeChild(i),(o+n)/s+"em"}function qe(e,t){return Ws(t).indexOf(e)!==-1}function je(e,t){for(;e&&e.parentElement&&!qe(e,t);)e=e.parentElement;return qe(e,t)?e:null}function Ve(e){return e?Ws(e.parentNode.children).indexOf(e):-1}function Ue(e,t,n){if(void 0!==n)e.style[t]=n;else if(Ju(t))e.setAttribute("style",t);else for(var i in t)Ue(e,i,t[i])}function He(e,t){var n=document.createElement("iframe");return n.classList.add("vp-resize-iframe"),n.onload=function(){return n.contentWindow.onresize=function(){return t(e)}},e.appendChild(n),n}function We(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(!e||"null"===e||0===t.length)return{track:null};var n=e.split("."),i=rc(n,2),r=i[0],o=i[1],a=r.split(/[-_]/),s=rc(a,1),u=s[0],c=r!==u,l=t.filter(function(e){return c?e.language===r||e.language===u:e.language===u}).sort(function(e,t){var n=2*(e.language===u&&e.kind===o)+2*(e.language===r)+1*(e.kind===o),i=2*(t.language===u&&t.kind===o)+2*(t.language===r)+1*(t.kind===o);return i-n});return l.length>0?{track:l[0],exactMatch:l[0].language===r&&l[0].kind===o}:{track:null}}function ze(e){return"object"==typeof e&&null!==e}function Ge(e){switch({}.toString.call(e)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return e instanceof Error}}function Ke(){return"undefined"==typeof document||"undefined"==typeof document.location?"":document.location.href}function Ye(e){this.name="RavenConfigError",this.message=e}function Xe(){return+new Date}function $e(){this._hasJSON=!("object"!=typeof JSON||!JSON.stringify),this._hasDocument=!Qe(zc),this._hasNavigator=!Qe(Gc),this._lastCapturedException=null,this._lastData=null,this._lastEventId=null,this._globalServer=null,this._globalKey=null,this._globalProject=null,this._globalContext={},this._globalOptions={logger:"javascript",ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],crossOrigin:"anonymous",collectWindowErrors:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,sampleRate:1},this._ignoreOnError=0,this._isRavenInstalled=!1,this._originalErrorStackTraceLimit=Error.stackTraceLimit,this._originalConsole=Wc.console||{},this._originalConsoleMethods={},this._plugins=[],this._startTime=Xe(),this._wrappedBuiltIns=[],this._breadcrumbs=[],this._lastCapturedEvent=null,this._keypressTimeout,this._location=Wc.location,this._lastHref=this._location&&this._location.href,this._resetBackoff();for(var e in this._originalConsole)this._originalConsoleMethods[e]=this._originalConsole[e]}function Qe(e){return void 0===e}function Je(e){return"function"==typeof e}function Ze(e){return"[object String]"===Kc.toString.call(e)}function et(e){for(var t in e)return!1;return!0}function tt(e,t){var n,i;if(Qe(e.length))for(n in e)rt(e,n)&&t.call(null,n,e[n]);else if(i=e.length)for(n=0;n<i;n++)t.call(null,n,e[n])}function nt(e,t){return t?(tt(t,function(t,n){e[t]=n}),e):e}function it(e,t){return!t||e.length<=t?e:e.substr(0,t)+"…"}function rt(e,t){return Kc.hasOwnProperty.call(e,t)}function ot(e){for(var t,n=[],i=0,r=e.length;i<r;i++)t=e[i],Ze(t)?n.push(t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):t&&t.source&&n.push(t.source);return new RegExp(n.join("|"),"i")}function at(e){var t=[];return tt(e,function(e,n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))}),t.join("&")}function st(e){var t=e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};var n=t[6]||"",i=t[8]||"";return{protocol:t[2],host:t[4],path:t[5],relative:t[5]+n+i}}function ut(){var e=Wc.crypto||Wc.msCrypto;if(!Qe(e)&&e.getRandomValues){var t=new Uint16Array(8);e.getRandomValues(t),t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;var n=function(e){for(var t=e.toString(16);t.length<4;)t="0"+t;return t};return n(t[0])+n(t[1])+n(t[2])+n(t[3])+n(t[4])+n(t[5])+n(t[6])+n(t[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"===e?t:3&t|8;return n.toString(16)})}function ct(e){for(var t,n=5,i=80,r=[],o=0,a=0,s=" > ",u=s.length;e&&o++<n&&(t=lt(e),!("html"===t||o>1&&a+r.length*u+t.length>=i));)r.push(t),a+=t.length,e=e.parentNode;return r.reverse().join(s)}function lt(e){var t,n,i,r,o,a=[];if(!e||!e.tagName)return"";if(a.push(e.tagName.toLowerCase()),e.id&&a.push("#"+e.id),t=e.className,t&&Ze(t))for(n=t.split(/\s+/),o=0;o<n.length;o++)a.push("."+n[o]);var s=["type","name","title","alt"];for(o=0;o<s.length;o++)i=s[o],r=e.getAttribute(i),r&&a.push("["+i+'="'+r+'"]');return a.join("")}function dt(e,t){return!!(!!e^!!t)}function ft(e,t){return!dt(e,t)&&(e=e.values[0],t=t.values[0],e.type===t.type&&e.value===t.value&&ht(e.stacktrace,t.stacktrace))}function ht(e,t){if(dt(e,t))return!1;var n=e.frames,i=t.frames;if(n.length!==i.length)return!1;for(var r,o,a=0;a<n.length;a++)if(r=n[a],o=i[a],r.filename!==o.filename||r.lineno!==o.lineno||r.colno!==o.colno||r.function!==o.function)return!1;return!0}function vt(e,t,n,i){var r=e[t];e[t]=n(r),i&&i.push([e,t,r])}function pt(e){return $i.iOS&&"onpagehide"in window?void window.addEventListener("pagehide",e,!1):void window.addEventListener("beforeunload",e,!1)}function mt(e){if(e.request.sentry)try{!function(){var t="dev"===e.request.build.js?"dev":"production",n={session:e.request.session,locale:e.request.lang,git_commit:e.request.build.player,debug_intent:e.request.sentry.debug_intent?1:0};e.request.ab_tests&&!function(){var t=e.request.ab_tests;Object.keys(t).forEach(function(e){var i=t[e].data;Object.keys(i).forEach(function(e){n[e]=i[e]})})}(),Zc.config(e.request.sentry.url,{logger:"player-raven",release:e.request.build.js,environment:t,tags:n,autoBreadcrumbs:{console:!1},includePaths:[/https?:\/\/.*vimeo\.com/],ignoreErrors:["Permission denied to access property 'toString'",'Permission denied to access property "toString"',"The play() request was interrupted by a call to pause().","Permission denied to access property 'href'",'Permission denied to access property "href"',"docs-homescreen-gb-container","Failed to load image.",'Объект не поддерживает свойство или метод "endsWith"',"play() can only be initiated by a user gesture.","Forbidden","Not Found"],shouldSendCallback:function(t){return!!e.request&&(!!e.request.sentry.enabled||!!(e.request.sentry.debug_enabled&&t.extra&&t.extra.debugLink))}}).install(),window.addEventListener("unhandledrejection",function(e){e.reason&&Zc.captureException(e.reason)}),e.request.sentry.debug_intent&&pt(function(){Zc.captureMessage("Session debug",{level:"info"})})}()}catch(e){}}function gt(e,t){return Zc.captureException(e,t),Zc.lastEventId()}function yt(e,t){return Zc.captureMessage(e,t),Zc.lastEventId()}function _t(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"player",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"info";Zc.captureBreadcrumb({message:e,data:t,category:n,level:i})}function bt(e){function t(e,t,n){this.message=e,this.name=t,this.source=n}function n(n){switch(e.config.view){case cc.privateLocked:throw new t("The video is private.","PrivacyError",n);case cc.privatePassword:throw new t("The video is password-protected. The viewer must enter the password first.","PasswordError",n);case cc.error:throw new t(e.config.message,"NotFoundError",n)}}function i(){var e=[];for(var t in F)if(F.hasOwnProperty(t)&&0!==t.indexOf("_")){if("function"==typeof F[t]){e.push(t);continue}"function"==typeof F[t].get&&e.push("get"+t.charAt(0).toUpperCase()+t.slice(1)),"function"==typeof F[t].set&&e.push("set"+t.charAt(0).toUpperCase()+t.slice(1))}return e.sort()}function r(){C||(l({event:"loaded",data:{id:e.config.video.id}}),C=!0)}function o(e){if(!e||""===e)return{};if("object"===("undefined"==typeof e?"undefined":Zu(e)))return e;try{return T=2,JSON.parse(e)}catch(n){var t={};return e.split("&").forEach(function(e){try{var n=e.split("="),i=decodeURIComponent(n[0]),r=decodeURIComponent(n[1]);if("id"===i)return;"params"===i&&(i="value"),r=r.split(",")[0],t[i]=r}catch(e){}}),T=1,t}}function a(e){if(!e||"_"===e.substr(0,1))return null;switch(1===T&&(e=e.replace("api_","")),e){case"changeColor":return F.color.set;case"paused":return F.paused.get;case"seekTo":return F.currentTime.set}if("function"==typeof F[e])return F[e];var t=e.substr(0,3),n=e.substr(3,1).toLowerCase()+e.substr(4);return F[n]&&F[n][t]?F[n][t]:null}function s(e){if(e.source===window.parent){var n=o(e.data),r=n.method,s=n.value;if(void 0!==r)try{var u=a(r);if(!u)throw new t("“"+r+"” is not a valid method. Valid methods are: "+i().join(", ")+".","TypeError",r);el.captureBreadcrumb("API message received",n,"api");var c=[s];u===F.addCuePoint&&"object"===("undefined"==typeof s?"undefined":Zu(s))?c=[s.time,s.data]:u===F.enableTextTrack&&"object"===("undefined"==typeof s?"undefined":Zu(s))&&(c=[s.language,s.kind]);var f=u.apply(e,c),h=0!==r.indexOf("get")&&"paused"!==r;if(f===_||h&&T<3)return;l({method:r,value:void 0!==f&&""!==f?f:s})}catch(e){d(e)}}}function u(e){var t=e.event;if(1===T)for(var n in M)if(M[n]===e.event){t=n;break}switch(t){case"onSeek":case"onProgress":delete e.data.percent,delete e.data.duration;break;case"onLoading":delete e.data.seconds,delete e.data.duration}var i="method="+encodeURIComponent(t||e.method);i+="&params=";var r=[];if(void 0!==e.value)r.push(encodeURIComponent(e.value));else if("object"===Zu(e.data))for(var o in e.data)r.push(encodeURIComponent(e.data[o]));else void 0!==e.data&&r.push(encodeURIComponent(e.data));return e.player_id&&r.push(e.player_id),i+=r.join(",")}function c(e){if(e.event){for(var t in D)if(D[t]===e.event){e.event=t;break}"cuechange"===e.event&&(e.data.text=e.data.cues[0].text,e.data.html=e.data.cues[0].html,delete e.data.cues)}return JSON.stringify(e)}function l(t){if((!t.event||(w.fire(t.event,t.data),b[t.event]))&&k){e.config.embed&&e.config.embed.player_id&&(t.player_id=e.config.embed.player_id);try{1===T?t=u(t):2===T&&(t=c(t)),"object"!==("undefined"==typeof t?"undefined":Zu(t))||"ready"!==t.event&&S||(t=JSON.stringify(t))}catch(e){}if(window.parent!=window)try{window.parent.postMessage(t,g&&"null"!==g?g:"*")}catch(e){}}}function d(e){var n={event:"error",data:{message:"An error occurred.",name:"Error",method:e.source}};e instanceof t&&(n={event:"error",data:{message:e.message,name:e.name,method:e.source}}),l(n)}function f(){if(x&&L){try{switch(L){case"not-supported":throw new t("This video is not supported in this browser.","NotSupportedError");case"no-files":throw new t("There was an error loading the files for this video.","FileError");default:throw new t("An error occurred during playback.","PlaybackError")}}catch(e){d(e)}L=null}}function h(){"embed"in e.config&&e.config.embed.on_site||(window.addEventListener?window.addEventListener("message",s,!1):window.attachEvent("onmessage",s))}function v(){e.events.on(kc.played,function(t){A||(A=!0,l({event:"play",data:{seconds:Fe(t),percent:Fe(t/e.config.video.duration),duration:Fe(e.config.video.duration)}}))}),e.events.on(kc.paused,function(t){A=!1,l({event:"pause",data:{seconds:Fe(t),percent:Fe(t/e.config.video.duration),duration:Fe(e.config.video.duration)}})}),e.events.on(kc.ended,function(){A=!1,l({event:"ended",data:{seconds:Fe(e.config.video.duration),percent:1,duration:Fe(e.config.video.duration)}})}),e.events.on(kc.playProgress,function(e,t,n){l({event:"timeupdate",data:{seconds:Fe(e),percent:Fe(n),duration:Fe(t)}})}),e.events.on(kc.bufferStarted,function(){l({event:"bufferstart",data:{}})}),e.events.on(kc.bufferEnded,function(){l({event:"bufferend",data:{}})}),e.events.on(kc.loadProgress,function(e,t,n){var i={event:"progress",data:{percent:Fe(n),duration:Fe(t),seconds:Fe(e)}};T<3&&(i.data.bytesLoaded=-1,i.data.bytesTotal=-1),l(i)}),e.events.on(kc.seeked,function(e,t,n){l({event:"seeked",data:{seconds:Fe(e),percent:Fe(n),duration:Fe(t)}})}),e.events.on(kc.volumeChanged,function(e){l({event:"volumechange",data:{volume:Fe(e)}})}),e.events.on(kc.playbackRateChanged,function(e){l({event:"playbackratechange",data:{playbackRate:e}})}),e.events.on(kc.error,function(e){L=e,f()}),e.events.on(kc.apiError,function(e){d(new t(e.message,e.name,e.method))}),e.events.on(kc.cueChanged,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e||{},i=n.language,r=void 0===i?null:i,o=n.label,a=void 0===o?null:o,s=n.kind,u=void 0===s?null:s;l({event:"cuechange",data:{label:a,language:r,kind:u,cues:t}})}),e.events.on(kc.captionsChanged,function(e){O=e;var t=e||{},n=t.language,i=void 0===n?null:n,r=t.label,o=void 0===r?null:r,a=t.kind,s=void 0===a?null:a;l({event:"texttrackchange",data:{label:o,language:i,kind:s}})}),e.doNotTrackEnabled||e.events.on(kc.emailCaptureSuccess,function(){l({event:"emailcapture"})}),e.events.on(kc.cuepoint,function(e){l({event:"cuepoint",data:{time:e.time,data:e.data,id:e.id}})}),e.events.on(kc.spatialMotionStart,function(){l({event:"motionstart",data:{}})}),e.events.on(kc.spatialMotionEnd,function(){l({event:"motionend",data:{}})}),e.events.on(kc.spaceChanged,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};b.spacechange=!0,l({event:"spacechange",data:e})}),e.events.on(kc.liveEventStarted,function(){l({event:"liveeventstarted",data:{}})}),e.events.on(kc.liveEventEnded,function(){l({event:"liveeventended",data:{}})}),e.events.on(kc.liveStreamOnline,function(){l({event:"livestreamonline",data:{}})}),e.events.on(kc.liveStreamOffline,function(){l({event:"livestreamoffline",data:{}})})}function p(){e.events.on(wc.reset,function(){L=null,P=!1,C=!1})}function m(){e.events.on(kc.configChanged,function(t){E&&setTimeout(function(){var t=!0;e.events.fire(wc.changeVolume,E,t)},0),t&&r()})}var g=document.referrer||e.config.request.referrer;try{g=decodeURIComponent(g)}catch(e){g=Ku(g)}var y,_="_ASYNC_",b={ready:!0,error:!0},w=he(),k=!(!window.postMessage||!window.parent.postMessage),S=!($i.browser.ie>=8&&$i.browser.ie<10),E=null,T=e.config.embed.api,x=!1,A=!1,L=null,P=!1,C=!1,O=null,R=["play","pause","ended","timeupdate","progress","seeked","error","texttrackchange","cuechange","volumechange","loaded","emailcapture","cuepoint","motionstart","motionend","liveeventstarted","liveeventended","livestreamonline","livestreamoffline","playbackratechange","bufferstart","bufferend"],I=R.filter(function(e){return"emailcapture"!==e}),M={onFinish:"ended",onLoading:"progress",onLoad:"ready",onProgress:"timeupdate",onPlay:"play",onPause:"pause",onSeek:"seeked"},D={playProgress:"timeupdate",loadProgress:"progress",finish:"ended",seek:"seeked"};t.prototype=new Error;var F={_fireEvent:function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];e.events.fire.apply(null,n)},_setEmbedEditor:function(t){e.config.embed.editor=!!t},_setEmbedSetting:function(t,n){e.config.embed.on_site&&(n="object"===("undefined"==typeof n?"undefined":Zu(n))?n:Number(n),"badge"===t&&(n?n=y:y=e.config.embed.settings.badge),e.config.embed.settings[t]=n,e.events.fire(kc.embedSettingChanged,t,n),e.events.fire(wc.reset),e.events.fire(kc.configChanged,!1,e.config))},_showOverlay:function(t,n){e.events.fire(wc.showOverlay,t,n)},_toggleDebugHud:function(){e.events.fire(kc.debugButtonPressed);
},_fieldOfView:{get:function(){var n=e.telecine.getEffectByName("ThreeSixtyEffect");if(e.telecine&&!n)throw new t("Field of view is not available in the current player.","UnsupportedError","getFieldOfView");return n.fieldOfView},set:function(n){var i=e.telecine.getEffectByName("ThreeSixtyEffect");if(e.telecine&&!i)throw new t("Field of view is not available in the current player.","UnsupportedError","setFieldOfView");e.telecine.getEffectByName("ThreeSixtyEffect").fieldOfView=n}},_coordinates:{get:function(){var n=e.telecine.getEffectByName("ThreeSixtyEffect");if(e.telecine&&!n)throw new t("Coordinates are not available in the current player.","UnsupportedError","getCoordinates");return n.currentCoordinates},set:function(n){var i=e.telecine.getEffectByName("ThreeSixtyEffect");if(e.telecine&&!i)throw new t("Coordinates are not available in the current player.","UnsupportedError","setCoordinates");try{e.telecine.getEffectByName("ThreeSixtyEffect").currentCoordinates=n}catch(e){throw new t(e.message,"RangeError","setCoordinates")}}},addEventListener:function(n,i){if(n in M&&(n=M[n]),n in D&&(n=D[n]),R.indexOf(n)<0)throw new t("“"+n+"” is not a valid event. Valid events are: "+I.join(", ")+".","TypeError","addEventListener");i?w.on(n,i):b[n]=!0,("loaded"===n&&e.config.view===cc.main||e.config.view===cc.privateUnlocked)&&r()},removeEventListener:function(e,t){t?w.off(e,t):b[e]=!1},play:function(){n("play");var i="[object MessageEvent]"===Object.prototype.toString.call(this),r=$i.iOS&&$i.iOS<10;if(i&&r&&!P)throw new t("The viewer must initiate playback first.","Error","play");e.events.fire(kc.playButtonPressed)},pause:function(){n("pause"),e.events.fire(kc.pauseButtonPressed)},loadVideo:function(i){var r=Re(i),o=r.id,a=r.url,s=r.params;if(!o&&!a)throw new t("The video id must be an integer.","TypeError","loadVideo");if(a&&a.match(null===new RegExp("^https?://"+e.config.player_url+"/video/([0-9]+)/config")))throw new t("The config url must be a valid Vimeo url.","TypeError","loadVideo");return e.loadVideo(a||o,s).then(function(){return T>2&&l({method:"loadVideo",value:i}),i}).catch(function(){try{n("loadVideo")}catch(e){if(e instanceof t)return void d(e);d(new t("An error occurred loading the video.","Error","loadVideo"))}throw new t("An error occurred loading the video.","Error","loadVideo")}),_},unload:function(){e.config.view!==cc.main&&e.config.view!==cc.privateUnlocked||e.events.fire(wc.reset)},enableTextTrack:function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=("text_tracks"in e.config.request?e.config.request.text_tracks:[]).map(function(e){return e.language=e.lang,e}),o=r.some(function(e){return e.language.toLowerCase()===n.toLowerCase()});if(!o)throw new t("There are no tracks for “"+n.toUpperCase()+"”.","InvalidTrackLanguageError","enableTextTrack");var a=i?n+"."+i:n,s=We(a,r),u=s.track;if(!u||i&&u.kind!==i)throw new t("There are no "+i+" tracks for “"+n.toUpperCase()+"”.","InvalidTrackError","enableTextTrack");return e.events.fire(wc.turnCaptionsOn,u.id,!0),T>2&&e.events.once(kc.captionsChanged,function(e,t){l({method:"enableTextTrack",value:{label:e.label,language:e.language,kind:e.kind}})}),_},disableTextTrack:function(){e.events.fire(wc.turnCaptionsOff)},ping:function(){return e.config.video.id},addCuePoint:function(n,i){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Cue points are not supported in the current player.","UnsupportedError","addCuePoint");if(n=parseFloat(n),isNaN(n)||n<0||n>e.config.video.duration)throw new t("Cue point time must be positive number less than the duration of the video ("+Fe(e.config.video.duration)+").","RangeError","addCuePoint");try{var r=function(){var t=e.telecine.addCuePoint(n,i);return setTimeout(function(){e.events.fire(kc.cuePointAdded,t)},0),{v:t.id}}();if("object"===("undefined"==typeof r?"undefined":Zu(r)))return r.v}catch(e){if("CuePointsNotSupported"===e.name)throw new t("Cue points are not supported in the current player.","UnsupportedError","addCuePoint");throw new t("Unable to add cue point","InvalidCuePoint","addCuePoint")}},removeCuePoint:function(n){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Cue points are not supported in the current player.","UnsupportedError","removeCuePoint");var i=e.telecine.cuePoints.filter(function(e){return e.id===n})[0];if(!i)throw new t("Cue point “"+n+"” was not found.","InvalidCuePoint","removeCuePoint");e.telecine.removeCuePoint(i),setTimeout(function(){e.events.fire(kc.cuePointRemoved,i)},0)},_addCard:function(t){e.events.fire(wc.addCard,t)},_removeCard:function(t){e.events.fire(wc.removeCard,t)},autopause:{get:function(){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Autopause is not supported in the current player.","UnsupportedError","getAutopause");return!!e.config.embed.autopause},set:function(n){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Autopause is not supported in the current player.","UnsupportedError","setAutopause");e.config.embed.autopause=!!n}},color:{get:function(){return e.config.embed.color.replace("#","")},set:function(n){if("moogaloop"===e.telecine.currentScanner)return void e.events.fire(wc.changeColor,n);if(e.config.embed.settings.color&&!e.config.embed.on_site)throw new t("The creator of the video has chosen to always use "+new ye(e.config.embed.color).hex+".","EmbedSettingsError","setColor");try{var i=new ye(n);e.events.fire(wc.changeColor,i.hex)}catch(e){throw new t("The color should be 3- or 6-digit hex value.","TypeError","setColor")}var r=new ye(23,35,34,.75),o=r.contrast(i).ratio;if(o<3){var a=i.clone().lighten(5,3,r);throw new t(i.hex+" does not meet minimum contrast ratio. We recommend using brighter colors. (You could try "+a.hex+" instead.) See WCAG 2.0 guidelines: http://www.w3.org/TR/WCAG/#visual-audio-contrast","ContrastError","setColor")}}},cuePoints:{get:function(){if(e.telecine&&"moogaloop"===e.telecine.currentScanner)throw new t("Cue points are not supported in the current player.","UnsupportedError","getCuePoints");return e.telecine.cuePoints.map(function(e){return{time:e.time,data:e.data,id:e.id}})}},currentTime:{get:function(){return e.telecine&&e.telecine.currentTime>.1?Fe(e.telecine.currentTime):0},set:function(n){if(n=parseFloat(n),isNaN(n)||n<0||n>e.config.video.duration)throw new t("Seconds must be a positive number less than the duration of the video ("+Fe(e.config.video.duration)+").","RangeError","setCurrentTime");var i="[object MessageEvent]"===Object.prototype.toString.call(this),r=$i.iOS&&$i.iOS<10;if(i&&r&&!P)throw new t("The viewer must initiate playback first.","Error","setCurrentTime");return e.events.fire(wc.seek,null,n),e.events.fire(kc.mousedOver),T>2&&e.events.once(kc.seeked,function(e,t,n){l({method:"setCurrentTime",value:e})}),_}},duration:{get:function(){return Fe(e.config.video.duration)}},ended:{get:function(){return!!e.telecine.ended}},loop:{get:function(){return!!e.config.embed.loop},set:function(t){e.events.fire(wc.changeLoop,t)}},paused:{get:function(){return!(e.telecine&&"paused"in e.telecine)||!!e.telecine.paused}},playbackRate:{get:function(){return e.telecine?e.telecine.playbackRate:1},set:function(n){if(!e.config.embed.settings.speed)throw new t("Setting the playback rate is not enabled for this video.","Error","setPlaybackRate");if(isNaN(n)||n<yc.low||n>yc.high)throw new t("Playback rate should be a number between "+yc.low+" and "+yc.high+".","RangeError","setPlaybackRate");e.events.fire(wc.changePlaybackRate,n)}},textTracks:{get:function(){var t=e.telecine?e.telecine.video.textTracks:[];return t.map(function(e){return{label:e.label,language:e.language,kind:e.kind,mode:e===O?"showing":"disabled"}})}},videoEmbedCode:{get:function(){return e.config.video.embed_code}},videoHeight:{get:function(){return e.telecine.videoHeight||e.config.video.height}},videoId:{get:function(){return e.config.video.id}},videoTitle:{get:function(){return e.config.video.title}},videoWidth:{get:function(){return e.telecine.videoWidth||e.config.video.width}},videoUrl:{get:function(){if(!e.config.video.url)throw new t("The URL is not available because of the video’s privacy settings.","PrivacyError","getVideoUrl");return e.config.video.url}},volume:{get:function(){var t=Fe(e.config.request.cookie.volume);return 1===T?Math.round(100*t):t},set:function(n){if(n=parseFloat(n),1===T&&(n/=100),isNaN(n)||n<0||n>1)throw new t("Volume should be a number between 0 and 1.","RangeError","setVolume");E=n;var i=!0;e.events.fire(wc.changeVolume,n,i)}},_like:{get:function(){return!!e.config.user.liked},set:function(t){if(e.config.embed.on_site){if(e.config.user.liked===t)return;e.events.fire(kc.likeButtonPressed,t)}}},_watchLater:{get:function(){return!!e.config.user.watch_later},set:function(t){if(e.config.embed.on_site){if(e.config.user.watch_later===t)return;e.events.fire(kc.watchLaterButtonPressed,t)}}},_setOutro:function(t,n){return e.config.embed.outro===t?void e.events.fire(wc.showOutro,t,n):(e.events.fire(wc.hideOutro),void setTimeout(function(){e.config.embed.outro=t,e.events.fire(wc.showOutro,t,n)},400))},_hideOutro:function(){e.events.fire(wc.hideOutro)},_setEmailCapture:function(t){return t?(e.config.embed.email=e.config.embed.email||{},e.config.embed.email.position=t.position.toLowerCase(),"after"===t.position.toLowerCase()?(e.config.embed.outro="email",void e.events.fire(wc.showOutro,"email",{version:2,data:t})):(e.config.embed.email.timecode=t.timecode,t.nohide=!0,t.noblur=!0,void F._showOverlay("email-capture",t))):void F._unsetEmailCapture()},_unsetEmailCapture:function(){e.config.embed.outro&&(e.events.fire(wc.hideOutro),delete e.config.embed.outro),e.config.embed.email&&(e.events.fire(wc.hideOverlay,{unmakeModal:!0}),delete e.config.embed.email)}};return e.events.on(kc.playInitiated,function(){P=!0}),v(),p(),m(),e.events.fire(kc.apiModuleReady),e.events.once(kc.ready,function(){x=!0,h(),l({event:"ready"}),f()}),F}function wt(e){return rl.indexOf(e[0])>-1}function kt(e){var t=e.match(il);return t&&t[0]}function St(e){var t=e.replace(nl,"");if(wt(t))return t;var n=kt(t);return n&&tl.test(n)?"":t}function Et(e){e=e.trim();var t=kt(e);return e&&!t&&(e="http://"+e),e}function Tt(e){return e?encodeURI(Et(St(e))):null}function xt(e){if("object"!==("undefined"==typeof e?"undefined":Zu(e)))return"";var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")}function At(e){return"string"!=typeof e?{}:e.replace("?","").split("&").reduce(function(e,t){if(t.length>0){var n=t.split("="),i=rc(n,2),r=i[0],o=i[1];e[r]=decodeURIComponent(o)}return e},{})}function Lt(e){function t(){return s&&s-ol<=(new Date).getTime()}function n(e){var t=(new Date).getTime()+1e3*e,n=1e3*e-ol-5e3;return l=setTimeout(function(){"onLine"in navigator&&!navigator.onLine||(c=r().catch(function(e){return el.captureException(e)}))},n),t}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};clearTimeout(l);var i=a;if(isNaN(e)&&"string"!=typeof e)return a=e,s=n(a.request.expires),Vi.resolve({old:i,loaded:a});var r=(new Date).getTime(),o=a&&a.video&&a.video.id,u=a&&a.request&&a.request.session,c=a&&a.request&&a.request.referrer,d=a&&a.embed&&a.embed.player_id,f=a&&a.embed&&a.embed.on_site,h=a&&a.embed&&a.embed.context,v=e;if(!isNaN(e)){var p=a&&a.player_url?"https://"+a.player_url:"",m=At(window.location.search),g=Object.assign(m,t),y=xt(g);v=p+"/video/"+e+"/config"+(y.length>0?"?":"")+y}return c&&(v+=(v.indexOf("?")===-1?"?":"&")+"referrer="+encodeURIComponent(c)),Me(v,{allowErrorStatuses:!0}).then(function(e){a=JSON.parse(e),a.view!==cc.error&&(s=n(a.request.expires),u&&a.video.id===o&&(a.request.session=u),c&&(a.request.referrer=c),d&&(a.embed.player_id=d),f&&(a.embed.on_site=1,a.embed.context=h));(new Date).getTime()-r;return{old:i,loaded:a}})}function r(){clearTimeout(l);var e=(new Date).getTime(),t=a&&a.request.referrer,i=a.request,r=i.signature,u=i.session,d=i.timestamp,f=i.expires,h="https://"+a.player_url+"/video/"+a.video.id+"/config/request?session="+u+"&signature="+r+"&time="+d+"&expires="+f;return t&&(h+=(h.indexOf("?")===-1?"?":"&")+"referrer="+encodeURIComponent(t)),Me(h).then(function(i){a.request=JSON.parse(i),t&&(a.request.referrer=t),s=n(a.request.expires);(new Date).getTime()-e;return c=null,o.fire(kc.requestConfigReloaded),a.request})}var o=e.events,a=null,s=null,u=null,c=null,l=null;return window.addEventListener("online",function(){t()&&(c=r().catch(function(e){return el.captureException(e)}))}),o.on(kc.error,function(e){"media-url-expired"===e&&(c=r().catch(function(e){return el.captureException(e)}))}),{get isExpired(){return t()},load:function(e,t){return i(e,t)},reload:function(){return a&&a.video.id?i(a.video.id):Vi.reject(new Error("No config loaded."))},toJSON:function(){return a},get config(){return a},set config(e){a=e},verify:function(){return t()?(c||(c=r()),c):Vi.resolve(a.request)},get _video(){return u},set _video(e){u=e}}}function Pt(e){if("number"==typeof e)return e;if(ll(e))return dl;if(cl(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=cl(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(fl,"");var n=vl.test(e);return n||pl.test(e)?ml(e.slice(2),n?2:8):hl.test(e)?dl:+e}function Ct(e,t,n){function i(t){var n=f,i=h;return f=h=void 0,y=t,p=e.apply(i,n)}function r(e){return y=e,m=setTimeout(s,t),_?i(e):p}function o(e){var n=e-g,i=e-y,r=t-n;return b?Sl(r,v-i):r}function a(e){var n=e-g,i=e-y;return void 0===g||n>=t||n<0||b&&i>=v}function s(){var e=_l();return a(e)?u(e):void(m=setTimeout(s,o(e)))}function u(e){return m=void 0,w&&f?i(e):(f=h=void 0,p)}function c(){void 0!==m&&clearTimeout(m),y=0,f=g=h=m=void 0}function l(){return void 0===m?p:u(_l())}function d(){var e=_l(),n=a(e);if(f=arguments,h=this,g=e,n){if(void 0===m)return r(g);if(b)return m=setTimeout(s,t),i(g)}return void 0===m&&(m=setTimeout(s,t)),p}var f,h,v,p,m,g,y=0,_=!1,b=!1,w=!0;if("function"!=typeof e)throw new TypeError(wl);return t=bl(t)||0,yl(n)&&(_=!!n.leading,b="maxWait"in n,v=b?kl(bl(n.maxWait)||0,t):v,w="trailing"in n?!!n.trailing:w),d.cancel=c,d.flush=l,d}function Ot(e){var t=e&&e.constructor,n="function"==typeof t&&t.prototype||Al;return e===n}function Rt(e,t){return function(n){return e(t(n))}}function It(e){if(!Il(e))return Ml(e);var t=[];for(var n in Object(e))Fl.call(e,n)&&"constructor"!=n&&t.push(n);return t}function Mt(e){return wd(e)&&bd(e)==kd}function Dt(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=Od}function Ft(e){return null!=e&&Md(e.length)&&!Id(e)}function Bt(){return!1}function Nt(e){return jd(e)&&qd(e.length)&&!!ff[Nd(e)]}function qt(e){return function(t){return e(t)}}function jt(e){if(null==e)return!0;if(xf(e)&&(Tf(e)||"string"==typeof e||"function"==typeof e.splice||Af(e)||Pf(e)||Ef(e)))return!e.length;var t=Sf(e);if(t==Cf||t==Of)return!e.size;if(Lf(e))return!kf(e).length;for(var n in e)if(If.call(e,n))return!1;return!0}function Vt(e,t){var n=e,i=t;return n%320!==0&&(n=100*Math.ceil(e/100),i=Math.round(n/e*t)),{width:n,height:i}}function Ut(e){var t=e.width,n=e.height,i=e.baseUrl,r=e.webpSupport,o=void 0!==r&&r,a=e.crop,s=void 0!==a&&a,u=i+(o?".webp":".jpg"),c={},l=parseInt(t,10),d=parseInt(n,10);return 0!==l&&(s?c.w=l:c.mw=l),0!==d&&(s?c.h=d:c.mh=d),$i.devicePixelRatio>1&&(c.q=70),Mf(c)||(u+="?"+xt(c)),u}function Ht(e){return new Vi(function(t,n){var i=new Image;i.src=e,i.onload=function(){return t(i)},i.onerror=function(){return n(new Error("Failed to load image."))}})}function Wt(e,t,n){function i(){n.classList.remove("vp-preview-invisible")}function r(){n.classList.add("vp-preview-invisible")}function o(){return n.classList.contains("vp-preview-invisible")}function a(){n.setAttribute("data-thumb",""),n.setAttribute("data-thumb-width",""),n.style.backgroundImage=""}function s(){return n.getAttribute("data-thumb")}function u(){var e=t.get("ui.player.innerWidth")*$i.devicePixelRatio,n=t.get("ui.player.innerHeight")*$i.devicePixelRatio;return Vt(e,n)}function c(){if(!e.config.video.thumbs.base)return Vi.resolve();var i=u(),r=i.width,o=i.height,a=Ut({width:r,height:o,baseUrl:e.config.video.thumbs.base,webpSupport:e.config.request.flags.webp});if(n.setAttribute("data-thumb",a),n.setAttribute("data-thumb-width",r),e.config.embed.autoplay&&"beginning"!==e.config.embed.outro)return Vi.resolve();var s=Ht(a).then(function(e){return n.style.backgroundImage="url("+e.src+")",t.dispatch(xl(e.width,e.height)),e}).catch(function(e){el.captureException(e,{extra:{thumbnailUrl:a}})});return Vi.race([s,new Vi(function(e){return setTimeout(e,2e3)})])}function l(){var e=u(),t=e.width,i=n.getAttribute("data-thumb-width");return t<=parseInt(i,10)||0===t?Vi.resolve():c()}function d(){f=c(),e.events.on(kc.didEnterFullscreen,function(){o()&&"beginning"!==e.config.embed.outro||(f=c())}),t.watch("ui.player.innerWidth",El(function(){f=f.then(function(){return l()}).catch(function(e){})},250)),t.watch("ui.preview.scaleFactor",function(e){e>1?n.classList.add("vp-preview-cover"):n.classList.remove("vp-preview-cover")})}var f=null;return d(),{show:i,hide:r,resetThumbnail:a,getThumbnail:s,loadThumbnail:c,thumbnailPromise:f}}function zt(e){return e===!0||e===!1?Number(e):"null"===e?null:e}function Gt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.cookie;try{if(t&&""!==t)return t.split(";").reduce(function(t,n){return n=n.trim(),0===n.indexOf(e+"=")?decodeURIComponent(n.substr(e.length+1)):t},null)}catch(e){}return null}function Kt(e,t,n){var i=new Date;i.setFullYear(i.getFullYear()+1),i=i.toGMTString(),t=zt(t);var r=e+"="+t+";";r+="expires="+i+";",r+="path=/;",r+="domain="+n+";";try{return document.cookie=r,!0}catch(e){return!1}}function Yt(e){function t(t){return new Vi(function(n,i){var r=document.createElement("a");r.href=e.config.request.urls.proxy;var o=document.createElement("iframe");o.src=t,o.setAttribute("title","Vimeo LocalStorage Proxy"),o.setAttribute("aria-hidden","true"),o.setAttribute("hidden",""),o.onload=function(t){var n=Ae(e.config.request.urls.proxy);o.contentWindow.postMessage({method:"ping"},n)},o.onerror=function(e){i(e)};var a=setTimeout(function(){i()},1e4),s=function e(i){0!==t.indexOf(i.origin)||"ready"!==i.data&&"ping"!==i.data||(window.removeEventListener("message",e,!1),clearTimeout(a),n(o))};window.addEventListener("message",s,!1),document.body.appendChild(o)})}function n(){y&&!Ff&&(Ff=t(e.config.request.urls.proxy))}function i(t){return Ff.then(function(n){var i=Ae(e.config.request.urls.proxy);return n.contentWindow.postMessage(t,i),n}).catch(function(t){el.captureException(t,{extra:{proxyUrl:e.config.request.urls.proxy}})})}function r(t){e.config.embed.on_site&&window.postMessage(t,window.location.origin)}function o(t,n){if(Ff){var o={method:"set",key:"sync_"+t,val:n,session:e.config.request.session};return i(o),void r(o)}try{window.localStorage.setItem("sync_"+t,JSON.stringify(n))}catch(e){}}function a(t,n){Df.indexOf(t)>=0&&(e.config.request.cookie[t]=n);var i=[];Df.indexOf(t)>=0&&null!==n&&i.push(t+"="+n);var r=s(Df);for(var o in r)o in r&&null!==r[o]&&o!==t&&i.push(o+"="+r[o]);Kt("player",'"'+i.join("&")+'"',e.config.request.cookie_domain)}function s(e){var t=null;try{t=Gt("player")}catch(e){}if(!t)return null;t=t.substring(1,t.length-1);var n={};t.split("&").forEach(function(e){e=e.split("="),n[e[0]]=zt(decodeURIComponent(e[1]||""))});var i=[].concat(e),r=i.reduce(function(e,t){if(t in n){var i=parseFloat(n[t]);return e[t]=isNaN(i)||"quality"===t?n[t]:i,e}return e[t]=null,e},{});return 1===i.length?r[e]:r}function u(e,t){t=zt(t),o(e,t),a(e,t)}function c(t,n){var i=!0;switch(t){case"sync_quality":e.events.fire(wc.changeQuality,n,i);break;case"sync_volume":e.events.fire(wc.changeVolume,n,i);break;case"sync_captions":if(null===n){e.events.fire(wc.turnCaptionsOff,i);break}e.events.fire(wc.turnCaptionsOn,n,i);break;case"sync_login":l(n);break;case"sync_active":null!==n&&n!==e.config.request.session&&e.config.embed.autopause&&e.events.fire(kc.becameInactive)}}function l(t){_>4||(_++,t&&!e.config.user.logged_in?e.events.fire(kc.userLogIn):!t&&e.config.user.logged_in&&e.events.fire(kc.userLoggedOut))}function d(){u("login",!!e.config.user.logged_in)}function f(){e.events.on(kc.qualityChanged,function(e,t){t||u("quality",e)})}function h(){e.events.on(kc.volumeChanged,function(t,n){e.config.request.cookie.volume=zt(t),n||u("volume",t)})}function v(){e.events.on(kc.captionsChanged,function(t,n){if(t){var i=t.language+"."+t.kind;return e.config.request.cookie.captions=zt(i),void(n||u("captions",i))}e.config.request.cookie.captions=null,n||u("captions",null)})}function p(){e.events.on(kc.playButtonPressed,function(){e.config.embed.settings.background||(u("active",e.config.request.session),e.events.fire(kc.becameActive))}),e.events.on([kc.pauseButtonPressed,kc.ended],function(){s("active")===e.config.request.session&&u("active",null)})}function m(){e.events.on(kc.userLoggedIn,function(){u("login",!0)})}function g(){return y?void window.addEventListener("message",function(t){var n=Ae(e.config.request.urls.proxy);t.origin===n&&"object"===Zu(t.data)&&"key"in t.data&&"newValue"in t.data?c(t.data.key,t.data.newValue):t.origin===window.location.origin&&t.data.session!==e.config.request.session&&c(t.data.key,t.data.val)},!1):void window.addEventListener("storage",function(e){if(0===e.key.indexOf("sync_")&&e.oldValue!==e.newValue&&window.localStorage.getItem(e.key)===e.newValue)try{c(e.key,JSON.parse(e.newValue))}catch(t){el.captureException(t,{extra:{key:e.key,oldValue:e.oldValue,newValue:e.newValue}})}},!1)}var y=0!==e.config.request.urls.proxy.indexOf(window.location.origin),_=0;return f(),h(),v(),p(),m(),n(),g(),{reset:d}}function Xt(e){e=e.toLowerCase();var t=new RegExp(e).test(Xf);return"safari"===e?t&&new RegExp("version").test(Xf):t}function $t(e){var t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),i=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(var r in i){var o=i[r];if(void 0!==t.style[o])return o}return e}function Qt(){var e=navigator,t=!1,n=[0,0,0],i=null,r="Shockwave Flash",o="application/x-shockwave-flash",a="ShockwaveFlash.ShockwaveFlash";if("undefined"!=typeof e.plugins&&"object"==typeof e.plugins[r])i=e.plugins[r].description,!i||"undefined"!=typeof e.mimeTypes&&e.mimeTypes[o]&&!e.mimeTypes[o].enabledPlugin||(t=!0,i=i.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),n[0]=parseInt(i.replace(/^(.*)\..*$/,"$1"),10),n[1]=parseInt(i.replace(/^.*\.(.*)\s.*$/,"$1"),10),n[2]=/[a-zA-Z]/.test(i)?parseInt(i.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if("undefined"!=typeof window.ActiveXObject)try{var s=new ActiveXObject(a);s&&(i=s.GetVariable("$version"),i&&(t=!0,i=i.split(" ")[1].split(","),n=[parseInt(i[0],10),parseInt(i[1],10),parseInt(i[2],10)]))}catch(e){}return{installed:t,version:n.join("."),major:n[0],minor:n[1],revision:n[2]}}function Jt(){return(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||MediaSource.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"'))}function Zt(){if(!Xt("safari"))return[];var e=Xf.split(" ").find(function(e){return/version\//.test(e)});return e?e.replace("version/","").split(".").map(function(e){return parseInt(e,10)}):[]}function en(){if(!Xt("chrome"))return[];var e=Xf.split(" ").find(function(e){return th?/CriOS\//.test(e):/chrome\//.test(e)});return e?e.replace("chrome/","").split(".").map(function(e){return parseInt(e,10)}):[]}function tn(){return!!(nh&&rh||nh&&oh)||"undefined"!=typeof MediaSource&&MediaSource.isTypeSupported('video/mp4; codecs="hvc1"')}function nn(){return!(ih.iOS||ih.iPad||ih.browser.ie)&&(!Xt("safari")||(Zt()[0]>11||11==Zt()[0]&&(Zt()[2]>1||Zt()[1]>0)))}function rn(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var u=0,c=t[a].length;u<c;u++)if(t[a][u].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function on(e,t,n){var i=void 0;try{document.removeChild({})}catch(r){i=Object.create(Object.getPrototypeOf(r),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:n,configurable:!0,writable:!0},toString:{value:function(){return t+": DOM Exception "+e},configurable:!0,writable:!0}})}return Object.freeze(i)}function an(e,t){var n,i=0;return n={},Vf(n,Au.iterator,function(){return this}),Vf(n,"next",function(){if(i<e.length){var n=t?[e[i],t[i++]]:e[i++];return{done:!1,value:n}}return{done:!0}}),n}function sn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.getFileById=vh,e}function un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.item=function(e){return this[e]},e.getTrackById=vh,e}function cn(e,t){for(var n=e,i=Array.isArray(n),r=0,n=i?n:n[Au.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if(r=n.next(),r.done)break;o=r.value}var a=o,s=Gf(a,2),u=s[0],c=s[1];if(u<=t&&c>=t)return[u,c]}return[]}function ln(){return"undefined"!=typeof window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function dn(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(e){return(e^(16*Math.random()>>e)/4).toString(16)})}function fn(e){for(var t=window.atob(e),n=t.length,i=new Uint8Array(n),r=0;r<n;r++)i[r]=t.charCodeAt(r);return i}function hn(e){return fn(e).buffer}function vn(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;i<r;i++)n[i]=e.charCodeAt(i);return n}function pn(e){return setTimeout(e,0)}function mn(e,t,n,i){var r=0,o=0,a=0,s=0,u=e,c=t,l=n/i,d=u/c;return d>=l?(o=c,r=(l*c).toFixed(2)):(r=u,o=(u/l).toFixed(2)),a=Math.max((u-r)/2,0),s=Math.max((c-o)/2,0),{width:r,height:o,left:a,top:s}}function gn(e){var t=/^(-)?P(?:(-?[0-9,.]*)Y)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)W)?(?:(-?[0-9,.]*)D)?(?:T(?:(-?[0-9,.]*)H)?(?:(-?[0-9,.]*)M)?(?:(-?[0-9,.]*)S)?)?$/,n=t.exec(e),i=0;if("undefined"!=typeof n[8]&&(i+=n[8]),"undefined"!=typeof n[7]&&(i+=60*n[7]),"undefined"!=typeof n[6]&&(i+=3600*n[6]),"undefined"!=typeof n[5]&&(i+=86400*n[5]),"undefined"!=typeof n[4]&&(i+=604800*n[4]),"undefined"!=typeof n[3]&&(i+=2628e3*n[3]),"undefined"!=typeof n[2]&&(i+=3154e4*n[2]),0!==i)return i}function yn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return Object.freeze(Vf({get length(){return e.length},start:function(t){return ph(e,t)},end:function(e){return ph(t,e)}},Au.iterator,function(){return an(e,t)}))}function _n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(0===e.length)return 0;for(var n=0,i=0,r=0;r<e.length;r++){var o=t[r]||1;i+=o,n+=e[r]*o}return n/i}function bn(e,t){if(e.sort(),0===e.length)return 0;if(t<=0)return e[0];if(t>=1)return e[e.length-1];var n=e.length*t,i=Math.floor(n),r=i+1,o=n%1;return r>=e.length?e[i]:e[i]*(1-o)+e[r]*o}function wn(e){e.sort(function(e,t){return e-t});var t=Math.floor(e.length/2);return e.length%2?e[t]:(e[t-1]+e[t])/2}function kn(e){return e?e.split("\n").reduce(function(e,t){var n=t.indexOf(":"),i=t.substring(0,n),r=t.substring(n+1);return"undefined"!=typeof i&&"undefined"!=typeof r&&(e[i.trim().toLowerCase()]=r.trim()),e},{}):{}}function Sn(e){e=e||{};var t={};return e.on=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to listen for an undefined event.");t[a]||(t[a]=[]),t[a].push(i)}return e},e.once=function(t,n){function i(){n.apply(e.off(t,i),arguments)}return i.handler=n,e.on(t,i)},e.off=function(n,i){n=[].concat(n);for(var r=0,o=n.length;r<o;r++){var a=n[r];if(!a)throw new Error("Tried to remove an undefined event.");if(a in t){var s=t[a].indexOf(i);if(s===-1){for(var u=0,c=t[a].length;u<c;u++)if(t[a][u].handler===i){s=r;break}if(s===-1)return e}t[a].splice(s,1)}}return e},e.fire=function(n){if(!n)throw new Error("Tried to fire an undefined event.");if(n in t)for(var i=t[n].slice(0),r=0,o=i.length;r<o;r++)i[r].apply(e,i.slice.call(arguments,1));return e},e}function En(e,t){return Object.keys(t).reduce(function(n,i){return t[i]&&"object"===Zu(t[i])?n[e(i)]=En(e,t[i]):n[e(i)]=t[i],n},{})}function Tn(e){return e.replace(/(_\w)/g,function(e){return e[1].toUpperCase()})}function xn(e){return En(Tn,e)}function An(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case hp:var r=i.video.liveEvent;return ic({},e,{liveStatus:r?r.status:null,liveArchiveStatus:r&&r.archive?r.archive.status:null});case lp:return ic({},e,{liveStatus:i?i.status:null,liveArchiveStatus:i&&i.archive?i.archive.status:null});case up:return ic({},e,{liveStatus:i});case cp:return ic({},e,{liveArchiveStatus:i});default:return e}}function Ln(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case hp:return ic({},e,i.video.liveEvent);case lp:return ic({},e,i);default:return e}}function Pn(e){return function(t){return dc[t.mime]===e}}function Cn(e){var t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function On(e){return e.quality||e.metadata.quality}function Rn(e){return"string"!=typeof e&&(e=On(e)),parseInt(e,10)}function In(e){return Rn(e)>=720}function Mn(e){var t=Ws(e).filter(Cn).map(On);return function(e){return!(t.indexOf(On(e))!==-1&&!Cn(e))}}function Dn(e){return function(t){if(!e.length)return!0;var n="number"!=typeof t.id?parseInt(t.id,10):t.id;return e.indexOf(n)!==-1}}function Fn(e){return"object"!==("undefined"==typeof e?"undefined":Zu(e))?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function Bn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc";return function(t,n){var i=Rn(t),r=Fn(t),o=Rn(n),a=Fn(n);return"asc"===e?i-o||r-a:o-i||a-r}}function Nn(e){var t=On(e),n={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(var i in n)t=t.replace(i,n[i]);return t}function qn(e){var t=e.files,n=void 0===t?[]:t,i=e.preference,r=void 0===i?"360p":i,o=e.priorityOffset,a=void 0===o?0:o;n=Ws(n),n.sort(Bn());var s=n.map(On);if(r){s.indexOf(r)===-1&&(s.push(r),s.sort(function(e,t){return Rn(t)-Rn(e)}));var u=s.indexOf(r),c=s.splice(0,u);c.reverse(),s.push.apply(s,c)}return n.map(function(e){return{id:e.id,src:e.url,mime:e.mime,priority:s.indexOf(e.quality)+1+a,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}}})}function jn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n={feature:t,$deeplink_path:Up+e,$always_deeplink:!0,ref:"player",context:"player"},i="",r=[];for(var o in n)r.push(encodeURIComponent(o)+"="+encodeURIComponent(n[o]));return i=r.join("&"),"https://bnc.lt/a/"+Hp+"?"+i}function Vn(e,t){return jn("videos/"+e,t)}function Un(e,t,n){function i(){e.events.fire(kc.bufferStarted,{initial:!0}),fe=!0,de=!0}function r(){de&&(e.events.fire(kc.bufferEnded),fe=!1,de=!1)}function o(t){J.classList.remove("invisible"),e.events.fire(kc.playInitiated),i()}function a(){var n="disable"!==e.config.video.privacy&&e.config.video.spatial&&$i.iOS&&!Le;if(n||J.classList.remove("invisible"),_e)return e.events.fire(kc.error,_e),
void e.preview.show();if(oe=!0,ae=!0,be)return void e.preview.show();if(Z.off(mh.PLAY,o),!ue){if(e.config.video.spatial&&$i.iOS&&!Le)return Le=!0,e.events.fire(wc.showOverlay,"app-redirect",{redirectUrl:e.doNotTrackEnabled?"https://itunes.apple.com/us/app/apple-store/id425194759?mt=8":Vn(e.config.video.id,"player-spatial-redirect"),title:null,buttonText:"Watch in the Vimeo app",ignoreText:null,bottomText:"360 not supported in this browser",newWindow:!e.config.embed.on_site}),void Z.once(mh.PLAY,o);e.events.fire(kc.playInitiated),i(),ue=!0,Z.play(),!e.config.user.progress||te||!e.config.embed.settings.playbar||e.config.embed.autoplay||e.config.embed.time||(Z.currentTime=e.config.user.progress,e.config.user.progress=0)}t.get(yp)&&Z.paused&&(e.events.fire(kc.controlbarBufferStarted),de=!0),ie&&(ke=!0,e.events.fire(wc.forceFullscreen)),ge&&s()}function s(){pe||be||(fe=!1,me=!1,ae&&Z.paused&&($&&(Z.currentTime=$,$=null),Z.play()))}function u(e,t){var n=e.length-1;if(e.length>1)for(var i=0,r=e.length;i<r;i++)if(e.start(i)<=t&&e.end(i)>=t){n=i;break}return n}function c(t){if(!ye&&Z.buffered&&Z.buffered.length>0){t=t||Z.currentTime;var n=u(Z.buffered,t),i=Z.buffered.end(n),r=i/Z.duration;if(e.events.fire(kc.loadProgress,i,Z.duration,r),de&&ae&&i===Z.duration)return void s()}}function l(t){for(var n=t.target,i=n.activeCues,r=[],o=void 0,a=0,s=i.length;a<s;a++)""!==i[a].text.replace(/^\s+|\s+$/gm,"")&&(o=document.createElement("span"),o.appendChild(i[a].getCueAsHTML()),r.push({html:o.innerHTML.replace("\n","<br>"),text:i[a].text}));e.events.fire(kc.cueChanged,n,r)}function d(){var n=e.config.request,i=n.signature,r=n.timestamp,o=n.expires,a=t.get("liveEvent");return Mf(a)?null:Object.assign({},a,{appPollUrl:"https://"+e.config.vimeo_url+"/live_event/status?clip_id="+e.config.video.id,playlistRefreshUrl:"https://"+e.config.player_url+"/live/"+e.config.video.id+"/playlist/refresh?signature="+i+"&time="+r+"&expires="+o,sessionRefreshUrl:"https://"+e.config.player_url+"/live/"+e.config.video.id+"/session/refresh?signature="+i+"&time="+r+"&expires="+o})}function f(t){switch(t){case vc.started:if(q(),J.classList.remove("invisible"),e.events.fire(kc.liveEventStarted),$i.android||$i.iOS)return;e.events.fire(kc.playButtonPressed);break;case vc.ended:e.events.fire(kc.liveEventEnded),e.events.fire(kc.ended);break;case vc.active:e.events.fire(kc.liveEventActive)}}function h(){t.watch("ui.liveEvent.liveStatus",f)}function v(){t.watch("ui.video.scaleFactor",function(e){e>1?J.classList.add("vp-telecine-cover"):J.classList.remove("vp-telecine-cover")})}function p(){var n=void 0,i=void 0;e.config.request.ab_tests&&e.config.request.ab_tests.bba&&(i=e.config.request.ab_tests.bba.group);var r=50;$i.spatialPlayback&&e.config.video.spatial&&(r=35);var o=[vv,Bv,qh,qv],a="undefined"==typeof e.config.video.file_codecs?null:e.config.video.file_codecs;Z=new ep(J,o,{externalDisplays:[AirPlayExternalDisplay],swfScanner:{swfUrl:e.config.request.urls.flideo},mediaSourceScanner:{maxPreloadStreamIndex:n,shouldUseBBA:i,droppedFrameSwitchPercent:r},liveEvent:d(),tests:e.config.request.ab_tests,fileCodecs:a}),Object.keys(mh).forEach(function(e){var t=mh[e];t!==mh.TIME_UPDATE&&t!==mh.PROGRESS&&t!==mh.SUSPEND&&t!==mh.ERROR&&Z.on(t,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};el.captureBreadcrumb(t,e,"video event")})}),Z.on(_h.SCANNER_CHANGE,function(){m(),setTimeout(function(){e.events.fire(Z.supportsSettingVolume?wc.enableVolume:wc.disableVolume),e.events.fire(Z.supportsTextTracks?wc.enableCaptions:wc.disableCaptions)},0),el.captureBreadcrumb("Scanner changed to "+Z.currentScanner,{},"video")}),Z.on(_h.CURRENT_FILE_CHANGE,function(t){el.captureBreadcrumb("Current file changed",{id:t.id,mime:t.mime,src:t.src,metadata:t.metadata},"video");var n=t.metadata.quality;if(t.mime===fc.dash){var i=e.config.request.files.dash.streams.map(function(e){return e.quality});n=C(e.config.embed.quality,i)||"auto",O(n)}e.events.fire(kc.qualityChanged,n,!0)}),Z.on(_h.STREAM_CHANGE,function(t){var n=t.index,i=t.streams,r=i[n],o=e.config.request.files.dash.streams.find(function(e){return e.id===parseInt(r.id,10)});"undefined"!=typeof o?(r.profile=o.profile,r.quality=o.quality,r.fps=o.fps):(r.profile=null,r.quality=r.height+"p",r.fps=r.framerate),el.captureBreadcrumb("Stream changed",r,"video"),e.events.fire(kc.streamChanged,r,n,i)}),Z.on(_h.STREAM_BUFFER_START,function(t){var n=t.hasLowerStreamIndex;el.captureBreadcrumb("Started buffering",{hasLowerStreamIndex:n},"video"),e.events.fire(kc.ranIntoBuffer,n)}),Z.on(_h.STREAM_BUFFER_END,function(){el.captureBreadcrumb("Stopped buffering",{},"video"),e.events.fire(kc.playbackResumed)}),Z.on(_h.BANDWIDTH,function(t){e.events.fire(kc.adaptiveBandwidth,t)}),Z.on(_h.CUE_POINT,function(t){e.events.fire(kc.cuepoint,t)}),Z.on(wh.MOTION_START,function(){e.events.fire(kc.spatialMotionStart)}),Z.on(wh.MOTION_START,function(){e.events.fire(kc.spatialMotionEnd)}),Z.on(_h.DROPPED_FRAMES,function(t){e.events.fire(kc.droppedFrames,t)}),Z.on(_h.DOWNLOAD_END,function(t){e.events.fire(kc.segmentDownloaded,t)}),Z.on(_h.STREAM_TARGET_CHANGE,function(t){var n,i=t.streams[t.index],r=e.config.request.files.dash.streams.find(function(e){return e.id===parseInt(i.id,10)});"undefined"!=typeof r&&(i.profile=r.profile,i.quality=r.quality,i.fps=r.fps);var o=[i,t.index,t.streams];(n=e.events).fire.apply(n,[kc.streamTargetChange].concat(o))}),Z.on(_h.AV_DURATION_MISMATCH,function(t){e.events.fire(kc.videoDurationMismatch,t)}),Z.on(bh.STREAM_ONLINE,function(){e.events.fire(kc.liveStreamOnline)}),Z.on(bh.STREAM_OFFLINE,function(){e.events.fire(kc.liveStreamOffline)}),Z.on(bh.REPRESENTATIONS_AVAILABLE,function(t){e.config.request.files.dash.streams=t.video.map(function(e){return{quality:e.height+"p"}}),e.events.fire(kc.liveRepresentationsAvailable,t)}),Z.on(bh.EVENT_STARTED,function(e){t.dispatch(fp(e)),t.dispatch(dp(vc.started))}),Z.on(bh.EVENT_ENDED,function(e){return t.dispatch(dp(vc.ended))}),Z.on(bh.EVENT_ACTIVE,function(){return t.dispatch(dp(vc.active))}),e.events.fire(kc.telecineReady)}function m(){var t="none";("metadata"===e.config.request.flags.preload_video||ie||$i.iOS>=8)&&(t="metadata"),"auto"===e.config.request.flags.preload_video&&(t="metadata","MediaSourceScanner"===Z.currentScanner&&(t="auto")),Z.preload=t,e.events.on(kc.mousedOver,function(){e.config.request&&"metadata_on_hover"===e.config.request.flags.preload_video&&!ue&&e.verifyConfig().then(function(){return Z.preload="metadata",!0}).catch(function(e){})})}function g(){Z.on(mh.LOADED_METADATA,function(t){ge=!0;var n=Z.duration;isFinite(n)&&n>0&&(e.config.video.duration=n),e.config.video.video_width=Z.videoWidth,e.config.video.video_height=Z.videoHeight}),Z.on(mh.LOADED_DATA,function(){0===Z.currentTime&&Z.paused&&r()}),Z.on(mh.DURATION_CHANGE,function(t){var n=Z.duration;isFinite(n)&&(e.config.video.duration>0&&(n<e.config.video.duration-1||n>e.config.video.duration+1)||(e.config.video.duration=n))}),Z.on(mh.WAITING,function(){return"LiveScanner"===Z.currentScanner?void i():void(ve||i())}),Z.on(mh.CAN_PLAY,function(){ce=!0,r(),"LiveScanner"!==Z.currentScanner&&(e.config.embed.autoplay||ae||oe&&!ue)&&s()}),Z.on(mh.CAN_PLAY_THROUGH,function(){le=!0,r(),"LiveScanner"!==Z.currentScanner&&(oe&&!ue&&s(),(fe||ae&&Z.paused)&&s())}),Z.on(mh.PROGRESS,function(e){c()})}function y(){e.events.on(kc.playButtonPressed,a).on(kc.pauseButtonPressed,function(){ae=!1,Z.pause(),t.get(pp)&&de&&r()}).on(kc.becameInactive,function(){window.location.search.indexOf("autopause=0")<0&&!Z.paused&&!e.config.embed.settings.background&&(ae=!1,e.events.fire(kc.pauseButtonPressed))}),Z.on(mh.PLAY,function(t){return ye=!1,ue||ce&&le?(J.classList.remove("invisible"),void e.events.fire(kc.played,Z.currentTime)):(e.events.fire(kc.playInitiated),ue=!0,oe=!0,void(ae=!0))}),Z.on(mh.PAUSE,function(t){!ue||fe||pe||me||e.events.fire(kc.paused,Z.currentTime,Z.ended)}),Z.on(mh.PLAYING,function(t){ue||(e.events.fire(kc.playInitiated),ue=!0),c(),he=!0}),Z.on(mh.TIME_UPDATE,function(t){var n=Z.currentTime;if(he&&de&&n>0&&(he=!1,r()),Z.buffered.length>0&&!de){var o=u(Z.buffered,n),a=Z.buffered.end(o);if(!ke&&n>0&&n<Z.duration&&a===n)return void i()}if(!ye){var s=Z.duration,c=n/s,l=Z.playbackRate;e.events.fire(kc.playProgress,n,s,c,l),$&&n>$&&($=null)}ee&&(ee.classList.add("hidden"),ee=null)}),Z.on(mh.ENDED,function(n){if(!pe)if(e.config.embed.loop)Z.play();else{if(ke&&e.events.fire(kc.fullscreenButtonPressed),ae=!1,oe=!1,we)return;if(t.get(yp))return;e.events.fire(kc.ended,n)}}),Z.on(_h.DRM_AUTH_SUCCESS,function(e){se=!0}),e.events.on(kc.playInitiated,function(){Z.once(mh.TIME_UPDATE,function(){return e.events.fire(kc.firstTimeUpdate)})}),e.events.on(kc.hudDisplayed,function(){we=!0}),e.events.on(kc.hudHidden,function(){we=!1,Z.ended&&e.events.fire(kc.ended)}),e.events.on(kc.bufferStarted,function(){pe||e.events.fire(bc.bufferStarted)})}function _(){function t(t){if(!n){if(el.captureBreadcrumb(t.name,{message:t.message},"telecine error","error"),"TextTracksNotSupported"===t.name)return void e.events.fire(wc.disableCaptions);var i=Vp[t.name]();if(_e=i.deferred?i.id:null,"DRMFailure"===t.name){var r=e.config.request.dynamic_drm_translation_map,o=t.message.code;r&&o&&r[o]&&(i.title=r[o].title,i.message=r[o].msg),el.captureBreadcrumb("DRM failure",t,"video")}e.events.fire(kc.error,i.id,i)}}var n=!1;pt(function(){n=!0}),Z.on(mh.ERROR,t),e.events.on("test-error",t)}function b(){e.events.on(wc.changeLoop,function(t){var n=!!t&&(!$i.iOS||$i.iOS>=10);e.config.embed.loop=n,Z.loop=n}),e.events.fire(wc.changeLoop,e.config.embed.loop)}function w(){e.events.on(kc.scrubbingStarted,function(){be||(i(),ae=!Z.paused,pe=!0,Z.pause())}),e.events.on(kc.scrubbingEnded,function(e){pe=!1,e||s()}),e.events.on(wc.seek,function(t,n){be||(n||(n=(Z.duration||e.config.video.duration)*Pe(t,0,1)),n=Pe(n,0,Z.duration||e.config.video.duration),ue||(e.events.fire(kc.playButtonPressed),ue=!0,oe=!0,ae=!0),Z.currentTime=n)}),Z.on(mh.SEEKING,function(){ve=!0},!1),Z.on(mh.SEEKED,function(){c();var t=Z.currentTime,n=Z.duration;e.events.fire(kc.seeked,t,n,t/n),ve=!1},!1),e.events.on(wc.setTime,function(t,n){t=Pe(t,0,Z.duration||e.config.video.duration),Z.currentTime=t})}function k(){e.events.on(wc.changeVolume,function(t,n,i){i&&(t+=Z.volume),Z.volume=Pe(t,0,1),Z.muted=0===Z.volume,e.events.fire(kc.volumeChanged,Pe(t,0,1),n)}),Z.on(mh.VOLUME_CHANGE,function(){return e.events.fire(kc.volumeChanged,Z.volume,!0)});var t=e.config.embed.muted?0:e.config.request.cookie.volume;e.events.fire(wc.changeVolume,t,!0)}function S(){e.events.on(wc.changeQuality,function(n,i){if(Z.video.currentFile.mime===fc.dash||t.get(yp))i=!0,O(n);else{var r=Ws(e.telecine.video.files).filter(Dn(Ce)).filter(function(e){return e.metadata.quality===n});r.sort(Bn()),r.length>0&&(ye=!0,Z.video.currentFile=r[0])}e.events.fire(kc.qualityChanged,n,i)});var n=Z.playbackRate;Z.on(mh.RATE_CHANGE,function(t){Z.playbackRate!==n&&(e.events.fire(kc.playbackRateChanged,Z.playbackRate,n),n=Z.playbackRate)}),e.events.on(wc.changePlaybackRate,function(e){Z.defaultPlaybackRate=e,Z.playbackRate=e}),e.events.on(kc.loadVideo,function(){Z.defaultPlaybackRate=1,Z.playbackRate=1})}function E(){function t(){be=!0,ue&&!Ee&&(ae=ae||!Z.paused,Z.pause(),e.events.fire(kc.paused,Z.currentTime))}function n(){be=!1,ae&&!Ee&&(ke||Se||!ie||e.events.fire(wc.forceFullscreen),s())}function i(e,i){i.isCentered()&&(i.isVisible()?t():n())}e.events.on(kc.overlayOpened,t),e.events.on(kc.overlayClosed,n),e.events.on(kc.menuVisibilityChanged,i)}function T(){e.events.on(kc.popupOpened,function(e){ue&&!Ee&&(ae=!Z.paused,Z.pause())}),e.events.on(kc.popupClosed,function(e){Ee||s()})}function x(){e.events.on(kc.didEnterFullscreen,function(t,n){J.classList.remove("hide-webkit-controls"),t&&(Se=!0),t||(ue||$i.browser.safari||(Z.poster=e.preview.getThumbnail()),ke=!0,setTimeout(function(){Z.video.textTracks.forEach(function(e){"hidden"===e.mode&&(e.mode="showing")})},500)),n||!$i.windowsPhone||$i.browser.edge||e.events.fire(wc.toggleNativeControls,!0)}),e.events.on(kc.didExitFullscreen,function(e){Z.poster="",e||Z.pause(),ue||J.classList.add("invisible"),ke=!1,Se=!1,re&&J.classList.add("hide-webkit-controls"),Z.video.textTracks.forEach(function(e){"showing"===e.mode&&(e.mode="hidden")})}),e.events.on(kc.playInitiated,function(){Z.poster=""})}function A(){e.events.on(wc.toggleNativeControls,function(e){return e?(Z.controls=!0,void n.classList.add("native-controls")):(Z.controls=!1,void n.classList.remove("native-controls"))})}function L(){e.events.on(kc.signatureExpired,function(){$=Z.currentTime}),e.events.on(kc.requestConfigReloaded,function(e){var t=!1;q(t)}),e.events.on(kc.configChanged,function(e,n){t.get(pp)&&Z.initLiveEvent(d()),q(e),z()})}function P(){e.events.on(wc.reset,function(){ye=!0,Z.paused||(Z.pause(),e.events.fire(kc.paused,Z.currentTime)),e.preview.show(),J.classList.add("invisible"),ue=!1,ae=!1,_e=null,setTimeout(function(){Z.currentTime=0},300)})}function C(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.config.embed.on_site||$i.android||$i.iOS||$i.windowsPhone||e.config.video.vod||!t?null:n.length&&n.indexOf(t)===-1?null:(e.events.fire(kc.forcedQuality,t),t)}function O(t){if("auto"===t)return Z.video.currentFile.restrictedStreamIndexes=[],void(Ae=!1);var n=Ws(e.config.request.files.dash.streams),i=n.filter(Dn(Ce)).sort(Bn("asc")).map(function(e){return e.quality}).indexOf(t);i!==-1&&(el.captureBreadcrumb("Switched to "+t,{},"video"),Z.video.currentFile.restrictedStreamIndexes=[i],Ae=i)}function R(){var n=e.config.request.files;if(!n.dash)return null;var i=n.dash.default_cdn,r=n.dash.cdns[i].url?n.dash.cdns[i].url:t.get(Sp,null);return{id:"dash-"+i+"-"+e.config.video.id,src:r,mime:t.get(wp)?fc.dash:fc.dashMpd,priority:1,metadata:{cdn:i,origin:n.dash.cdns[i].origin,quality:"sd"}}}function I(){var n=e.config.request.files;if(n.hls&&($i.iPhone||$i.iPad)){var i=n.hls.default_cdn,r=n.hls.cdns[i].url?n.hls.cdns[i].url:t.get(Ep,null);return{id:"hls-"+i+"-"+e.config.video.id,src:r,mime:fc.hlsLive,priority:2,metadata:{cdn:i,origin:n.hls.cdns[i].origin,quality:"sd"}}}return null}function M(){var e=[],t=R();t&&e.push(t);var n=I();return n&&e.push(n),e}function D(){if(t.get(yp)||t.get(wp))return M();var n=e.config.request.files,i=Ws(n.progressive).filter(Dn(Ce)).filter(Mn(n.progressive)),r=i.some(In);$i.mobileAndroid&&(r=!1);var o="720p";if(r){var a=Ws(i).map(On);a.indexOf("1080p")!==-1&&a.indexOf("720p")===-1&&(o="1080p")}var s=e.config.request.cookie.hd||e.config.video.default_to_hd?o:"360p",u=i.map(function(e){return e.quality}),c=C(e.config.embed.quality,u),l=e.config.request.cookie.quality||c||s,d=qn({files:i,preference:l,priorityOffset:2}),f=e.config.request.drm&&$i.browser.safari;if(n.hls&&($i.iPhone||$i.iPad)||f){var h=n.hls.default_cdn,v=n.hls.cdns[h].url;if(Ce.length>0){var p=/\/(((\d+),?)+)\/master\.m3u8/,m=p.exec(v);null!==m&&(v=v.replace(m[1],Ce.join(",")))}d.push({id:"hls-"+h+"-"+e.config.video.id,src:v,mime:fc.hls,priority:2,metadata:{cdn:h,origin:n.hls.cdns[h].origin,quality:"sd"}})}if(n.dash&&!f)for(var g in n.dash.cdns){var y=n.dash.cdns[g].url;if(Ce.length>0){var _=/\/(((\d+),?)+)\/master\.json/,b=_.exec(y);null!==b&&(y=y.replace(b[1],Ce.join(",")))}d.push({id:"dash-"+g+"-"+e.config.video.id,src:y,mime:fc.dash,priority:g===n.dash.default_cdn?1:2,metadata:{cdn:g,origin:n.dash.cdns[g].origin,quality:"sd"}})}return d}function F(){return"text_tracks"in e.config.request?e.config.request.text_tracks.map(function(e){return{id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang}}):[]}function B(){var n=e.config.request.files;if(n.hls){if(t.get(yp))return I();var i=n.hls.default_cdn,r=n.hls.cdns[i].url;return n.hls.cdns[i].captions&&(r=n.hls.cdns[i].captions),{src:r,mime:fc.hls,metadata:{cdn:e.config.request.files.hls.cdn,origin:e.config.request.files.hls.origin,quality:"sd"}}}return null}function N(){var t=e.config.video.file_codecs,n=null!==t&&(t.hevc.sdr.length>0||t.hevc.hdr.length>0),i=[];return n&&(i=$i.hdr&&t.hevc.hdr.length>0?t.hevc.hdr:$i.hevc&&t.hevc.sdr.length>0?t.hevc.sdr:t.avc),e.events.fire(kc.hevcRestrictedStreams,i),i}function q(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!(t.get(mp)||t.get(gp)||t.get(_p)&&!t.get(wp))){Le=!1,Ce=N();var i=D(),r=F();if(Z.video&&!n)return i.forEach(function(e){var t=Z.video.files.getFileById(e.id);t&&(t.src=e.src)}),void r.forEach(function(e){var t=Z.video.textTracks.getTrackById(e.id);t&&(t.src=e.src)});var o=xe(Q);if(Z.video={id:e.config.video.id,title:e.config.video.title,subtitle:"from "+e.config.video.owner.name,files:i,textTracks:r,externalDisplayFiles:{AirPlay:B()},metadata:{thumbnail:e.config.video.thumbs[640],useHls:e.config.request.drm&&$i.browser.safari,drm:e.config.request.drm,percentShown:sp.frustumSurfaceArea(e.config.video.spatial.fov,o.width,o.height)}},Z.playsinline=ne,Z.muted=e.config.embed.muted,0===r.length){var a=!0;return void e.events.fire(wc.turnCaptionsOff,a)}if(Z.video.textTracks.forEach(function(t){t.on("cuechange",l),t.on("modechange",function(n){ke&&"showing"===t.mode&&e.events.fire(kc.captionsChanged,t)})}),null!==e.config.request.cookie.captions&&"null"!==e.config.request.cookie.captions){var s=!0;return void e.events.fire(wc.turnCaptionsOn,e.config.request.cookie.captions,s)}if(e.config.video.lang){var u=e.config.request.lang.split(/[-_]/),c=rc(u,1),d=c[0],f=e.config.video.lang.split(/[-_]/),h=rc(f,1),v=h[0];if(d!==v){var p=e.config.request.lang+".subtitles",m=We(p,Z.video.textTracks),g=m.track;if(g){var y=!0;return void e.events.fire(wc.turnCaptionsOn,p,y)}}}e.events.fire(wc.turnCaptionsOff)}}function j(e,t,n,i){if(se){var r=new XMLHttpRequest;r.open("DELETE",e+"/plays/"+t+"/"+n+"?token="+i,!1),r.send(),se=!1}}function V(){e.config.embed.time>0&&(Z.currentTime=e.config.embed.time,e.config.embed.time=0)}function U(){e.events.on(wc.turnCaptionsOn,function(t,n){if(!Te||Te.id!==t){var i=Z.video.textTracks.getTrackById(t),r=!0;if(!i){var o=We(t,Z.video.textTracks);i=o.track,r=o.exactMatch}i!==Te&&setTimeout(function(){Z.video.textTracks.forEach(function(e){e.mode=e===i?"hidden":"disabled"}),e.events.fire(kc.captionsChanged,i,n||!r),Te=i},0)}}).on(wc.turnCaptionsOff,function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];setTimeout(function(){Z.video.textTracks.forEach(function(e){e.mode="disabled"}),e.events.fire(kc.cueChanged),Te&&(Te=null,e.events.fire(kc.captionsChanged,null,t))},0)})}function H(){Z.on(gh.AVAILABLE,function(t){var n=t.type;if(!e.config.request.drm)switch(n){case"AirPlay":e.events.fire(kc.airPlayAvailable)}}),Z.on(gh.UNAVAILABLE,function(t){var n=t.type;if(!e.config.request.drm)switch(n){case"AirPlay":e.events.fire(kc.airPlayNotAvailable)}}),Z.on(gh.ACTIVATED,function(t){var n=t.type;switch(Ee=!0,n){case"AirPlay":e.events.fire(kc.airPlayActivated)}}),Z.on(gh.DEACTIVATED,function(t){var n=t.type;switch(Ee=!1,n){case"AirPlay":e.events.fire(kc.airPlayDeactivated)}}),e.events.on(kc.airPlayButtonPressed,function(){Z.showExternalDisplayPicker("AirPlay")})}function W(){function t(){return!Z.supportsPresentationMode("picture-in-picture")||$i.spatialPlayback&&e.config.video.spatial?void e.events.fire(kc.pictureInPictureNotAvailable):void e.events.fire(kc.pictureInPictureAvailable)}var n=Z.presentationMode;Z.on(mh.PLAY,function(){return ge?void t():void Z.once(mh.LOADED_METADATA,t)}),Z.on(_h.PRESENTATION_MODE_CHANGE,function(t){"inline"===n&&"picture-in-picture"===t&&e.events.fire(kc.pictureInPictureActivated),"picture-in-picture"===n&&"inline"===t&&e.events.fire(kc.pictureInPictureDeactivated),n=t,Z.video.textTracks.forEach(function(e){"picture-in-picture"===t&&"hidden"===e.mode&&(e.mode="showing"),"inline"===t&&"showing"===e.mode&&(e.mode="hidden")})}),e.events.on(wc.activatePictureInPicture,function(){Z.supportsPresentationMode("picture-in-picture")&&(Z.presentationMode="picture-in-picture")}),e.events.on(wc.deactivatePictureInPicture,function(){Z.supportsPresentationMode("picture-in-picture")&&(Z.presentationMode="inline")})}function z(){var n=t.get(yp)&&!$i.android&&!$i.iOS;(e.config.embed.autoplay&&(!t.get(pp)||t.get(wp))||n)&&(oe=!0,e.events.fire(kc.playButtonPressed))}function G(){e.events.on(kc.enteredTinyMode,function(){te=!0}).on([kc.enteredMiniMode,kc.enteredNormalMode],function(){te=!1})}function K(){var t=0,n=null,i=function(){n||(n=e.config.embed.color),e.events.fire(wc.changeColor,"#46d439")},r=function(){n&&(e.events.fire(wc.changeColor,n),n=null)};e.events.on(wc.setEffect,function(n){if(Z.deactivateEffects(),"ascii"===n||"ascii-color"===n){if(Z.supportsEffect(pv)){Z.activateEffect(pv,{color:"ascii-color"===n,fps:t||Z.video.currentFile.metadata.fps});try{var o=e.config.request.files.dash.streams;o.sort(Bn("asc"));var a=e.config.request.files.dash.streams.indexOf(o[0]);Z.video.currentFile.restrictedStreamIndexes=[a]}catch(e){}return e.element.setAttribute("data-filter",n),"ascii"===n?void i():void r()}return void e.events.fire(wc.setEffect,"none")}if("ascii"!==n&&"ascii-color"!==n){var s=[];Ae!==!1&&s.push(Ae),Z.video.currentFile.restrictedStreamIndexes=s}r(),e.element.setAttribute("data-filter",n)}).on(kc.streamChanged,function(e,n,i){t=e.fps})}function Y(){pt(function(){var t=e.config.request.drm;t&&j(t.hoover_url,t.user,t.asset,t.hoover_token)}),e.events.on(kc.loadVideo,function(){var t=e.config.request&&e.config.request.drm;t&&j(t.hoover_url,t.user,t.asset,t.hoover_token)})}function X(){if(!$i.spatialPlayback)return void e.events.once(kc.firstTimeUpdate,function(){e.config.video.spatial&&e.events.fire(bc.spatialUnsupported,be)});var t=null,n=function(){t&&(Z.deactivateEffect(sp),t=null,e.events.fire(wc.toggleSpatialPlayback,t)),e.config.video.spatial&&(e.config.request.drm||Z.supportsEffect(sp)&&(t=Z.activateEffect(sp,{threeUrl:e.config.request.urls.three_js,fps:e.config.video.fps,fieldOfView:e.config.video.spatial.fov,directorTimeline:e.config.video.spatial.director_timeline,projection:e.config.video.spatial.projection,stereoMode:e.config.video.spatial.stereo_mode,initialView:e.config.video.spatial.initial_view,isMobile:$i.android,dimensions:e.config.embed.on_site?{width:1080,height:540}:{width:640,height:360}}),e.events.fire(wc.toggleSpatialPlayback,t)))};e.events.fire(wc.attachSpatialPlaybackEvents),n(),e.events.on(kc.configChanged,n),Z.on(mh.SEEKED,function(){return e.events.fire(wc.revealSpatialControls)}),Z.on(mh.PLAY,function(){return e.events.fire(wc.revealSpatialControls)}),Z.on(wh.CAMERA_UPDATE,function(t){return e.events.fire(kc.cameraUpdate,t)}),Z.on(wh.SPATIAL_UNSUPPORTED,function(){return t&&(Z.deactivateEffect(sp),t=null,e.events.fire(wc.toggleSpatialPlayback,t)),ue?void e.events.fire(bc.spatialFailure,be):void e.events.once(kc.firstTimeUpdate,function(){e.events.fire(bc.spatialFailure,be)})})}var $,Q=n.querySelector(".vp-video"),J=n.querySelector(".vp-telecine"),Z=null,ee=null,te=!1,ne=e.config.embed.playsinline&&($i.mobileAndroid||$i.iOS>=10),ie=!e.config.embed.playsinline&&($i.mobileAndroid||$i.iOS&&!$i.iPad),re=$i.iOS>=8&&!$i.iPad,oe=!1,ae=!1,se=!1,ue=!1,ce=!1,le=!1,de=!1,fe=!1,he=!1,ve=!1,pe=!1,me=!1,ge=!1,ye=!0,_e=null,be=!1,we=!1,ke=!1,Se=!1,Ee=!1,Te=null,Ae=!1,Le=!1,Ce=[];return J.classList.add("invisible"),re&&J.classList.add("hide-webkit-controls"),e.config.video.live_event&&n.classList.add("live-background"),e.config.embed.transparent&&n.classList.add("transparent"),v(),p(),h(),m(),g(),y(),_(),b(),w(),k(),S(),E(),T(),x(),A(),L(),P(),U(),H(),W(),G(),K(),q(),X(),Y(),e.ready().then(function(){return setTimeout(function(){return z()},0),V(),null}).catch(function(e){}),e.events.fire(kc.videoModuleReady),{telecine:Z}}function Hn(e,t,n,i){return!i.relatedTarget||(!n||e===t)&&(t!==i.relatedTarget&&!t.contains(i.relatedTarget))}function Wn(e){return Date.now()-e}function zn(e){return Gn()-e}function Gn(){return parseInt(Date.now()/1e3,10)}function Kn(e){var t=e.getHours(),n=e.getMinutes(),i=t>=12?"PM":"AM";return t%=12,t=t?t:12,n=n<10?"0"+n:n,t+":"+n+" "+i}function Yn(e,t){function n(){return Date.now?Date.now():(new Date).getTime()}function i(){return e.config.video.spatial?"mono"!==e.config.video.spatial.stereo_mode?2:1:0}function r(){var t=e.telecine.getEffectByName("ThreeSixtyEffect");return $i.spatialPlayback&&t?t.isStereo()?2:1:0}function o(){v=!1,p=e.telecine?e.telecine.currentTime:0,m=0,g=0,y=0,_=!1}function a(t,n,i,r){e.verifyConfig().then(function(){var o=n;o.signature=e.config.request.signature,o.session=e.config.request.session,o.time=e.config.request.timestamp,o.expires=e.config.request.expires;var s=JSON.stringify(o),u="https://"+e.config.player_url+t;if(navigator.sendBeacon&&navigator.sendBeacon(u,s))return!0;var c=new XMLHttpRequest;return c.open("POST",u,!i),c.setRequestHeader("Content-Type","text/plain;charset=UTF-8"),c.withCredentials=!0,c.onload=function(){200!==c.status&&r<2&&setTimeout(function(){a(t,n,i,r+1)},1e3)},c.send(s),c}).catch(function(e){})}function s(n,o,s){var u=e.telecine.currentFile||{},c=u.id,l=void 0===c?0:c,d=u.mime,f=void 0===d?fc.h264:d,h=u.metadata;h=void 0===h?{}:h;var v=h.profile,p=void 0===v?-1:v;if(f===fc.dash){var g=S,y=g.id;l=void 0===y?0:y;var _=g.profile;p=void 0===_?-1:_}e.performDelegateAction(lc.playLog,function(c){var d=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(n,{referrer:e.config.request.referrer,embed:!e.config.embed.on_site,context:e.config.embed.context,autoplay:d.continuous?2:e.config.embed.autoplay,loop:e.config.embed.loop?1:0,id:e.config.video.id,vodId:e.config.video.vod&&e.config.video.vod.id?e.config.video.vod.id:null,vodSaleId:e.config.video.vod&&e.config.video.vod.sale_id?e.config.video.vod.sale_id:null,sessionTime:Fe(m),videoShape:i(),spatialPlayback:r(),userId:e.config.user.id,userAccountType:e.config.user.account_type,userIsMod:e.config.user.mod?1:0,ownerId:e.config.video.owner.id,ownerAccountType:e.config.video.owner.account_type,privacy:e.config.video.privacy,rating:e.config.video.rating?e.config.video.rating.id:null,type:hc[e.telecine.currentScanner],videoFileId:Number.isInteger(Number(l))?l:0,delivery:dc[f],profileId:p,quality:u.metadata?u.metadata.quality:null,duration:Fe(e.config.video.duration),seconds:Fe(o),isLive:t.get(bp)?1:0,playbackRate:e.telecine.playbackRate},s)})}function u(){!_&&e.playLoggingEnabled&&(_=!0,s("/log/play",0))}function c(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e.playLoggingEnabled){var o=n();r&&g+k>o||(g=o,r&&!e.config.request.flags.partials||v||s("/log/partial",t,i))}}function l(t,n){if(!e.doNotTrackEnabled){n=n||{};var i={referrer:e.config.request.referrer,embed:!e.config.embed.on_site,context:e.config.embed.context,id:e.config.video.id,vodId:e.config.video.vod&&e.config.video.vod.id?e.config.video.vod.id:null,vodSaleId:e.config.video.vod&&e.config.video.vod.sale_id?e.config.video.vod.sale_id:null,userId:e.config.user.id,userAccountType:e.config.user.account_type,ownerId:e.config.video.owner?e.config.video.owner.id:0,duration:Fe(e.config.video.duration),seconds:Fe(e.telecine.currentTime),playbackRate:e.telecine.playbackRate};for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r]);a("/log/"+t,i)}}function d(){function t(){var n=e.telecine.getEffectByName("ThreeSixtyEffect").currentCoordinates,i=100,a=Math.round(n.lat*i)/i,u=Math.round(n.long*i)/i,c={sessionTime:m,videoTime:e.telecine.currentTime,coordinates:{lat:a,lon:u}};r.push(c),setTimeout(function(){o&&t()},s)}function i(){r.length&&e.performDelegateAction(lc.playLog,function(t){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a("/log/spatial",{embed:!e.config.embed.on_site,id:e.config.video.id,context:e.config.embed.context,ownerId:e.config.video.owner?e.config.video.owner.id:0,referrer:e.config.request.referrer,vodId:e.config.video.vod&&e.config.video.vod.id?e.config.video.vod.id:null,vodSaleId:e.config.video.vod&&e.config.video.vod.sale_id?e.config.video.vod.sale_id:null,motionLog:JSON.stringify(r)},!1)})}e.events.on(kc.playProgress,function(e,t,i,r){var o=Math.floor(e);!v&&y+k<n()&&(e>p&&(m+=(e-p)/r),p=e),o%b===0&&c(e)}),e.events.on(kc.playbackRateChanged,function(t,n){l("playback_rate_change",{oldPlaybackRate:n}),c(e.telecine.currentTime)}),e.events.on(kc.playInitiated,function(){u()}),e.events.on(kc.paused,function(t){e.telecine.ended||c(t)}),e.events.on(kc.seeked,function(e,t,n){w=e,v||c(w)}),e.events.on(kc.scrubbingStarted,function(){y=n(),v=!0}),e.events.on(kc.scrubbingEnded,function(){p=e.telecine.currentTime,v=!1,c(w)}),e.events.on(kc.prefsButtonPressed,function(){c(e.telecine.currentTime)}),e.events.on(kc.ended,function(){m+=e.config.video.duration-p;var t=!1,n=!1;c(e.config.video.duration,t,n)}),e.events.on(kc.streamChanged,function(e){S=e});var r=[],o=!1,s=1e3;e.events.on(kc.spatialMotionStart,function(){o=!0,t()}),e.events.on(kc.spatialMotionEnd,function(){o=!1,i()}),e.events.on(kc.loadVideo,function(){i(),r=[]}),pt(function(){if(e.telecine&&e.telecine.currentTime>0){var t=!0,n=!1;c(e.telecine.currentTime,t,n),i()}})}function f(){function t(e){return function(){l(e)}}if(!e.doNotTrackEnabled){var n=[{type:"share_press",event:kc.shareButtonPressed},{type:"facebook_press",event:kc.facebookButtonPressed},{type:"twitter_press",event:kc.twitterButtonPressed},{type:"tumblr_press",event:kc.tumblrButtonPressed},{type:"email_press",event:kc.emailButtonPressed},{type:"embed_press",event:kc.embedButtonPressed},{type:"login_success",event:kc.userLoggedIn},{type:"airplay",event:kc.airPlayActivated},{type:"vod_press",event:kc.vodButtonPressed},{type:"collection_press",event:kc.collectionsButtonPressed},{type:"email_capture_submitted",event:kc.emailCaptureSubmitted}];n.forEach(function(n){e.events.on(n.event,t(n.type))}),e.events.on(kc.outroDisplayed,function(t){var n={outroType:e.config.embed.outro,ownerAccountType:e.config.video.owner.account_type,playerWidth:e.element.clientWidth,playerHeight:e.element.clientHeight};t&&t.length&&(n.outroVideos=t.join(",")),l("outro_displayed",n)}).on(kc.outroVideoPressed,function(t){l("outro_video_press",{ownerAccountType:e.config.video.owner.account_type,videoId:t})}).on(kc.followButtonPressed,function(){l("outro_follow_press",{add:!e.config.user.following})}).on(kc.outroCtaPressed,function(t){l("outro_cta_press",{ownerAccountType:e.config.video.owner.account_type,link:t})}).on(kc.outroLinkPressed,function(t){l("outro_link_press",{ownerAccountType:e.config.video.owner.account_type,link:t})}).on(kc.outroImagePressed,function(t){l("outro_image_press",{ownerAccountType:e.config.video.owner.account_type,link:t})}).on(kc.likeButtonPressed,function(){l("like_press",{add:!e.config.user.liked})}).on(kc.watchLaterButtonPressed,function(){l("watch_later_press",{add:!e.config.user.watch_later})}).on(kc.popupOpened,function(e){0===e.indexOf("login-")&&l("login_attempt")}).on(kc.captionsChanged,function(e,t){if(!t)return e?void l("text_track_change",{textTrackLanguage:e.language,textTrackKind:e.kind}):void l("text_track_change")}).on(kc.badgePressed,function(e){1!==e&&12!==e||l("badge_press",{badgeId:e})}).on(kc.overlayOpened,function(e){"email-capture"===e&&l("email_capture_displayed")}).on(kc.overlayClosed,function(e){"email-capture"===e&&l("email_capture_dismissed")}).on(kc.cardPressed,function(t){l("card_press",{ownerAccountType:e.config.video.owner.account_type,cardId:t,cardType:"link"})}).on(kc.cardDisplayed,function(t,n){e.config.embed.editor||l("card_displayed",{ownerAccountType:e.config.video.owner.account_type,cardId:t,cardType:n.url?"link":"text"})})}}function h(){e.events.on(kc.configChanged,function(e){e&&o()})}var v,p,m,g,y,_,b=30,w=0,k=1e3,S={};return o(),d(),f(),h(),e.events.fire(kc.statsModuleReady),{}}function Xn(){return function(e){return function(){function t(e,t){return r(e,function(e){var n=a.get({selector:e,listener:t});if(!n){var r=i(e,t);n=a.insert({selector:e,listener:t,unsubscribe:r})}return n.unsubscribe})}function n(e,t){return r(e,function(e){
var n=a.get({selector:e,listener:t});return n&&n.unsubscribe()})}function i(e,t){function n(){var n=e(o.getState());if(i!==n){var r=i;i=n,t(i,r,o.getState())}}var i=e(o.getState());return o.subscribe(n)}function r(e,t){return e=[].concat(e),e.map(function(e){return t(o.createGetter(e))})}var o=e.apply(void 0,arguments),a=ac();return ic({},o,{watch:t,unwatch:n})}}}function $n(e,t){return null==e||e!==e?t:e}function Qn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return function(){function n(){return e}function i(e,t){e=a(e);var n=e(o.getState());return void 0!==t&&(n=um(n,t)),void 0===n&&r(e),n}function r(e){}var o=t.apply(void 0,arguments),a=Fa(function(e){if(zr(e))return e;var t=vs(n(),e);return zr(t)?t:function(t){return vs(t,e)}});return ic({},o,{getSelectors:n,createGetter:a,get:i})}}}function Jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case hp:return ic({},e,t.payload);default:return e}}function Zn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:cm,t=arguments[1],n=t.type,i=t.payload;switch(n){case hp:return ic({},e,i.embed);default:return e}}function ei(e,t){return e===t}function ti(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var i=t.length,r=0;r<i;r++)if(!e(t[r],n[r]))return!1;return!0}function ni(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:ei,n=null,i=null;return function(){return ti(t,n,arguments)||(i=e.apply(null,arguments)),n=arguments,i}}function ii(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every(function(e){return"function"==typeof e})){var n=t.map(function(e){return typeof e}).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, "+("instead received the following types: ["+n+"]"))}return t}function ri(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return function(){for(var t=arguments.length,i=Array(t),r=0;r<t;r++)i[r]=arguments[r];var o=0,a=i.pop(),s=ii(i),u=e.apply(void 0,[function(){return o++,a.apply(null,arguments)}].concat(n)),c=ni(function(){for(var e=[],t=s.length,n=0;n<t;n++)e.push(s[n].apply(null,arguments));return u.apply(null,e)});return c.resultFunc=a,c.recomputations=function(){return o},c.resetRecomputations=function(){return o=0},c}}function oi(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=t.type,i=t.payload;switch(n){case hp:return ic({},e,i.video);default:return e}}function ai(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case pm:return ic({},e,{width:t.payload.width,height:t.payload.height});default:return e}}function si(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case Tl:return ic({},e,{width:t.payload.width,height:t.payload.height});default:return e}}function ui(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];switch(t.type){case Gm:return ic({},e,{size:t.payload});default:return e}}function ci(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];arguments[2];return{player:ai(e.player,t),preview:si(e.preview,t),cards:ui(e.cards,t),liveEvent:An(e.liveEvent,t)}}function li(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1],n=ic({},Jn(e,t),{embed:Zn(e.embed,t),video:oi(e.video,t),liveEvent:Ln(e.liveEvent,t)});return ic({},n,{ui:ci(e.ui,t,n)})}function di(e,t,n){function i(e){n.style.fontSize=e+"px"}function r(){n.classList.add("hidden"),n.setAttribute("hidden","")}function o(){"picture-in-picture"!==e.telecine.presentationMode&&(n.classList.remove("hidden"),n.removeAttribute("hidden"))}function a(e){var t=e.text.replace("\n","<br>").split(/<br ?\/?>/),n=t.reduce(function(e,t){return Math.max(e,t.replace(/<\/?\w>/g,"").length)},0),i="+"+Array(n+3).join("-")+"+";return t=t.map(function(e){var t=n-e.replace(/<\/?\w>/g,"").length,i=Math.floor(t/2),r=Math.ceil(t/2);return'<span class="bar">|</span>&nbsp;'+Array(i+1).join("&nbsp;")+e+Array(r+1).join("&nbsp;")+'&nbsp;<span class="bar">|</span>'}),i+"<br>"+t.join("<br>")+"<br>"+i}function s(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];n.firstChild;)n.removeChild(n.firstChild);if(e.length){var t=document.createDocumentFragment();e.forEach(function(e){var n=document.createElement("span"),i=e.html;p&&(i=a(e)),n.innerHTML=i,t.appendChild(n)}),n.appendChild(t)}}function u(){e.events.on(kc.cueChanged,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return m=t,s(t),t.length?h?void o():void(v=!0):void r()}).on(kc.captionsChanged,function(e){return e?(n.setAttribute("lang",e.language),void n.setAttribute("dir",e.rtl?"rtl":"ltr")):(n.removeAttribute("dir"),void n.removeAttribute("lang"))}).on(kc.playInitiated,function(){h=!0,v&&(v=!1,o())}).on(kc.pictureInPictureActivated,function(){r()}).on(kc.pictureInPictureDeactivated,function(){o()}).on(wc.reset,function(){h=!1,r()}).on(wc.setEffect,function(e){p="ascii"===e,s(m)})}function c(){t.watch("ui.captions.size",i),i(t.get("ui.captions.size"))}function l(){e.events.on(kc.controlBarVisibilityChanged,function(e){return e?void n.classList.add("with-controls"):void n.classList.remove("with-controls")})}function d(){e.events.on(kc.overlayOpened,function(){n.classList.add("invisible")}).on(kc.overlayClosed,function(){n.classList.remove("invisible")})}function f(){e.events.on(kc.ended,function(){"nothing"!==e.config.embed.outro&&n.classList.add("invisible")}).on([kc.played,kc.scrubbingStarted],function(){n.classList.remove("invisible")})}var h=!1,v=!1,p=!1,m=[];return u(),c(),l(),d(),f(),{}}function fi(e,t,n){var i=!0,r=!0;if("function"!=typeof e)throw new TypeError(Cg);return Pg(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),Lg(e,t,{leading:i,maxWait:t,trailing:r})}function hi(e,t,n){function i(){t.watch("ui.player.layout",a),t.watch("ui.player.innerBottom",o);var e=Og(r,16);He(n,e),r()}function r(){var e=xe(n),i=e.width,r=e.height;return t.dispatch(mm(i,r))}function o(t){e.events.fire(kc.spaceChanged,[{bottom:t}])}function a(e){var t=be(uc,Math.round),n=t(e.x),i=t(e.y),r=t(e.width),o=t(e.height);Ue(s,{left:n,top:i,width:r,height:o})}var s=n.querySelector(".vp-player-layout");i()}function vi(e){function t(e){var t=e.old,n=e.loaded;if(!t);if(window.parent!==window){var i="Private Video on Vimeo";n.view!==cc.main&&n.view!==cc.privateUnlocked||(i=n.video.title+" from "+n.video.owner.name+" on Vimeo"),document.title=i,history&&history.replaceState&&n.video&&t&&history.replaceState({id:n.video.id},"","/video/"+n.video.id+window.location.search)}if(n.view!==cc.main&&n.view!==cc.privateUnlocked)throw new Error("Config not authorized: "+n.view);t&&t.embed&&t.embed.color!==n.embed.color&&w.fire(wc.changeColor,n.embed.color),C&&C.reset();var r=!t||!t.video||t.video.id!==n.video.id||t.video.version.current!==n.video.version.current;return O=null,b.dispatch(vp(n)),w.fire(wc.reset),w.fire(kc.configChanged,r,n),e}function n(e){if($i.hasAutoplayPolicy&&e.loaded.embed.autoplay){var t=!!e.loaded.embed.muted,n=!!e.loaded.embed.playsinline;return Du.video({muted:t,inline:n}).then(function(t){var n=t.result;return n===!1&&(e.loaded.embed.autoplay=0),e})}return e}function i(e){if("opacity"===e.propertyName){var t=document.querySelector(".vp-placeholder");t&&(Wp(t).off("transitionend",i),t.parentNode.removeChild(t))}}function r(){var e=document.querySelector(".vp-placeholder");e&&(Wp(e).on("transitionend",i),e.classList.add("vp-placeholder-fadeout"))}function o(){window.requestAnimationFrame(function(){r(),h.classList.remove("loading")}),D()}function a(e){return g.then(function(){if(d(e),L&&L.resetThumbnail(),"function"!=typeof M.authorizationHandler)throw new Error("Config was not authorized.");return M.authorizationHandler(o)}).then(function(e){k.config=e;var t=!0;return O=null,b.dispatch(vp(k.config)),w.fire(wc.reset),w.fire(kc.configChanged,t,k.config),e})}function s(){var e=document.location.hash,t=Ie(e);null!==t&&(k.config.embed.time=Pe(t,0,k.config.video.duration),$i.touch||(k.config.embed.autoplay=1),e.indexOf("at=")!==-1&&history&&history.replaceState&&history.replaceState("","",window.location.pathname+window.location.search))}function u(){w.on(kc.userLogIn,function(e){k.reload().then(function(t){if(!k.config.user.logged_in)return w.fire(kc.loginFailure),t;switch(w.fire(kc.userLoggedIn,e),e){case"like":k.config.user.liked&&w.fire(kc.liked);break;case"watch-later":k.config.user.watch_later&&w.fire(kc.addedToWatchLater);break;case"private":w.fire(kc.privateUnlocked)}return t}).catch(function(e){el.captureException(e)})}),w.on(kc.userLoggedOut,function(){k.reload().catch(function(e){el.captureException(e)})})}function c(){var e=h.querySelector(".vp-shade"),t=h.querySelector(".vp-spin"),n=void 0;w.on(kc.bufferStarted,function(){clearTimeout(n),n=setTimeout(function(){e.classList.remove("vp-shade-invisible"),t.classList.remove("vp-spin-invisible")},600)}),w.on(kc.bufferEnded,function(){clearTimeout(n),e.classList.add("vp-shade-invisible"),t.classList.add("vp-spin-invisible"),L.hide()})}function l(e){s(),u(),c(),f(e)}function d(e){P||(P=new bt(e),Object.keys(P).forEach(function(e){if("function"==typeof P[e])return void Object.defineProperty(B,e,{enumerable:!0,value:P[e]});var t={enumerable:!0,get:P[e].get};P[e].set&&(t.set=P[e].set),Object.defineProperty(B,e,t)}))}function f(e){void new hi(e,b,h),L=new Wt(e,b,h.querySelector(".vp-preview")),A=new Un(e,b,h.querySelector(".vp-video-wrapper")),void new di(e,b,h.querySelector(".vp-captions")),void new tm(e,b),void new Yn(e,b),void new rm(e,h,b),C=new Yt(e),d(e)}var h=e.element,v=e.delegate,p=void 0===v?{}:v,m=e.cssLoadedPromise,g=void 0===m?Vi.resolve(null):m,y=(e.name,se),_=[],b=ae(li,y(Xn(),Qn(xg),ue.apply(void 0,_))),w=he(),k=new Lt({events:w}),S=Be();h.classList.add("player-"+S),h.classList.add("loading"),h.id||(h.id="player"+S),h.innerHTML=Ag.render("outer",{strings:{back:"Назад",close:"Закрыть наложение"}});var E=h.querySelector(".vp-telecine");if($i.iOS){var T=document.createElement("video");E.appendChild(T);try{T.setAttribute("muted",""),T.setAttribute("playsinline","");var x=T.play();T.pause(),void 0!==x&&x.catch(function(e){return el.captureException(e)})}catch(e){el.captureException(e)}}var A=null,L=null,P=null,C=null,O=null,R=null,I=null,M={},D=void 0,F=new Vi(function(e,t){D=e}).then(function(){return w.fire(kc.ready),null}),B={get config(){return k.config},set config(e){k.config=e},get delegate(){return p},set delegate(e){p=e},ready:function(e){return e?void F.then(function(){return e()}).catch(function(e){el.captureException(e)}):F},get sessionId(){return k.config.request.session}},N={get store(){return b},get config(){return k.config},get element(){return h},get events(){return w},get uuid(){return S},get externalApi(){return B},get telecine(){return vs(A,"telecine")},get preview(){return L},get doNotTrackEnabled(){return k.config.embed.dnt||k.config.request.flags.dnt},get playLoggingEnabled(){return k.config.embed.log_plays&&k.config.request.flags.plays},init:function(e,i){return R?R:(M=i,R=k.load(e).then(t).then(n).catch(function(e){return a(N)}).then(function(){return el.setUp(k.config),null}).then(function(){return"function"==typeof M.initializationHandler?Vi.resolve(i.initializationHandler()):null}).then(function(){return l(N),"function"==typeof M.postInitializationHandler?Vi.resolve(i.postInitializationHandler()):null}).then(function(){return Vi.all([L.thumbnailPromise,g])}).then(o).catch(function(e){el.captureException(e)}))},loadVideo:function(e,i){if(I===e&&O)return O;if(i.video_version){var r=k.config.video.version.available;if(!r||!Array.isArray(r))return Vi.reject("No available video versions");if(r=r.map(function(e){return e.id}),r.indexOf(i.video_version)===-1)return Vi.reject("Invalid version id specified")}return w.fire(kc.loadVideo),I=e,h.classList.add("loading"),O=k.load(e,i).then(t).then(n).catch(function(e){return el.captureException(e),a(N)}).then(function(e){var t=L.loadThumbnail();return Vi.resolve(t)}).then(o)},performDelegateAction:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=void 0;if(p&&p[e.will]){var r;if(i=(r=p)[e.will].apply(r,[k.config.video.id].concat(n)),i===!1)return}t.apply(void 0,[k.config.video.id].concat(n,[i])),p&&p[e.did]&&p[e.did]()},ready:function(){return F},verifyConfig:function(){return k.verify()},updatePhpTokens:function(){return new Vi(function(e,t){var n=k.config.user,i=n.vimeo_api_client_token,r=n.vimeo_api_interaction_tokens,o=!1;if(i)try{var a=JSON.parse(atob(i.split(".")[1])).exp;o=zn(a)>=0}catch(e){return void t("Failed to parse PHP client token expiration")}if(r)try{var s=JSON.parse(atob(r.likes.split(".")[1])).exp,u=JSON.parse(atob(r.watch_later.split(".")[1])).exp,c=JSON.parse(atob(r.following.split(".")[1])).exp;o=zn(s)>=0||zn(u)>=0||zn(c)>=0}catch(e){return void t("Failed to parse PHP interaction tokens expiration")}if(o){var l=k.config.request,d=l.signature,f=l.session,h=l.timestamp,v=l.expires,p="https://"+k.config.player_url+"/video/"+k.config.video.id+"/token/refresh?signature="+d+"&session="+f+"&time="+h+"&expires="+v;return void Me(p).then(function(t){return t=JSON.parse(t),k.config.user.vimeo_api_client_token=t?t.vimeo_api_client_token:null,k.config.user.vimeo_api_interaction_tokens=t?t.vimeo_api_interaction_tokens:null,e()}).catch(function(e){t("Failed to refresh JWT token: "+e)})}e()})}};return N}function pi(e,t,n,i){var r=!1;i="function"==typeof t?n:i,n="function"==typeof t?t:n,t="function"==typeof t?null:t;var o=function(e){var t=!0;if(e.changedTouches){var o=e.changedTouches[0].pageX-window.pageXOffset,a=e.changedTouches[0].pageY-window.pageYOffset,s=document.elementFromPoint(o,a);null!==s&&this.contains(s)&&(t=n.call(this,e))}return"function"==typeof i&&i.call(this,e),r=!0,t},a=function(e){return r?void(r=!1):n.call(this,e)};return t?void Wp(e).on("click",t,a).on("touchend",t,o):void Wp(e).on("click",a).on("touchend",o)}function mi(e,t){function n(){T=r(),S.forEach(u),pi(T,".js-menuClose",m),Wp(window).on("resize",_)}function i(){Wp(window).off("resize",_)}function r(){var e=document.createElement("div"),t={strings:{close:"Close menu"}};return e.innerHTML=Ag.render("menu",t),e.children[0]}function o(){return T.classList.contains("vp-menu-center")}function a(){return T.classList.contains("vp-menu-carousel")}function s(){var e=E.length>1&&!a();E.forEach(function(t){t.setCollapsible(e),t.resetCarousel(a())})}function u(e){E.push(e),T.appendChild(e.element),s(),e.on("open",l),e.on(["open","close"],d),e.on(["openEnd","closeEnd"],f),e.on("select",p)}function c(e){return E.find(function(t){return t.id===e})}function l(e){E.filter(function(e){return e.isOpen()}).forEach(function(e){return e.close()})}function d(e){A=!0,b()}function f(e){A=!1}function h(){return t&&"true"===t.getAttribute("aria-expanded")}function v(n){h()||(n=n||t.contains(document.activeElement),t.setAttribute("aria-expanded","true"),T.removeAttribute("hidden"),e.events.fire(kc.menuVisibilityChanged,!0,x),_(),s(),T.classList.remove("vp-menu-hidden"),window.requestAnimationFrame(function(){T.classList.remove("vp-menu-invisible"),n&&k()[0].focus()}))}function p(){a()||m()}function m(){h()&&(t.setAttribute("aria-expanded","false"),e.events.fire(kc.menuVisibilityChanged,!1,x),T.classList.add("vp-menu-invisible"))}function g(e){T.classList.add("vp-menu-hidden"),T.setAttribute("hidden","")}function y(e){return h()?(m(),!1):(v(e),!0)}function _(){var e=xe(T),t=window.getComputedStyle(T),n=parseFloat(t.fontSize),i=e.bottom-T.scrollHeight;if(i<10){var r=e.bottom-10;return T.style.height=r/n+"em",void T.classList.add("vp-menu-scroll")}T.style.height="auto",T.classList.remove("vp-menu-scroll")}function b(){_(),A&&requestAnimationFrame(b)}function w(){Wp(T).on("transitionend",function(e){this===T&&"opacity"===e.propertyName&&T.classList.contains("vp-menu-invisible")&&g(e)}),Wp(document).on("click",function(e){null!==t&&(!h()||t.contains(e.target)||T.contains(e.target)||m())}),window.addEventListener("blur",m,!1)}function k(){return E.reduce(function(e,t){return e.concat(t.getTabindexItems())},[])}var S=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],E=[],T=void 0,x=void 0,A=!1;return n(),w(),x={element:T,button:t,isCentered:o,isVisible:h,show:v,hide:m,toggle:y,setPanelModes:s,addPanel:u,getPanel:c,getTabindexItems:k,destroy:i}}function gi(e){function t(t){e.style[$i.transitionProperty+"Duration"]=t}function n(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.children.length-1,r=-Math.round(t/u());return Math.min(Math.max(r,n),i)}function i(t){Wp(e).on($i.pointerEvents?"pointerdown":["touchstart","mousedown"],l),Wp(e).on("click","a",o),Wp(window).on("resize",m),m(),a(t)}function r(){Wp(e).off($i.pointerEvents?"pointerdown":["touchstart","mousedown"],l),Wp(e).off("click","a",o),Wp(window).off("resize",m),e.style.removeProperty($i.transformProperty)}function o(){return!1}function a(e){"undefined"!=typeof e&&g(e,"0ms")}function s(e){return function(t){var n=t?"on":"off",i={pointerdown:["pointermove","pointerup"],MSPointerDown:["pointermove","pointerup"],touchstart:["touchmove","touchend"],mousedown:["mousemove","mouseup"]};Wp(window)[n](i[e.type][0],d),Wp(window)[n](i[e.type][1],f)}}function u(){var t=e.children[0],n=getComputedStyle(t);return t.offsetWidth+parseInt(n.marginLeft,10)+parseInt(n.marginRight,10)}function c(e){var t=[e.clientX,e.clientY],n=t[0],i=t[1];if(e.targetTouches&&e.targetTouches.length>0){var r=[e.touches[0].pageX,e.touches[0].pageY];n=r[0],i=r[1]}return{x:n,y:i}}function l(e){e.stopImmediatePropagation();var n=c(e),i=n.x,r=n.y;w.x=i-b.x,w.y=r-b.y,S=!1,T=s(e),T(!0),t("0ms")}function d(e){var t=c(e),i=t.x,r=t.y,o=.15;return k.x=b.x,k.y=b.y,b.x=i-w.x,b.y=r-w.y,Math.abs(b.x-k.x)>=o*Math.abs(b.y-k.y)?(e.preventDefault(),S=!0,_.fire("touchMove"),E=Date.now(),void y(b.x)):(T(!1),void v(n(b.x)))}function f(e){if(e.stopImmediatePropagation(),T(!1),S){e.preventDefault();var t=b.x-k.x,i=Date.now()-E+1;return b.x+=50*t/i,v(n(b.x)),void _.fire("touchEnded")}h(e)}function h(t){t.preventDefault();var n=sc(t.target,e.children);if(n!==-1){if(n!==x)return void v(n);_.fire("tap",n)}}function v(e){g(e),_.fire("slide",e)}function p(e){g(Ve(e))}function m(){g(x,"0ms")}function g(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=u();e!==-1&&i>0&&(t(n),b.x=-e*i,y(b.x))}function y(t){var i=n(t,-1,e.children.length);i!==x&&(_.fire("focus",i),x=i),e.style[$i.transformProperty]="translateX("+t+"px)"}he(this);var _=this,b={x:0,y:0},w={x:0,y:0},k={x:0,y:0},S=void 0,E=void 0,T=void 0,x=0;return{setUp:i,show:p,resize:m,destroy:r,on:this.on}}function yi(e){function t(){n(),L=i(),P=L.querySelector(".js-panelItems"),C=new gi(P),C.on("slide",m),C.on("tap",g),pi(L,".js-panelTitleButton",p),pi(L,"li",y),Wp(L).on("keydown",_),Wp(L).on("keypress",_),Wp(L).on("transitionend",function(e){e.target===L&&(l()?f(e):v(e))})}function n(){E=Object.assign(E,{get active(){return w()?w().label:""}})}function i(){var e=document.createElement("div");return e.innerHTML=Ag.render("menu_list_panel",E),e.children[0]}function r(e){var t=Ws(L.querySelectorAll(".vp-panel-item"));return t[e]||t}function o(e){e!==a()&&(L.classList.toggle("vp-panel-open",!e),L.classList.toggle("vp-panel-collapsible",e),e?P.setAttribute("hidden",""):(P.removeAttribute("hidden"),L.style.removeProperty("height")))}function a(){return L.classList.contains("vp-panel-collapsible")}function s(e){if(O=e,I=L.querySelector(".vp-indicator"),C.destroy(),I.classList.remove("vp-indicator-visible"),O){var t=A.findIndex(function(e){return e.active});C.setUp(t),u(),I.classList.add("vp-indicator-visible")}}function u(){C.on("touchMove",function(){I.classList.add("vp-indicator-inactive")}),C.on("touchEnded",function(){I.classList.remove("vp-indicator-inactive")})}function c(){L.classList.add("vp-panel-pinTitle")}function l(){return L.classList.contains("vp-panel-open")}function d(){if(a()){T.fire("open",R),e.events.fire(kc.menuPanelOpened,!0,R),P.removeAttribute("hidden"),L.classList.add("vp-panel-open");var t=window.getComputedStyle(L),n=parseFloat(t.fontSize);L.style.height=L.scrollHeight/n+"em";var i=$i.transitionProperty+"Delay";r().forEach(function(e,t){var n=40*t+100;e.style[i]=n+"ms",e.classList.add("vp-panel-item-in")})}}function f(e){T.fire("openEnd",R)}function h(){a()&&(T.fire("close",R),e.events.fire(kc.menuPanelClosed,!1,R),L.classList.remove("vp-panel-open"),L.style.removeProperty("height"))}function v(e){P.setAttribute("hidden",""),r().forEach(function(e,t){e.classList.remove("vp-panel-item-in")}),T.fire("closeEnd",R)}function p(e){return e.preventDefault(),l()?h():d()}function m(e){T.fire("select",A[e].id)}function g(e){T.fire("select",A[e].id)}function y(e){if(!O){var t=sc(e.target,r());T.fire("select",A[t].id)}}function _(e){if("keypress"===e.type&&13===e.which||"keydown"===e.type&&32===e.which){var t=sc(e.target,r());if(t!==-1)return T.fire("select",A[t].id),!1}return null}function b(e){var t=A.findIndex(function(e){return e.active});if(t!==-1){A[t].active=!1;var n=r(t);n.classList.remove("vp-panel-item-on"),n.setAttribute("aria-checked","false")}var i=A.findIndex(function(t){return""+t.id==""+e});if(i!==-1){A[i].active=!0;var o=r(i);o.classList.add("vp-panel-item-on"),o.setAttribute("aria-checked","true");var a=L.querySelector(".js-panelStatText");a.innerHTML=A[i].label}I.classList.remove("vp-indicator-inactive")}function w(){return A.find(function(e){return e.active})}function k(e){if(!w()||"auto"===w().id){var t=L.querySelector(".js-panelStatText");t.innerHTML=e}}function S(){return Ws(L.querySelectorAll('.vp-panel-collapsible button[tabindex="0"], .vp-panel-open li[tabindex="0"]'))}var E=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},T=he(),x=E.id,A=E.items,L=void 0,P=void 0,C=void 0,O=!1,R=void 0,I=void 0;return t(),R={id:x,element:L,setCollapsible:o,resetCarousel:s,pinTitle:c,isOpen:l,open:d,close:h,setActiveItem:b,setTitleStat:k,getTabindexItems:S,on:T.on,off:T.off}}function _i(e,t,n){return e=String(e),new Array(t-e.length+1).join(n||"0")+e}function bi(e,t){var n=Math.floor(e/3600%60),i=Math.floor(e/60%60);if(e=Math.floor(e%60),t){var r=e+" second"+(1===e?"":"s");return i>0&&(r=i+" minute"+(1===i?"":"s")+", "+r),n>0&&(r=n+" hour"+(1===n?"":"s")+", "+r),r}return(n>0?n+":":"")+_i(i,2)+":"+_i(e,2)}function wi(e,t,n){function i(){qe=null,je=null}function r(){if(!je){var e=xe(ne).left,t=parseInt(window.getComputedStyle(ne,"").borderLeftWidth,10);je=e+t}return je}function o(){if(!qe){var e=xe(ne).right,t=parseInt(window.getComputedStyle(ne,"").borderRightWidth,10);qe=e-t}return qe}function a(t){var n=r(),i=o(),a=i-n,s=t-n;if(e.config.user.progress&&s<=10&&!Se)return 0;var u=s/a;return Pe(u,0,1)}function s(t){for(var n=Ve,i=Array.isArray(n),r=0,n=i?n:n[Symbol.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if(r=n.next(),r.done)break;o=r.value}var s=o,u=xe(s),c=u.left,l=u.right;if(t>=c&&t<=l){var d=parseFloat(s.getAttribute("data-time"));return d/e.config.video.duration}}return a(t)}function u(t,n){Se&&!Me&&(n=n||e.config.video.duration*t||0,window.requestAnimationFrame(function(){c(t,n),l(t,n)}))}function c(e,n){(!t.get(pp)||Be&&0!==n)&&(t.get(bp)&&(e=100),se.style.left=Math.min(Fe(100*e),100)+"%",ue.innerHTML=bi(n))}function l(e,n){t.get(bp)&&(e=100);var i=Math.min(Fe(100*e),100);oe.style.width=i+"%",oe.setAttribute("aria-valuenow",Fe(n)),oe.setAttribute("aria-valuetext",bi(Math.round(n),!0)+" played"),ee.setAttribute("width",i+"%")}function d(e,n){t.get(bp)&&(e=100);var i=Math.min(Fe(100*e),100);re.style.width=i+"%",re.setAttribute("aria-valuenow",Fe(n)),re.setAttribute("aria-valuetext",bi(n,!0)+" loaded"),Z.setAttribute("width",i+"%")}function f(){return Se=!0,Ne&&(De=!1,n.classList.add("invisible"),E(),m()),Q.classList.contains("state-playing")?(e.events.fire(kc.pauseButtonPressed),h()):(e.events.fire(kc.playButtonPressed),v()),!$i.android}function h(){Be=!1,Q.classList.remove("state-playing"),Q.classList.add("state-paused");var e=Q.getAttribute("data-title-play");Q.setAttribute("title",e),Q.setAttribute("aria-label",e)}function v(){Be=!0,Ne&&E(),Q.classList.remove("state-paused"),Q.classList.add("state-playing");var e=Q.getAttribute("data-title-pause");Q.setAttribute("title",e),Q.setAttribute("aria-label",e)}function p(){De&&(ke||(Se&&Ie||Te||$e)&&(Ee||(!ze&&!Ge||Te)&&(Te&&e.config.view===cc.privateUnlocked||Ce||Ae||(De=!1,e.events.fire(kc.controlBarVisibilityChanged,De),n.classList.add("invisible")))))}function m(){De||Te||(n.classList.remove("hidden"),n.removeAttribute("hidden"),setTimeout(function(){De=!0,e.events.fire(kc.controlBarVisibilityChanged,De),n.classList.remove("invisible")},0))}function g(e){return Xe.push(e),ie.appendChild(e.element),e}function y(e){Xe=Xe.filter(function(t){return t!==e}),ie.removeChild(e.element),e.destroy()}function _(t){var n=[];"text_tracks"in e.config.request&&(e.config.request.text_tracks.forEach(function(e){var t="CC"===e.label.substring(e.label.length-2),i="captions"!==e.kind||t?"":" CC";n.push({label:e.label+i,id:""+e.id,active:He===""+e.id})}),n.push({label:"Выкл.",id:"off",active:null===He}));var i=new yi(e,{items:n,id:"cc",title:"Скрытые субтитры"});i.on("select",function(t){return"off"===t?void e.events.fire(wc.turnCaptionsOff):void e.events.fire(wc.turnCaptionsOn,t)});var r=new mi(e,t,[i]);return r}function b(){window.requestAnimationFrame(function(){c(0,e.config.video.duration),l(0,0),d(0,0)})}function w(){Se=!1,Ee=!1,Ae=!1,Oe=!1,Me=!1,ke=!1,Ie=!1,ge&&(y(ge),ge=null),Ue&&(y(Ue),Ue=null)}function k(){if(!e.config.embed.settings.custom_logo)return null;var t=e.config.embed.settings.custom_logo,n=t.img;return $i.devicePixelRatio>=2&&(n=n.replace(/(mw|mh)=(\d+)/g,function(e,t,n){return t+"="+2*parseInt(n,10)})),{showLink:null!==t.url,url:Tt(t.url),img:n,sticky:t.sticky,width:t.width,height:t.height}}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;if(he){var t,n=1/ve.length,i=e/n,r=Math.ceil(i),o=i%1;o<=.33&&(t="fill1"),o>.33&&o<=.66&&(t="fill2"),ve.forEach(function(e,n){return e.classList.remove("fill0"),e.classList.remove("fill1"),e.classList.remove("fill2"),n===r-1&&o&&o<=.66?void e.classList.add(t):void(n>r-1&&e.classList.add("fill0"))}),he.setAttribute("aria-valuenow",e.toFixed(3)),he.setAttribute("aria-valuetext",Math.round(100*e)+"%")}}function E(){if(e.config.view===cc.main||e.config.view===cc.privateUnlocked){var i=e.config.embed.settings,r={show:i.logo,showLink:!!e.config.video.url,url:e.config.video.url},o=k();if(e.config.embed.settings.watch_trailer&&!Se&&!Be&&!e.config.embed.autoplay&&e.config.embed.on_site)return void T(r,o);var a=!e.telecine||e.telecine.supportsSettingVolume,s=!e.telecine||e.telecine.supportsTextTracks,u="text_tracks"in e.config.request&&e.config.request.text_tracks.length,c={targetBlank:0===e.config.embed.on_site,playState:Be?"playing":"paused",volume:a&&i.volume,ccButton:s&&u,ccOn:null!==He,prefsButton:!0,airplayButton:$i.airPlay,stereoscopicButton:"disable"!==e.config.video.privacy&&$i.stereoscopic&&e.config.video.spatial,fullscreenButton:i.fullscreen,vimeoLogo:r,duration:bi(e.config.video.duration),rawDuration:e.config.video.duration,strings:{play:"Воспроизвести",pause:"Пауза",loadedBar:"загружено",playedBar:"воспроизведено",volume:"Громкость (изменяется с помощью кнопок курсора)",captions:"Выбрать субтитры",prefs:"Настройки",effect:"Выберите эффект для видео",airPlay:"Выбрать устройство AirPlay",airPlayOff:"Выключить AirPlay",pipEnter:"Включить режим “кадр-в-кадре”",pipReturn:"Выключить режим “кадр-в-кадре”",fullscreen:"Полноэкранный режим",enterFullscreen:"Перейти в полноэкранный режим",exitFullscreen:"Выйти из полноэкранного режима",watchOnVimeo:"Смотреть на сайте vimeo.com",stereoscopic:"Enable stereoscopic playback",stereoscopicOff:"Disable stereoscopic playback"}};if(o&&(c.customLogo=o),e.config.video.live_event&&$i.iOS&&(c.prefsButton=!1),n.classList.remove("trailer"),Ne=!1,n.innerHTML=Ag.render("controlbar",c),Q=n.querySelector(".play"),J=Q.querySelector(".buffer"),Z=Q.querySelector(".loaded"),ee=Q.querySelector(".played"),te=n.querySelector(".play-bar"),ne=n.querySelector(".vp-progress"),ie=n.querySelector(".js-menubar"),re=te.querySelector(".loaded"),oe=te.querySelector(".played"),ae=te.querySelector(".cuepoints"),se=n.querySelector(".timecode"),ue=se.querySelector(".box"),ce=n.querySelector(".ghost-timecode"),le=ce.querySelector(".box"),de=n.querySelector(".thumb-preview"),fe=n.querySelector(".thumb"),he=n.querySelector(".volume"),he&&(ve=Ws(he.querySelectorAll("div")),S(e.config.request.cookie.volume)),me=n.querySelector(".play-bar .cc"),pe=n.querySelector(".js-prefs"),We=n.querySelector(".effect"),ye=n.querySelector(".pip"),$i.airPlay&&(_e=n.querySelector(".airplay")),$i.stereoscopic&&e.config.video.spatial&&(be=n.querySelector(".stereoscopic")),we=n.querySelector(".fullscreen"),Ee=!1,Se||G(),De&&e.events.fire(kc.controlBarVisibilityChanged,De),$e&&p(),t.get(bp)){var l=n.querySelector(".live");l.style.display="block";var d=l.querySelector(".circle");Ke?(d.classList.remove("offline"),d.classList.add("online"),Q.classList.remove("hidden"),pe&&pe.classList.remove("hidden")):(d.classList.add("offline"),d.classList.remove("online"),Q.classList.add("hidden"),pe&&pe.classList.add("hidden")),Be?se.style.display="block":se.style.display="none",ue.style.cursor="default",ne.classList.add("disabled")}}}function T(t,i){n.classList.add("trailer");var r={vimeoLogo:t,text:e.config.video.vod.button_text||"Смотреть трейлер",strings:{playTrailer:"Воспроизвести трейлер",watchOnVimeo:"Смотреть на сайте vimeo.com"}};i&&(r.customLogo=i),n.innerHTML=Ag.render("controlbar_trailer",r),Q=n.querySelector(".play"),Ne=!0}function x(){pi(n,".play, .replay",f),e.events.on([kc.playInitiated,kc.playButtonPressed],v),e.events.on([kc.pauseButtonPressed,kc.paused],h),e.events.on(kc.error,function(e){"telecine-file-error"!==e&&h()}),e.events.on(kc.played,function(){v()}),e.events.on(kc.ended,function(){Me=!1,h(),u(1)}),e.events.on(kc.overlayOpened,function(e){"not-supported"===e&&h()})}function A(){e.events.on(kc.loadProgress,function(e,t,n){ke||window.requestAnimationFrame(function(){d(n,e)})})}function L(){e.events.on([kc.bufferStarted,kc.controlbarBufferStarted],function(){J.setAttribute("class",J.getAttribute("class").replace(/\s+hidden/,"")),Ce=!0,$e||m()}),e.events.on([kc.bufferEnded,kc.controlbarBufferEnded],function(){re.classList.remove("hidden"),t.get(bp)&&oe.classList.remove("hidden"),J.setAttribute("class",J.getAttribute("class")+" hidden"),Ce=!1})}function P(){function i(t){if(!t.button||2!==t.button){e.element.classList.add("scrubbing"),e.events.fire(kc.scrubbingStarted);var i=t.type;if("pointerdown"===i||"MSPointerDown"===i){a=t.pointerId;try{t.target.msSetPointerCapture?t.target.msSetPointerCapture(a):t.target.setPointerCapture(a)}catch(e){}Wp(n).on("pointermove",".vp-progress",r).on("pointerup",".vp-progress",o)}else"touchstart"===i?Wp(n).on("touchmove",r).on("touchend",o):Wp(document).on("mousemove",r).on("mouseup",o);var d=t.clientX;t.targetTouches&&t.targetTouches.length>0&&(d=t.targetTouches[0].clientX,t.preventDefault());var f=s(d),h=null;if(Se)u(f);else{var v=e.config.video.duration*f;c(f,v),l(f,v),Me=!0}return e.events.fire(wc.seek,f,h),!1}}function r(t){if(Me=!1,a===t.pointerId&&t.isPrimary!==!1){var n=t.clientX;t.targetTouches&&t.targetTouches.length>0&&(n=t.targetTouches[0].clientX,t.preventDefault());var i=s(n);u(i),e.events.fire(wc.seek,i)}}function o(t){var i=t.type;"pointerup"===i||"MSPointerUp"===i?Wp(n).off("pointermove",".vp-progress",r).off("pointerup",".vp-progress",o):"touchend"===t.type?Wp(n).off("touchmove",r).off("touchend",o):Wp(document).off("mousemove",r).off("mouseup",o),e.events.fire(kc.scrubbingEnded),
e.element.classList.remove("scrubbing")}e.events.on(kc.playProgress,function(t,n,i){Me&&(0===e.config.embed.time||e.config.embed.time>0&&t>=e.config.embed.time)&&(Me=!1),Ae||u(i,t)}),e.events.on(kc.scrubbingStarted,function(e){Ae=!0,Le=e}),e.events.on(kc.scrubbingEnded,function(){Ae=!1,Le=!1});var a;e.events.on(kc.seeked,function(e,t,n){Le&&u(n)}),t.get(pp)&&!t.get(_p)||(Wp(n).on($i.pointerEvents?"pointerdown":["touchstart","mousedown"],".vp-progress",i),e.events.on(wc.setTime,function(t,n){t=Pe(t,0,e.config.video.duration),n||(n=t/e.config.video.duration),window.requestAnimationFrame(function(){c(n,t),l(n,t)})}))}function C(){function i(){return g||(g=e.verifyConfig().then(function(e){return Ht(e.thumb_preview.url)})),g.then(function(t){var n=e.config.request.thumb_preview;return fe.style.backgroundImage||(fe.style.width=n.frame_width/2+"px",fe.style.height=n.frame_height/2+"px",fe.style.backgroundImage="url("+n.url+")",fe.style.backgroundSize=n.width/2+"px "+n.height/2+"px"),t})}function s(t){if(t.target===te){var n=a(t.clientX);u(n),e.events.fire(wc.seek,n)}}function c(e){return ce.classList.contains("hidden")?e:(de.classList.remove("hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){de.classList.remove("invisible")})}),e)}function l(t){Re||Oe||(ce.classList.remove("hidden"),Re=!0,h(t),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){ce.classList.remove("invisible")})}),e.config.request.thumb_preview&&y&&i().then(c).catch(function(){}),Wp(te).on("click",s))}function d(t){var n=e.config.video.duration/e.config.request.thumb_preview.frames,i=Math.min(e.config.request.thumb_preview.frames-1,Math.ceil(t/n)),r=i%e.config.request.thumb_preview.columns,o=Math.floor(i/e.config.request.thumb_preview.columns),a=-(r*e.config.request.thumb_preview.frame_width/2),s=-(o*e.config.request.thumb_preview.frame_height/2);return[a,s]}function f(e){for(var t=Ve,n=Array.isArray(t),i=0,t=n?t:t[Symbol.iterator]();;){var r;if(n){if(i>=t.length)break;r=t[i++]}else{if(i=t.next(),i.done)break;r=i.value}var o=r,a=xe(o),s=a.left,u=a.right,c=a.width;if(e>=s&&e<=u)return{clientX:s+c/2,snappedTo:o}}return{clientX:e,snappedTo:null}}function h(t){if(e.config.request.thumb_preview&&null===y){var n=xe(ne).width,r=document.querySelector(".player").clientHeight,s=215,u=185;if(y=r>=s&&n>=u,!y)return void de.classList.add("hidden");i().then(c).catch(function(){})}Re&&!function(){var n=f(t.clientX,Ve),r=n.clientX,s=n.snappedTo,u=a(r),c=e.config.video.duration*u;Ve.forEach(function(e){return e.classList.toggle("active",e===s)}),e.config.request.thumb_preview&&y&&i().then(function(e){var t=d(c),n=rc(t,2),i=n[0],r=n[1];return window.requestAnimationFrame(function(){fe.style.backgroundPosition=i+"px "+r+"px"}),e}).catch(function(){}),window.requestAnimationFrame(function(){le.innerHTML=bi(c);var e=(100*u).toFixed(3);ce.style.left=e+"%",p(u),t.clientX>o()+10&&!de.contains(document.elementFromPoint(t.clientX,t.clientY))&&m()})}()}function v(){var e=xe(Q).left,t=xe(te).right,n=xe(de).width,i=e+Math.ceil(n/2),a=t-Math.ceil(n/2),s=r(),u=o(),c=u-s,l=(i-s)/c,d=(a-s)/c;return[l,d]}function p(e){var t=v(),n=rc(t,2),i=n[0],r=n[1],o=Math.max(i,Math.min(r,e)),a=(100*o).toFixed(3);de.style.left=a+"%"}function m(){ce&&(ce.classList.add("invisible"),de.classList.add("invisible")),Re=!1,Wp(te).off("click",s)}var g=void 0,y=null;t.get(pp)&&!t.get(_p)||Wp(n).on("mouseenter",".vp-progress",l).on("mousemove",".play-bar",h).on("mouseleave",".play-bar",m),Wp(n).on("transitionend",".ghost-timecode",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(ce.classList.add("hidden"),de.classList.add("hidden"))},!1),e.events.on(kc.mousedOut,m),e.events.on(kc.configChanged,function(){g=null})}function O(){function t(e){He=e,ge&&ge.getPanel("cc")&&(ge.getPanel("cc").setActiveItem(e),setTimeout(function(){ge.hide()},100)),me&&(me.classList.add("on"),me.classList.remove("off"))}function i(){He=null,ge&&ge.getPanel("cc")&&(ge.getPanel("cc").setActiveItem("off"),setTimeout(function(){ge.hide()},100)),me&&(me.classList.add("off"),me.classList.remove("on"))}pi(n,".cc",function(){e.events.fire(kc.ccButtonPressed)}),e.events.on(kc.ccButtonPressed,function(e){return ge?void ge.toggle(e):(ge=g(_(me,te)),void ge.show(e))}),e.events.on(kc.captionsChanged,function(e){return e?void t(e.id):void i()}).on(kc.controlBarVisibilityChanged,function(e){e||ge&&ge.hide()}).on([wc.enableCaptions,wc.disableCaptions],function(){E()})}function R(){function i(){if(e.telecine.video.currentFile.mime===fc.dash){var t=e.config.request.files.dash.streams,n=Ws(t).sort(Bn()).filter(Mn(t)).filter(Dn(Ye)).map(function(e){var t=On(e);return{id:t,label:Nn(e),active:a===t}});return n.unshift({id:"auto",label:"Auto",active:!a||"auto"===a}),n}var i=e.telecine.video.files;return Ws(i).filter(Pn("progressive")).filter(Mn(i)).sort(Bn()).filter(Dn(Ye)).map(function(e){return{label:On(e),id:On(e),active:a===e.metadata.quality}})}function r(e){var t=e.sort(Bn()).map(function(e){var t=e+"p",n=t;return{id:t,label:n,active:a===t}});return t.unshift({id:"auto",label:"Auto",active:!a||"auto"===a}),t}function o(){function n(t){f.element.classList.toggle("vp-menu-center",t),e.events.fire(kc.menuCentered,f.isCentered(),f)}function r(e){f.element.classList.toggle("vp-menu-carousel",e),f.setPanelModes()}var o=[],a=new yi(e,{id:"quality",title:"Качество",items:u||i()});a.on("select",function(t){e.events.fire(wc.changeQuality,t)}),s&&a.setTitleStat(s),a.pinTitle(),o.push(a);var c=e.telecine.supportsPlaybackRate;if(c&&e.config.embed.settings.speed){var l=Qe.map(function(t){return t.active=t.id===e.telecine.playbackRate,t}),d=new yi(e,{id:"speed",title:"Скорость воспроизведения",items:l});d.on("select",function(t){e.events.fire(wc.changePlaybackRate,t)}),d.pinTitle(),o.push(d)}var f=new mi(e,pe,o);return t.watch("ui.controlbar.isPrefsMenuCentered",n),t.watch("ui.controlbar.hasPrefsMenuCarousel",r),n(t.get("ui.controlbar.isPrefsMenuCentered")),r(t.get("ui.controlbar.hasPrefsMenuCarousel")),f}var a=void 0,s=void 0,u=null;pi(n,".js-prefs",function(){e.events.fire(kc.prefsButtonPressed)}),e.events.on(kc.prefsButtonPressed,function(e){if(pe){if(!Ue)return Ue=g(o()),void Ue.show(e);Ue.toggle(e)}}),e.events.on(kc.qualityChanged,function(e){a=e,Ue&&Ue.getPanel("quality")&&Ue.getPanel("quality").setActiveItem(e)}),e.events.on(kc.streamChanged,function(e){var t=e.quality||e.height+"p";s=t,Ue&&Ue.getPanel("quality")&&Ue.getPanel("quality").setTitleStat(Nn(e))}),e.events.on(kc.playbackRateChanged,function(e){Ue&&Ue.getPanel("speed")&&Ue.getPanel("speed").setActiveItem(e)}),e.events.on(kc.liveRepresentationsAvailable,function(e){var t=e.video.map(function(e){return e.height.toString()});a=null,u=r(t),Ue&&(y(Ue),Ue=null)}),e.events.on(kc.hevcRestrictedStreams,function(e){Ye=e})}function I(){var t=document.createElement("a");if(t.style.cssText="-moz-filter:blur(2px);-webkit-filter:blur(2px);filter:blur(2px);",!(t.style.length<1||e.config.embed.settings.background)){var i=null,r=function(){var t=[{label:"Soporific",id:"aden"},{label:"Escutcheon",id:"earlybird"},{label:"Pluvious",id:"hudson"},{label:"Moribund",id:"inkwell"},{label:"Fecundity",id:"mayfair"},{label:"Jejune",id:"toaster"},{label:"Выкл.",id:"none",active:!0}],n=$i.browser.safari,i=e.telecine.supportsEffect(pv),r=dc[e.telecine.video.currentFile.mime],o="dash"===r;return!n&&o&&i&&t.unshift({label:"ASCII",id:"ascii"}),t};pi(n,".effect",function(){return e.events.fire(kc.effectButtonPressed)}),e.events.on(kc.effectButtonPressed,function(t){if(We.classList.remove("hidden"),!i){var n=new yi(e,{id:"effect",title:"Эффект",items:r()});return n.on("select",function(t){return e.events.fire(wc.setEffect,t)}),i=g(new mi(e,We,[n])),void i.show(t)}i.toggle(t)}),e.events.on(wc.setEffect,function(e){return i.getPanel("effect").setActiveItem(e),"none"===e?(We.classList.add("off"),void We.classList.remove("on")):(We.classList.add("on"),void We.classList.remove("off"))}),e.events.on(kc.ready,function(){e.telecine.on(_h.SCANNER_CHANGE,function(){i&&(y(i),i=null),Ue&&(y(Ue),Ue=null)})})}}function M(){pi(n,".pip",function(){return"picture-in-picture"===e.telecine.presentationMode?void e.events.fire(wc.deactivatePictureInPicture):void e.events.fire(wc.activatePictureInPicture)}),e.events.on(kc.pictureInPictureAvailable,function(){ye&&(ye.classList.remove("hidden"),ye.hidden=!1,i())}).on(kc.pictureInPictureNotAvailable,function(){ye&&(ye.classList.add("hidden"),ye.hidden=!0,i())}).on(kc.pictureInPictureActivated,function(){Ge=!0,ye&&(ye.classList.add("return"),ye.classList.remove("enter"),ye.setAttribute("title",ye.getAttribute("data-title-return")))}).on(kc.pictureInPictureDeactivated,function(){Ge=!1,ye&&(ye.classList.add("enter"),ye.classList.remove("return"),ye.setAttribute("title",ye.getAttribute("data-title-enter")))})}function D(){$i.airPlay&&(pi(n,".airplay",function(){e.events.fire(kc.airPlayButtonPressed)}),e.events.on(kc.airPlayAvailable,function(){_e&&(_e.classList.remove("hidden"),_e.hidden=!1,i())}).on(kc.airPlayNotAvailable,function(){_e&&(_e.classList.add("hidden"),_e.hidden=!0,i())}).on(kc.airPlayActivated,function(){ze=!0,_e&&(_e.classList.remove("off"),_e.classList.add("on"),_e.setAttribute("title",_e.getAttribute("data-title-on"))),m()}).on(kc.airPlayDeactivated,function(){ze=!1,_e&&(_e.classList.remove("on"),_e.classList.add("off"),_e.setAttribute("title",_e.getAttribute("data-title-off")))}))}function F(){pi(n,".fullscreen",function(){e.events.fire(kc.fullscreenButtonPressed)}),e.events.on(kc.didEnterFullscreen,function(){ke=!1,n.classList.remove("tiny"),we&&we.setAttribute("title",we.getAttribute("data-title-unfullscreen"))}),e.events.on(kc.didExitFullscreen,function(e){if(we){var t=we.cloneNode(!0);we.parentNode.replaceChild(t,we),we=t,we.setAttribute("title",we.getAttribute("data-title-fullscreen"))}e||(ke=!0),$&&n.classList.add("tiny")})}function B(){e.events.on([kc.mousedOver,kc.scrubbingStarted,wc.changeVolume],m).on([kc.mousedOut,kc.mouseTimeout],p).on(kc.willEnterFullscreen,function(){Ee=!1,p()}).on(kc.willExitFullscreen,function(){Ee=!1}).on(kc.targetTimeReached,function(){Ie=!0,p()}).on(wc.changeVolume,function(e,t){t||m()});var t=[".play",".play-bar",".custom-logo",".vp-menu"];Wp(n).on(["pointerenter","pointerleave","mouseenter","mouseleave"],t,function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(Ee="pointerenter"===e.type||"MSPointerEnter"===e.type)):void($i.touch||(Ee="mouseover"===e.type))}),Wp(n).on("transitionend",function(e){this===n&&"opacity"===e.propertyName&&n.classList.contains("invisible")&&(n.classList.add("hidden"),n.setAttribute("hidden",""))})}function N(){function t(t){if(1===t.which){he.setAttribute("data-tabindex",he.getAttribute("tabindex")),he.removeAttribute("tabindex"),Oe=!0,e.element.classList.add("scrubbing"),e.events.fire(kc.volumeScrubbingStarted);var s=t.type;if("pointerdown"===s||"MSPointerDown"===s){a=t.pointerId;try{t.target.msSetPointerCapture?t.target.msSetPointerCapture(a):t.target.setPointerCapture(a)}catch(e){}Wp(n).on("pointermove",".volume",i).on("pointerup",".volume",r)}else"touchstart"===s?Wp(document).on("touchmove",i).on("touchend",r):Wp(document).on("mousemove",i).on("mouseup",r);var u=t.clientX;t.targetTouches&&(u=t.targetTouches[0].clientX);var c=o(u);e.events.fire(wc.changeVolume,c),S(c)}}function i(t){var n=t.clientX;t.targetTouches&&(n=t.targetTouches[0].clientX,t.preventDefault());var i=o(n);e.events.fire(wc.changeVolume,i),S(i)}function r(t){Oe=!1,e.events.fire(kc.volumeScrubbingEnded),e.element.classList.remove("scrubbing");var o=t.type;"pointerup"===o||"MSPointerUp"===o?Wp(n).off("pointermove",".volume",i).off("pointerup",".volume",r):"touchend"===t.type?Wp(document).off("touchmove",i).off("touchend",r):Wp(document).off("mousemove",i).off("mouseup",r),he.setAttribute("tabindex",he.getAttribute("data-tabindex")),he.removeAttribute("data-tabindex")}function o(e){var t=xe(he).left,n=xe(he).right,i=n-t,r=e-t,o=r/i;return Pe(o,0,1)}Wp(n).on("mousemove",".volume",function(e){var t=e.srcElement;if(ve.indexOf(t)===-1){var n=xe(he),i=e.clientX,r=n.bottom-2;if(t=document.elementFromPoint(i,r),ve.indexOf(t)===-1)return}t.classList.add("hover"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.classList.remove("hover"),t.classList.add("animate")})})}),Wp(n).on("transitionend",".volume div",function(e){"height"===e.propertyName&&this.classList.remove("animate")}),Wp(document).on("contextmenu",".volume",function(){this.blur()});var a;Wp(n).on($i.pointerEvents?"pointerdown":["touchstart","mousedown"],".volume",t),e.events.on(kc.volumeChanged,function(e){!Oe&&ve&&S(e)}).on([wc.enableVolume,wc.disableVolume],function(){E()})}function q(){e.events.on(kc.overlayOpened,function(e){if("not-supported"!==e&&"private-unlocked"!==e&&"help"!==e)Te=!0,p();else for(var t=n.querySelectorAll("a, button, input, [tabindex]"),i=0,r=t.length;i<r;i++){var o=t[i].getAttribute("tabindex");o&&t[i].setAttribute("data-tabindex",o),t[i].setAttribute("tabindex","-1")}}).on(kc.overlayClosed,function(){Te=!1,m();for(var e=n.querySelectorAll("[tabindex]"),t=0,i=e.length;t<i;t++){var r=e[t].getAttribute("data-tabindex");r&&"null"!==r?e[t].setAttribute("tabindex",r):e[t].removeAttribute("tabindex"),e[t].removeAttribute("data-tabindex")}})}function j(){e.events.on(kc.outroDisplayed,function(){n.classList.add("controls-outro")}).on(kc.outroHidden,function(){n.classList.remove("controls-outro")})}function V(){function t(e,t){U(t),t.isCentered()&&t.isVisible()&&n.classList.add("controls-centerMenu"),t.isCentered()&&t.isVisible()||n.classList.remove("controls-centerMenu")}function i(){Xe.filter(function(e){return e.isVisible()}).forEach(function(e){return e.hide()})}function r(e){e||i()}e.events.on([kc.menuCentered,kc.menuVisibilityChanged],t).on(kc.didExitFullscreen,i).on(kc.controlBarVisibilityChanged,r),Wp(window).on("resize",function(){Xe.forEach(U)})}function U(t){var n=e.element.querySelector(".vp-player-inner"),i=xe(n),r=xe(t.button),o=xe(t.element.parentElement),a=xe(t.element),s=0,u=r.right-r.width/2+a.width/2;u<o.right&&(s=o.right-u);var c=window.getComputedStyle(t.element),l=parseFloat(c.fontSize);if(t.isCentered()){var d=i.right-o.right,f=i.bottom-o.bottom,h=(i.width-a.width)/2,v=(i.height-a.height)/2;t.element.style.right=(h-d)/l+"em",t.element.style.bottom=(v-f)/l+"em"}else t.element.style.right=s/l+"em",t.element.style.bottom=o.height/l+"em"}function H(){e.events.on(kc.configChanged,function(t,n){X(),P(),E(),e.config.view===cc.privateUnlocked&&m(),i()})}function W(){e.events.on(wc.reset,function(){b(),m(),w()}),Wp(window).on("resize",function(){i()})}function z(){e.events.on(kc.enteredTinyMode,function(){$=!0,n.classList.add("tiny")}).on(kc.enteredMiniMode,function(){$=!1,n.classList.remove("tiny")}).on(kc.enteredNormalMode,function(){$=!1,n.classList.remove("tiny")})}function G(){var t=e.config.user.progress,n=t/e.config.video.duration;!t||e.config.embed.autoplay||e.config.embed.time||Ne||(c(n,t),l(n,t),Me=!0)}function K(){if(e.config.embed.on_site){var t=new Bf;e.events.on(kc.cuePointAdded,function(i){if(i.data.visible){var r=document.createElement("div");r.setAttribute("id","cuepoint-"+i.id),r.setAttribute("data-time",i.time),r.classList.add("cuepoint"),r.classList.add("out"),r.appendChild(document.createElement("div"));var o=i.time/e.config.video.duration*100;r.style.left=o+"%",t.set(i,r),ae.appendChild(r),Ve=Ws(n.querySelectorAll(".cuepoint")),window.requestAnimationFrame(function(){return r.classList.remove("out")})}}),e.events.on(kc.cuePointRemoved,function(e){var n=t.get(e);n&&(t.delete(e),n.classList.add("out"))}),Wp(n).on("transitionend",".cuepoint",function(e){this.classList.contains("out")&&(ae.removeChild(this),Ve=Ws(n.querySelectorAll(".cuepoint")))})}}function Y(){be&&(pi(n,".stereoscopic",function(){e.events.fire(kc.stereoscopicButtonPressed)}),be.classList.remove("hidden"),be.hidden=!1)}function X(){t.get(pp)&&!t.get(_p)&&(e.events.on(kc.liveStreamOnline,function(){Ke=!0,$i.android||$i.iOS||(Be=!0),E()}),e.events.on(kc.liveStreamOffline,function(){Ke=!1,$i.android||$i.iOS||(Be=!1),E()}))}var $,Q,J,Z,ee,te,ne,ie,re,oe,ae,se,ue,ce,le,de,fe,he,ve,pe,me,ge,ye,_e,be,we,ke=!1,Se=!1,Ee=!1,Te=!1,Ae=!1,Le=!1,Ce=!1,Oe=!1,Re=!1,Ie=!1,Me=!1,De=!0,Be=!1,Ne=!1,qe=null,je=null,Ve=[],Ue=null,He=null,We=null,ze=!1,Ge=!1,Ke=t.get(yp),Ye=[],Xe=[],$e=e.config.embed.autoplay&&e.config.request.flags.autohide_controls,Qe=[{id:.5,label:"0.5x"},{id:1,label:"Normal"},{id:1.25,label:"1.25x"},{id:1.5,label:"1.5x"},{id:2,label:"2x"}];return E(),x(),P(),L(),C(),N(),O(),R(),I(),M(),D(),F(),B(),q(),j(),V(),H(),W(),G(),z(),K(),Y(),X(),e.events.on(kc.playInitiated,function(){A(),Se=!0;var t=e.config.embed.time||e.telecine.currentTime;u(t/e.config.video.duration,t),Me=!0}),e.events.fire(kc.controlBarModuleReady),{}}function ki(e,t,n){function i(){clearTimeout(A),A=null}function r(){U&&(clearTimeout(A),A=setTimeout(s,L))}function o(){Rg.element&&Rg.element.classList.contains("js-player-fullscreen")&&(O||(n.classList.add("player-cursor-hide"),C=!0,O=!0))}function a(){O&&(n.classList.remove("player-cursor-hide"),O=!1)}function s(t){if((q||N)&&!V&&(i(),!document.activeElement||!document.body.classList.contains("showfocus")||!z.contains(document.activeElement)&&!G.contains(document.activeElement))){e.events.fire(t?kc.mousedOut:kc.mouseTimeout),C=!0;var n=$i.spatialPlayback&&e.config.video.spatial;n||(W.classList.add("hidden"),W.setAttribute("hidden","")),P=!0,o()}}function u(){q&&N||(e.events.fire(kc.mousedOver),W.classList.remove("hidden"),W.removeAttribute("hidden")),r()}function c(){q||N?n.removeAttribute("tabindex"):q||N||j||n.setAttribute("tabindex","0")}function l(){function t(){u()}function c(t){if(L=T,C)return void(C=!1);if(a(),0!==t.screenX&&t.screenX!==screen.width-1&&0!==t.screenY&&t.screenY!==screen.height-1){if(m=!0,$i.spatialPlayback&&e.config.video&&e.config.video.spatial){var n=xe(e.element),c=t.clientX-n.left,l=t.clientY-n.top,d=4*Dg,f=l>e.element.clientHeight-Mg,h=c>e.element.clientWidth-Dg&&l<d;if(D||!f&&!h)return}P&&u(),r()}else if(i(),o(),m){var v=!0;s(v),m=!1}}function l(){L=x,r()}function d(){var e=!0;s(e)}function f(e){var t=G.contains(e.target)||z.contains(e.target),n=R&&R.getWrapper().contains(e.target);if(q&&N||n){if(!t&&(q||N)){var i=!0;s(i)}}else u()}function h(e){return"mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE?(L=T,t(e)):(L=x,void f(e))}function v(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return c(e)}function p(e){if("mouse"===e.pointerType||e.pointerType===e.MSPOINTER_TYPE_MOUSE)return d(e)}var m=!0;return $i.pointerEvents?void Wp(n).on("pointerenter",h).on("pointermove",v).on("pointerleave",p):void Wp(n).on("touchmove",l).on("touchend",f).on("mouseenter",t).on("mousemove",c).on("mouseleave",d)}function d(){e.events.on(kc.played,function(e){X||0===e||u()}).on(kc.paused,u).on([kc.bufferEnded,kc.scrubbingEnded,kc.volumeChanged,kc.menuPanelOpened],r).on(kc.playInitiated,function(){U=!0}),e.events.on(kc.menuVisibilityChanged,function(e){e&&r()}),e.events.on(kc.overlayOpened,c).on(kc.controlBarVisibilityChanged,function(e){N=e,c()}).on(kc.sidedockVisibilityChanged,function(e){q=e,c()}),e.events.on(kc.outroDisplayed,function(){V=!0,u()}).on(kc.outroHidden,function(){V=!1})}function f(){function i(e){return(e.classList.contains("vp-title")||e.classList.contains("vp-target")||K.contains(e.parentNode)&&"HEADER"===e.parentNode.tagName||Y.contains(e))&&!z.contains(e)}function r(n){if(!a&&2!==n.button&&n.target.classList&&i(n.target)){var r=("pointerup"===n.type||"MSPointerUp"===n.type)&&"mouse"!==n.pointerType&&n.pointerType!==n.MSPOINTER_TYPE_MOUSE,o=U&&$i.spatialPlayback&&e.config.video.spatial&&I;if($i.touch||r){var u=e.telecine.supportedPresentationModes.indexOf("inline")!==-1&&!$i.mobileAndroid;if(!o){if(U&&u)return;return void e.events.fire(kc.playButtonPressed)}}s++,1===s&&setTimeout(function(){if(o){var i=B&&B.x===n.clientX&&B.y===n.clientY;return 1===s&&i&&!$i.mobileAndroid&&e.events.fire(e.telecine.paused?kc.playButtonPressed:kc.pauseButtonPressed),1!==s&&e.telecine.getEffectByName("ThreeSixtyEffect").snapToCenter(),void(s=0)}if(1===s){if(t.get(pp)&&!t.get(yp))return;e.events.fire(e.telecine.paused?kc.playButtonPressed:kc.pauseButtonPressed)}else e.events.fire(kc.fullscreenButtonPressed);s=0},200)}}var o=!1,a=!1,s=0;e.events.on(kc.menuVisibilityChanged,function(e){a=e}),Wp(n).on($i.pointerEvents?"pointerup":"click",r),Wp(n).on("mousedown",".vp-video-wrapper",function(e){if(!o){if(W.classList.remove("hidden"),W.removeAttribute("hidden"),2!==e.button){var t;document.createEvent&&(t=document.createEvent("MouseEvents"),t.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,0,null),W.dispatchEvent(t))}return!1}}).on("contextmenu",".vp-video",function(e){return W.classList.remove("hidden"),W.removeAttribute("hidden"),!1}),e.events.on(wc.toggleNativeControls,function(e){return e?(o=!0,void W.classList.add("hidden")):(o=!1,void W.classList.remove("hidden"))})}function h(){if(!$i.touch){var t,i;Wp(n).on("focus","a, button, input, [tabindex]",function(){i=this,clearTimeout(t),t=null,document.activeElement===this&&u()}),Wp(n).on("blur","a, button, input, [tabindex]",function(){document.activeElement===this&&(t=setTimeout(s,50))}),n.addEventListener("focus",function(e){u(),i&&i.focus()},!1),e.events.on(kc.overlayOpened,function(){j=!0,n.removeAttribute("tabindex")}),e.events.on(kc.overlayClosed,function(){j=!1})}}function v(){e.events.on(kc.didEnterFullscreen,function(e){o(),V&&u()}).on(kc.didExitFullscreen,function(e){return P=!0,e?void s():(u(),void i())})}function p(){e.events.on([kc.playProgress,kc.seeked],function t(n){n>=H&&null===A&&(e.events.fire(kc.targetTimeReached),e.events.off([kc.playProgress,kc.seeked],t))})}function m(){e.events.on(wc.reset,function(){P=!0,C=!0,N=!0,q=!1,U=!1,p(),i()})}function g(){e.events.on(wc.attachSpatialPlaybackEvents,_),e.events.on(wc.toggleSpatialPlayback,function(e){y(),I=e,w()})}function y(){Y.classList.remove("threesixty-video"),e.element.classList.remove("grabbable"),e.element.classList.remove("grabbing"),R&&R.hide()}function _(){var t=function(e){return function(){I&&e.apply(void 0,arguments)}};e.events.on(wc.revealSpatialControls,t(function(){e.element.classList.add("grabbable"),R&&R.updatePosition(e.element),!R||R.visible||I.isStereo()||R.reveal()})),e.events.on(kc.ended,t(function(){y()})),e.events.on(kc.cameraUpdate,t(function(e){R&&R.setAngle(e.lat,e.lon)})),e.events.on(kc.playInitiated,t(function(){e.config.video.spatial&&b()})),e.events.on(kc.stereoscopicButtonPressed,t(function(){w()}));var n=null,i=t(function(t){D||(D=!0,t.preventDefault(),e.element.classList.add("grabbing"),B={x:t.clientX,y:t.clientY},I.makeContact(B))}),r=t(function(e){D&&(w(),I.move({x:e.clientX,y:e.clientY}))}),o=t(function(t){D&&(e.element.classList.remove("grabbing"),I.releaseContact(!1),D=!1)}),a=t(function(t){t.preventDefault(),I.isUserInteracting||(I.isUserInteracting=!0),null!==n&&clearTimeout(n),w(),n=setTimeout(function(){e.element.classList.remove("player-cursor-hide"),e.element.classList.add("grabbable"),I.isUserInteracting=!1},500),e.element.classList.add("player-cursor-hide"),e.element.classList.remove("grabbable"),I.moveWheel({x:t.deltaX,y:t.deltaY})}),s=t(function(e){D||(D=!0,I.makeContact({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),u=t(function(e){D&&(e.preventDefault(),w(),I.move({x:e.touches[0].clientX,y:e.touches[0].clientY}))}),c=t(function(e){I.releaseContact(!0),D=!1}),l=t(function(e){D||w(),I.moveDevice(e.alpha,e.beta,e.gamma,e.orientation)}),d=t(function(t){D=!1,e.element.classList.remove("grabbing"),I.abandonMotion()});e.events.once(kc.playInitiated,function(){e.store.watch("ui.player.layout",function(){R&&R.updatePosition(e.element),I&&I.adjustRenderSize(),D=!1}),$i.android&&window.addEventListener("deviceorientation",l,!1),$i.pointerEvents?(Wp(W).on("pointerdown",i),window.addEventListener("pointermove",r),window.addEventListener("pointerup",o),window.addEventListener("pointerleave",d)):(Wp(W).on("touchstart",s).on("mousedown",i).on("wheel",a),window.addEventListener("touchmove",u),window.addEventListener("mousemove",r),window.addEventListener("mouseup",o),window.addEventListener("touchend",c),window.addEventListener("mouseleave",d))})}function b(){function t(){var e=n;if(!F){var t=F=document.createElement("div");t.classList.add("cloaked"),t.classList.add("player-alert-round"),t.classList.add("player-alert-round--top"),t.classList.add("player-alert-round--threesixty"),e.appendChild(t)}}function i(e){F&&(F.innerHTML=Ag.render("threesixty_reminder",e))}function r(){i({showArrows:!1,text:$i.android?"Look around":"Click and drag to look around"})}function o(){i({showArrows:!1,text:$i.android?"Look around":"Use arrow keys to see more"})}var a=e.telecine.getEffectByName("ThreeSixtyEffect"),s=7e3,u=14e3,c=3e3,l=e.config.embed.settings.spatial_compass;l?(R||(R=new Ig(e.element.querySelector(".vp-controls-wrapper"),function(){a.snapToCenter()})),R.updatePosition(e.element),R.reveal()):R&&R.hide(),e.events.once(kc.firstTimeUpdate,function(){var t=e.config.embed.cards,n=15,i=t&&t.length&&t[0].timecode<n;i||(M.push(setTimeout(function(){r(),E(F),k(F),setTimeout(function(){return S(F)},c)},s)),$i.android||M.push(setTimeout(function(){o(),E(F),k(F),setTimeout(function(){return S(F)},c)},u)))}),t()}function w(){M.forEach(function(e){return clearTimeout(e)}),M=[]}function k(e){e&&(e.classList.remove("cloaked"),window.requestAnimationFrame(function(){e.classList.add("in")}))}function S(e){e&&(e.classList.add("leaving"),window.requestAnimationFrame(function(){Wp(e).on("transitionend",function t(n){"opacity"===n.propertyName&&(e.classList.remove("in"),e.classList.remove("leaving"),e.classList.add("cloaked"),Wp(e).off("transitionend",t))})}))}function E(e){var t=xe(z);return t.width>60?void e.classList.add("player-alert-bumpdown"):void e.classList.remove("player-alert-bumpdown")}var T=2e3,x=4500,A=null,L=$i.touch?x:T,P=!0,C=!0,O=!1,R=null,I=null,M=[],D=!1,F=null,B=null,N=!0,q=!1,j=!1,V=!1,U=!1,H=1.75,W=n.querySelector(".vp-target"),z=n.querySelector(".vp-sidedock"),G=n.querySelector(".vp-controls"),K=n.querySelector(".vp-title"),Y=n.querySelector(".vp-video"),X=e.config.embed.autoplay&&e.config.request.flags.autohide_controls;return l(),d(),f(),h(),v(),p(),m(),g(),{}}function Si(e,t){function n(e){var n="watchlater"===e||"unwatchlater"===e?.5:.4,i=t.clientHeight;return t.clientHeight>t.clientWidth&&(i=t.clientWidth),{height:Math.round(i*n),width:Math.round(i*n*1.6)}}function i(e,t){var n=e.querySelector(".hour-hand"),i=e.querySelector(".minute-hand");if(n&&i){var r=t?1:-1,o=new Date,a=Math.abs(o.getHours()-12),s=o.getMinutes(),u=s/60*360-135,c=a/12*360+s/60*5,l=1.5,d=c+30*l*r,f=u+360*l*r;n.style[$i.transformProperty]="rotate("+c+"deg)",i.style[$i.transformProperty]="rotate("+u+"deg)",window.requestAnimationFrame(function(){e.classList.add("animate"),$i.browser.firefox||$i.browser.opera||window.requestAnimationFrame(function(){n.style[$i.transformProperty]="rotate("+d+"deg)",i.style[$i.transformProperty]="rotate("+f+"deg)"})})}}function r(e,r){if(null!==t.parentElement.offsetParent){t.classList.remove("hidden"),t.removeAttribute("hidden"),t.setAttribute("data-name",e);var a=n(e),s="width:"+a.width+"px;height:"+a.height+"px";d.style.cssText=s,d.innerHTML=r,"watchlater"!==e&&"unwatchlater"!==e||i(d,"watchlater"===e),clearTimeout(l),t.classList.remove("animate"),window.requestAnimationFrame(function(){t.classList.remove("invisible"),l=setTimeout(o,750)})}}function o(){t.classList.add("animate"),t.classList.add("invisible")}function a(){t.classList.remove("animate"),t.classList.remove("invisible"),t.classList.add("hidden"),t.setAttribute("hidden",""),t.removeAttribute("data-name"),d.innerHTML="",d.classList.remove("filled"),d.classList.remove("animate"),e.events.fire(kc.notificationHidden)}function s(){e.events.on(kc.liked,function(e){e||r("like",Ag.render("icon_heart"))}),e.events.on(kc.unliked,function(e){e||r("unlike",Ag.render("icon_broken_heart"))})}function u(){e.events.on(kc.addedToWatchLater,function(e){e||r("watchlater",Ag.render("icon_clock"))}),e.events.on(kc.removedFromWatchLater,function(e){e||r("unwatchlater",Ag.render("icon_clock"))})}function c(){Wp(t).on("transitionend",function(e){d.contains(e.target)&&"height"===e.propertyName?setTimeout(o,100):e.target===t&&"opacity"===e.propertyName&&window.requestAnimationFrame(a)})}var l,d=t.querySelector(".notification");return c(),s(),u(),e.events.fire(kc.notificationModuleReady),{}}function Ei(e){return e=Ey(e),e&&xy.test(e)?e.replace(Ty,Sy):e}function Ti(e,t){function n(e){Oe(e,"facebook",{width:580,height:400})}function i(e){Oe(e,"twitter",{width:550,height:420})}function r(e){Oe(e,"tumblr",{width:540,height:600})}function o(){function n(){e.events.fire(kc.embedCodeCopied);var n=t.querySelector(".js-embedCopy");n.innerHTML=n.getAttribute("data-success-label"),clearTimeout(i),i=setTimeout(function(){n.innerHTML=n.getAttribute("data-label")},2e3)}var i;Wp(t).on("transitionend",".js-share-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(a.fire(kc.embedViewEnd),this.classList.add("cloaked"))}).on("transitionend",".js-embed-screen",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&(a.fire(kc.shareViewEnd),this.classList.add("cloaked"),De(t))}).on("copy","input[name=embed_code]",function(){e.events.fire(kc.embedCodeCopied)}),pi(t,".js-facebook",function(){return e.events.fire(kc.facebookButtonPressed,this.href),Ee(),!1}),pi(t,".js-twitter",function(){return e.events.fire(kc.twitterButtonPressed,this.href),Ee(),!1}),pi(t,".js-tumblr",function(){return e.events.fire(kc.tumblrButtonPressed,this.href),Ee(),!1}),pi(t,".js-email",function(){return e.events.fire(kc.emailButtonPressed),window.top.location=this.href,Ee(),!1}),pi(t,".js-embed",function(){return e.events.fire(kc.embedButtonPressed),u.showEmbedView(),Ee(),!1}),pi(t,".js-embedCopy",function(){if(s){var e=t.querySelector("input[name=embed_code]");e.select();try{document.execCommand("copy")&&n()}catch(e){}return document.activeElement.blur(),!1}}),$i.touch?Wp(t).on("focus","input[name=embed_code]",function(){var e=this;setTimeout(function(){e.setSelectionRange(0,9999),e.setAttribute("readonly","readonly")},0)}).on("blur","input",function(){this.removeAttribute("readonly")}):Wp(t).on("click","input[name=embed_code]",function(){this.setSelectionRange(0,9999)}),a.on(kc.embedViewShown,function(){function i(){var i=t.querySelector(".js-embedCopy"),r=new ZeroClipboard(i,{moviePath:e.config.request.urls.zeroclip_swf,trustedDomains:["*"],allowScriptAccess:"always"});r.on("complete",n)}if(!s&&$i.flash.installed){var r="zc_script_loaded";if(!document.getElementById(r)){var o,a=document.createElement("script");return a.setAttribute("id",r),a.setAttribute("src",e.config.request.urls.zeroclip_js),a.onreadystatechange=a.onload=function(){o||i(),o=!0},void document.getElementsByTagName("head")[0].appendChild(a)}i()}})}var a=he(),s=!1,u={get events(){return a},setup:function(){t.classList.remove("vp-share-embed-active","vp-share-embed-only"),e.config.embed.settings.share&&e.config.embed.settings.share.embed_only&&t.classList.add("vp-share-embed-only");var o=t.querySelector(".js-embedCopy");o&&(o.style.width=Ne(o,["Копировать","Скопировано!"])),e.events.on(kc.facebookButtonPressed,n).on(kc.twitterButtonPressed,i).on(kc.tumblrButtonPressed,r)},destroy:function(){e.events.off(kc.facebookButtonPressed,n).off(kc.twitterButtonPressed,i).off(kc.tumblrButtonPressed,r)},getShareData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(arguments[1],e.config.video.title),i=e.config.video.owner.name,r=e.config.video.share_url;return s=document.queryCommandSupported&&document.queryCommandSupported("copy"),
t.template=Ag.render("share",{url:e.config.video.url,shareUrl:r,playerShareUrl:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/share",title:n,owner:i,embed:"public"===e.config.video.embed_permission&&e.config.embed.settings.embed,embedOnly:e.config.embed.settings.share&&e.config.embed.settings.share.embed_only,embedCode:Ay(e.config.video.embed_code),copyButton:s||$i.flash.installed,customizeEmbed:!!e.config.video.url,readOnly:!$i.touch,strings:{share:"Поделиться",facebook:"Поделиться в Facebook",twitter:"Поделиться в Twitter",tumblr:"Поделиться в Tumblr",email:"Поделиться по эл. почте",emailSubject:"Посмотрите “"+n+"” от "+i+" на Vimeo",emailBody:"Посмотрите “"+n+"” от "+i+" на Vimeo\n\nДанное видео предлагается к просмотру по адресу "+r+"\n\nЕсли оно вам понравится, не забудьте поделиться им с другими!\n\nНа Vimeo есть множество удивительных видео. См. другие видео по адресу: https://vimeo.com.",embedCode:"Получить код вставки",embedTitle:"Вставить",embedSubtitle:"Добавьте данное видео на свой сайт с помощью кода для вставки ниже.",copy:"Копировать",copySuccess:"Скопировано!",customize:'<a href="'+e.config.video.url+'#embed" target="_blank" rel="noopener">Персонализировать эту вставку</a> на Vimeo'}}),e.config.embed.settings.share&&e.config.embed.settings.share.embed_only&&(t.wrapperClass="embed-only"),t},showShareView:function(){t.querySelector(".js-share-screen").classList.remove("cloaked"),t.classList.remove("vp-share-embed-active"),a.fire(kc.shareViewShown)},showEmbedView:function(){e.config.embed.settings.share.embed_only||(t.querySelector(".js-embed-screen").classList.remove("cloaked"),t.classList.add("vp-share-embed-active")),a.fire(kc.embedViewShown)}};return o(),u}function xi(e,t){function n(e){if("yes"===e.form.getAttribute("data-bubble")){e.form.setAttribute("data-bubble","no");var n=t.querySelector(".vp-validation-bubble"),r=n.querySelector(".vp-validation-bubble-message");r.innerHTML=e.validationMessage||"Ошибка ввода.";var o=xe(e),a=xe(e.form);n.style.left=o.left-a.left+"px",n.style.top=o.height+1+"px",n.classList.remove("hidden"),e.focus(),window.requestAnimationFrame(function(){n.classList.add("vp-validation-bubble-animate")}),i()}}function i(e){var n=t.querySelector(".vp-validation-bubble");if(n){if(e)return clearTimeout(l),void n.classList.remove("vp-validation-bubble-animate");var i=5e3;clearTimeout(l),l=setTimeout(function(){n.classList.remove("vp-validation-bubble-animate")},i)}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.showBubble,o=void 0===r||r,a=t.querySelector("input[type=email]"),s=t.querySelector("input[type=text]");return a.setAttribute("aria-invalid","false"),a.setCustomValidity(""),a.checkValidity&&!a.checkValidity()?(a.setAttribute("aria-invalid","true"),a.validity.valueMissing&&a.setCustomValidity("Введите адрес эл. почты."),a.validity.typeMismatch&&a.setCustomValidity("Введите действительный адрес эл. почты."),o&&n(a),!1):(s.setAttribute("aria-invalid","false"),s.setCustomValidity(""),s.checkValidity&&!s.checkValidity()?(s.setAttribute("aria-invalid","true"),s.validity.typeMismatch&&s.setCustomValidity("Please enter a valid name."),!1):(i(!0),!0))}function o(){var e=t.querySelector(".vp-email-capture"),n=t.querySelector(".vp-email-capture-confirm");e.classList.add("vp-email-capture-invisible"),n.classList.remove("vp-email-capture-confirm-hidden"),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){n.classList.add("in"),setTimeout(d,2250)})})}function a(e,n,i){De(t);var r=Ws(e.querySelectorAll("input")),o=r.map(function(e){return e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.value)}).join("&"),a=3e3,s=new XMLHttpRequest;s.open(e.method,e.action+window.location.search,!0),s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.withCredentials=!0,s.timeout=a,s.onload=function(){var e;try{e=JSON.parse(s.responseText)}catch(e){}n(e,s)},s.onerror=function(e){i(e)},s.send(o)}function s(t){function i(t,n){return t===!1?void s(n.status,n):(e.config.embed.email=null,e.events.fire(kc.emailCaptureSuccess),void o())}function s(e){c.classList.remove("loading"),u.setCustomValidity("Uh oh. There was a problem. Please try again."),u.setAttribute("aria-invalid","true"),n(u)}if(!r())return!1;var u=t.querySelector("input[type=email]"),c=t.querySelector("input[type=submit]"),l={signature:"signature",time:"timestamp",expires:"expires"};Object.keys(l).forEach(function(n){var i=t.querySelector("input[name="+n+"]");i.value=e.config.request[l[n]]}),c.classList.add("loading"),a(t,i,s)}function u(){pi(t,".vp-email-capture-form-button--cancel",function(){d()}),pi(t,".vp-email-capture-form-button--reset",function(){e.events.fire(kc.playButtonPressed)}),pi(t,".vp-email-capture-form-button--submit",function(){this.form.classList.add("vp-email-capture-form-submitted"),this.form.setAttribute("data-bubble","yes"),r()}),Wp(t).on("submit",".vp-email-capture-form",function(){return e.events.fire(kc.emailCaptureSubmitted),s(this),!1}).on(["focus","input"],".vp-email-capture-form-input[type=email]",function(){r({showBubble:!1})})}var c=he(),l=void 0,d=function(){c.fire(kc.emailCaptureEnd)},f={get events(){return c},getData:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.config.embed.email||{},r=n.custom_logo||i.custom_logo;if(r)var o=Ut({width:150,height:75,baseUrl:r,webpSupport:e.config.request.flags.webp});return t.template=Ag.render("email_capture",{allowSkip:n.allow_skip||i.allow_skip,customLogo:o,text:n.text||i.text||"",action:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/submit-email",confirmation:n.confirmation||i.confirmation||"Спасибо! Ваш электронный адрес успешно добавлен.",referrer:e.config.request.referrer,strings:{email:"Адрес эл. почты",fullName:"Имя (опционально)",nothanks:"Нет, спасибо",submit:"Отправить"}}),t.modal=!0,t.logo=!1,t.preventBackgroundClose=!0,t.noblur=n.noblur,t}};return u(),f}function Ai(e,t,n){function i(e,t){return t.indexOf(e)!==-1}function r(){if(i(e.config.embed.outro,["vod"]))return L="vod",O=o(L),D===!0&&h(),Vi.resolve(O);B=!0;var t="https://"+e.config.player_url+"/video/"+e.config.video.id+"/outro?on_site="+e.config.embed.on_site+"&type="+e.config.embed.outro+"&email="+(e.config.embed.email?1:0);return Me(t,{withCredentials:!0}).then(function(e){return JSON.parse(e)}).then(function(e){return L=e.type,O=o(L,e.data),a(),O})}function o(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Vt(e.element.clientWidth*$i.devicePixelRatio,e.element.clientHeight*$i.devicePixelRatio),o=r.width,a=r.height;if(n.img_base&&(n.bgimage=Ut({width:o,height:a,baseUrl:n.img_base,webpSupport:e.config.request.flags.webp})),i(t,["vod"])){var s="undefined"!=typeof e.config.video.vod.is_preorder?e.config.video.vod.is_preorder:!!e.config.video.vod.date_available,u=e.config.video.vod.is_coming_soon,c=e.config.video.vod.date_available_formatted_datetime||e.config.video.vod.date_available,l='Скоро в разделе "Vimeo по запросу".';u&&c&&(l='Скоро в разделе "Vimeo по запросу" (с '+c+")."),s&&(l="Сделайте предварительный заказ. Смотрите с "+c+"."),n={purchased:e.config.user.purchased,title:e.config.video.vod.feature_title,url:e.config.video.vod.url,currency:e.config.request.currency,countries:e.config.video.vod.countries,country:e.config.request.country,buttons:e.config.video.vod.purchase_options,translationMap:e.config.request.dynamic_translation_map,isPreorder:s,isComingSoon:u,releaseDate:c,strings:{watch:s?"Смотрите с "+c:"Смотреть",preRelease:l}}}return i(t,["videos","threevideos","promoted"])&&(e.config.user.following=n.following,n={contexts:Array.isArray(n)?n:[n],owner:e.config.video.owner.id,bgimage:n.bgimage,following:n.following},n.contexts&&n.contexts.forEach(function(t){t.videos.forEach(function(i){i.fullTitle=i.title,i.byline="",i.owner.id!==n.owner&&(i.fullTitle=i.title+" от "+i.owner.name,i.byline="от "+i.owner.name),i.thumbnail_base&&(i.thumbnail=Ut({width:Math.round(o/t.videos.length),height:Math.round(a/t.videos.length),baseUrl:i.thumbnail_base,webpSupport:e.config.request.flags.webp}))})})),i(t,["link"])&&(n.url=Tt(n.url),n.url2=Tt(n.url2)),i(t,["share"])&&(n.strings={back:"Назад"}),n}function a(){O&&(O.bgimage&&Ht(O.bgimage),O.contexts&&O.contexts.forEach(function(e){e.videos.forEach(function(e){Ht(e.thumbnail)})}))}function s(){var e=document.querySelector(".js-outro-followWrap");if(e){var t=window.getComputedStyle(e),n=parseFloat(t.fontSize);e.style.width=e.clientWidth/n+"em"}}function u(){t.watch("ui.outro.isLinkTitleVisible",c),t.watch("ui.outro.isLinkDescriptionVisible",l),c(t.get("ui.outro.isLinkTitleVisible")),l(t.get("ui.outro.isLinkDescriptionVisible"))}function c(e){C.classList.toggle("outro--link-medium",e)}function l(e){C.classList.toggle("outro--link-large",e)}function d(){var e=n.querySelector(".js-outro-content"),t=x.getShareData();e.innerHTML=t.template,x.setup()}function f(){var e=n.querySelector(".js-outro-content"),t=A.getData({},O);e.innerHTML=t.template}function h(){if(R=!0,i(L,["beginning"]))return C.innerHTML="",void e.events.fire(wc.reset);if(null===O&&!B)return void r().then(function(){return h()}).catch(function(){});if(i(L,["videos","threevideos","promoted"])){var t=O.contexts.reduce(function(e,t){return e+t.videos.length},0);if(0===t)return;O.showFollowButton=!e.config.user.owner&&e.config.user.logged_in,O.strings={follow:"Подписаться",following:"Подписаны",unfollow:"Отписаться"}}O&&(O.target=!e.config.embed.on_site);var o=L;i(L,["threevideos","promoted"])&&(o="videos"),C.innerHTML=Ag.render("outro_"+o,O),C.setAttribute("data-type",o),n.classList.remove("hidden"),n.removeAttribute("hidden"),I=!0,i(L,["videos","threevideos"])?s():i(L,["link"])?u():i(L,["share"])?d():i(L,["email"])&&f(),window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){n.classList.add("in"),m()})})}function v(){x.destroy(),R=!1,M=!1,I=!1,window.requestAnimationFrame(function(){n.classList.remove("in"),e.events.fire(kc.outroHidden),T()})}function p(){return I?void v():void(R&&(R=!1,e.events.fire(kc.outroHidden)))}function m(){if(!M&&n.clientWidth){Wp(window).off("resize",N),M=!0;var t=[];O&&O.contexts&&O.contexts.forEach(function(e){e.videos&&e.videos.forEach(function(e){var n=e.id,i=C.querySelector('[data-video-id="'+n+'"]');i&&i.clientWidth>0&&t.push(n)})}),e.events.fire(kc.outroDisplayed,t)}}function g(){e.events.on(kc.playProgress,function(e,t,n){D=!1,!B&&null===O&&e>=t-F&&r().catch(function(){})})}function y(){e.events.on(kc.playInitiated,function(){i(e.config.embed.outro,["nothing","beginning"])&&(L=e.config.embed.outro,O=!1)}),e.events.on(kc.ended,function(){P=setTimeout(function(){e.events.fire(wc.showOutro)},q)}),e.events.on(kc.loadVideo,function(){clearTimeout(P)}),e.events.on(wc.showOutro,function(t,n){e.performDelegateAction(lc.showOutro,function(){t&&(L=t,O=null,B=!1),n&&n.data&&(O=o(t,n.data)),D=!0,h()})}),e.events.on(wc.hideOutro,function(){p()}),Wp(n).on("click",".js-videoLink",function(t){e.events.fire(kc.outroVideoPressed,parseInt(this.getAttribute("data-video-id"),10))}),Wp(n).on("click",".js-cta",function(t){e.events.fire(kc.outroCtaPressed,this.href)}),Wp(n).on("click",".js-link",function(t){e.events.fire(kc.outroLinkPressed,this.href)}),Wp(n).on("click",".js-imageLink",function(t){e.events.fire(kc.outroImagePressed,this.href)}),Wp(n).on("transitionend",function(e){n.classList.contains("in")||(n.classList.add("hidden"),n.setAttribute("hidden",""))},!1),e.events.on([kc.played,kc.seeked,kc.scrubbingStarted],p),e.events.on(kc.outroDisplayed,function(){e.element.classList.add("player-outroVisible")}).on(kc.outroHidden,function(){e.element.classList.remove("player-outroVisible")})}function _(){pi(n,".js-outro-follow",function(){e.events.fire(kc.followButtonPressed)}),Wp(n).on("mouseleave",".js-outro-follow",function(e){var t=document.querySelector(".js-outro-follow");t&&t.classList.remove("outro-follow--activated")}),e.events.on(kc.followed,function(){var e=document.querySelector(".js-outro-follow");e&&(e.setAttribute("aria-pressed",!0),e.classList.add("outro-follow--activated"))}),e.events.on(kc.unfollowed,function(){var e=document.querySelector(".js-outro-follow");e&&e.setAttribute("aria-pressed",!1)})}function b(){e.events.on(wc.showOverlay,function(){setTimeout(function(){n.classList.add("hidden")},150)}),e.events.on(kc.overlayClosed,function(){n.classList.contains("in")&&n.classList.remove("hidden")})}function w(){e.events.on(wc.reset,function(){O=null,B=!1})}function k(){pi(n,".js-vod-button",function(){var t=this.getAttribute("data-product-id");return e.events.fire(kc.vodButtonPressed,t),!1}),pi(n,".js-vod-watch",function(){if(!("date_available"in e.config.video.vod))return p(),e.events.fire(kc.vodButtonPressed),!1})}function S(){C&&(x=new Ti(e,C),x.events.on(kc.embedViewShown,function(){e.config.embed.settings.share.embed_only||(n.querySelector(".js-back").classList.remove("cloaked"),n.classList.add("embed-active"))}).on(kc.shareViewShown,function(){n.classList.remove("embed-active")}),pi(n,".js-back",function(){return x.showShareView(),!1}),x.events.on(kc.shareViewEnd,function(){n.querySelector(".js-back").classList.add("cloaked")}))}function E(){C&&(A=new xi(e,C))}function T(){Wp(window).off("resize",N),Wp(window).on("resize",N)}var x,A,L,P,C=n.querySelector(".vp-outro"),O=null,R=!1,I=!1,M=!1,D=!1,F=10,B=!1,N=Og(m,250),q=250;return g(),y(),_(),b(),w(),k(),S(),E(),T(),{}}function Li(e,t,n){function i(){var e=xe(n),t=xe(Q),i=xe(ee),r=t.bottom+(e.height-t.bottom)/2;return e.height-r-i.height/2+"px"}function r(){var e=xe(n),t=xe(Q),i=xe(J),r=e.height/2,o=t.bottom+(e.height-t.bottom)/2;return{top:r-i.height/2+"px",transform:"translateY("+(o-r)+"px)"}}function o(t,o){n.setAttribute("data-name",t),Q.innerHTML=o.template,$i.iOS&&Rg.element&&(e.events.fire(kc.willExitFullscreen),Rg.exit()),o.noblur||(X=document.activeElement,Ee(X)),o.modal&&c(),o.preventBackgroundClose&&n.setAttribute("data-background-close","false"),o.wrapperClass&&n.classList.add(o.wrapperClass),o.icon.type&&(o.logo&&(ee.classList.remove("hidden"),J.classList.add("cloaked"),window.requestAnimationFrame(function(){ee.innerHTML=Ag.render("logo"),ee.style.bottom=i()})),J.classList.remove("hidden"),Z.innerHTML=o.icon.html,window.requestAnimationFrame(function(){var e=r();J.style.top=e.top,J.style[$i.transformProperty]=e.transform}),n.setAttribute("data-icon",o.icon.type),J.setAttribute("data-icon",o.icon.type),Z.setAttribute("data-icon",o.icon.type),"private-unlocked"===t&&Z.classList.add("open")),n.classList.add("invisible"),n.classList.remove("hidden"),n.removeAttribute("hidden"),n.classList.add("in"),ie=o,ne=t,te=!0,e.events.fire(kc.overlayOpened,t),e.element.classList.add("player-overlayVisible"),["share","hd-not-allowed"].indexOf(t)>-1&&De(n),window.requestAnimationFrame(function(){n.classList.remove("invisible"),window.requestAnimationFrame(function(){Q.classList.add("in"),$.classList.add("in")})})}function a(){Q.classList.remove("in"),Q.classList.add("out")}function s(t){if(!d()&&te){n.removeAttribute("data-background-close"),$.classList.remove("in"),$.classList.add("out"),a(),n.classList.remove("in"),n.classList.add("out"),clearTimeout(K),K=setTimeout(u,200),t&&t.preventDefault&&t.preventDefault();var i=n.querySelector(".js-back");i&&i.classList.add("cloaked"),re.destroy(),e.events.fire(kc.overlayClosed,ne),e.element.classList.remove("player-overlayVisible"),te=!1,ne=null,ie=null,window.requestAnimationFrame(function(){X&&(Te(X),X=null)})}}function u(){n.setAttribute("hidden",""),n.removeAttribute("data-name"),n.removeAttribute("data-icon"),n.classList.add("hidden"),n.classList.remove("out"),n.classList.remove("embed-active"),n.classList.remove("modal"),n.classList.remove("embed-only"),$.classList.remove("out"),$.classList.remove("in"),J.removeAttribute("data-icon"),J.classList.add("hidden"),J.classList.remove("animate"),Z.removeAttribute("data-icon"),Z.innerHTML="",ee.classList.add("hidden"),Q.classList.remove("out"),Q.innerHTML="",e.events.fire(kc.overlayCleared)}function c(){n.classList.add("modal"),n.setAttribute("data-modal","true")}function l(){n.setAttribute("data-modal","false")}function d(){return"true"===n.getAttribute("data-modal")}function f(e){if("yes"===e.form.getAttribute("data-bubble")){e.form.setAttribute("data-bubble","no");var t=n.querySelector(".vp-validation-bubble"),i=t.querySelector(".vp-validation-bubble-message");i.innerHTML=e.validationMessage||"There is an error with this input.";var r=xe(e),o=xe(e.form);t.style.left=r.left-o.left+"px",t.style.top=r.height+1+"px",t.classList.remove("hidden"),e.focus(),window.requestAnimationFrame(function(){t.classList.add("vp-validation-bubble-animate")}),h()}}function h(e){var t=n.querySelector(".vp-validation-bubble");if(t){if(e)return clearTimeout(Y),void t.classList.remove("vp-validation-bubble-animate");clearTimeout(Y),Y=setTimeout(function(){t.classList.remove("vp-validation-bubble-animate")},5e3)}}function v(e){var t=n.querySelector("input[type=password]");return t.form.classList.contains("submitted")?(t.setAttribute("aria-invalid","false"),t.setCustomValidity(""),t.checkValidity&&!t.checkValidity()?(t.setAttribute("aria-invalid","true"),t.validity.valueMissing&&t.setCustomValidity("Введите пароль."),e||f(t),!1):(h(!0),!0)):null}function p(e,t,i){De(n);var r=Ws(e.querySelectorAll("input")),o=r.map(function(e){return e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):encodeURIComponent(e.value)}).join("&"),a=new XMLHttpRequest;a.open(e.method,e.action+window.location.search,!0),a.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),a.withCredentials=!0,a.timeout=3e3,a.onload=function(){var e;try{e=JSON.parse(a.responseText)}catch(e){}t(e,a)},a.onerror=function(e){i(e)},a.send(o)}function m(){g(),_(),l(),a()}function g(){ee.classList.add("animate")}function y(){ee.classList.add("hidden"),ee.classList.remove("animate")}function _(){J.classList.remove("cloaked"),J.classList.add("animate"),window.requestAnimationFrame(function(){J.style[$i.transformProperty]="translateY(-10px)"})}function b(){J.classList.add("centered"),J.style[$i.transformProperty]=""}function w(){Z.classList.add("open")}function k(){Z.classList.add("pulled-back")}function S(){Z.classList.add("out"),Z.classList.remove("pulled-back")}function E(){Wp(n).on("transitionend",".vp-overlay-logo",function(e){"opacity"===e.propertyName&&this.classList.contains("animate")&&y()}),Wp(n).on("transitionend",".vp-overlay-icon-wrapper",function(e){e.propertyName.indexOf("transform")>-1&&(""===this.style[$i.transformProperty]?(this.classList.remove("centered"),"lock"!==this.getAttribute("data-icon")||Z.classList.contains("open")||Z.querySelector("canvas")?k():setTimeout(w,100)):"translateY(-10px)"===this.style[$i.transformProperty]&&b())}),Wp(n).on("transitionend",".vp-overlay-icon",function(e){e.propertyName.indexOf("transform")>-1&&(this.classList.contains("out")?(l(),s()):this.classList.contains("pulled-back")?S():this.classList.contains("open")&&k())})}function T(){return{modal:!1,template:null,logo:!1,icon:{type:null,html:null}}}function x(t){return t.icon={type:"lock",html:Ag.render("icon_lock")},t.modal=!0,t.logo=!0,t.template=Ag.render("private_locked",{action:"https://"+e.config.vimeo_url+"/log_in",strings:{title:"Частное видео",subtitle:"Для просмотра требуется войти в аккаунт (при наличии разрешения)",logIn:"Войти в аккаунт",logInLabel:"Войти в систему (открывается в новом окне)"}}),t}function A(t){return t.icon={type:"lock",html:Ag.render("icon_lock")},t.template=Ag.render("password",{action:"https://"+e.config.player_url+"/video/"+e.config.video.id+"/check-password?referrer="+e.config.request.referrer,strings:{title:"Требуется пароль",subtitle:"Введите его в поле ниже.",password:"Пароль",watch:"Смотреть видео"}}),t.modal=!0,t.logo=!!e.config.embed.settings.branding,t}function L(e){return e.icon={type:"lock",html:Ag.render("icon_lock")},e.template=Ag.render("private_unlocked",{strings:{title:"Частное видео",subtitle:"Вы вошли в систему и имеете разрешение на просмотр (поздравляем!).",watch:"Смотреть видео"}}),e}function P(e,t){return e.template=Ag.render("error",{title:t.title,message:t.message}),e.modal=!!t.modal,e.logo=!!t.logo,t.icon&&"lock"===t.icon&&(e.icon={type:"lock",html:Ag.render("icon_lock")}),e}function C(t){return t.template=Ag.render("help",{onSite:e.config.embed.on_site,strings:{title:"Комбинации клавиш",volumeUp:"Увеличить громкость",volumeDown:"Уменьшить громкость",scrubForward:"Перемотка вперед",scrubBackwards:"Перемотка назад",like:"Нравится",share:"Поделиться",watchLater:"Посмотреть позже",captions:"Вкл/выкл субтитры",prefs:"Включить меню настроек",fullscreen:"Вкл/выкл полноэкранный режим",viewOnVimeo:"Посмотреть на Vimeo"}}),t}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.redirectUrl,i=t.title,r=t.buttonText,o=t.ignoreText,a=t.bottomText,s=t.newWindow;return e.template=Ag.render("app_redirect",{redirectUrl:n,newWindow:s,strings:{title:i,buttonText:r,ignoreText:o,bottomText:a}}),e.modal=!1,e.logo=!1,e.preventBackgroundClose=!0,e}function R(){e.events.on(wc.hideOverlay,function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.unmakeModal&&l(),s()}),e.events.on(wc.showOverlay,function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=function(){var e=T();switch(t){case"share":return o(t,re.getShareData(e,n)),void re.setup();case"private-locked":return void o(t,x(e));case"password":return void o(t,A(e));case"private-unlocked":return void o(t,L(e));case"error":return void o(t,P(e,n));case"help":return void o(t,C(e));case"email-capture":return void o(t,oe.getData(e,n));case"app-redirect":return void o(t,O(e,n))}};return te&&!n.nohide?"share"!==ne&&"help"!==ne&&"hd-not-allowed"!==ne||ne!==t?(e.events.once(kc.overlayCleared,i),l(),void s()):void s():void i()}),Wp(n).on("input","input",function(){this.form.classList.add("interacted")}).on(["focus","blur"],"input",function(){h(!0)}).on("transitionend",".vp-validation-bubble",function(e){"opacity"===e.propertyName&&"0"===window.getComputedStyle(this,"").opacity&&this.classList.add("hidden")}),e.events.on([kc.overlayCloseButtonPressed,kc.played],s),e.events.on(kc.privateUnlocked,function(){"private-locked"===ne&&(l(),s())}),e.events.on(kc.configChanged,function(){"share"===ne&&(ie=re.getShareData(T()),Q.innerHTML=ie.template,re.setup())}),Wp(window).on("resize",function(){if(te){ee.style.bottom=i();var e=r();J.style.top=e.top,J.style[$i.transformProperty]=e.transform}})}function I(){t.watch("ui.overlay.isEmailCaptureVisible",M),e.events.on(kc.ready,D),e.events.on(kc.configChanged,D),e.events.on(kc.playProgress,F),oe.events.on(kc.emailCaptureEnd,B)}function M(t){!t&&te&&"email-capture"===ne?(se=te,l(),s()):t&&se&&(se=!1,e.events.fire(wc.showOverlay,"email-capture"))}function D(){var n=e.config.embed.email||{};if(e.telecine){var i=n.timecode||0;ae=e.telecine.currentTime>i}if(n&&"before"===n.position&&!ae){if(!t.get("ui.overlay.isEmailCaptureVisible"))return void(se=!0);e.events.fire(wc.showOverlay,"email-capture")}}function F(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=e.config.embed.email||{};n&&"during"===n.position&&(t<n.timecode&&(ae=!1),t>=n.timecode&&!ae&&(ae=!0,e.events.fire(wc.showOverlay,"email-capture")))}function B(){l(),s()}function N(){re.events.on(kc.embedViewShown,function(){e.config.embed.settings.share.embed_only||(n.querySelector(".js-back").classList.remove("cloaked"),n.classList.add("embed-active"))}).on(kc.shareViewShown,function(){n.classList.remove("embed-active")}),pi(n,".js-back",function(){return re.showShareView(),!1}),re.events.on(kc.shareViewEnd,function(){n.querySelector(".js-back").classList.add("cloaked")})}function q(){Wp(Q).on("click",".popup",function(){return e.events.fire(wc.openPopup,"login-private-locked"),!1})}function j(){function t(t){function n(t,n){return t===!1?void i(n.status,n):(e.events.fire(kc.passwordUnlocked,t),"icon-hidden"===window.getComputedStyle($,":after").content?(l(),void s()):void m())}function i(e){a.classList.remove("loading"),o.setCustomValidity("Ой! Произошла ошибка. Повторите попытку."),o.setAttribute("aria-invalid","true"),f(o)}var r=v();if(!r)return!1;var o=t.querySelector("input[type=password]"),a=t.querySelector("input[type=submit]");a.classList.add("loading"),p(t,n,i)}Wp(Q).on("click",".password input[type=submit]",function(){this.form.classList.add("submitted"),this.form.setAttribute("data-bubble","yes"),v(!0)}).on("submit",".password form",function(){return t(this),!1}).on(["focus","input"],[".password input[type=email]",".password input[type=password]"],function(){v()})}function V(){pi(Q,".unlocked button",function(){var t=xe(Z);0===t.width?(g(),l(),s()):m(),$i.iPad||$i.iPhone||e.events.once(kc.overlayCleared,function(){e.events.fire(kc.playButtonPressed)})})}function U(){e.events.on(kc.stereoscopicButtonPressed,function(){e.events.fire(wc.showOverlay,"app-redirect",{redirectUrl:e.doNotTrackEnabled?"https://play.google.com/store/apps/details?id=com.vimeo.android.videoapp&hl=en":Vn(e.config.video.id,"player-spatial-redirect"),title:"Headset viewing isn’t currently supported in mobile browsers.",buttonText:"Watch in the Vimeo app",ignoreText:null,bottomText:null,newWindow:!e.config.embed.on_site})}),Wp(Q).on("click",".app-redirect-ignore",function(){s()}),Wp(Q).on("click","[data-new-window]",function(e){return window.open(document.querySelector(".app-redirect-button").getAttribute("href")),!1})}function H(){var t=void 0;e.events.on(kc.error,function(n){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{modal:!0,final:!0};if(i.final!==!1){t=n;var r=T();return r.modal=i.modal,r.template=Ag.render("error",{title:i.title,message:i.message}),te?(s(),void e.events.once(kc.overlayCleared,function(){return o(n,r)})):void o(n,r)}}),Wp(Q).on("click",".error",function(n){e.events.fire(kc.errorLinkPressed,n.target.href,t)})}function W(){e.events.on(kc.configChanged,function(){window.requestAnimationFrame(function(){l(),s()})})}function z(){pi(n,".js-close",function(){e.events.fire(kc.overlayCloseButtonPressed)}),Wp(n).on(["click","touchend"],[".vp-overlay-content",".js-share",".vp-overlay-logo"],function(e){e.stopPropagation()}).on(["click","touchend"],[".vp-overlay-cell","nav"],function(){return"false"===n.getAttribute("data-background-close")||(e.events.fire(kc.overlayCloseButtonPressed),!1)})}function G(){e.events.on(wc.showOutro,function(){n.classList.add("hidden")}),e.events.on(kc.outroHidden,function(){n.classList.contains("in")&&n.classList.remove("hidden")})}var K,Y,X,$=n.querySelector(".vp-overlay-cell"),Q=n.querySelector(".vp-overlay"),J=n.querySelector(".vp-overlay-icon-wrapper"),Z=J.querySelector(".vp-overlay-icon"),ee=n.querySelector(".vp-overlay-logo"),te=!1,ne=null,ie=null,re=new Ti(e,Q),oe=new xi(e,Q),ae=!1,se=!1;return R(),E(),I(),N(),U(),q(),j(),V(),H(),W(),z(),G(),e.events.fire(kc.overlayModuleReady),{}}function Pi(e,t){function n(e,t){var n=".player-"+u+" ",i=n+e.join(","+n);if(t){var r=c+" ";i+=","+r+e.join(","+r)}return l&&(i=i.replace(/:hover/g,":active")),i=i.replace(/ &/g,"")}function i(){var e=document.createElement("style");return e.setAttribute("data-player",u),document.querySelector("head").appendChild(e),d=e.sheet}function r(){for(;d.cssRules.length>0;)d.deleteRule(0)}function o(){d?r():i()}function a(e){o();var t=e.complement,i=new ye(23,35,34,.75),r=new ye(0,0,0,.15),a=r.overlayOn(e);i.contrast(t).ratio<3&&t.lighten(5,3,i);var s,u=e.lightness<40?e.clone().lighten(15,3,e):e.clone().darken(15,3,e);return ke(n(Ly,!0),"color:"+e.hex+" !important",d),ke(n(Py,!0),"color:"+t.hex+" !important",d),ke(n(Cy),"color:"+e.hex,d),ke(n(Iy),"fill:"+e.hex,d),ke(n(Dy),"stroke:"+e.hex,d),ke(n(By),"background-color:"+e.hex,d),ke(n(Ny),"border-color:"+e.hex,d),ke(n(Oy),"color:"+t.hex,d),ke(n(Ry),"fill:"+t.hex,d),ke(n(My),"fill:"+u.hex,d),ke(n(Fy),"stroke:"+u.hex,d),ke(n(zy),"border-color:"+a.hex,d),ke(n(Gy),"background-color:"+a.hex,d),e.luminance>.95&&(t=e.clone().darken(15,3,e),ke(n(qy),"color:"+t.hex,d),ke(n(jy),"fill:"+t.hex,d),ke(n(Vy),"stroke:"+t.hex,d),u=t.clone().darken(15,3,t),ke(n(My),"fill:"+u.hex,d),ke(n(Fy),"stroke:"+u.hex,d)),e.yiq>175&&e.luminance<.95&&(s=u.clone().darken(15,3,u),ke(n(My),"fill:"+s.hex,d),ke(n(Fy),"stroke:"+s.hex,d),ke(n(Uy),"color:"+u.hex,d),ke(n(Hy),"fill:"+u.hex,d),ke(n(Wy),"stroke:"+u.hex,d)),{main:e.hex,selected:u.hex,sidedockHover:s?u.hex:e.luminance>.95?t.hex:ye.white.hex,sidedockSelected:e.luminance>.95?t.hex:e.hex,sidedockSelectedHover:s?s.hex:u.hex}}function s(){e.events.on(wc.changeColor,function(t){var n;try{n=new ye(t)}catch(e){n=new ye("00adef")}var i=a(n);e.config._colors=i,e.config.embed.color=i.main.replace("#",""),e.events.fire(kc.colorChanged,e.config.embed.color)}),e.events.fire(wc.changeColor,e.config.embed.color)}var u=t.uuid,c=t.id,l=t.isMobileDevice,d=null;return s(),{}}function Ci(e){function t(){e.events.on(wc.openPopup,function(t,n){var i="https://"+e.config.player_url,o=i+"/video/"+e.config.video.id,a=670,s=545;switch(t){case"login-like":r=Oe(o+"/login/like","login",{width:a,height:s}),e.events.fire(kc.popupOpened,t);break;case"login-watch-later":r=Oe(o+"/login/watch-later","login",{width:a,height:s}),e.events.fire(kc.popupOpened,t);break;case"login-private-locked":r=Oe(o+"/login/private","login",{width:a,height:s}),e.events.fire(kc.popupOpened,t);break;case"purchase":var u=i+"/video/"+(e.config.video.vod.feature_id||e.config.video.id)+"/purchase/vod";n&&n.productId&&(u+="/"+n.productId),u+="?referrer="+encodeURIComponent(e.config.request.referrer),r=Oe(u,"purchase",{width:790,height:670}),e.events.fire(kc.popupOpened,t)}}),window.closePopup=function(t){if(r){try{r.close(),e.events.fire(kc.popupClosed,t)}catch(e){}r=null}}}function n(){e.config.embed.on_site||(window.confirmPurchase=function(t,n,i){return n?void e.loadVideo(t):void(i&&e.events.fire(kc.playButtonPressed))})}function i(){e.config.embed.on_site||(window.confirmLoginAction=function(t,n){e.events.fire(kc.userLogIn,n)})}var r=null;return t(),n(),i(),{}}function Oi(e,t,n,i){var r=i[t];return r?(r=Mi(e,r),r=Ri(r,n,i.prices),i.expires_in_duration_str&&(r=r.replace("{TIME}",i.expires_in_duration_str)),i.available_on_formatted&&(r=r.replace("{DATE}",i.available_on_formatted)),r):null}function Ri(e,t,n){var i=n.USD;return t in n&&(i=n[t]),e.indexOf("${price}")!==-1?e.replace("${price}",i):e.indexOf("{PRICE}")!==-1?e.replace("{PRICE}",i):e}function Ii(e,t){return!e||0===e.length||e.indexOf(t)!==-1}function Mi(e,t){return"undefined"!=typeof e&&"undefined"!=typeof e[t]?e[t]:t}function Di(e,t){function n(){return j||H||W}function i(){B&&(X||(N&&Y||n()||Q)&&(q||(!V&&!U||n())&&(B=!1,e.events.fire(kc.sidedockVisibilityChanged,B),($||t).classList.add("invisible"))))}function r(){if(!B&&!n()){var i=$||t;i.classList.add("invisible"),i.classList.remove("hidden"),i.removeAttribute("hidden"),t.classList.remove("hidden"),t.removeAttribute("hidden"),t.classList.contains("vod")&&t.classList.remove("vod"),setTimeout(function(){B=!0,e.events.fire(kc.sidedockVisibilityChanged,B),i.classList.remove("invisible")},0)}}function o(){N=!1,q=!1,X=!1}function a(t,n,i){var r="data-label-"+i,o="add"!==i||e.config.user.logged_in?r:"data-label-add-logged-out";t.setAttribute("aria-label",t.getAttribute(o)),n.classList.add("hidden"),n.setAttribute("hidden",""),n.firstChild.innerHTML=t.getAttribute(r)}function s(){var e=z.indexOf(this);G.forEach(function(t,n){n!==e&&t&&t.classList.add("invisible")}),e>=0&&G[e]&&(G[e].classList.add("invisible"),G[e].classList.remove("hidden"),G[e].removeAttribute("hidden",""),K=window.requestAnimationFrame(function(){K=window.requestAnimationFrame(function(){G[e].classList.remove("invisible"),G[e].classList.add("visible")})}))}function u(){var e="BUTTON"===this.tagName?this:this.querySelector("button"),t=z.indexOf(e);
t>=0&&G[t]&&(K&&(window.cancelAnimationFrame(K),K=null),G[t].classList.add("invisible"))}function c(){if(L){var e=L.parentElement;$.insertBefore(e,$.firstChild)}}function l(){if(L){var e=L.parentElement;t.insertBefore(e,$)}}function d(){if(e.config.view===cc.main||e.config.view===cc.privateUnlocked){var n=e.config.embed.settings,i=e.config.video.vod&&"purchase_options"in e.config.video.vod&&e.config.video.vod.purchase_options.length,r=i&&e.config.video.vod.is_coming_soon,o="ondemand.main"===e.config.embed.context,a=e.config.video.vod&&e.config.user.purchased?1:0,s=i&&n.vod&&Ii(e.config.video.vod.countries,e.config.request.country);s&&r&&o&&(s=!1);var u=i&&e.config.video.vod.purchase_options[0],l=null;u&&(l=Oi(e.config.request.dynamic_translation_map,"label_string",e.config.request.currency,u)),t.innerHTML=Ag.render("sidedock",{loggedIn:!!e.config.user.logged_in,vodButton:s,purchased:a,vodPurchaseInfo:u,vodDisplayLabel:l,likeButton:n.like,liked:e.config.user.liked,watchLaterButton:n.watch_later,addedToWatchLater:e.config.user.watch_later,collectionsButton:n.collections,shareButton:n.share,strings:{like:"Нравится",likeLoggedOut:"Нравится (открывается в новом окне)",unlike:"Снять отметку “Нравится”",watchLaterAdd:"Посмотреть позже",watchLaterAddLoggedOut:"Посмотреть позже (открывается в новом окне)",watchLaterRemove:"Удалить из списка “Посмотреть позже”",collections:"Добавить в коллекции",share:n.share&&n.share.embed_only?"Вставить":"Поделиться"}}),L=t.querySelector(".vod-button"),s&&($=t.querySelector(".sidedock-inner"),a&&c());var d=$||t;i&&s&&!e.config.embed.settings.instant_sidedock?t.classList.add("vod"):$i.touch&&(B=!0,e.events.fire(kc.sidedockVisibilityChanged,B),d.classList.remove("hidden"),d.removeAttribute("hidden"),d.classList.remove("invisible")),P=t.querySelector(".like-button"),C=t.querySelector(".like-label"),O=t.querySelector(".watch-later-button"),R=t.querySelector(".watch-later-label"),I=t.querySelector(".collections-button"),M=t.querySelector(".collections-label"),D=t.querySelector(".share-button"),F=t.querySelector(".share-label"),z=[L,P,O,D,I],G=[null,C,R,F,M]}}function f(){var t=e.config.embed.settings.instant_sidedock,n=e.config.video.vod,i=n&&"purchase_options"in n&&n.purchase_options.length,o=n&&Ii(e.config.video.vod.countries,e.config.request.country);(t||i&&o)&&(Q||r())}function h(){pi(t,".vod-button",function(){var t=L.getAttribute("data-product-id");e.events.fire(kc.vodButtonPressed,t)},u),e.events.on(kc.outroDisplayed,function(){c(),t.classList.add("sidedock-outro"),"share"===e.config.embed.outro&&(e.config.embed.settings.share=0,d())}),e.events.on(kc.outroHidden,function(){l(),t.classList.remove("sidedock-outro"),"share"===e.config.embed.outro&&(e.config.embed.settings.share=1,d())})}function v(){pi(t,".like-button",function(){e.events.fire(kc.likeButtonPressed)},u),e.events.on(kc.liked,function(){P&&(P.classList.add("on"),a(P,C,"remove"))}),e.events.on(kc.unliked,function(){P&&(P.classList.remove("on"),a(P,C,"add"))})}function p(){pi(t,".watch-later-button",function(){e.events.fire(kc.watchLaterButtonPressed)},u),e.events.on(kc.addedToWatchLater,function(){O&&(O.classList.add("on"),a(O,R,"remove"))}),e.events.on(kc.removedFromWatchLater,function(){O&&(O.classList.remove("on"),a(O,R,"add"))})}function m(){pi(t,".collections-button",function(){e.events.fire(kc.collectionsButtonPressed)},u)}function g(){pi(t,".share-button",function(){return e.events.fire(e.config.embed.settings.share.embed_only?kc.embedButtonPressed:kc.shareButtonPressed),!1},u)}function y(){var e=function(e){"opacity"===e.propertyName&&e.target.classList.contains("invisible")&&(e.target.classList.add("hidden"),e.target.setAttribute("hidden",""),e.target.classList.remove("visible"))};Wp(t).on("blur","button",u).on("mouseleave",".box",u).on(["focus","pointerdown","touchstart","mouseenter"],"button",s).on("transitionend","label",e),pi(t,"label",function(){var e=G.indexOf(this);e>=0&&z[e].click()})}function _(){e.events.on([kc.mousedOut,kc.mouseTimeout],i).on(kc.mousedOver,r).on(kc.targetTimeReached,function(){Y=!0,i()}).on(kc.played,function(){N=!0}),Wp(t).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(q="pointerenter"===e.type||"MSPointerEnter"===e.type)):void(q="mouseover"===e.type)}),Wp(t).on("transitionend",function(e){var n=$||t;"opacity"===e.propertyName&&n.classList.contains("invisible")&&(n.classList.add("hidden"),n.setAttribute("hidden",""),L&&n.contains(L)&&(t.classList.add("hidden"),t.setAttribute("hidden","")))})}function b(){e.events.on(kc.willEnterFullscreen,function(){q=!1,i()}).on(kc.didExitFullscreen,function(e){e||(X=!0)})}function w(){e.events.on([kc.airPlayActivated],function(){V=!0,r()}).on([kc.airPlayDeactivated],function(){V=!1})}function k(){e.events.on(kc.pictureInPictureActivated,function(){U=!0,r()}).on(kc.pictureInPictureDeactivated,function(){U=!1})}function S(){e.events.on(kc.overlayOpened,function(){j=!0,q=!1,i()}).on(kc.overlayClosed,function(){j=!1,r()})}function E(){e.events.on(kc.alertVisibilityChanged,function(e){H=e,e&&i()})}function T(){e.events.on([kc.menuCentered,kc.menuVisibilityChanged],function(e,t){t.isCentered()&&t.isVisible()&&(W=!0,q=!1,i()),t.isCentered()&&t.isVisible()||(W=!1,r())})}function x(){e.events.on(kc.configChanged,function(){d()})}function A(){e.events.on(wc.reset,function(){q=!1,Y=!1,i(),o()})}var L,P,C,O,R,I,M,D,F,B=!1,N=!1,q=!1,j=!1,V=!1,U=!1,H=!1,W=!1,z=[],G=[],K=null,Y=!1,X=!1,$=null,Q=e.config.embed.autoplay&&e.config.request.flags.autohide_controls;return d(),f(),h(),v(),p(),m(),g(),y(),_(),b(),w(),k(),S(),E(),T(),x(),A(),e.events.fire(kc.sidedockModuleReady),{}}function Fi(e,t){function n(){g=!1,t.classList.add("invisible")}function i(){t.classList.remove("hidden"),t.removeAttribute("hidden"),setTimeout(function(){g=!0,t.classList.remove("invisible")},0)}function r(){return _||b||w}function o(){if(g){if(r())return void n();if(T)return void n();if(!k&&S)return E&&y?void 0:void n()}}function a(){if(!g){if(k&&!r())return void i();if(E&&!x&&!T)return S||r()?e.config.embed&&e.config.embed.settings.info_on_pause&&E&&!r()?void i():void 0:void i()}}function s(){if(e.config.view===cc.main||e.config.view===cc.privateUnlocked){var n=!!e.config.embed.settings.byline,i=null!==e.config.video.owner.url,r=e.config.video.owner.url,o=0===e.config.embed.on_site,a=e.config.embed.settings.spatial_label,s="undefined"!=typeof e.config.video.file_codecs,u={linkToOwner:i,ownerLink:r,targetBlank:o,showPortrait:!!e.config.embed.settings.portrait,portraitImg:e.config.video.owner[$i.devicePixelRatio>1?"img_2x":"img"],showByline:n,showTitle:!!e.config.embed.settings.title,showTitleLink:null!==e.config.video.url,titleLink:e.config.video.url,title:e.config.video.title,is360:e.config.video.spatial&&a,hasHDR:s&&e.config.video.file_codecs.hevc.hdr.length>0,strings:{}};if(e.config.embed.settings.byline){var c=e.config.embed.settings.byline_badge,l="";c&&c.type&&(l=Ag.render("title_byline_badge",{targetBlank:o,cssClass:c.type,link:c.url||!1})),u.strings.byline="от "+Ag.render("title_owner_byline",{linkToOwner:i,ownerLink:r,targetBlank:o,owner:e.config.video.owner.name})+l}var d=e.config.embed.settings.badge;if(d){var f=$i.devicePixelRatio>1?"img_2x":"img";$i.svg&&d.svg&&(f="svg"),u.showPortrait=!1,u.badge={link:d.link,img:d[f],offset:d.offset||!1,width:d.width,height:d.height,name:d.name,shadow:d.shadow||!1}}e.config.embed.autoplay&&(t.classList.add("hidden"),t.setAttribute("hidden","")),t.innerHTML=Ag.render("title",u)}}function u(){e.events.on([kc.mousedOut,kc.mouseTimeout],o).on(kc.mousedOver,a).on(kc.playInitiated,function(){S=!0,E=!1,o()}).on([kc.playButtonPressed,kc.played],function(){E=!1,x=!1,o()}).on(kc.paused,function(e,t){t||(E=!0,a())}).on(kc.ended,function(){T=!0,o()}).on(kc.scrubbingStarted,function(){A=E,x=!0}).on(kc.scrubbingEnded,function(){A&&(x=!1)}).on(kc.willEnterFullscreen,function(){o()}).on(kc.didExitFullscreen,function(e){e||a()}),Wp(t).on(["pointerenter","pointerleave","mouseenter","mouseleave"],function(e){return"pointerType"in e?void("mouse"!==e.pointerType&&e.pointerType!==e.MSPOINTER_TYPE_MOUSE||(y="pointerenter"===e.type||"MSPointerEnter"===e.type)):void(y="mouseover"===e.type)}),Wp(t).on("transitionend",function(e){"opacity"===e.propertyName&&t.classList.contains("invisible")&&(t.classList.add("hidden"),t.setAttribute("hidden",""))},!1)}function c(){e.events.on(kc.ended,function(e){o()})}function l(){e.events.on([kc.airPlayActivated],function(){k=!0,a()}).on([kc.airPlayDeactivated],function(){k=!1,o()})}function d(){e.events.on(kc.overlayOpened,function(e){"not-supported"!==e&&"private-unlocked"!==e&&"help"!==e&&(_=!0,y=!1,o())}).on(kc.overlayClosed,function(){_=!1,y=!1,setTimeout(a,0)})}function f(){e.events.on(kc.outroDisplayed,function(e){b=!0,y=!1,o()}).on(kc.outroHidden,function(){b=!1,y=!1,setTimeout(a,0)})}function h(){e.events.on([kc.menuCentered,kc.menuVisibilityChanged],function(e,t){t.isCentered()&&t.isVisible()&&(w=!0,y=!1,o()),t.isCentered()&&t.isVisible()||(w=!1,y=!1,a())})}function v(){pi(t,".badge",function(){e.events.fire(kc.badgePressed,e.config.embed.settings.badge.id)})}function p(){e.events.on(kc.configChanged,function(){s(),e.config.view===cc.privateUnlocked&&a()})}function m(){e.events.on(wc.reset,function(){S=!1,E=!0,T=!1,x=!1,a()})}var g=!0,y=!1,_=!1,b=!1,w=!1,k=!1,S=!1,E=!0,T=!1,x=!1,A=!1;return s(),u(),c(),l(),d(),f(),h(),v(),p(),m(),e.events.fire(kc.titleModuleReady),{}}function Bi(e,t,n){function i(){k=new gi(b),t.watch("ui.cards.size",a),t.watch("ui.cards.isCarouselVisible",u),t.watch("ui.cards.isCardsThumbVisible",s),u(t.get("ui.cards.isCarouselVisible")),e.events.on(kc.configChanged,r),e.events.on(wc.addCard,y),e.events.on(wc.removeCard,_),k.on("slide",T(m)),k.on("tap",T(v)),e.events.on(kc.playProgress,T(l)),e.events.on(kc.ended,T(h)),pi(document,".player-cardsCorner .card",T(p)),r()}function r(){if(h(),g(),Array.isArray(e.config.embed.cards)&&e.config.embed.cards.length){if(e.config.video.title&&e.config.embed.settings.title){var t={className:"card--contentInfo",timecode:0,headline:e.config.video.title,teaser:e.config.embed.settings.byline?e.config.video.owner.name:"",image:e.config.video.owner[$i.devicePixelRatio>1?"img_2x":"img"],id:"title-card"};o(-1,t)}e.config.embed.cards.forEach(function(e){o(e.timecode,e)})}}function o(n,i){var r=w.get(n),o=new Yy(e,i);if(w.set(n,o),r)return b.replaceChild(o.element,r.element),o;var a=w.keys().indexOf(n);return b.insertBefore(o.element,b.children[a]),t.dispatch(Km(w.size)),o}function a(t){e.element.classList.toggle("player-withCards",t>0)}function s(e){n.classList.toggle("cards-wrapper--withThumbnails",e)}function u(t){e.element.classList.toggle("player-cardsCarousel",t),e.element.classList.toggle("player-cardsCorner",!t),k.destroy(),t&&k.setUp()}function c(e){var n=w.values().filter(function(t){return t.isActive(e)}).slice(-1)[0];if(n)return n;if(t.get("ui.cards.isCarouselVisible")){var i=w.values().slice(-1)[0];if(i&&e>i.end)return i}return null}function l(e){var n=c(e);if(n!==S&&(n||!E))return E=!1,h(),S=n,S&&"title-card"===S.id?void(t.get("ui.cards.isCarouselVisible")&&d(S,!0)):void d(S,!0)}function d(t,n){t&&(n?t.element.classList.add("card-animating"):t.element.classList.remove("card-animating"),t.element.classList.add("card-active"),Wp(t.element.childNodes[1]).on("mouseover",function(){E=!0}),Wp(t.element.childNodes[1]).on("mouseout",function(){E=!1}),k.show(t.element),e.events.fire(kc.cardDisplayed,t.id,t.data))}function f(e){E||e.classList.remove("card-active")}function h(){Ws(n.querySelectorAll(".card-active")).forEach(f)}function v(t){var n=w.values()[t];n.data.url&&"title-card"!==n.id&&(e.events.fire(kc.cardPressed,n.id,n.data),e.telecine.paused||e.events.fire(kc.pauseButtonPressed),window.open(n.data.url))}function p(t){t.preventDefault();var n=sc(t.target,b.children),i=w.values()[n];i.data.url&&"title-card"!==i.id&&(e.events.fire(kc.cardPressed,i.id,i.data),e.telecine.paused||e.events.fire(kc.pauseButtonPressed),window.open(i.data.url))}function m(t){var n=w.values()[t];"title-card"!==n.id&&e.events.fire(kc.cardDisplayed,n.id,n.data),e.events.fire(wc.setTime,n.time)}function g(){w.forEach(function(e,t){e.element.parentNode.removeChild(e.element)}),w=new Xy}function y(e){var t=o(e.timecode,e);h(),d(t)}function _(e){h();var t=w.get(e.timecode).element;t.parentNode.removeChild(t),w.delete(e.timecode)}var b=n.querySelector(".vp-cards"),w=new Xy,k=void 0,S=void 0,E=!1,T=function(e){return function(){w.size>0&&e.apply(void 0,arguments)}};return i(),{}}function Ni(e,t,n){function i(){return!L&&(e.config.view===cc.main||e.config.view===cc.privateUnlocked)}function r(){C&&"help"===A&&e.events.fire(kc.overlayCloseButtonPressed)}function o(e){return"number"!=typeof e.which&&(e.which=e.keyCode),e}function a(e){if("keypress"===e.type){var t=String.fromCharCode(e.which);return e.shiftKey||(t=t.toLowerCase()),t}return e.which in Qy?Qy[e.which]:String.fromCharCode(e.which).toLowerCase()}function s(e){return!(e.ctrlKey||e.metaKey||e.altKey)&&(e.which in Qy?"keydown"===e.type:"keypress"===e.type)}function u(e){var t=e.target||e.srcElement;return"INPUT"===t.tagName||"SELECT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable}function c(t){if(t=Array.isArray(t)?t:[t],C&&"help"===A){if(e.events.fire(kc.overlayCloseButtonPressed),t[0]===wc.showOverlay&&"help"===t[1])return!1;if(t[0]!==wc.openVimeo)return setTimeout(function(){e.events.fire.apply(null,t)},250),!1}return e.events.fire.apply(null,t),!1}function l(n,i){if(!t.get(pp)){if(!B){i&&!e.telecine.paused&&e.events.fire(kc.pauseButtonPressed);var r=!0;e.events.fire(kc.scrubbingStarted,r),B=!0}h(F),F++,1===F&&(D=e.config.video.fps);var o=i?1:D,a="right"===n?o:-o,s=Math["right"===n?"ceil":"floor"](e.telecine.currentTime*e.config.video.fps);d(s+a)}}function d(t){var n=null,i=t/e.config.video.fps;e.events.fire(wc.seek,n,i)}function f(t){D=R,F=0;var n=t.shiftKey;e.events.fire(kc.scrubbingEnded,n),B=!1}function h(e){var t=e,n=Math.ceil(R),i=Math.ceil(I-R),r=M;D=v(t,n,i,r)}function v(e,t,n,i){return e/=i,e--,n*(e*e*e+1)+t}function p(e){var t=O.getTabindexItems(),n=t.indexOf(document.activeElement),i="up"===e?n-1:n+1,r=null;return r=i>=t.length?t[0]:i<0?t[t.length-1]:t[i],!r||(r.focus(),!1)}function m(){return!!O||(!(!t.get(pp)||t.get(yp))||(document.activeElement&&document.activeElement!==document.body?void 0:(e.events.fire(kc[e.telecine.paused?"playButtonPressed":"pauseButtonPressed"]),r(),!1)))}function g(){return O?(O.element.contains(document.activeElement)&&O.button.focus(),O.hide(),!1):document.activeElement&&n.contains(document.activeElement)?(Ee(),!0):C?(e.events.fire(kc.overlayCloseButtonPressed),!1):void 0}function y(){if(O)return!O.element.contains(document.activeElement)||p("up");if($i.spatialPlayback&&e.config.video.spatial)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress("up"),!1;if(e.config.embed.on_site&&document.activeElement&&!n.contains(document.activeElement))return!0;r();var t=!1,i=!0;return e.events.fire(wc.changeVolume,$y,t,i),!1}function _(){if(O)return!O.element.contains(document.activeElement)||p("down");if($i.spatialPlayback&&e.config.video.spatial)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress("down"),!1;if(e.config.embed.on_site&&document.activeElement&&!n.contains(document.activeElement))return!0;r();var t=!1,i=!0;return e.events.fire(wc.changeVolume,-$y,t,i),!1}function b(t,n){if(O)return!O.element.contains(document.activeElement)||p("left"===n?"up":"down");if(r(),$i.spatialPlayback&&e.config.video.spatial)return e.telecine.getEffectByName("ThreeSixtyEffect").keyPress(n),!1;if(document.activeElement&&document.activeElement===P){var i=!1,o=!0,a="left"===n?-$y:$y;return e.events.fire(wc.changeVolume,a,i,o),!1}return t.shiftKey||0===F?void l(n,t.shiftKey):void N(n,t.shiftKey)}function w(){e.events.on(kc.overlayOpened,function(e){C=!0,A=e,"not-supported"===e&&(L=!0)}),e.events.on(kc.overlayClosed,function(){C=!1,A=null})}function k(){e.events.on(kc.menuVisibilityChanged,function(e,t){O=!!e&&t})}function S(){e.events.on(kc.configChanged,function(e){e&&(L=!1)})}function E(){function n(e){if(o(e),s(e)&&!u(e)&&i()){var t=a(e);if(t in l){if("function"==typeof l[t])return void(l[t](e,t)===!1&&(e.preventDefault(),e.stopPropagation()));c(l[t])===!1&&(e.preventDefault(),e.stopPropagation())}}}function r(n){if(o(n),!u(n)&&i()){var r=a(n);return $i.spatialPlayback&&e.config.video.spatial&&("left"===r||"right"===r||"up"===r||"down"===r)?void e.telecine.getEffectByName("ThreeSixtyEffect").keyUp(r):void(t.get(pp)||"left"!==r&&"right"!==r||f(n))}}var l={l:kc.likeButtonPressed,w:kc.watchLaterButtonPressed,s:kc.shareButtonPressed,c:[kc.ccButtonPressed,!0],h:[kc.prefsButtonPressed,!0],f:kc.fullscreenButtonPressed,x:[kc.effectButtonPressed,!0],e:[kc.effectButtonPressed,!0],d:kc.debugButtonPressed,space:m,up:y,down:_,left:b,right:b,esc:g,"?":[wc.showOverlay,"help"]};e.config.embed.on_site||(l.v=wc.openVimeo),document.addEventListener("keydown",n,!1),document.addEventListener("keypress",n,!1),document.addEventListener("keyup",r,!1)}function T(){e.events.on(kc.becameActive,function(){L=!1}).on(kc.becameInactive,function(){L=!0}),e.config.embed.on_site&&document.querySelector(".player")===n&&(L=!1)}function x(){var e=void 0,t=!1;document.body.addEventListener("keydown",function(n){9!==n.which||document.body.classList.contains("showfocus")?27===n.which?document.body.classList.remove("showfocus"):32!==n.which&&13!==n.which||(t=!0,clearTimeout(e),e=setTimeout(function(){t=!1},200)):document.body.classList.add("showfocus")}),document.body.addEventListener("click",function(e){t||document.body.classList.remove("showfocus")})}var A,L=!!e.config.embed.on_site,P=n.querySelector(".volume"),C=!1,O=!1,R=e.config.video.fps/5,I=Math.max(R,.618*e.config.video.duration),M=100,D=R,F=0,B=!1,N=Og(l,80);return w(),k(),S(),E(),T(),x(),{pause:function(){L=!0},unpause:function(){L=!1}}}function qi(e,t,n,i){function r(t){t&&"undefined"!=typeof F[t]&&(S.events.fire(F[t]),e.classList.toggle("player-normal","normal"===t),e.classList.toggle("player-mini","mini"===t),e.classList.toggle("player-tiny","tiny"===t))}function o(t){Object.keys(Sm).forEach(function(n){return e.classList.toggle("player-"+n,t===n)})}function a(){var t=(S.config.view===cc.main||S.config.view===cc.privateUnlocked)&&S.config.embed.settings&&!S.config.embed.settings.playbar;e.classList.toggle("no-playbar",t),e.classList.toggle("with-fullscreen",!!S.config.embed.settings.fullscreen);var n=S.config.embed.settings.custom_logo;e.classList.toggle("with-custom-logo",!!n),e.classList.toggle("with-sticky-custom-logo",n&&n.sticky),e.classList.toggle("background-mode",!!S.config.embed.settings.background),e.classList.toggle("touch-support",$i.touch)}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S.config.video.url;if(!(!t||e&&e.metaKey))return t.indexOf("#")===-1&&S.telecine.currentTime>0&&S.telecine.currentTime<S.config.video.duration-30&&!S.telecine.paused&&(t+="#at="+Math.floor(S.telecine.currentTime)),S.config.embed.on_site?void(window.location=t):(window.open(t),Se(e),S.events.fire(kc.pauseButtonPressed),!1)}function u(){a(),S.events.on(kc.configChanged,a)}function c(){P=new Vi(function(e,t){var n=function(){return window.innerWidth>0&&window.innerHeight>0},i=null,r=function t(){return clearTimeout(i),n()?void e():void(i=setTimeout(t,250))};S.events.once(kc.ready,r),S.events.once(kc.error,r)})}function l(){var e=function(e,t){return S.verifyConfig().then(function(){var n=S.config.request,i=n.signature,r=n.session,o=n.timestamp,a=n.expires,s="https://"+S.config.player_url+"/video/"+S.config.video.id+"/"+e+"?signature="+i+"&session="+r+"&time="+o+"&expires="+a;return Me(s,{method:t})}).catch(function(n){el.captureException(n,{extra:{action:e,method:t}})})},t=function(e,t){return S.updatePhpTokens().then(function(){var n="following"===e?S.config.video.owner.id:S.config.video.id,i=S.config.user.vimeo_api_interaction_tokens,r="";if(i)switch(r="?auth=",e){case mc.likes:r+=i.likes;break;case mc.watchLater:r+=i.watch_later;break;case mc.following:r+=i.following}var o=S.config.video.unlisted_hash&&"following"!==e?":"+S.config.video.unlisted_hash:"",a="https://"+S.config.vimeo_api_url+"/users/"+S.config.user.id+"/"+e+"/"+n+o+r;return Me(a,{method:t,withCredentials:!1,jwt:S.config.user.vimeo_api_client_token}).catch(function(n){el.captureException(n,{extra:{action:e,method:t}})})}).catch(function(e){el.captureException(e)})};S.events.on(kc.vodButtonPressed,function(e){if(S.config.user.purchased){if(!S.config.video.vod.is_feature&&S.config.video.vod.feature_id)return void S.loadVideo(S.config.video.vod.feature_id).then(function(){return S.events.fire(kc.playButtonPressed),S.config.video.vod.feature_id}).catch(function(e){el.captureException(e),S.events.fire(wc.showOverlay,"error",{title:"Приносим извинения",message:"Возникла проблема. Повторите попытку."})});if(S.config.video.vod&&S.config.video.vod.is_coming_soon)return;return void S.events.fire(kc.playButtonPressed)}S.performDelegateAction(lc.purchase,function(){S.events.fire(wc.openPopup,"purchase",{productId:e})},e)}),S.events.on(kc.likeButtonPressed,function(){return S.config.user.logged_in?void(S.config.user.id!==S.config.video.owner.id&&(S.config.user.liked?S.performDelegateAction(lc.unlike,function(){S.config.video.privacy!==gc.hidefromsite?t("likes","DELETE"):e("like","DELETE"),S.config.user.liked=!1,S.events.fire(kc.unliked)}):S.performDelegateAction(lc.like,function(){S.config.video.privacy!==gc.hidefromsite?t("likes","PUT"):e("like","PUT"),S.config.user.liked=!0,S.events.fire(kc.liked)}))):void S.performDelegateAction(lc.loginForm,function(){S.events.fire(wc.openPopup,"login-like")},"like")}),S.events.on(kc.watchLaterButtonPressed,function(){if(S.config.video.url||S.config.video.privacy===gc.unlisted)return S.config.user.logged_in?S.config.user.watch_later?void S.performDelegateAction(lc.removeFromWatchLater,function(){t("watchlater","DELETE"),S.config.user.watch_later=!1,S.events.fire(kc.removedFromWatchLater)}):void S.performDelegateAction(lc.addToWatchLater,function(){t("watchlater","PUT"),S.config.user.watch_later=!0,S.events.fire(kc.addedToWatchLater)}):void S.performDelegateAction(lc.loginForm,function(){S.events.fire(wc.openPopup,"login-watch-later")},"watch-later")}),S.events.on(kc.collectionsButtonPressed,function(){S.performDelegateAction(lc.collectionsOverlay,function(){return S.config.video.vod&&S.config.video.vod.url?void s(null,S.config.video.vod.url+"#collections"):S.config.video.url?void s(null,S.config.video.url+"#collections"):void 0})}),S.events.on(kc.shareButtonPressed,function(){var e=S.config.embed.settings.share&&S.config.embed.settings.share.embed_only,t=function(){S.events.fire(wc.showOverlay,"share",e)};return Rg.element?void t():void S.performDelegateAction(lc.shareOverlay,t)}),S.events.on(kc.embedButtonPressed,function(){S.config.embed.settings.share.embed_only&&S.performDelegateAction(lc.shareOverlay,function(){S.events.fire(wc.showOverlay,"share",!0)})}),S.events.on(kc.followButtonPressed,function(){if(S.config.user.logged_in&&S.config.user.id!==S.config.video.owner.id){if(S.config.user.following)return t("following","DELETE"),S.config.user.following=!1,void S.events.fire(kc.unfollowed);t("following","PUT"),S.config.user.following=!0,S.events.fire(kc.followed)}})}function d(){function t(){var t=xe(e),n=t.width,i=t.height,r="10px",o=450,a=1024,s=200;return i<=s?r:n<o?"12px":n<=a?"11px":r}function n(){P.then(function(){var e=t();return O.style.fontSize=e,R.style.fontSize=e,I.style.fontSize=e,!0}).catch(function(){})}S.events.on(kc.didEnterFullscreen,n),S.events.on(kc.didExitFullscreen,n),window.addEventListener("orientationchange",n),D&&(e.classList.add("mobile"),n())}function f(){E.watch("ui.player.mode",r)}function h(){E.watch("ui.player.breakpoint",o)}function v(){function t(){var t=e;if(i&&i.getFullscreenElement&&"function"==typeof i.getFullscreenElement){var n=i.getFullscreenElement();n&&n instanceof HTMLElement&&n.contains(e)&&n.classList.contains("js-player-fullscreen")&&(t=n)}return t}function n(e,n){return c?void(c=!1):void(s||(s=!0,S.events.fire(kc.didEnterFullscreen,t()===e,u)))}function r(e){return c?void(c=!1):void(s&&(s=!1,S.events.fire(kc.didExitFullscreen,u),u||S.events.fire(wc.toggleNativeControls,!1),u=!1))}S.config.embed.fullscreen=!0,$i.iPad&&e.classList.add("no-fullscreen-api-support");var o=S.config.embed.playsinline&&$i.iOS>=10,a=$i.iPad||o;Rg.enabled||a||(e.classList.add("no-fullscreen-support"),$i.iOS||(S.config.embed.fullscreen=!1));var s=!1,u=!1,c=!1;S.events.on([kc.pictureInPictureActivated,kc.pictureInPictureDeactivated],function(){c=!0}),S.events.on(wc.forceFullscreen,function(){return Rg.enabled||Rg.videoEnabled(e)?(S.events.fire(kc.willEnterFullscreen),u=!1,void Rg.request(t())):void S.events.fire(wc.toggleNativeControls,!0)}),S.events.on(kc.fullscreenButtonPressed,function(){"picture-in-picture"===S.telecine.presentationMode&&S.events.fire(wc.deactivatePictureInPicture),Rg.element?(S.events.fire(kc.willExitFullscreen),Rg.exit()):(S.events.fire(kc.willEnterFullscreen),u=!0,Rg.request(t()))});var l=Rg.onenter,d=Rg.onexit;if(Rg.onenter=function(e){if(!s)return t().contains(e)?void n(e,!0):void("function"==typeof l&&l(e))},Rg.onexit=function(){return s?void r(!0):void("function"==typeof d&&d())},Wp(e).on("click","a",function(e){Rg.element===t()&&Rg.exit()}),Wp(e).on("gestureend",function(e){e.scale>1&&S.events.fire(kc.fullscreenButtonPressed)}),"undefined"!=typeof MSGesture){var f=1,h=new MSGesture;h.target=e,Wp(e).on("pointerdown",function(e){h.addPointer(e.pointerId)}).on(["MSGestureChange"],function(e){f*=e.scale}).on(["MSGestureEnd"],function(){(!s&&f>=2||s&&f<1)&&S.events.fire(kc.fullscreenButtonPressed),f=1})}}function p(){pi(e,"a[data-clip-link]",s),S.events.on(wc.openVimeo,s)}function m(){return S.config.video.live_event?void(E.get(_p)||E.get(wp)||(C=new yy(e,S,E))):void(C&&(C.hide(),C=null))}function g(){u(),c(),l(),d(),f(),h(),v(),p(),m()}function y(){x||(x=new Li(S,E,e.querySelector(".vp-overlay-wrapper")))}function _(){A||(A=new Pi(S,{uuid:S.uuid,id:e.id,isMobileDevice:!1}))}function b(){L||(L=new Ci(S))}function w(){y(),_(),b(),void new wi(S,E,O),void new ki(S,E,e);var t=new Ni(S,E,e);void new Si(S,e.querySelector(".notification-wrapper")),void new Ai(S,E,e.querySelector(".vp-outro-wrapper")),void new Di(S,R),void new Fi(S,I),Object.defineProperties(T,{pauseKeyboard:{enumerable:!0,value:t.pause},unpauseKeyboard:{enumerable:!0,value:t.unpause}})}Ag.helpers=Ky;var k=Ce(n),S=new vi({element:e,delegate:i,cssLoadedPromise:k}),E=S.store;e.classList.add("js-player-fullscreen");var T=S.externalApi,x=null,A=null,L=null,P=null,C=null,O=e.querySelector(".vp-controls"),R=e.querySelector(".vp-sidedock"),I=e.querySelector(".vp-title"),M=e.querySelector(".vp-cards-wrapper"),D=$i.mobileAndroid||$i.iPhone||$i.windowsPhone||$i.browser.bb10,F={tiny:kc.enteredTinyMode,mini:kc.enteredMiniMode,normal:kc.enteredNormalMode,none:kc.enteredNormalMode},B={initializationHandler:function(){return w(),g(),Vi.resolve()},postInitializationHandler:function(){return S.telecine&&(void new hy(e.querySelector(".stats-debug"),S),void new Bi(S,E,M),void new Zy(S,S.telecine,e.querySelector(".vp-player-inner"))),Vi.resolve()},authorizationHandler:function(e){e(),y(),_();var t="Error",n="Unhandled video privacy";switch(S.config.view){case cc.privatePassword:return new Vi(function(e,t){S.events.fire(wc.showOverlay,"password"),S.events.once(kc.passwordUnlocked,function(t){e(t)})});case cc.privateLocked:b();var i="private-locked",r=null;return S.config.user.logged_in&&(i="error",r={title:"Частное видео",message:"Приносим извинения, у вас нет прав просмотра.",modal:!0,logo:!!S.config.embed.settings.branding,icon:"lock"}),S.events.fire(wc.showOverlay,i,r),Vi.reject();case cc.error:t=S.config.title,n=S.config.message}return S.events.fire(wc.showOverlay,"error",{title:t,message:n,modal:!0}),Vi.reject()}};return S.init(t,B).then(function(){return S.config.view!==cc.privateUnlocked||S.config.embed.autoplay||S.events.fire(wc.showOverlay,"private-unlocked"),!0}).catch(function(t){el.captureException(t),y(),_(),e.classList.remove("loading"),S.events.fire(kc.error,jp.id,jp)}),T}var ji="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},Vi=e(function(e){!function(t,n,i){n[t]=n[t]||i(),e.exports&&(e.exports=n[t])}("Promise","undefined"!=typeof ji?ji:ji,function(){function e(e,t){f.add(e,t),d||(d=v(f.drain))}function t(e){var t,n=typeof e;return null==e||"object"!=n&&"function"!=n||(t=e.then),"function"==typeof t&&t}function n(){for(var e=0;e<this.chain.length;e++)i(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function i(e,n,i){var r,o;try{n===!1?i.reject(e.msg):(r=n===!0?e.msg:n.call(void 0,e.msg),r===i.promise?i.reject(TypeError("Promise-chain cycle")):(o=t(r))?o.call(r,i.resolve,i.reject):i.resolve(r))}catch(e){i.reject(e)}}function r(i){var a,u=this;if(!u.triggered){u.triggered=!0,u.def&&(u=u.def);try{(a=t(i))?e(function(){var e=new s(u);try{a.call(i,function(){r.apply(e,arguments)},function(){o.apply(e,arguments)})}catch(t){o.call(e,t)}}):(u.msg=i,u.state=1,u.chain.length>0&&e(n,u))}catch(e){o.call(new s(u),e)}}}function o(t){var i=this;i.triggered||(i.triggered=!0,i.def&&(i=i.def),i.msg=t,i.state=2,i.chain.length>0&&e(n,i))}function a(e,t,n,i){for(var r=0;r<t.length;r++)!function(r){e.resolve(t[r]).then(function(e){n(r,e)},i)}(r)}function s(e){this.def=e,this.triggered=!1}function u(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function c(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var i=new u(this);this.then=function(t,r){var o={success:"function"!=typeof t||t,failure:"function"==typeof r&&r};return o.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");o.resolve=e,o.reject=t}),i.chain.push(o),0!==i.state&&e(n,i),o.promise},this.catch=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){r.call(i,e)},function(e){o.call(i,e)})}catch(e){o.call(i,e)}}var l,d,f,h=Object.prototype.toString,v="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),l=function(e,t,n,i){return Object.defineProperty(e,t,{value:n,writable:!0,configurable:i!==!1})}}catch(e){l=function(e,t,n){return e[t]=n,e}}f=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,n,i;return{add:function(r,o){i=new e(r,o),n?n.next=i:t=i,n=i,i=void 0},drain:function(){var e=t;for(t=n=d=void 0;e;)e.fn.call(e.self),e=e.next}}}();var p=l({},"constructor",c,!1);return c.prototype=p,l(p,"__NPO__",0,!1),l(c,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");t(e)})}),l(c,"reject",function(e){return new this(function(t,n){if("function"!=typeof t||"function"!=typeof n)throw TypeError("Not a function");n(e)})}),l(c,"all",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");var r=e.length,o=Array(r),s=0;a(t,e,function(e,t){o[e]=t,++s===r&&n(o)},i)})}),l(c,"race",function(e){var t=this;return"[object Array]"!=h.call(e)?t.reject(TypeError("Not an array")):new t(function(n,i){if("function"!=typeof n||"function"!=typeof i)throw TypeError("Not a function");a(t,e,function(e,t){n(t)},i)})}),c})});Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){
var o=t[r];if(e.call(i,o,r,t))return o;r++}}});var Ui=navigator.userAgent.toLowerCase(),Hi=!!t("android")&&(parseFloat(Ui.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Wi=window.devicePixelRatio||1,zi=!(!t("windows phone")&&!t("iemobile"))&&(parseFloat(Ui.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Gi=!!t("msie")&&parseFloat(Ui.replace(/^.*msie (\d+).*$/,"$1")),Ki=!!t("trident")&&parseFloat(Ui.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,Yi=!!(t("ipad;")||t("iphone;")||t("ipod touch;"))&&parseFloat(Ui.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),Xi=t("safari")&&t("apple")&&!t("chrome")&&!t("android")&&11==o()[0],$i={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Hi,hasAutoplayPolicy:Hi||Yi||Xi||a()[0]>=66,iOS:Yi,mobileAndroid:Hi&&t("mobile"),browser:{bb10:t("bb10"),chrome:t("chrome"),firefox:t("firefox"),ie:Gi||Ki,edge:t("edge"),opera:t("opera"),safari:t("safari")&&t("apple")&&!t("chrome")&&!t("android")},devicePixelRatio:Wi,flash:i(),iPhone:t("iphone;")||t("ipod touch;")||t("ipod;"),iPad:t("ipad;"),iPadNonRetina:t("ipad;")&&Wi<2,mac:t("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||t("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:n("transform"),transitionProperty:n("transition"),windowsPhone:zi},Qi=/mac os x 10_13/.test(Ui),Ji=$i.iOS&&/os 11/.test(Ui),Zi=$i.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,er=$i.iPad&&(1024===window.screen.availHeight&&1366===window.screen.availWidth||1112===window.screen.availHeight&&834===window.screen.availWidth);$i.hevc=s(),$i.hdr=Xi&&Ji&&(Zi||er),$i.vp9hdr=r(),$i.spatialPlayback=u(),$i.stereoscopic=$i.spatialPlayback&&$i.mobileAndroid;var tr=Array.isArray,nr=tr,ir="object"==typeof ji&&ji&&ji.Object===Object&&ji,rr=ir,or=rr,ar="object"==typeof self&&self&&self.Object===Object&&self,sr=or||ar||Function("return this")(),ur=sr,cr=ur,lr=cr.Symbol,dr=lr,fr=dr,hr=Object.prototype,vr=hr.hasOwnProperty,pr=hr.toString,mr=fr?fr.toStringTag:void 0,gr=c,yr=Object.prototype,_r=yr.toString,br=l,wr=dr,kr=gr,Sr=br,Er="[object Null]",Tr="[object Undefined]",xr=wr?wr.toStringTag:void 0,Ar=d,Lr=f,Pr=Ar,Cr=Lr,Or="[object Symbol]",Rr=h,Ir=nr,Mr=Rr,Dr=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Fr=/^\w*$/,Br=v,Nr=p,qr=Ar,jr=Nr,Vr="[object AsyncFunction]",Ur="[object Function]",Hr="[object GeneratorFunction]",Wr="[object Proxy]",zr=m,Gr=ur,Kr=Gr["__core-js_shared__"],Yr=Kr,Xr=Yr,$r=function(){var e=/[^.]+$/.exec(Xr&&Xr.keys&&Xr.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Qr=g,Jr=Function.prototype,Zr=Jr.toString,eo=y,to=zr,no=Qr,io=Nr,ro=eo,oo=/[\\^$.*+?()[\]{}|]/g,ao=/^\[object .+?Constructor\]$/,so=Function.prototype,uo=Object.prototype,co=so.toString,lo=uo.hasOwnProperty,fo=RegExp("^"+co.call(lo).replace(oo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ho=_,vo=b,po=ho,mo=vo,go=w,yo=go,_o=yo(Object,"create"),bo=_o,wo=bo,ko=k,So=S,Eo=bo,To="__lodash_hash_undefined__",xo=Object.prototype,Ao=xo.hasOwnProperty,Lo=E,Po=bo,Co=Object.prototype,Oo=Co.hasOwnProperty,Ro=T,Io=bo,Mo="__lodash_hash_undefined__",Do=x,Fo=ko,Bo=So,No=Lo,qo=Ro,jo=Do;A.prototype.clear=Fo,A.prototype.delete=Bo,A.prototype.get=No,A.prototype.has=qo,A.prototype.set=jo;var Vo=A,Uo=L,Ho=P,Wo=Ho,zo=C,Go=zo,Ko=Array.prototype,Yo=Ko.splice,Xo=O,$o=zo,Qo=R,Jo=zo,Zo=I,ea=zo,ta=M,na=Uo,ia=Xo,ra=Qo,oa=Zo,aa=ta;D.prototype.clear=na,D.prototype.delete=ia,D.prototype.get=ra,D.prototype.has=oa,D.prototype.set=aa;var sa=D,ua=go,ca=ur,la=ua(ca,"Map"),da=la,fa=Vo,ha=sa,va=da,pa=F,ma=B,ga=ma,ya=N,_a=ya,ba=q,wa=ya,ka=j,Sa=ya,Ea=V,Ta=ya,xa=U,Aa=pa,La=ba,Pa=ka,Ca=Ea,Oa=xa;H.prototype.clear=Aa,H.prototype.delete=La,H.prototype.get=Pa,H.prototype.has=Ca,H.prototype.set=Oa;var Ra=H,Ia=Ra,Ma="Expected a function";W.Cache=Ia;var Da,Fa=W,Ba=Fa,Na=500,qa=z,ja=qa,Va=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ua=/\\(\\)?/g,Ha=ja(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Va,function(e,n,i,r){t.push(i?r.replace(Ua,"$1"):n||e)}),t}),Wa=Ha,za=G,Ga=dr,Ka=za,Ya=nr,Xa=Rr,$a=1/0,Qa=Ga?Ga.prototype:void 0,Ja=Qa?Qa.toString:void 0,Za=K,es=Za,ts=Y,ns=nr,is=Br,rs=Wa,os=ts,as=X,ss=Rr,us=1/0,cs=$,ls=as,ds=cs,fs=Q,hs=fs,vs=J,ps="object"==typeof global&&global&&global.Object===Object&&global,ms="object"==typeof self&&self&&self.Object===Object&&self,gs=ps||ms||Function("return this")(),ys=gs.Symbol,_s=Object.prototype,bs=_s.hasOwnProperty,ws=_s.toString,ks=ys?ys.toStringTag:void 0,Ss=Object.prototype,Es=Ss.toString,Ts="[object Null]",xs="[object Undefined]",As=ys?ys.toStringTag:void 0,Ls=ne(Object.getPrototypeOf,Object),Ps="[object Object]",Cs=Function.prototype,Os=Object.prototype,Rs=Cs.toString,Is=Os.hasOwnProperty,Ms=Rs.call(Object);Da="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")();var Ds=oe(Da),Fs={INIT:"@@redux/INIT"},Bs=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ns=window.Array.from,qs=[1];"function"==typeof Ns&&Ns(qs)===qs&&(Ns=!1);var js,Vs,Us,Hs,Ws=Ns||function(e){return[].slice.call(e,0)},zs={object:!0,symbol:!0},Gs=function(){var e;if("function"!=typeof Symbol)return!1;e=Symbol("test symbol");try{String(e)}catch(e){return!1}return!!zs[typeof Symbol.iterator]&&(!!zs[typeof Symbol.toPrimitive]&&!!zs[typeof Symbol.toStringTag])},Ks=function(){var e,t=Object.assign;return"function"==typeof t&&(e={foo:"raz"},t(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")},Ys=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}},Xs=Object.keys,$s=function(e){return Xs(null==e?e:Object(e))},Qs=Ys()?Object.keys:$s,Js=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e},Zs=Qs,eu=Js,tu=Math.max,nu=function(e,t){var n,i,r,o=tu(arguments.length,2);for(e=Object(eu(e)),r=function(i){try{e[i]=t[i]}catch(e){n||(n=e)}},i=1;i<o;++i)t=arguments[i],Zs(t).forEach(r);if(void 0!==n)throw n;return e},iu=Ks()?Object.assign:nu,ru=Array.prototype.forEach,ou=Object.create,au=function(e,t){var n;for(n in e)t[n]=e[n]},su=function(e){var t=ou(null);return ru.call(arguments,function(e){null!=e&&au(Object(e),t)}),t},uu=function(e){return"function"==typeof e},cu="razdwatrzy",lu=function(){return"function"==typeof cu.contains&&(cu.contains("dwa")===!0&&cu.contains("foo")===!1)},du=String.prototype.indexOf,fu=function(e){return du.call(this,e,arguments[1])>-1},hu=lu()?String.prototype.contains:fu,vu=e(function(e){var t,n=iu,i=su,r=uu,o=hu;t=e.exports=function(e,t){var r,a,s,u,c;return arguments.length<2||"string"!=typeof e?(u=t,t=e,e=null):u=arguments[2],null==e?(r=s=!0,a=!1):(r=o.call(e,"c"),a=o.call(e,"e"),s=o.call(e,"w")),c={value:t,configurable:r,enumerable:a,writable:s},u?n(i(u),c):c},t.gs=function(e,t,a){var s,u,c,l;return"string"!=typeof e?(c=a,a=t,t=e,e=null):c=arguments[3],null==t?t=void 0:r(t)?null==a?a=void 0:r(a)||(c=a,a=void 0):(c=t,t=a=void 0),null==e?(s=!0,u=!1):(s=o.call(e,"c"),u=o.call(e,"e")),l={get:t,set:a,configurable:s,enumerable:u},c?n(i(c),l):l}}),pu=function(e){return!!e&&("symbol"==typeof e||!!e.constructor&&("Symbol"===e.constructor.name&&"Symbol"===e[e.constructor.toStringTag]))},mu=pu,gu=function(e){if(!mu(e))throw new TypeError(e+" is not a symbol");return e},yu=vu,_u=gu,bu=Object.create,wu=Object.defineProperties,ku=Object.defineProperty,Su=Object.prototype,Eu=bu(null);if("function"==typeof Symbol){js=Symbol;try{String(js()),Hs=!0}catch(e){}}var Tu=function(){var e=bu(null);return function(t){for(var n,i,r=0;e[t+(r||"")];)++r;return t+=r||"",e[t]=!0,n="@@"+t,ku(Su,n,yu.gs(null,function(e){i||(i=!0,ku(this,n,yu(e)),i=!1)})),n}}();Us=function(e){if(this instanceof Us)throw new TypeError("TypeError: Symbol is not a constructor");return Vs(e)};var xu=Vs=function e(t){var n;if(this instanceof e)throw new TypeError("TypeError: Symbol is not a constructor");return Hs?js(t):(n=bu(Us.prototype),t=void 0===t?"":String(t),wu(n,{__description__:yu("",t),__name__:yu("",Tu(t))}))};wu(Vs,{for:yu(function(e){return Eu[e]?Eu[e]:Eu[e]=Vs(String(e))}),keyFor:yu(function(e){var t;_u(e);for(t in Eu)if(Eu[t]===e)return t}),hasInstance:yu("",js&&js.hasInstance||Vs("hasInstance")),isConcatSpreadable:yu("",js&&js.isConcatSpreadable||Vs("isConcatSpreadable")),iterator:yu("",js&&js.iterator||Vs("iterator")),match:yu("",js&&js.match||Vs("match")),replace:yu("",js&&js.replace||Vs("replace")),search:yu("",js&&js.search||Vs("search")),species:yu("",js&&js.species||Vs("species")),split:yu("",js&&js.split||Vs("split")),toPrimitive:yu("",js&&js.toPrimitive||Vs("toPrimitive")),toStringTag:yu("",js&&js.toStringTag||Vs("toStringTag")),unscopables:yu("",js&&js.unscopables||Vs("unscopables"))}),wu(Us.prototype,{constructor:yu(Vs),toString:yu("",function(){return this.__name__})}),wu(Vs.prototype,{toString:yu(function(){return"Symbol ("+_u(this).__description__+")"}),valueOf:yu(function(){return _u(this)})}),ku(Vs.prototype,Vs.toPrimitive,yu("",function(){var e=_u(this);return"symbol"==typeof e?e:e.toString()})),ku(Vs.prototype,Vs.toStringTag,yu("c","Symbol")),ku(Us.prototype,Vs.toStringTag,yu("c",Vs.prototype[Vs.toStringTag])),ku(Us.prototype,Vs.toPrimitive,yu("c",Vs.prototype[Vs.toPrimitive]));var Au=Gs()?Symbol:xu,Lu=e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=t.repeat=function(e,t){return new Array(t+1).join(e)},i=t.pad=function(e,t){return n("0",t-e.toString().length)+e};t.formatTime=function(e){return i(e.getHours(),2)+":"+i(e.getMinutes(),2)+":"+i(e.getSeconds(),2)+"."+i(e.getMilliseconds(),3)},t.timer="undefined"!=typeof performance&&null!==performance&&"function"==typeof performance.now?performance:Date}),Pu=e(function(e,t){!function(t,n){e.exports=n()}(ji,function(e){function t(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}function n(e,t){Object.defineProperty(this,"kind",{value:e,enumerable:!0}),t&&t.length&&Object.defineProperty(this,"path",{value:t,enumerable:!0})}function i(e,t,n){i.super_.call(this,"E",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0}),Object.defineProperty(this,"rhs",{value:n,enumerable:!0})}function r(e,t){r.super_.call(this,"N",e),Object.defineProperty(this,"rhs",{value:t,enumerable:!0})}function o(e,t){o.super_.call(this,"D",e),Object.defineProperty(this,"lhs",{value:t,enumerable:!0})}function a(e,t,n){a.super_.call(this,"A",e),Object.defineProperty(this,"index",{value:t,enumerable:!0}),Object.defineProperty(this,"item",{value:n,enumerable:!0})}function s(e,t,n){var i=e.slice((n||t)+1||e.length);return e.length=t<0?e.length+t:t,e.push.apply(e,i),e}function u(e){var t=typeof e;return"object"!==t?t:e===Math?"math":null===e?"null":Array.isArray(e)?"array":"[object Date]"===Object.prototype.toString.call(e)?"date":"undefined"!=typeof e.toString&&/^\/.*\//.test(e.toString())?"regexp":"object"}function c(t,n,l,d,f,h,v){f=f||[];var p=f.slice(0);if("undefined"!=typeof h){if(d){if("function"==typeof d&&d(p,h))return;if("object"==typeof d){if(d.prefilter&&d.prefilter(p,h))return;if(d.normalize){var m=d.normalize(p,h,t,n);m&&(t=m[0],n=m[1])}}}p.push(h)}"regexp"===u(t)&&"regexp"===u(n)&&(t=t.toString(),n=n.toString());var g=typeof t,y=typeof n;if("undefined"===g)"undefined"!==y&&l(new r(p,n));else if("undefined"===y)l(new o(p,t));else if(u(t)!==u(n))l(new i(p,t,n));else if("[object Date]"===Object.prototype.toString.call(t)&&"[object Date]"===Object.prototype.toString.call(n)&&t-n!==0)l(new i(p,t,n));else if("object"===g&&null!==t&&null!==n){if(v=v||[],v.indexOf(t)<0){if(v.push(t),Array.isArray(t)){var _;t.length;for(_=0;_<t.length;_++)_>=n.length?l(new a(p,_,new o(e,t[_]))):c(t[_],n[_],l,d,p,_,v);for(;_<n.length;)l(new a(p,_,new r(e,n[_++])))}else{var b=Object.keys(t),w=Object.keys(n);b.forEach(function(i,r){var o=w.indexOf(i);o>=0?(c(t[i],n[i],l,d,p,i,v),w=s(w,o)):c(t[i],e,l,d,p,i,v)}),w.forEach(function(t){c(e,n[t],l,d,p,t,v)})}v.length=v.length-1}}else t!==n&&("number"===g&&isNaN(t)&&isNaN(n)||l(new i(p,t,n)))}function l(t,n,i,r){return r=r||[],c(t,n,function(e){e&&r.push(e)},i),r.length?r:e}function d(e,t,n){if(n.path&&n.path.length){var i,r=e[t],o=n.path.length-1;for(i=0;i<o;i++)r=r[n.path[i]];switch(n.kind){case"A":d(r[n.path[i]],n.index,n.item);break;case"D":delete r[n.path[i]];break;case"E":case"N":r[n.path[i]]=n.rhs}}else switch(n.kind){case"A":d(e[t],n.index,n.item);break;case"D":e=s(e,t);break;case"E":case"N":e[t]=n.rhs}return e}function f(e,t,n){if(e&&t&&n&&n.kind){for(var i=e,r=-1,o=n.path?n.path.length-1:0;++r<o;)"undefined"==typeof i[n.path[r]]&&(i[n.path[r]]="number"==typeof n.path[r]?[]:{}),i=i[n.path[r]];switch(n.kind){case"A":d(n.path?i[n.path[r]]:i,n.index,n.item);break;case"D":delete i[n.path[r]];break;case"E":case"N":i[n.path[r]]=n.rhs}}}function h(e,t,n){if(n.path&&n.path.length){var i,r=e[t],o=n.path.length-1;for(i=0;i<o;i++)r=r[n.path[i]];switch(n.kind){case"A":h(r[n.path[i]],n.index,n.item);break;case"D":r[n.path[i]]=n.lhs;break;case"E":r[n.path[i]]=n.lhs;break;case"N":delete r[n.path[i]]}}else switch(n.kind){case"A":h(e[t],n.index,n.item);break;case"D":e[t]=n.lhs;break;case"E":e[t]=n.lhs;break;case"N":e=s(e,t)}return e}function v(e,t,n){if(e&&t&&n&&n.kind){var i,r,o=e;for(r=n.path.length-1,i=0;i<r;i++)"undefined"==typeof o[n.path[i]]&&(o[n.path[i]]={}),o=o[n.path[i]];switch(n.kind){case"A":h(o[n.path[i]],n.index,n.item);break;case"D":o[n.path[i]]=n.lhs;break;case"E":o[n.path[i]]=n.lhs;break;case"N":delete o[n.path[i]]}}}function p(e,t,n){if(e&&t){var i=function(i){n&&!n(e,t,i)||f(e,t,i)};c(e,t,i)}}var m,g,y=[];return m="object"==typeof ji&&ji?ji:"undefined"!=typeof window?window:{},g=m.DeepDiff,g&&y.push(function(){"undefined"!=typeof g&&m.DeepDiff===l&&(m.DeepDiff=g,g=e)}),t(i,n),t(r,n),t(o,n),t(a,n),Object.defineProperties(l,{diff:{value:l,enumerable:!0},observableDiff:{value:c,enumerable:!0},applyDiff:{value:p,enumerable:!0},applyChange:{value:f,enumerable:!0},revertChange:{value:v,enumerable:!0},isConflict:{value:function(){return"undefined"!=typeof g},enumerable:!0},noConflict:{value:function(){return y&&(y.forEach(function(e){e()}),y=null),l},enumerable:!0}}),l})}),Cu=e(function(e,t){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ws(e)}function r(e){return"color: "+c[e].color+"; font-weight: bold"}function o(e){var t=e.kind,n=e.path,i=e.lhs,r=e.rhs,o=e.index,a=e.item;switch(t){case"E":return[n.join("."),i,"→",r];case"N":return[n.join("."),r];case"D":return[n.join(".")];case"A":return[n.join(".")+"["+o+"]",a];default:return[]}}function a(e,t,n,a){var s=(0,u.default)(e,t);try{a?n.groupCollapsed("diff"):n.group("diff")}catch(e){n.log("diff")}s?s.forEach(function(e){var t=e.kind,a=o(e);n.log.apply(n,["%c "+c[t].text,r(t)].concat(i(a)))}):n.log("—— no diff ——");try{n.groupEnd()}catch(e){n.log("—— diff end —— ")}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var s=Pu,u=n(s),c={E:{color:"#2196F3",text:"CHANGED:"},N:{color:"#4CAF50",text:"ADDED:"},D:{color:"#F44336",text:"DELETED:"},A:{color:"#2196F3",text:"ARRAY:"}};e.exports=t.default}),Ou=e(function(e,t){function n(e){return e&&e.__esModule?e:{default:e}}function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ws(e)}function r(e,t,n,r){switch("undefined"==typeof e?"undefined":s(e)){case"object":return"function"==typeof e[r]?e[r].apply(e,i(n)):e[r];case"function":return e(t);default:return e}}function o(e){var t=e.timestamp,n=e.duration;return function(e,i,r){var o=["action"];return o.push("%c"+String(e.type)),t&&o.push("%c@ "+i),n&&o.push("%c(in "+r.toFixed(2)+" ms)"),o.join(" ")}}function a(e,t){var n=t.logger,i=t.actionTransformer,a=t.titleFormatter,s=void 0===a?o(t):a,c=t.collapsed,d=t.colors,f=t.level,h=t.diff,v="undefined"==typeof t.titleFormatter;e.forEach(function(o,a){var p=o.started,m=o.startedTime,g=o.action,y=o.prevState,_=o.error,b=o.took,w=o.nextState,k=e[a+1];k&&(w=k.prevState,b=k.started-p);var S=i(g),E="function"==typeof c?c(function(){return w},g,o):c,T=(0,u.formatTime)(m),x=d.title?"color: "+d.title(S)+";":"",A=["color: gray; font-weight: lighter;"];A.push(x),t.timestamp&&A.push("color: gray; font-weight: lighter;"),t.duration&&A.push("color: gray; font-weight: lighter;");var L=s(S,T,b);try{E?d.title&&v?n.groupCollapsed.apply(n,["%c "+L].concat(A)):n.groupCollapsed(L):d.title&&v?n.group.apply(n,["%c "+L].concat(A)):n.group(L)}catch(e){n.log(L)}var P=r(f,S,[y],"prevState"),C=r(f,S,[S],"action"),O=r(f,S,[_,y],"error"),R=r(f,S,[w],"nextState");P&&(d.prevState?n[P]("%c prev state","color: "+d.prevState(y)+"; font-weight: bold",y):n[P]("prev state",y)),C&&(d.action?n[C]("%c action    ","color: "+d.action(S)+"; font-weight: bold",S):n[C]("action    ",S)),_&&O&&(d.error?n[O]("%c error     ","color: "+d.error(_,y)+"; font-weight: bold;",_):n[O]("error     ",_)),R&&(d.nextState?n[R]("%c next state","color: "+d.nextState(w)+"; font-weight: bold",w):n[R]("next state",w)),h&&(0,l.default)(y,w,n,E);try{n.groupEnd()}catch(e){n.log("—— log end ——")}})}Object.defineProperty(t,"__esModule",{value:!0});var s="function"==typeof Au&&"symbol"==typeof Au.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Au&&e.constructor===Au&&e!==Au.prototype?"symbol":typeof e};t.printBuffer=a;var u=Lu,c=Cu,l=n(c)}),Ru=e(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={level:"log",logger:console,logErrors:!0,collapsed:void 0,predicate:void 0,duration:!1,timestamp:!0,stateTransformer:function(e){return e},actionTransformer:function(e){return e},errorTransformer:function(e){return e},colors:{title:function(){return"inherit"},prevState:function(){return"#9E9E9E"},action:function(){return"#03A9F4"},nextState:function(){return"#4CAF50"},error:function(){return"#F20404"}},diff:!1,diffPredicate:void 0,transformer:void 0},e.exports=t.default}),Iu=(e(function(e,t){function n(e){return e&&e.__esModule?e:{default:e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r({},u.default,e),n=t.logger,i=t.stateTransformer,s=t.errorTransformer,c=t.predicate,l=t.logErrors,d=t.diffPredicate;if("undefined"==typeof n)return function(){return function(e){return function(t){return e(t)}}};if(e.getState&&e.dispatch)return function(){return function(e){return function(t){return e(t)}}};var f=[];return function(e){var n=e.getState;return function(e){return function(u){if("function"==typeof c&&!c(n,u))return e(u);var h={};f.push(h),h.started=a.timer.now(),h.startedTime=new Date,h.prevState=i(n()),h.action=u;var v=void 0;if(l)try{v=e(u)}catch(e){h.error=s(e)}else v=e(u);h.took=a.timer.now()-h.started,h.nextState=i(n());var p=t.diff&&"function"==typeof d?d(n,u):t.diff;if((0,o.printBuffer)(f,r({},t,{diff:p})),f.length=0,h.error)throw h.error;return v}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.logger=t.createLogger=t.defaults=void 0;var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},o=Ou,a=Lu,s=Ru,u=n(s),c=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.dispatch,n=e.getState;if("function"==typeof t||"function"==typeof n)return i()({dispatch:t,getState:n})};t.defaults=u.default,t.createLogger=i,t.logger=c,t.default=c}),new Blob([new Uint8Array([255,227,24,196,0,0,0,3,72,1,64,0,0,4,132,16,31,227,192,225,76,255,67,12,255,221,27,255,228,97,73,63,255,195,131,69,192,232,223,255,255,207,102,239,255,255,255,101,158,206,70,20,59,255,254,95,70,149,66,4,16,128,0,2,2,32,240,138,255,36,106,183,255,227,24,196,59,11,34,62,80,49,135,40,0,253,29,191,209,200,141,71,7,255,252,152,74,15,130,33,185,6,63,255,252,195,70,203,86,53,15,255,255,247,103,76,121,64,32,47,255,34,227,194,209,138,76,65,77,69,51,46,57,55,170,170,170,170,170,170,170,170,170,170,255,227,24,196,73,13,153,210,100,81,135,56,0,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170,170])],{type:"audio/mpeg"})),Mu=new Blob([new Uint8Array([0,0,0,28,102,116,121,112,105,115,111,109,0,0,2,0,105,115,111,109,105,115,111,50,109,112,52,49,0,0,0,8,102,114,101,101,0,0,2,239,109,100,97,116,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,33,16,5,32,164,27,255,192,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,55,167,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,112,0,0,2,194,109,111,111,118,0,0,0,108,109,118,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,232,0,0,0,47,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,0,0,1,236,116,114,97,107,0,0,0,92,116,107,104,100,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,47,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,36,101,100,116,115,0,0,0,28,101,108,115,116,0,0,0,0,0,0,0,1,0,0,0,47,0,0,0,0,0,1,0,0,0,0,1,100,109,100,105,97,0,0,0,32,109,100,104,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,172,68,0,0,8,0,85,196,0,0,0,0,0,45,104,100,108,114,0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0,0,0,1,15,109,105,110,102,0,0,0,16,115,109,104,100,0,0,0,0,0,0,0,0,0,0,0,36,100,105,110,102,0,0,0,28,100,114,101,102,0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1,0,0,0,211,115,116,98,108,0,0,0,103,115,116,115,100,0,0,0,0,0,0,0,1,0,0,0,87,109,112,52,97,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,2,0,16,0,0,0,0,172,68,0,0,0,0,0,51,101,115,100,115,0,0,0,0,3,128,128,128,34,0,2,0,4,128,128,128,20,64,21,0,0,0,0,1,244,0,0,1,243,249,5,128,128,128,2,18,16,6,128,128,128,1,2,0,0,0,24,115,116,116,115,0,0,0,0,0,0,0,1,0,0,0,2,0,0,4,0,0,0,0,28,115,116,115,99,0,0,0,0,0,0,0,1,0,0,0,1,0,0,0,2,0,0,0,1,0,0,0,28,115,116,115,122,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,115,0,0,1,116,0,0,0,20,115,116,99,111,0,0,0,0,0,0,0,1,0,0,0,44,0,0,0,98,117,100,116,97,0,0,0,90,109,101,116,97,0,0,0,0,0,0,0,33,104,100,108,114,0,0,0,0,0,0,0,0,109,100,105,114,97,112,112,108,0,0,0,0,0,0,0,0,0,0,0,0,45,105,108,115,116,0,0,0,37,169,116,111,111,0,0,0,29,100,97,116,97,0,0,0,1,0,0,0,0,76,97,118,102,53,54,46,52,48,46,49,48,49])],{type:"video/mp4"}),Du={audio:fe,video:de};if(function(){for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var n=e[t];window.requestAnimationFrame=window[n+"RequestAnimationFrame"],window.cancelAnimationFrame=window[n+"CancelAnimationFrame"]||window[n+"CancelRequestAnimationFrame"]}!/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)&&window.requestAnimationFrame&&window.cancelAnimationFrame||(window.requestAnimationFrame=function(e){return setTimeout(e,0)},window.cancelAnimationFrame=clearTimeout)}(),Number.isInteger||(Number.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}),!Object.setPrototypeOf&&!{}.__proto__){var Fu=Object.getPrototypeOf;Object.getPrototypeOf=function(e){return e.__proto__?e.__proto__:Fu.call(Object,e)}}if("undefined"!=typeof DOMTokenList){var Bu=function(){var e=document.createElement("div");return e.classList.toggle("test-class",!1),!e.classList.contains("test-class")}();Bu||!function(){var e=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,n){return n===!0?void this.add(t):n===!1?void this.remove(t):void e.call(this,t)}}()}"function"!=typeof Object.assign&&!function(){Object.assign=function(e){if(void 0===e||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(void 0!==i&&null!==i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}}(),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return r;r++}return-1}});var Nu=ve,qu=Nu,ju={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Vu=qu(ju),Uu=Vu,Hu=ts,Wu=Uu,zu=/&(?:amp|lt|gt|quot|#39);/g,Gu=RegExp(zu.source),Ku=pe;ye.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return ye.rgbToHex(this.red,this.green,this.blue)},set hex(e){return this.rgba=ye.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=ye.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}var t=e(this.red/255),n=e(this.green/255),i=e(this.blue/255),r=.2126*t+.7152*n+.0722*i;return r},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=ye.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new ye(this)},lighten:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.lighten(5),i=n.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&n)for(var i=n.contrast(this).ratio;i<t&&(this.darken(5),i=n.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var n=this.luminance+.05,i=e.luminance+.05,r=n/i;return i>n&&(r=1/r),r=Math.round(10*r)/10,{ratio:r,error:0,min:r,max:r}}var o=this.overlayOn(ye.white).contrast(e).ratio,a=this.overlayOn(ye.black).contrast(e).ratio,s=Math.max(o,a),u={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},c=this.clone();c.rgb=u;var l=this.overlayOn(c).contrast(e).ratio;return{ratio:Math.round((l+s)/2*10)/10,error:Math.round((s-l)/2*10)/10,min:l,max:s,closest:c,farthest:a===s?ye.white:ye.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new ye(0,0,0):new ye(255,255,255)}},ye.hexToRgb=function(e){var t;return e=String(e),3===e.length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e),t&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3])):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},ye.rgbToHex=function(e,t,n){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(n)).toString(16).slice(1)},ye.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var i=Math.max(e,t,n),r=Math.min(e,t,n),o=(i+r)/2,a=o,s=o;if(i===r)return{hue:0,saturation:0,lightness:100*s};var u=i-r;return a=s>.5?u/(2-i-r):u/(i+r),i===e?o=(t-n)/u+(t<n?6:0):i===t?o=(n-e)/u+2:i===n&&(o=(e-t)/u+4),o/=6,{hue:Math.round(360*o),saturation:Math.round(100*a),lightness:Math.round(100*s)}},ye.hslToRgb=function(e,t,n){function i(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(6*(2/3-n)):e}if(e/=360,t/=100,n/=100,0===t)return{red:Math.floor(255*n),green:Math.floor(255*n),blue:Math.floor(255*n)};var r=n<.5?n*(1+t):n+t-t*n,o=2*n-r;return{red:Math.floor(255*i(o,r,e+1/3)),green:Math.floor(255*i(o,r,e)),blue:Math.floor(255*i(o,r,e-1/3))}},ye.hslToHex=function(e,t,n){var i=ye.hslToRgb(e,t,n);return ye.rgbToHex(i.red,i.green,i.blue)},ye.white=new ye("fff"),ye.black=new ye("000");var Yu=Ar,Xu=nr,$u=Lr,Qu="[object String]",Ju=_e,Zu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ec=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},tc=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),nc=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},ic=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},rc=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),oc=we(function(e,t){return Object.keys(e).every(function(n){return e[n]===t[n]})}),ac=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return{get:function(t){return t?e.find(oc(t)):e},insert:function(t){return(e=e.concat(t)).slice(-1).pop()},getOrInsert:function(e){return this.get(e)||this.insert(e)},remove:function(t){
return e.splice(e.findIndex(oc(t)),1).pop()}}},sc=be(Ve,je),uc=function(e){return e+"px"},cc={main:1,privateLocked:2,privateUnlocked:3,privatePassword:4,error:7,contentRating:9},lc={like:{will:"willLikeVideo",did:"didLikeVideo"},unlike:{will:"willUnlikeVideo",did:"didUnlikeVideo"},addToWatchLater:{will:"willAddToWatchLater",did:"didAddToWatchLater"},removeFromWatchLater:{will:"willRemoveFromWatchLater",did:"didRemoveFromWatchLater"},purchase:{will:"willOpenVodPurchaseForm",did:"didOpenVodPurchaseForm"},shareOverlay:{will:"willOpenShareOverlay",did:"didOpenShareOverlay"},loginForm:{will:"willOpenLoginForm",did:"didOpenLoginForm"},collectionsOverlay:{will:"willOpenCollectionsOverlay",did:"didOpenCollectionsOverlay"},showOutro:{will:"willShowOutro",did:"didShowOutro"},playLog:{will:"willSendPlayLog",did:"didSendPlayLog"}},dc={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","video/vnd.mpeg.dash.mpd":"live","application/x-mpegURL":"hlslive"},fc={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},hc={HTMLScanner:"html",MediaSourceScanner:"html",LiveScanner:"html",SWFScanner:"flash"},vc={pending:"pending",active:"active",started:"started",ended:"ended"},pc={started:"started",done:"done",error:"error"},mc={likes:"likes",watchLater:"watchlater",following:"following"},gc={public:"anybody",nobody:"nobody",follow:"contacts",password:"password",user:"users",purgatory:"purgatory",hidefromsite:"disable",paytoview:"ptv",paytoviewextra:"ptv_extra",unlisted:"unlisted"},yc={low:.5,high:2},_c={maxDuration:1e4,maxFrequency:5},bc={badPlayback:"bad-playback",bufferStarted:"buffer-started",bufferEnded:"buffer-ended",spatialUnsupported:"spatial-unsupported",spatialFailure:"spatial-failure"},wc={seek:"control-seek",changeVolume:"control-change-volume",hideOverlay:"control-hide-overlay",showOverlay:"control-show-overlay",openPopup:"control-open-popup",reset:"control-reset",changeLoop:"control-change-loop",changeQuality:"control-change-quality",openVimeo:"control-open-vimeo",changeColor:"control-change-color",disableVolume:"control-disable-volume",enableVolume:"control-enable-volume",disableCaptions:"control-disable-captions",enableCaptions:"control-enable-captions",forceFullscreen:"control-force-fullscreen",turnCaptionsOn:"control-turn-captions-on",turnCaptionsOff:"control-turn-captions-off",toggleNativeControls:"control-toggle-native-controls",showOutro:"control-show-outro",hideOutro:"control-hide-outro",setEffect:"control-set-effect",activatePictureInPicture:"control-activate-picture-in-picture",deactivatePictureInPicture:"control-deactivate-picture-in-picture",attachSpatialPlaybackEvents:"control-attach-spatial-playback-events",toggleSpatialPlayback:"control-toggle-spatial-playback",revealSpatialControls:"control-reveal-spatial-controls",setTime:"control-set-time",addCard:"control-add-card",removeCard:"control-remove-card",changePlaybackRate:"control-change-playback-rate"},kc={apiError:"events-api-error",error:"events-error",hevcRestrictedStreams:"hevc-restricted-streams",playInitiated:"events-play-initiated",paused:"events-paused",played:"events-played",loadProgress:"events-load-progress",playProgress:"events-play-progress",seeked:"events-seeked",ended:"events-ended",bufferStarted:"events-buffer-started",bufferEnded:"events-buffer-ended",volumeChanged:"events-volume-changed",qualityChanged:"events-quality-changed",targetTimeReached:"events-target-time-reached",cueChanged:"events-cue-changed",streamChanged:"events-stream-changed",ranIntoBuffer:"events-ran-into-buffer",playbackResumed:"events-playback-resumed",adaptiveBandwidth:"events-adaptive-bandwidth",streamTargetChange:"events-stream-target-change",forcedQuality:"events-forced-quality",cuepoint:"events-cuepoint",firstTimeUpdate:"events-first-time-update",droppedFrames:"events-dropped-frames",segmentDownloaded:"events-segment-downloaded",playbackRateChanged:"events-playback-rate-changed",videoDurationMismatch:"events-video-duration-mismatch",fullscreenButtonPressed:"events-fullscreen-button-pressed",pauseButtonPressed:"events-pause-button-pressed",playButtonPressed:"events-play-button-pressed",prefsButtonPressed:"events-prefs-button-pressed",ccButtonPressed:"events-cc-button-pressed",scrubbingStarted:"events-scrubbing-started",scrubbingEnded:"events-scrubbing-ended",volumeScrubbingStarted:"events-volume-scrubbing-started",volumeScrubbingEnded:"events-volume-scrubbing-ended",controlBarVisibilityChanged:"events-control-bar-visibility-changed",sidedockVisibilityChanged:"events-sidedock-visibility-changed",menuVisibilityChanged:"events-menu-visibility-changed",captionsChanged:"events-captions-changed",cuePointAdded:"events-cue-point-added",cuePointRemoved:"events-cue-point-removed",spatialMotionStart:"events-spatial-motion-start",spatialMotionEnd:"events-spatial-motion-end",stereoscopicButtonPressed:"events-stereoscopic-button-pressed",controlbarBufferStarted:"events-controlbar-buffer-started",controlbarBufferEnded:"events-controlbar-buffer-ended",menuPanelOpened:"events-menu-panel-opened",menuPanelClosed:"events-menu-panel-closed",menuCentered:"events-menu-centered",badgePressed:"events-badge-pressed",willEnterFullscreen:"events-will-enter-fullscreen",didEnterFullscreen:"events-did-enter-fullscreen",willExitFullscreen:"events-will-exit-fullscreen",didExitFullscreen:"events-did-exit-fullscreen",likeButtonPressed:"events-like-button-pressed",watchLaterButtonPressed:"events-watch-later-button-pressed",shareButtonPressed:"events-share-button-pressed",embedButtonPressed:"events-embed-button-pressed",vodButtonPressed:"events-vod-button-pressed",collectionsButtonPressed:"events-collections-button-pressed",followButtonPressed:"events-follow-button-pressed",overlayOpened:"events-overlay-opened",overlayClosed:"events-overlay-closed",overlayCleared:"events-overlay-cleared",overlayCloseButtonPressed:"events-overlay-close-button-pressed",facebookButtonPressed:"events-facebook-button-pressed",twitterButtonPressed:"events-twitter-button-pressed",tumblrButtonPressed:"events-tumblr-button-pressed",emailButtonPressed:"events-email-button-pressed",embedCodeCopied:"events-embed-code-copied",popupOpened:"events-popup-opened",effectButtonPressed:"events-effect-button-pressed",debugButtonPressed:"events-debug-button-pressed",emailCaptureSubmitted:"events-email-capture-submitted",popupClosed:"events-popup-closed",shareViewShown:"events-share-view-shown",embedViewShown:"events-embed-view-shown",shareViewEnd:"events-share-view-end",embedViewEnd:"events-embed-view-end",mousedOut:"events-moused-out",mousedOver:"events-moused-over",mouseTimeout:"events-mouse-timeout",liked:"events-liked",unliked:"events-unliked",addedToWatchLater:"events-added-to-watch-later",removedFromWatchLater:"events-removed-from-watch-later",userLogIn:"events-user-log-in",userLoggedIn:"events-user-logged-in",userLoggedOut:"events-user-logged-out",loginFailure:"events-login-failure",colorChanged:"events-color-changed",configChanged:"events-config-changed",passwordUnlocked:"events-password-unlocked",privateUnlocked:"events-private-unlocked",enteredTinyMode:"events-entered-tiny-mode",enteredMiniMode:"events-entered-mini-mode",enteredNormalMode:"events-entered-normal-mode",signatureExpired:"events-signature-expired",requestConfigReloaded:"events-request-config-reloaded",embedSettingChanged:"events-embed-setting-changed",outroDisplayed:"events-outro-displayed",outroHidden:"events-outro-hidden",outroVideoPressed:"events-outro-video-pressed",becameActive:"events-became-active",becameInactive:"events-became-inactive",tipped:"events-tipped",emailCaptureSuccess:"events-email-capture-success",loadVideo:"events-load-video",cameraUpdate:"events-camera-update",outroLinkPressed:"events-outro-link-pressed",errorLinkPressed:"events-error-link-pressed",followed:"events-followed",unfollowed:"events-unfollowed",outroImagePressed:"events-outro-image-pressed",outroCtaPressed:"events-outro-cta-pressed",hudDisplayed:"events-hud-displayed",hudHidden:"events-hud-hidden",cardDisplayed:"events-card-displayed",cardPressed:"events-card-pressed",spaceChanged:"events-space-changed",emailCaptureEnd:"events-email-capture-end",titleModuleReady:"events-title-module-ready",sidedockModuleReady:"events-sidedock-module-ready",controlBarModuleReady:"events-control-bar-module-ready",videoModuleReady:"events-video-module-ready",overlayModuleReady:"events-overlay-module-ready",notificationModuleReady:"events-notification-module-ready",statsModuleReady:"events-stats-module-ready",apiModuleReady:"events-api-module-ready",ready:"events-ready",telecineReady:"events-telecine-ready",notificationHidden:"events-notification-hidden",alertVisibilityChanged:"events-alert-visibility-changed",airPlayAvailable:"events-air-play-available",airPlayNotAvailable:"events-air-play-not-available",airPlayActivated:"events-air-play-activated",airPlayDeactivated:"events-air-play-deactivated",airPlayButtonPressed:"events-air-play-button-pressed",pictureInPictureAvailable:"events-picture-in-picture-available",pictureInPictureNotAvailable:"events-picture-in-picture-not-available",pictureInPictureActivated:"events-picture-in-picture-activated",pictureInPictureDeactivated:"events-picture-in-picture-deactivated",liveEventPending:"events-live-event-pending",liveEventActive:"events-live-event-active",liveEventStarted:"events-live-event-started",liveEventEnded:"events-live-event-ended",liveArchiveStarted:"events-live-archive-started",liveArchiveDone:"events-live-archive-done",liveArchiveError:"events-live-archive-error",liveRepresentationsAvailable:"events-live-representations-available",liveStreamOnline:"events-live-stream-online",liveStreamOffline:"events-live-stream-offline"},Sc={isObject:ze,isError:Ge},Ec=Sc,Tc={collectWindowErrors:!0,debug:!1},xc="undefined"!=typeof window?window:"undefined"!=typeof ji?ji:"undefined"!=typeof self?self:{},Ac=[].slice,Lc="?",Pc=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;Tc.report=function(){function e(e){o(),d.push(e)}function t(e){for(var t=d.length-1;t>=0;--t)d[t]===e&&d.splice(t,1)}function n(){a(),d=[]}function i(e,t){var n=null;if(!t||Tc.collectWindowErrors){for(var i in d)if(d.hasOwnProperty(i))try{d[i].apply(null,[e].concat(Ac.call(arguments,2)))}catch(e){n=e}if(n)throw n}}function r(e,t,n,r,o){var a=null;if(v)Tc.computeStackTrace.augmentStackTraceWithInitialElement(v,t,n,e),s();else if(o&&Ec.isError(o))a=Tc.computeStackTrace(o),i(a,!0);else{var u,l={url:t,line:n,column:r},d=void 0,f=e;if("[object String]"==={}.toString.call(e)){var u=e.match(Pc);u&&(d=u[1],f=u[2])}l.func=Lc,a={name:d,message:f,url:Ke(),stack:[l]},i(a,!0)}return!!c&&c.apply(this,arguments)}function o(){l||(c=xc.onerror,xc.onerror=r,l=!0)}function a(){l&&(xc.onerror=c,l=!1,c=void 0)}function s(){var e=v,t=f;f=null,v=null,h=null,i.apply(null,[e,!1].concat(t))}function u(e,t){var n=Ac.call(arguments,1);if(v){if(h===e)return;s()}var i=Tc.computeStackTrace(e);if(v=i,h=e,f=n,setTimeout(function(){h===e&&s()},i.incomplete?2e3:0),t!==!1)throw e}var c,l,d=[],f=null,h=null,v=null;return u.subscribe=e,u.unsubscribe=t,u.uninstall=n,u}(),Tc.computeStackTrace=function(){function e(e){if("undefined"!=typeof e.stack&&e.stack){for(var t,n,i,r=/^\s*at (.*?) ?\(((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i,o=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|\[native).*?)(?::(\d+))?(?::(\d+))?\s*$/i,a=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i,s=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i,u=/\((\S*)(?::(\d+))(?::(\d+))\)/,c=e.stack.split("\n"),l=[],d=(/^(.*) is undefined$/.exec(e.message),0),f=c.length;d<f;++d){if(n=r.exec(c[d])){var h=n[2]&&0===n[2].indexOf("native"),v=n[2]&&0===n[2].indexOf("eval");v&&(t=u.exec(n[2]))&&(n[2]=t[1],n[3]=t[2],n[4]=t[3]),i={url:h?null:n[2],func:n[1]||Lc,args:h?[n[2]]:[],line:n[3]?+n[3]:null,column:n[4]?+n[4]:null}}else if(n=a.exec(c[d]))i={url:n[2],func:n[1]||Lc,args:[],line:+n[3],column:n[4]?+n[4]:null};else{if(!(n=o.exec(c[d])))continue;var v=n[3]&&n[3].indexOf(" > eval")>-1;v&&(t=s.exec(n[3]))?(n[3]=t[1],n[4]=t[2],n[5]=null):0!==d||n[5]||"undefined"==typeof e.columnNumber||(l[0].column=e.columnNumber+1),i={url:n[3],func:n[1]||Lc,args:n[2]?n[2].split(","):[],line:n[4]?+n[4]:null,column:n[5]?+n[5]:null}}!i.func&&i.line&&(i.func=Lc),l.push(i)}return l.length?{name:e.name,message:e.message,url:Ke(),stack:l}:null}}function t(e,t,n,i){var r={url:t,line:n};if(r.url&&r.line){if(e.incomplete=!1,r.func||(r.func=Lc),e.stack.length>0&&e.stack[0].url===r.url){if(e.stack[0].line===r.line)return!1;if(!e.stack[0].line&&e.stack[0].func===r.func)return e.stack[0].line=r.line,!1}return e.stack.unshift(r),e.partial=!0,!0}return e.incomplete=!0,!1}function n(e,r){for(var o,a,s=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,u=[],c={},l=!1,d=n.caller;d&&!l;d=d.caller)if(d!==i&&d!==Tc.report){if(a={url:null,func:Lc,line:null,column:null},d.name?a.func=d.name:(o=s.exec(d.toString()))&&(a.func=o[1]),"undefined"==typeof a.func)try{a.func=o.input.substring(0,o.input.indexOf("{"))}catch(e){}c[""+d]?l=!0:c[""+d]=!0,u.push(a)}r&&u.splice(0,r);var f={name:e.name,message:e.message,url:Ke(),stack:u};return t(f,e.sourceURL||e.fileName,e.line||e.lineNumber,e.message||e.description),f}function i(t,i){var r=null;i=null==i?0:+i;try{if(r=e(t))return r}catch(e){if(Tc.debug)throw e}try{if(r=n(t,i+1))return r}catch(e){if(Tc.debug)throw e}return{name:t.name,message:t.message,url:Ke()}}return i.augmentStackTraceWithInitialElement=t,i.computeStackTraceFromStackProp=e,i}();var Cc=Tc,Oc=e(function(e,t){function n(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}function i(e,t,n,i){return JSON.stringify(e,r(t,i),n)}function r(e,t){var i=[],r=[];return null==t&&(t=function(e,t){return i[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n(i,t)).join(".")+"]"}),function(o,a){if(i.length>0){var s=n(i,this);~s?i.splice(s+1):i.push(this),~s?r.splice(s,1/0,o):r.push(o),~n(i,a)&&(a=t.call(this,o,a))}else i.push(a);return null==e?a:e.call(this,o,a)}}t=e.exports=i,t.getSerialize=r});Ye.prototype=new Error,Ye.prototype.constructor=Ye;var Rc=Ye,Ic=function(e,t,n){var i=e[t],r=e;if(t in e){var o="warn"===t?"warning":t;e[t]=function(){var e=[].slice.call(arguments),t=""+e.join(" "),a={level:o,logger:"console",extra:{arguments:e}};n&&n(t,a),i&&Function.prototype.apply.call(i,r,e)}}},Mc={wrapMethod:Ic},Dc=Cc,Fc=Oc,Bc=Rc,Nc=Sc,qc=Nc.isError,jc=Nc.isObject,Vc=Mc.wrapMethod,Uc="source protocol user pass host port path".split(" "),Hc=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/,Wc="undefined"!=typeof window?window:"undefined"!=typeof ji?ji:"undefined"!=typeof self?self:{},zc=Wc.document,Gc=Wc.navigator;$e.prototype={VERSION:"3.14.2",debug:!1,TraceKit:Dc,config:function(e,t){var n=this;if(n._globalServer)return this._logDebug("error","Error: Raven has already been configured"),n;if(!e)return n;var i=n._globalOptions;t&&tt(t,function(e,t){"tags"===e||"extra"===e||"user"===e?n._globalContext[e]=t:i[e]=t}),n.setDSN(e),i.ignoreErrors.push(/^Script error\.?$/),i.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/),i.ignoreErrors=ot(i.ignoreErrors),i.ignoreUrls=!!i.ignoreUrls.length&&ot(i.ignoreUrls),i.whitelistUrls=!!i.whitelistUrls.length&&ot(i.whitelistUrls),i.includePaths=ot(i.includePaths),i.maxBreadcrumbs=Math.max(0,Math.min(i.maxBreadcrumbs||100,100));var r={xhr:!0,console:!0,dom:!0,location:!0},o=i.autoBreadcrumbs;return"[object Object]"==={}.toString.call(o)?o=nt(r,o):o!==!1&&(o=r),i.autoBreadcrumbs=o,Dc.collectWindowErrors=!!i.collectWindowErrors,n},install:function(){var e=this;return e.isSetup()&&!e._isRavenInstalled&&(Dc.report.subscribe(function(){e._handleOnErrorStackInfo.apply(e,arguments)}),e._instrumentTryCatch(),e._globalOptions.autoBreadcrumbs&&e._instrumentBreadcrumbs(),e._drainPlugins(),e._isRavenInstalled=!0),Error.stackTraceLimit=e._globalOptions.stackTraceLimit,this},setDSN:function(e){var t=this,n=t._parseDSN(e),i=n.path.lastIndexOf("/"),r=n.path.substr(1,i);t._dsn=e,t._globalKey=n.user,t._globalSecret=n.pass&&n.pass.substr(1),t._globalProject=n.path.substr(i+1),t._globalServer=t._getGlobalServer(n),t._globalEndpoint=t._globalServer+"/"+r+"api/"+t._globalProject+"/store/",this._resetBackoff()},context:function(e,t,n){return Je(e)&&(n=t||[],t=e,e=void 0),this.wrap(e,t).apply(this,n)},wrap:function(e,t,n){function i(){var i=[],o=arguments.length,a=!e||e&&e.deep!==!1;for(n&&Je(n)&&n.apply(this,arguments);o--;)i[o]=a?r.wrap(e,arguments[o]):arguments[o];try{return t.apply(this,i)}catch(t){throw r._ignoreNextOnError(),r.captureException(t,e),t}}var r=this;if(Qe(t)&&!Je(e))return e;if(Je(e)&&(t=e,e=void 0),!Je(t))return t;try{if(t.__raven__)return t;if(t.__raven_wrapper__)return t.__raven_wrapper__}catch(e){return t}for(var o in t)rt(t,o)&&(i[o]=t[o]);return i.prototype=t.prototype,t.__raven_wrapper__=i,i.__raven__=!0,i.__inner__=t,i},uninstall:function(){return Dc.report.uninstall(),this._restoreBuiltIns(),Error.stackTraceLimit=this._originalErrorStackTraceLimit,this._isRavenInstalled=!1,this},captureException:function(e,t){if(!qc(e))return this.captureMessage(e,nt({trimHeadFrames:1,stacktrace:!0},t));this._lastCapturedException=e;try{var n=Dc.computeStackTrace(e);this._handleStackInfo(n,t)}catch(t){if(e!==t)throw t}return this},captureMessage:function(e,t){if(!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(e)){t=t||{};var n=nt({message:e+""},t);if(this._globalOptions.stacktrace||t&&t.stacktrace){var i;try{throw new Error(e)}catch(e){i=e}i.name=null,t=nt({fingerprint:e,trimHeadFrames:(t.trimHeadFrames||0)+1},t);var r=Dc.computeStackTrace(i),o=this._prepareFrames(r,t);n.stacktrace={frames:o.reverse()}}return this._send(n),this}},captureBreadcrumb:function(e){var t=nt({timestamp:Xe()/1e3},e);if(Je(this._globalOptions.breadcrumbCallback)){var n=this._globalOptions.breadcrumbCallback(t);if(jc(n)&&!et(n))t=n;else if(n===!1)return this}return this._breadcrumbs.push(t),this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs&&this._breadcrumbs.shift(),this},addPlugin:function(e){var t=[].slice.call(arguments,1);return this._plugins.push([e,t]),this._isRavenInstalled&&this._drainPlugins(),this},setUserContext:function(e){return this._globalContext.user=e,this},setExtraContext:function(e){return this._mergeContext("extra",e),this},setTagsContext:function(e){return this._mergeContext("tags",e),this},clearContext:function(){return this._globalContext={},this},getContext:function(){return JSON.parse(Fc(this._globalContext))},setEnvironment:function(e){return this._globalOptions.environment=e,this},setRelease:function(e){return this._globalOptions.release=e,this},setDataCallback:function(e){var t=this._globalOptions.dataCallback;return this._globalOptions.dataCallback=Je(e)?function(n){return e(n,t)}:e,this},setBreadcrumbCallback:function(e){var t=this._globalOptions.breadcrumbCallback;return this._globalOptions.breadcrumbCallback=Je(e)?function(n){return e(n,t)}:e,this},setShouldSendCallback:function(e){var t=this._globalOptions.shouldSendCallback;return this._globalOptions.shouldSendCallback=Je(e)?function(n){return e(n,t)}:e,this},setTransport:function(e){return this._globalOptions.transport=e,this},lastException:function(){return this._lastCapturedException},lastEventId:function(){return this._lastEventId},isSetup:function(){return!!this._hasJSON&&(!!this._globalServer||(this.ravenNotConfiguredError||(this.ravenNotConfiguredError=!0,this._logDebug("error","Error: Raven has not been configured.")),!1))},afterLoad:function(){var e=Wc.RavenConfig;e&&this.config(e.dsn,e.config).install()},showReportDialog:function(e){if(zc){e=e||{};var t=e.eventId||this.lastEventId();if(!t)throw new Bc("Missing eventId");var n=e.dsn||this._dsn;if(!n)throw new Bc("Missing DSN");var i=encodeURIComponent,r="";r+="?eventId="+i(t),r+="&dsn="+i(n);var o=e.user||this._globalContext.user;o&&(o.name&&(r+="&name="+i(o.name)),o.email&&(r+="&email="+i(o.email)));var a=this._getGlobalServer(this._parseDSN(n)),s=zc.createElement("script");s.async=!0,s.src=a+"/api/embed/error-page/"+r,(zc.head||zc.body).appendChild(s)}},_ignoreNextOnError:function(){var e=this;this._ignoreOnError+=1,setTimeout(function(){e._ignoreOnError-=1})},_triggerEvent:function(e,t){var n,i;if(this._hasDocument){t=t||{},e="raven"+e.substr(0,1).toUpperCase()+e.substr(1),zc.createEvent?(n=zc.createEvent("HTMLEvents"),n.initEvent(e,!0,!0)):(n=zc.createEventObject(),n.eventType=e);for(i in t)rt(t,i)&&(n[i]=t[i]);if(zc.createEvent)zc.dispatchEvent(n);else try{zc.fireEvent("on"+n.eventType.toLowerCase(),n)}catch(e){}}},_breadcrumbEventHandler:function(e){var t=this;return function(n){if(t._keypressTimeout=null,t._lastCapturedEvent!==n){t._lastCapturedEvent=n;var i;try{i=ct(n.target)}catch(e){i="<unknown>"}t.captureBreadcrumb({category:"ui."+e,message:i})}}},_keypressEventHandler:function(){var e=this,t=1e3;return function(n){var i;try{i=n.target}catch(e){return}var r=i&&i.tagName;if(r&&("INPUT"===r||"TEXTAREA"===r||i.isContentEditable)){var o=e._keypressTimeout;o||e._breadcrumbEventHandler("input")(n),clearTimeout(o),e._keypressTimeout=setTimeout(function(){e._keypressTimeout=null},t)}}},_captureUrlChange:function(e,t){var n=st(this._location.href),i=st(t),r=st(e);this._lastHref=t,n.protocol===i.protocol&&n.host===i.host&&(t=i.relative),n.protocol===r.protocol&&n.host===r.host&&(e=r.relative),this.captureBreadcrumb({category:"navigation",data:{to:t,from:e}})},_instrumentTryCatch:function(){function e(e){return function(t,i){for(var r=new Array(arguments.length),o=0;o<r.length;++o)r[o]=arguments[o];var a=r[0];return Je(a)&&(r[0]=n.wrap(a)),e.apply?e.apply(this,r):e(r[0],r[1])}}function t(e){var t=Wc[e]&&Wc[e].prototype;t&&t.hasOwnProperty&&t.hasOwnProperty("addEventListener")&&(vt(t,"addEventListener",function(t){return function(i,o,a,s){try{o&&o.handleEvent&&(o.handleEvent=n.wrap(o.handleEvent))}catch(e){}var u,c,l;return r&&r.dom&&("EventTarget"===e||"Node"===e)&&(c=n._breadcrumbEventHandler("click"),l=n._keypressEventHandler(),u=function(e){if(e){var t;try{t=e.type}catch(e){return}return"click"===t?c(e):"keypress"===t?l(e):void 0}}),t.call(this,i,n.wrap(o,void 0,u),a,s)}},i),vt(t,"removeEventListener",function(e){return function(t,n,i,r){try{n=n&&(n.__raven_wrapper__?n.__raven_wrapper__:n)}catch(e){}return e.call(this,t,n,i,r)}},i))}var n=this,i=n._wrappedBuiltIns,r=this._globalOptions.autoBreadcrumbs;vt(Wc,"setTimeout",e,i),vt(Wc,"setInterval",e,i),Wc.requestAnimationFrame&&vt(Wc,"requestAnimationFrame",function(e){return function(t){return e(n.wrap(t))}},i);for(var o=["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"],a=0;a<o.length;a++)t(o[a])},_instrumentBreadcrumbs:function(){function e(e,n){e in n&&Je(n[e])&&vt(n,e,function(e){return t.wrap(e)})}var t=this,n=this._globalOptions.autoBreadcrumbs,i=t._wrappedBuiltIns;if(n.xhr&&"XMLHttpRequest"in Wc){var r=XMLHttpRequest.prototype;vt(r,"open",function(e){return function(n,i){return Ze(i)&&i.indexOf(t._globalKey)===-1&&(this.__raven_xhr={method:n,url:i,status_code:null}),e.apply(this,arguments)}},i),vt(r,"send",function(n){return function(i){function r(){if(o.__raven_xhr&&(1===o.readyState||4===o.readyState)){try{o.__raven_xhr.status_code=o.status}catch(e){}t.captureBreadcrumb({type:"http",category:"xhr",data:o.__raven_xhr})}}for(var o=this,a=["onload","onerror","onprogress"],s=0;s<a.length;s++)e(a[s],o);return"onreadystatechange"in o&&Je(o.onreadystatechange)?vt(o,"onreadystatechange",function(e){return t.wrap(e,void 0,r)}):o.onreadystatechange=r,n.apply(this,arguments)}},i)}n.xhr&&"fetch"in Wc&&vt(Wc,"fetch",function(e){return function(n,i){for(var r=new Array(arguments.length),o=0;o<r.length;++o)r[o]=arguments[o];var a,s=r[0],u="GET";"string"==typeof s?a=s:(a=s.url,s.method&&(u=s.method)),r[1]&&r[1].method&&(u=r[1].method);var c={method:u,url:a,status_code:null};return t.captureBreadcrumb({type:"http",category:"fetch",data:c}),e.apply(this,r).then(function(e){return c.status_code=e.status,e})}},i),n.dom&&this._hasDocument&&(zc.addEventListener?(zc.addEventListener("click",t._breadcrumbEventHandler("click"),!1),zc.addEventListener("keypress",t._keypressEventHandler(),!1)):(zc.attachEvent("onclick",t._breadcrumbEventHandler("click")),zc.attachEvent("onkeypress",t._keypressEventHandler())));var o=Wc.chrome,a=o&&o.app&&o.app.runtime,s=!a&&Wc.history&&history.pushState;if(n.location&&s){var u=Wc.onpopstate;Wc.onpopstate=function(){var e=t._location.href;if(t._captureUrlChange(t._lastHref,e),u)return u.apply(this,arguments)},vt(history,"pushState",function(e){return function(){var n=arguments.length>2?arguments[2]:void 0;return n&&t._captureUrlChange(t._lastHref,n+""),e.apply(this,arguments)}},i)}if(n.console&&"console"in Wc&&console.log){var c=function(e,n){t.captureBreadcrumb({message:e,level:n.level,category:"console"})};tt(["debug","info","warn","error","log"],function(e,t){Vc(console,t,c)})}},_restoreBuiltIns:function(){for(var e;this._wrappedBuiltIns.length;){e=this._wrappedBuiltIns.shift();var t=e[0],n=e[1],i=e[2];t[n]=i}},_drainPlugins:function(){var e=this;tt(this._plugins,function(t,n){var i=n[0],r=n[1];i.apply(e,[e].concat(r))})},_parseDSN:function(e){var t=Hc.exec(e),n={},i=7;try{for(;i--;)n[Uc[i]]=t[i]||""}catch(t){throw new Bc("Invalid DSN: "+e)}if(n.pass&&!this._globalOptions.allowSecretKey)throw new Bc("Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key");return n},_getGlobalServer:function(e){var t="//"+e.host+(e.port?":"+e.port:"");return e.protocol&&(t=e.protocol+":"+t),t},_handleOnErrorStackInfo:function(){this._ignoreOnError||this._handleStackInfo.apply(this,arguments)},_handleStackInfo:function(e,t){var n=this._prepareFrames(e,t);this._triggerEvent("handle",{stackInfo:e,options:t}),this._processException(e.name,e.message,e.url,e.lineno,n,t)},_prepareFrames:function(e,t){var n=this,i=[];if(e.stack&&e.stack.length&&(tt(e.stack,function(e,t){var r=n._normalizeFrame(t);r&&i.push(r)}),t&&t.trimHeadFrames))for(var r=0;r<t.trimHeadFrames&&r<i.length;r++)i[r].in_app=!1;return i=i.slice(0,this._globalOptions.stackTraceLimit)},_normalizeFrame:function(e){if(e.url){var t={filename:e.url,lineno:e.line,colno:e.column,function:e.func||"?"};return t.in_app=!(this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(t.filename)||/(Raven|TraceKit)\./.test(t.function)||/raven\.(min\.)?js$/.test(t.filename)),t}},_processException:function(e,t,n,i,r,o){var a;if((!this._globalOptions.ignoreErrors.test||!this._globalOptions.ignoreErrors.test(t))&&(t+="",r&&r.length?(n=r[0].filename||n,r.reverse(),a={frames:r}):n&&(a={frames:[{filename:n,lineno:i,in_app:!0}]}),(!this._globalOptions.ignoreUrls.test||!this._globalOptions.ignoreUrls.test(n))&&(!this._globalOptions.whitelistUrls.test||this._globalOptions.whitelistUrls.test(n)))){var s=nt({exception:{values:[{type:e,value:t,stacktrace:a}]},culprit:n},o);this._send(s)}},_trimPacket:function(e){var t=this._globalOptions.maxMessageLength;if(e.message&&(e.message=it(e.message,t)),e.exception){var n=e.exception.values[0];n.value=it(n.value,t)}var i=e.request;return i&&(i.url&&(i.url=it(i.url,this._globalOptions.maxUrlLength)),i.Referer&&(i.Referer=it(i.Referer,this._globalOptions.maxUrlLength))),e.breadcrumbs&&e.breadcrumbs.values&&this._trimBreadcrumbs(e.breadcrumbs),e},_trimBreadcrumbs:function(e){for(var t,n,i,r=["to","from","url"],o=0;o<e.values.length;++o)if(n=e.values[o],n.hasOwnProperty("data")&&jc(n.data)){i=n.data;for(var a=0;a<r.length;++a)t=r[a],i.hasOwnProperty(t)&&(i[t]=it(i[t],this._globalOptions.maxUrlLength))}},_getHttpData:function(){if(this._hasNavigator||this._hasDocument){var e={};return this._hasNavigator&&Gc.userAgent&&(e.headers={"User-Agent":navigator.userAgent}),this._hasDocument&&(zc.location&&zc.location.href&&(e.url=zc.location.href),zc.referrer&&(e.headers||(e.headers={}),e.headers.Referer=zc.referrer)),e}},_resetBackoff:function(){this._backoffDuration=0,this._backoffStart=null},_shouldBackoff:function(){return this._backoffDuration&&Xe()-this._backoffStart<this._backoffDuration},_isRepeatData:function(e){var t=this._lastData;return!(!t||e.message!==t.message||e.culprit!==t.culprit)&&(e.stacktrace||t.stacktrace?ht(e.stacktrace,t.stacktrace):!e.exception&&!t.exception||ft(e.exception,t.exception))},_setBackoffState:function(e){if(!this._shouldBackoff()){var t=e.status;if(400===t||401===t||429===t){var n;try{n=e.getResponseHeader("Retry-After"),n=1e3*parseInt(n,10)}catch(e){}this._backoffDuration=n?n:2*this._backoffDuration||1e3,this._backoffStart=Xe()}}},_send:function(e){var t=this._globalOptions,n={project:this._globalProject,logger:t.logger,platform:"javascript"},i=this._getHttpData();if(i&&(n.request=i),e.trimHeadFrames&&delete e.trimHeadFrames,e=nt(n,e),e.tags=nt(nt({},this._globalContext.tags),e.tags),e.extra=nt(nt({},this._globalContext.extra),e.extra),e.extra["session:duration"]=Xe()-this._startTime,this._breadcrumbs&&this._breadcrumbs.length>0&&(e.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}),et(e.tags)&&delete e.tags,this._globalContext.user&&(e.user=this._globalContext.user),t.environment&&(e.environment=t.environment),t.release&&(e.release=t.release),t.serverName&&(e.server_name=t.serverName),Je(t.dataCallback)&&(e=t.dataCallback(e)||e),e&&!et(e)&&(!Je(t.shouldSendCallback)||t.shouldSendCallback(e)))return this._shouldBackoff()?void this._logDebug("warn","Raven dropped error due to backoff: ",e):void("number"==typeof t.sampleRate?Math.random()<t.sampleRate&&this._sendProcessedPayload(e):this._sendProcessedPayload(e))},_getUuid:function(){return ut()},_sendProcessedPayload:function(e,t){var n=this,i=this._globalOptions;if(this.isSetup()){if(this._lastEventId=e.event_id||(e.event_id=this._getUuid()),e=this._trimPacket(e),!this._globalOptions.allowDuplicates&&this._isRepeatData(e))return void this._logDebug("warn","Raven dropped repeat event: ",e);this._lastData=e,this._logDebug("debug","Raven about to send:",e);var r={sentry_version:"7",sentry_client:"raven-js/"+this.VERSION,sentry_key:this._globalKey};this._globalSecret&&(r.sentry_secret=this._globalSecret);var o=e.exception&&e.exception.values[0];this.captureBreadcrumb({category:"sentry",message:o?(o.type?o.type+": ":"")+o.value:e.message,event_id:e.event_id,level:e.level||"error"});var a=this._globalEndpoint;(i.transport||this._makeRequest).call(this,{url:a,auth:r,data:e,options:i,onSuccess:function(){n._resetBackoff(),n._triggerEvent("success",{data:e,src:a}),t&&t()},onError:function(i){n._logDebug("error","Raven transport failed to send: ",i),i.request&&n._setBackoffState(i.request),n._triggerEvent("failure",{data:e,src:a}),i=i||new Error("Raven send failed (no additional details provided)"),t&&t(i)}})}},_makeRequest:function(e){var t=new XMLHttpRequest,n="withCredentials"in t||"undefined"!=typeof XDomainRequest;if(n){var i=e.url;"withCredentials"in t?t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status)e.onSuccess&&e.onSuccess();else if(e.onError){var n=new Error("Sentry error code: "+t.status);n.request=t,e.onError(n)}}:(t=new XDomainRequest,i=i.replace(/^https?:/,""),e.onSuccess&&(t.onload=e.onSuccess),e.onError&&(t.onerror=function(){
var n=new Error("Sentry error code: XDomainRequest");n.request=t,e.onError(n)})),t.open("POST",i+"?"+at(e.auth)),t.send(Fc(e.data))}},_logDebug:function(e){this._originalConsoleMethods[e]&&this.debug&&Function.prototype.apply.call(this._originalConsoleMethods[e],this._originalConsole,[].slice.call(arguments,1))},_mergeContext:function(e,t){Qe(t)?delete this._globalContext[e]:this._globalContext[e]=nt(this._globalContext[e]||{},t)}};var Kc=Object.prototype;"undefined"!=typeof __false__&&__false__&&($e.utils={isUndefined:Qe,isFunction:Je,isString:Ze,isObject:jc,isEmptyObject:et,isError:qc,each:tt,objectMerge:nt,truncate:it,hasKey:rt,joinRegExp:ot,urlencode:at,uuid4:ut,htmlTreeAsString:ct,htmlElementAsString:lt,parseUrl:st,fill:vt}),$e.prototype.setUser=$e.prototype.setUserContext,$e.prototype.setReleaseContext=$e.prototype.setRelease;var Yc=$e,Xc=Yc,$c="undefined"!=typeof window?window:"undefined"!=typeof ji?ji:"undefined"!=typeof self?self:{},Qc=$c.Raven,Jc=new Xc;Jc.noConflict=function(){return $c.Raven=Qc,Jc},Jc.afterLoad();var Zc=Jc,el={setUp:mt,captureException:gt,captureMessage:yt,captureBreadcrumb:_t},tl=/^(%20|\s)*(javascript|data)/im,nl=/[^\x20-\x7E]/gim,il=/^([^:]+):/gm,rl=[".","/"],ol=6e4,al=ur,sl=function(){return al.Date.now()},ul=sl,cl=Nr,ll=Rr,dl=NaN,fl=/^\s+|\s+$/g,hl=/^[-+]0x[0-9a-f]+$/i,vl=/^0b[01]+$/i,pl=/^0o[0-7]+$/i,ml=parseInt,gl=Pt,yl=Nr,_l=ul,bl=gl,wl="Expected a function",kl=Math.max,Sl=Math.min,El=Ct,Tl="PREVIEW_SET_SIZE",xl=function(e,t){return{type:Tl,payload:{width:e,height:t}}},Al=Object.prototype,Ll=Ot,Pl=Rt,Cl=Pl,Ol=Cl(Object.keys,Object),Rl=Ol,Il=Ll,Ml=Rl,Dl=Object.prototype,Fl=Dl.hasOwnProperty,Bl=It,Nl=go,ql=ur,jl=Nl(ql,"DataView"),Vl=jl,Ul=go,Hl=ur,Wl=Ul(Hl,"Promise"),zl=Wl,Gl=go,Kl=ur,Yl=Gl(Kl,"Set"),Xl=Yl,$l=go,Ql=ur,Jl=$l(Ql,"WeakMap"),Zl=Jl,ed=Vl,td=da,nd=zl,id=Xl,rd=Zl,od=Ar,ad=eo,sd="[object Map]",ud="[object Object]",cd="[object Promise]",ld="[object Set]",dd="[object WeakMap]",fd="[object DataView]",hd=ad(ed),vd=ad(td),pd=ad(nd),md=ad(id),gd=ad(rd),yd=od;(ed&&yd(new ed(new ArrayBuffer(1)))!=fd||td&&yd(new td)!=sd||nd&&yd(nd.resolve())!=cd||id&&yd(new id)!=ld||rd&&yd(new rd)!=dd)&&(yd=function(e){var t=od(e),n=t==ud?e.constructor:void 0,i=n?ad(n):"";if(i)switch(i){case hd:return fd;case vd:return sd;case pd:return cd;case md:return ld;case gd:return dd}return t});var _d=yd,bd=Ar,wd=Lr,kd="[object Arguments]",Sd=Mt,Ed=Sd,Td=Lr,xd=Object.prototype,Ad=xd.hasOwnProperty,Ld=xd.propertyIsEnumerable,Pd=Ed(function(){return arguments}())?Ed:function(e){return Td(e)&&Ad.call(e,"callee")&&!Ld.call(e,"callee")},Cd=Pd,Od=9007199254740991,Rd=Dt,Id=zr,Md=Rd,Dd=Ft,Fd=Bt,Bd=e(function(e,t){var n=ur,i=Fd,r=t&&!t.nodeType&&t,o=r&&!0&&e&&!e.nodeType&&e,a=o&&o.exports===r,s=a?n.Buffer:void 0,u=s?s.isBuffer:void 0,c=u||i;e.exports=c}),Nd=Ar,qd=Rd,jd=Lr,Vd="[object Arguments]",Ud="[object Array]",Hd="[object Boolean]",Wd="[object Date]",zd="[object Error]",Gd="[object Function]",Kd="[object Map]",Yd="[object Number]",Xd="[object Object]",$d="[object RegExp]",Qd="[object Set]",Jd="[object String]",Zd="[object WeakMap]",ef="[object ArrayBuffer]",tf="[object DataView]",nf="[object Float32Array]",rf="[object Float64Array]",of="[object Int8Array]",af="[object Int16Array]",sf="[object Int32Array]",uf="[object Uint8Array]",cf="[object Uint8ClampedArray]",lf="[object Uint16Array]",df="[object Uint32Array]",ff={};ff[nf]=ff[rf]=ff[of]=ff[af]=ff[sf]=ff[uf]=ff[cf]=ff[lf]=ff[df]=!0,ff[Vd]=ff[Ud]=ff[ef]=ff[Hd]=ff[tf]=ff[Wd]=ff[zd]=ff[Gd]=ff[Kd]=ff[Yd]=ff[Xd]=ff[$d]=ff[Qd]=ff[Jd]=ff[Zd]=!1;var hf=Nt,vf=qt,pf=e(function(e,t){var n=rr,i=t&&!t.nodeType&&t,r=i&&!0&&e&&!e.nodeType&&e,o=r&&r.exports===i,a=o&&n.process,s=function(){try{return a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}),mf=hf,gf=vf,yf=pf,_f=yf&&yf.isTypedArray,bf=_f?gf(_f):mf,wf=bf,kf=Bl,Sf=_d,Ef=Cd,Tf=nr,xf=Dd,Af=Bd,Lf=Ll,Pf=wf,Cf="[object Map]",Of="[object Set]",Rf=Object.prototype,If=Rf.hasOwnProperty,Mf=jt,Df=["quality","volume","captions"],Ff=null,Bf=window.WeakMap||function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+(t++ +"__")};return n.prototype.set=function(t,n){if("object"!==("undefined"==typeof t?"undefined":Zu(t))&&"function"!=typeof t)throw new TypeError("Invalid value used as weak map key");var i=t[this.name];return i&&i[0]===t?i[1]=n:e(t,this.name,{value:[t,n],writable:!0}),this},n.prototype.get=function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},n.prototype.delete=function(e){var t=e[this.name];return!(!t||t[0]!==e)&&(t[0]=t[1]=void 0,!0)},n.prototype.has=function(e){var t=e[this.name];return!!t&&t[0]===e},n}(),Nf="function"==typeof Au&&"symbol"==typeof Au.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Au&&e.constructor===Au&&e!==Au.prototype?"symbol":typeof e},qf=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},jf=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Vf=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},Uf=function e(t,n,i){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,n,i)}if("value"in r)return r.value;var a=r.get;if(void 0!==a)return a.call(i)},Hf=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},Wf=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},zf=function e(t,n,i,r){var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var a=Object.getPrototypeOf(t);null!==a&&e(a,n,i,r)}else if("value"in o&&o.writable)o.value=i;else{var s=o.set;void 0!==s&&s.call(r,i)}return i},Gf=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Au.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Au.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Kf=function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Ws(e)},TelecineError=function TelecineError(e,t){qf(this,TelecineError),this.name=e,this.message=t,Object.freeze(this)},Yf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,e),this._telecine=t,this._element=t._element,this._options=n}return jf(e,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}]),jf(e,[{key:"activate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the activate method.")}},{key:"deactivate",value:function(){throw new TelecineError("NotImplemented","The effect must implement the deactivate method.")}}]),e}();Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){for(var t=Object(this),n=t.length>>>0,i=arguments[1],r=0;r<n;){var o=t[r];if(e.call(i,o,r,t))return o;r++}}});var Xf=navigator.userAgent.toLowerCase(),$f=!!Xt("android")&&(parseFloat(Xf.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Qf=window.devicePixelRatio||1,Jf=!(!Xt("windows phone")&&!Xt("iemobile"))&&(parseFloat(Xf.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Zf=!!Xt("msie")&&parseFloat(Xf.replace(/^.*msie (\d+).*$/,"$1")),eh=!!Xt("trident")&&parseFloat(Xf.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,th=!!(Xt("ipad;")||Xt("iphone;")||Xt("ipod touch;"))&&parseFloat(Xf.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")),nh=Xt("safari")&&Xt("apple")&&!Xt("chrome")&&!Xt("android")&&11==Zt()[0],ih={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:$f,hasAutoplayPolicy:$f||th||nh||en()[0]>=66,iOS:th,mobileAndroid:$f&&Xt("mobile"),browser:{bb10:Xt("bb10"),chrome:Xt("chrome"),firefox:Xt("firefox"),ie:Zf||eh,edge:Xt("edge"),opera:Xt("opera"),safari:Xt("safari")&&Xt("apple")&&!Xt("chrome")&&!Xt("android")},devicePixelRatio:Qf,flash:Qt(),iPhone:Xt("iphone;")||Xt("ipod touch;")||Xt("ipod;"),iPad:Xt("ipad;"),iPadNonRetina:Xt("ipad;")&&Qf<2,mac:Xt("mac os"),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Xt("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:$t("transform"),transitionProperty:$t("transition"),windowsPhone:Jf},rh=/mac os x 10_13/.test(Xf),oh=ih.iOS&&/os 11/.test(Xf),ah=ih.iPhone&&812===window.screen.availHeight&&375===window.screen.availWidth,sh=ih.iPad&&(1024===window.screen.availHeight&&1366===window.screen.availWidth||1112===window.screen.availHeight&&834===window.screen.availWidth);ih.hevc=tn(),ih.hdr=nh&&oh&&(ah||sh),ih.vp9hdr=Jt(),ih.spatialPlayback=nn(),ih.stereoscopic=ih.spatialPlayback&&ih.mobileAndroid;var uh=/Firefox/.test(navigator.userAgent),ch=/i(Phone|Pad|Pod touch);/.test(navigator.userAgent),lh=/Android/.test(navigator.userAgent),dh=lh&&/mobile/.test(navigator.userAgent.toLowerCase()),fh=function(){var e=/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./,t=navigator.userAgent.match(e);return!!t&&{major:t[1],minor:t[2]}}(),hh={firefox:uh,iOS:ch,android:lh,androidMobile:dh,chrome:fh},vh=function(e){for(var t=0,n=this.length;t<n;t++)if(this[t].id===""+e)return this[t];return null},ph=function(e,t){if(!e||void 0===e[t])throw on(1,"INDEX_SIZE_ERR");return e[t]};yn.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");for(var t=[],n=[],i=0,r=e.length;i<r;i++)t.push(e.start(i)),n.push(e.end(i));return yn(t,n)};var mh={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},gh={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},yh={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},_h={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",STREAM_CHANGE:"streamchange",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",PRESENTATION_MODE_CHANGE:"presentationmodechange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",AV_DURATION_MISMATCH:"avdurationmismatch"},bh={EVENT_PENDING:"liveeventpending",EVENT_ACTIVE:"liveeventactive",EVENT_STARTING:"liveeventstarting",EVENT_STARTED:"liveeventstarted",EVENT_ENDED:"liveeventended",ARCHIVE_STARTED:"livearchivestarted",ARCHIVE_DONE:"livearchivedone",ARCHIVE_ERROR:"livearchiveerror",STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",REPRESENTATIONS_AVAILABLE:"liverepresentationsavailable"},wh={CAMERA_UPDATE:"cameraupdate",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported"},kh={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Sh=Object.assign({},mh,gh,yh,_h,wh,bh,kh),Eh=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,e),this._element=t,this._options=i,this._telecineVideo=null,this._currentFile=null,this._externalDisplays=[],rn(this),this.on("play",function(){return n._initMediaSession()})}return jf(e,null,[{key:"displayName",get:function(){return"Scanner"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[]}},{key:"supportsSettingVolume",get:function(){return!0}},{key:"supportsTextTracks",get:function(){return!1}},{key:"supportsPlaybackRate",get:function(){return!1}}]),jf(e,[{key:"deactivate",value:function(){this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate"))}},{key:"reactivate",value:function(){}},{key:"play",value:function(){return Vi.reject(new TelecineError("NotImplemented","The scanner must implement the play method."))}},{key:"pause",value:function(){throw new TelecineError("NotImplemented","The scanner must implement the pause method.")}},{key:"addTextTrack",value:function(e){return this}},{key:"removeTextTrack",value:function(e){return this}},{key:"getCuesForTrack",value:function(e){return[]}},{key:"getActiveCuesForTrack",value:function(e){return[]}},{key:"setModeForTrack",value:function(e,t){return this}},{key:"setSrcForTrack",value:function(e,t){return this}},{key:"addCuePoint",value:function(e){arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this scanner.")}},{key:"removeCuePoint",value:function(e){return!1}},{key:"removeAllCuePoints",value:function(){return!1}},{key:"showExternalDisplayPicker",value:function(e){if(!this._externalDisplays.length)throw new TelecineError("ExternalDisplayUnvailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();var t=this._externalDisplays.filter(function(t){return t.constructor.displayName.replace("ExternalDisplay","")===e})[0];if(!t)throw new TelecineError("InvalidExternalDisplay","The specified external display is not available.");t.showPicker()}},{key:"initDrm",value:function(){return!1}},{key:"_pickFile",value:function(){if(this._files.length<1)return null;var e=this._files.slice(0).sort(function(e,t){return e.priority-t.priority});return e[0]}},{key:"_updateCurrentFile",value:function(){var e=this._pickFile();return e?void(this.currentFile=e):void this.fire(_h.SCANNER_ERROR,{reason:"all files failed"})}},{key:"_switchToNextFile",value:function(){var e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()}},{key:"_initMediaSession",value:function(){var e=this;if("mediaSession"in navigator){var t={title:this._telecineVideo.title,artist:this._telecineVideo.subtitle,artwork:[]};this._telecineVideo.metadata.thumbnail&&t.artwork.push({src:this._telecineVideo.metadata.thumbnail}),navigator.mediaSession.metadata=new MediaMetadata(t),"function"==typeof navigator.mediaSession.setActionHandler&&(navigator.mediaSession.setActionHandler("play",function(){e.play(),e.fire(kh.MEDIASESSION_PLAY)}),navigator.mediaSession.setActionHandler("pause",function(){e.pause(),e.fire(kh.MEDIASESSION_PAUSE)}),navigator.mediaSession.setActionHandler("seekforward",function(){e.currentTime=Math.min(e.duration,e.currentTime+10),e.fire(kh.MEDIASESSION_SEEK_FORWARD)}),navigator.mediaSession.setActionHandler("seekbackward",function(){e.currentTime=Math.max(0,e.currentTime-10),e.fire(kh.MEDIASESSION_SEEK_BACKWARD)}))}}},{key:"buffered",get:function(){return yn()}},{key:"cuePoints",get:function(){return[]}},{key:"currentFile",get:function(){return this._currentFile},set:function(e){this._currentFile=e,this.fire(_h.CURRENT_FILE_CHANGE,e)}},{key:"currentTime",get:function(){return 0},set:function(e){}},{key:"duration",get:function(){return NaN}},{key:"ended",get:function(){return!1}},{key:"externalDisplayAvailable",get:function(){return this._externalDisplays.some(function(e){return e.available})}},{key:"externalDisplayActive",get:function(){return this._externalDisplays.some(function(e){return e.active})}},{key:"loop",get:function(){return!1},set:function(e){}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return!1},set:function(e){}},{key:"playsinline",get:function(){return!1},set:function(e){}},{key:"paused",get:function(){return!0}},{key:"defaultPlaybackRate",get:function(){return 1},set:function(e){}},{key:"playbackRate",get:function(){return 1},set:function(e){}},{key:"preload",get:function(){return"none"},set:function(e){}},{key:"presentationMode",get:function(){return"inline"},set:function(e){if(this.supportedPresentationModes.indexOf(e)===-1)throw new TelecineError("InvalidPresentationMode","The “"+e+"” presentation mode is not supported.")}},{key:"supportedPresentationModes",get:function(){return["inline"]}},{key:"video",get:function(){return this._telecineVideo},set:function(e){var t=this;if(this.reactivate(),this._telecineVideo!==e){if(this._telecineVideo&&(this._telecineVideo.off("filesrcupdate"),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=e,this._files=e.files.filter(function(e){return t.constructor.supportedVideoTypes.indexOf(e.mime)!==-1}),this._telecineVideo.on("filesrcupdate",function(e){e===t._currentFile&&t._updateCurrentFile()}),this._telecineVideo.on("texttracksrcupdate",function(e){t.video.currentScanner&&t.video.currentScanner.setSrcForTrack(e,e.src)}),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];var n=this.constructor.supportedExternalDisplays;Array.isArray(n)||(n=[]);var i=n.map(function(e){return e.displayName});this._options.externalDisplays.filter(function(e){return e.supported&&i.indexOf(e.displayName)!==-1}).forEach(function(n){var i=new n(e),r=n.displayName.replace("ExternalDisplay","");i.on(mh.LOADED_METADATA,function(e){return t.fire(mh.LOADED_METADATA,e)}),i.on("available",function(){return t.fire(gh.AVAILABLE,{type:r})}),i.on("unavailable",function(){return t.fire(gh.UNAVAILABLE,{type:r})}),i.on("activated",function(){"function"==typeof t.onexternaldisplayactivated&&t.onexternaldisplayactivated(i),t.fire(gh.ACTIVATED,{type:r})}),i.on("deactivated",function(){"function"==typeof t.onexternaldisplaydeactivated&&t.onexternaldisplaydeactivated(i),t.fire(gh.DEACTIVATED,{type:r})}),t._externalDisplays.push(i)})}this._updateCurrentFile()}}},{key:"videoWidth",get:function(){return 0}},{key:"videoHeight",get:function(){return 0}},{key:"volume",get:function(){return 1},set:function(e){}}]),e}(),Th=new Bf,xh=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,e);var i=parseFloat(t);if(isNaN(i))throw new TypeError("Time must be a number.");if(i<0)throw new TypeError("Time must be a positive number.");this.time=t,this.data=n,this.id=dn();try{var r="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new r(t,t+.25,JSON.stringify(n)),this.vttCue.id=this.id}catch(e){throw new TelecineError("CuePointsNotSupported","Cue points are not supported in this browser.")}Th.set(this.vttCue,this),Object.freeze(this)}return jf(e,null,[{key:"fromVTTCue",value:function(t){if(Th.has(t))return Th.get(t);var n={};try{n=JSON.parse(t.text)}catch(e){}return new e(t.startTime,n)}}]),e}(),Ah=function(){function e(t){var n=this;qf(this,e),this._interval=null,this._rates=[],this._averageRate=0,this._lastChecked=null,this._lastLoaded=0,this._scanner=t,this._scanner.on("loadstart",function(){return n.startInterval()}),this._scanner.on("progress",function(){return n.startInterval()}),this._scanner.on("ended",function(){return n.stopInterval()})}return jf(e,[{key:"startInterval",value:function(){var e=this;this._interval||(this._interval=window.setInterval(function(){return e.updateDownloadRate()},1e3))}},{key:"stopInterval",value:function(){window.clearInterval(this._interval)}},{key:"updateDownloadRate",value:function(){for(var e=ln(),t=0,n=this._scanner.buffered,i=Array.isArray(n),r=0,n=i?n:n[Au.iterator]();;){var o;if(i){if(r>=n.length)break;o=n[r++]}else{if(r=n.next(),r.done)break;o=r.value}var a=o,s=Gf(a,2),u=s[0],c=s[1];t+=c-u}if(!this._lastChecked)return this._lastChecked=e,void(this._lastLoaded=t);if(this._lastLoaded!==t){var l=Math.max(t-this._lastLoaded,0);this._rates.push(l),this._rates=this._rates.slice(-15),this._averageRate=this._rates.reduce(function(e,t){return e+t})/this._rates.length,this._lastChecked=e,this._lastLoaded=t,Math.round(t)>=Math.round(this._scanner.duration)&&this.stopInterval()}}},{key:"averageDownloadRate",get:function(){return this._averageRate}}]),e}(),Lh=function(){function e(t){qf(this,e),this._available=!1,this._active=!1,this._video=t,rn(this)}return jf(e,null,[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}]),jf(e,[{key:"showPicker",value:function(){}},{key:"getFile",value:function(){var e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles[e])return this._video.externalDisplayFiles[e];var t=this.constructor.supportedVideoTypes,n=this._video.files.filter(function(e){return t.indexOf(e.mime)!==-1}).sort(function(e,n){return e.mime===n.mime?e.priority-n.priority:t.indexOf(e.mime)-t.indexOf(n.mime)});if(!n.length)throw new Error("No files available for "+this.constructor.displayName+" external display.");return n[0]}},{key:"active",get:function(){return this._active}},{key:"available",get:function(){return this._available}},{key:"element",get:function(){return document.createElement("div")}}]),e}(),AirPlayExternalDisplay=function(e){function AirPlayExternalDisplay(e){qf(this,AirPlayExternalDisplay);var t=Wf(this,(AirPlayExternalDisplay.__proto__||Object.getPrototypeOf(AirPlayExternalDisplay)).call(this,e));return t._videoElement=document.createElement("video"),t._videoElement.setAttribute("data-airplay",""),t._videoElement.setAttribute("x-webkit-airplay","allow"),t.addVideoEventListeners(),t}return Hf(AirPlayExternalDisplay,e),jf(AirPlayExternalDisplay,null,[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}]),jf(AirPlayExternalDisplay,[{key:"addVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._videoElement;t.addEventListener(mh.LOADED_METADATA,function(t){e.fire(mh.LOADED_METADATA,t)}),t.addEventListener("webkitplaybacktargetavailabilitychanged",function(t){switch(t.availability){case"available":e._available||(e._available=!0,e.fire(yh.AIRPLAY_AVAILABLE));break;case"not-available":e._available&&(e._available=!1,e.fire(yh.AIRPLAY_UNAVAILABLE))}}),t.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",function(t){return t.target.webkitCurrentPlaybackTargetIsWireless?(e._active=!0,void e.fire(yh.AIRPLAY_ACTIVATED)):(e._active=!1,void e.fire(yh.AIRPLAY_DEACTIVATED))})}},{key:"showPicker",value:function(){var e=this;this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then(function(){return e._videoElement.webkitShowPlaybackTargetPicker()}).catch(function(){})}},{key:"loadMetadata",value:function(){var e=this;return this._videoElement.readyState>=1?Vi.resolve():new Vi(function(t,n){e._videoElement.addEventListener(mh.LOADED_METADATA,function(){t()}),e._videoElement.src=e.getFile().src})}},{key:"element",get:function(){return this._videoElement},set:function(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.addVideoEventListeners(e),this._videoElement=e,this._videoElement.setAttribute("x-webkit-airplay","allow"))}}]),AirPlayExternalDisplay}(Lh),Ph=document.createElement("video"),Ch={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},Oh=function(){var e="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}(),Rh=function(){var e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}(),Ih=new Bf,Mh=0,Dh=1,Fh=2,Bh=3,Nh=4,qh=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=e.querySelector("video");return r||(r=document.createElement("video"),r.preload="none",i._element.appendChild(r)),i._video=r,n.htmlScanner&&n.htmlScanner.controls&&(i._video.controls=!0),i._boundHandleVideoEvent=i.handleVideoEvent.bind(i),i.addVideoEventListeners(),i._downloadRate=new Ah(i),i._bufferTimer=null,i._readyState=Mh,i._paused=!0,i._preload="none",i._externalDisplayActivated=!1,i._inFullscreen=!1,i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supported",get:function(){return t.supportedVideoTypes.length>0}},{key:"supportedVideoTypes",get:function(){var e=[];if("function"!=typeof Ph.canPlayType)return e;for(var t in Ch){var n=Ch[t];ih.android&&"application/vnd.apple.mpegurl"===t||(ih.android&&!ih.mobileAndroid&&"video/mp4"===t&&ih.android instanceof String?parseInt(ih.android.split(".")[0],10)>3&&e.push(t):Ph.canPlayType(n).replace(/^no$/,"")&&e.push(t))}return e}},{key:"supportedExternalDisplays",get:function(){return[AirPlayExternalDisplay]}},{key:"supportsSettingVolume",get:function(){if(ih.android)return!1;var e=Ph.volume;return Ph.volume=.5*e,Ph.volume!==e}},{key:"supportsTextTracks",get:function(){return"undefined"!=typeof Ph.textTracks&&Ph.textTracks instanceof TextTrackList}},{key:"supportsPlaybackRate",get:function(){if(ih.android&&hh.chrome&&hh.chrome.major<52)return!1;var e=Ph.playbackRate;Ph.playbackRate=.5*e;var t=e!==Ph.playbackRate;return Ph.playbackRate=e,t}}]),jf(t,[{key:"deactivate",value:function(){Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactivate",this).call(this),this.removeVideoEventListeners(),this.removeSnapshot(),this._video.style.display="none"}},{key:"reactivate",value:function(){Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"reactivate",this).call(this),this.addVideoEventListeners(),this._video.style.display=""}},{key:"addVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._video;Object.keys(mh).forEach(function(n){var i=mh[n];t.addEventListener(i,e._boundHandleVideoEvent)})}},{key:"removeVideoEventListeners",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._video;Object.keys(mh).forEach(function(n){var i=mh[n];t.removeEventListener(i,e._boundHandleVideoEvent)})}},{key:"play",value:function(){var e=this;this._video.preload="",this._paused=!1;var t=this._video.play();return void 0!==t?t=t.catch(function(e){}):new Vi(function(t,n){e._video.addEventListener("playing",function(){return t()})})}},{key:"pause",value:function(){this._paused=!0,this._video.pause()}},{key:"addTextTrack",value:function(e){var n=this,i=document.createElement("track");i.id="telecine-track-"+e.id,i.src=e.src,i.kind=e.kind,i.srclang=e.language,i.label=e.label,i.addEventListener("cuechange",function(){return e.dispatchEvent("cuechange")}),this._video.addEventListener("timeupdate",function(){n._video.webkitDisplayingFullscreen&&(e.mode=i.track.mode)});var r=function(){var t=hh.iOS&&n._video.webkitDisplayingFullscreen;return e._modeHasBeenSet&&!t?void(i.track.mode=Oh[e.mode]):void(e.mode=i.track.mode)},o=[];if(i.addEventListener("load",r),["loadeddata","seeking"].forEach(function(e){n._video.addEventListener(e,r),o.push([e,r])}),e._modeHasBeenSet&&(i.track.mode=Oh[e.mode]),!Rh){var a=[],s=function(){var t=i.track;if(t&&"disabled"!==Oh[t.mode]){if(a.length!==t.activeCues.length)return e.dispatchEvent("cuechange"),void(a=Ws(t.activeCues));for(var n=0,r=t.activeCues.length;n<r;n++)if(t.activeCues[n].startTime!==a[n].startTime)return e.dispatchEvent("cuechange"),void(a=Ws(t.activeCues))}};this._video.addEventListener("timeupdate",s),o.push(["timeupdate",s])}return pn(function(){return n._video.appendChild(i)}),Ih.set(e,o),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"addTextTrack",this).call(this,e)}},{key:"removeTextTrack",value:function(e){var n=this,i=this._video.querySelector("#telecine-track-"+e.id);i&&this._video.removeChild(i);var r=Ih.get(e);return Array.isArray(r)&&r.forEach(function(e){var t=Gf(e,2),i=t[0],r=t[1];n._video.removeEventListener(i,r)}),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"removeTextTrack",this).call(this,e)}},{key:"getCuesForTrack",value:function(e){var n=this.getTrackById("telecine-track-"+e.id);return n?Ws(n.cues):Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getCuesForTrack",this).call(this,e)}},{key:"getActiveCuesForTrack",value:function(e){var n=this.getTrackById("telecine-track-"+e.id);return n?Ws(n.activeCues):Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getActiveCuesForTrack",this).call(this,e)}},{key:"setModeForTrack",value:function(e,n){var i=this.getTrackById("telecine-track-"+e.id);return i&&i.mode!==Oh[n]&&(i.mode=Oh[n],Rh||"disabled"===n||e.dispatchEvent("cuechange")),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setModeForTrack",this).call(this,e,n)}},{key:"setSrcForTrack",value:function(e,n){var i=this._video.querySelector("#telecine-track-"+e.id);return i&&null===i.track.cues&&(i.src=n),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setSrcForTrack",this).call(this,e,n)}},{key:"addCuePoint",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",function(e){[].concat(Kf(e.target.activeCues)).forEach(function(e){t.fire(_h.CUE_POINT,xh.fromVTTCue(e))})})),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");var i=new xh(e,n);return this._cuePointTrack.addCue(i.vttCue),i}},{key:"removeCuePoint",value:function(e){if(!e)throw new TelecineError("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0}},{key:"removeAllCuePoints",value:function(){var e=this;return this._cuePointTrack&&this._cuePointTrack.length&&[].concat(Kf(this._cuePointTrack.cues)).forEach(function(t){e._cuePointTrack.removeCue(t)}),!0}
},{key:"oncanplay",value:function(){return!1}},{key:"oncanplaythrough",value:function(){return!1}},{key:"onerror",value:function(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this.fire(mh.ERROR,new TelecineError("MediaSrcNotSupportedError","The media was not suitable.")),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return this.fire(mh.ERROR,new TelecineError("MediaDecodeError","The media could not be decoded.")),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_NETWORK:return this.fire(mh.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")),!1;case this._video.error.MEDIA_ERR_ABORTED:return this.fire(mh.ERROR,new TelecineError("MediaAbortedError","The user agent aborted the fetching of the media.")),!1;default:return this.fire(mh.ERROR,new TelecineError("MediaUnknownError","An unknown error occurred.")),!1}}},{key:"onloadedmetadata",value:function(){this.readyState=Dh}},{key:"onloadeddata",value:function(){this.readyState=Fh}},{key:"onsuspend",value:function(){this.updateReadyState()}},{key:"onplay",value:function(){return this._ignorePlayEvent?(this._ignorePlayEvent=!1,!1):void(("picture-in-picture"===this.presentationMode||"fullscreen"===this.presentationMode||this._inFullscreen)&&(this._paused=!1))}},{key:"onpause",value:function(){return window.clearTimeout(this._bufferTimer),this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):void(("picture-in-picture"===this.presentationMode||"fullscreen"===this.presentationMode||this._inFullscreen)&&(this._paused=!0))}},{key:"onended",value:function(){if(this._paused=!0,this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1}},{key:"onprogress",value:function(){this.updateReadyState()}},{key:"ontimeupdate",value:function(){var e=this,t=cn(this.buffered,this.currentTime),n=Gf(t,2),i=n[1],r=1e3*(i-this.currentTime);if(!hh.firefox&&(r<.25&&this.currentTime+r<this.duration&&(this.readyState=Fh),window.clearTimeout(this._bufferTimer),!this.paused)){for(var o=0,a=this.buffered,s=Array.isArray(a),u=0,a=s?a:a[Au.iterator]();;){var c;if(s){if(u>=a.length)break;c=a[u++]}else{if(u=a.next(),u.done)break;c=u.value}var l=c,d=Gf(l,2),f=d[0],h=d[1];o+=h-f}o>=this.duration||(this._bufferTimer=window.setTimeout(function(){e._video.paused||e.readyState>Fh&&(e.readyState=Fh)},1500))}}},{key:"onwaiting",value:function(){return hh.firefox&&(this.readyState=Fh),!1}},{key:"onemptied",value:function(){this._readyState=Mh}},{key:"onseeked",value:function(){this.readyState<Fh&&(this.readyState=Fh),this.updateReadyState()}},{key:"onwebkitbeginfullscreen",value:function(){this._inFullscreen=!0}},{key:"onwebkitendfullscreen",value:function(){this._inFullscreen=!1,this._video.paused&&(this._paused=!0)}},{key:"onwebkitpresentationmodechanged",value:function(){switch(this._video.webkitPresentationMode){case"picture-in-picture":this._video.controls=!0;break;case"inline":var e=this._options.htmlScanner&&this._options.htmlScanner.controls;e||(this._video.controls=!1)}this.fire(_h.PRESENTATION_MODE_CHANGE,this._video.webkitPresentationMode)}},{key:"shouldHandleVideoEvent",value:function(e){return!0}},{key:"handleVideoEvent",value:function(e){e.target===this._video&&this.shouldHandleVideoEvent(e)!==!1&&("function"==typeof this["on"+e.type]&&this["on"+e.type](e)===!1||this.fire(e.type))}},{key:"swapVideo",value:function(e,t){var n=e.paused;this.removeVideoEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),t.currentTime=e.currentTime,n||t.play(),this.addVideoEventListeners(t),this._video=t}},{key:"onexternaldisplayactivated",value:function(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)}},{key:"onexternaldisplaydeactivated",value:function(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)}},{key:"setVideoSrc",value:function(e){this._video.src=e}},{key:"canSeekTo",value:function(e){var t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(var n=0,i=this._video.seekable.length;n<i;n++)if(this._video.seekable.start(n)<=e&&this._video.seekable.end(n)>=e)return!0;return!1}},{key:"seekToTime",value:function(e){var t=this;return this.canSeekTo(e)?(cn(this.buffered,e).length||(this.readyState=Dh),this._video.currentTime=e,Vi.resolve(this._video.currentTime)):new Vi(function(n,i){var r=function i(){t.canSeekTo(e)&&(Object.keys(mh).forEach(function(e){var n=mh[e];t._video.removeEventListener(n,i)}),cn(t.buffered,e).length||(t.readyState=Dh),t._video.currentTime=e,n(t._video.currentTime))};Object.keys(mh).forEach(function(e){var n=mh[e];t._video.addEventListener(n,r)})})}},{key:"takeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e||(e=document.createElement("canvas"),e.setAttribute("telecine-snapshot",""),this._element.appendChild(e)),e.setAttribute("width",this._element.clientWidth+"px"),e.setAttribute("height",this._element.clientHeight+"px"),e.style.display="";var t=mn(this._video.clientWidth,this._video.clientHeight,this._video.videoWidth,this._video.videoHeight),n=t.width,i=t.height,r=t.left,o=t.top;e.style.cssText="position:absolute;width:"+n+"px;height:"+i+"px;left:"+r+"px;top:"+o+"px";var a=e.getContext("2d");e.width>0&&e.height>0&&a.drawImage(this._video,0,0,e.width,e.height)}},{key:"removeSnapshot",value:function(){var e=this._element.querySelector("[telecine-snapshot]");e&&(e.style.display="none")}},{key:"getTrackById",value:function(e){if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);var t=document.getElementById(e);return t?t.track:null}},{key:"updateReadyState",value:function(){if(this.buffered.length){var e=this.duration-this.buffered.end(this.buffered.length-1),t=e/this._downloadRate.averageDownloadRate,n=this.duration-this.currentTime;if(isFinite(t)){var i=cn(this.buffered,this.currentTime),r=Gf(i,2),o=r[1],a=o-this.currentTime;t<n?this.readyState=Nh:this.readyState===Nh&&t>n?this.readyState=Bh:a>2&&(t<=n/2||a>10)&&(this.readyState=Bh)}}}},{key:"initDrm",value:function(){var e=this._telecineVideo.drmHandler;e&&e.init(this)}},{key:"buffered",get:function(){return yn.from(this._video.buffered)}},{key:"cuePoints",get:function(){return this._cuePointTrack?[].concat(Kf(this._cuePointTrack.cues)).map(function(e){return xh.fromVTTCue(e)}):Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"cuePoints",this)}},{key:"currentFile",get:function(){return Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",this)},set:function(e){var n=this,i=!this._video.paused,r=this.currentTime,o=!this._currentFile||e.video.id!==this._currentFile.video.id;if(o||this.takeSnapshot(),this._ignorePlayEvent=!1,this._ignorePauseEvent=!1,this._currentFile=e,o&&(this._video.preload=this._preload),this.constructor===t&&this._video.readyState>Mh&&(this._video.currentTime=0),(hh.iOS||ih.android)&&this._currentFile.video.title){var a=this._currentFile.video.title;this._currentFile.video.subtitle&&(a=a+" "+this._currentFile.video.subtitle),this._video.setAttribute("title",a)}else this._video.removeAttribute("title");this._readyState=Mh,this.setVideoSrc(this._currentFile.src,o),this.fire(_h.CURRENT_FILE_CHANGE,e),this.constructor!==t||o?i&&this.play():(this.seekToTime(r).then(function(e){return i&&n.play(),e}).catch(function(){}),this.once("canplay",function(){return n.removeSnapshot()}),this.once("playing",function(){return n.removeSnapshot()}))}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.seekToTime(e)}},{key:"duration",get:function(){return this._video.duration}},{key:"ended",get:function(){return this._video.ended}},{key:"loop",get:function(){return this._video.loop},set:function(e){this._video.loop=e}},{key:"muted",get:function(){return this._video.muted},set:function(e){this._video.muted=e}},{key:"playsinline",get:function(){return this._video.playsinline},set:function(e){this._video.playsinline=e,e?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}},{key:"paused",get:function(){return this._paused}},{key:"defaultPlaybackRate",get:function(){return this._video.defaultPlaybackRate},set:function(e){this._video.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._video.playbackRate},set:function(e){this._video.playbackRate=e}},{key:"preload",get:function(){return this._preload},set:function(e){this._video.preload=e,this._preload=e}},{key:"presentationMode",get:function(){return this._video.webkitPresentationMode?this._video.webkitPresentationMode:Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"presentationMode",this)},set:function(e){zf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"presentationMode",e,this),"function"==typeof this._video.webkitSetPresentationMode&&this._video.webkitSetPresentationMode(e)}},{key:"supportedPresentationModes",get:function(){var e=Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"supportedPresentationModes",this);return"function"==typeof this._video.webkitSupportsPresentationMode&&this._video.webkitSupportsPresentationMode("picture-in-picture")&&e.push("picture-in-picture"),e}},{key:"video",get:function(){return this._telecineVideo},set:function(e){var n=this;zf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"video",e,this),hh.iOS&&this._externalDisplays.forEach(function(e){"AirPlay"===e.constructor.displayName&&(e.element=n._video)}),this.initDrm()}},{key:"videoWidth",get:function(){return this._video.videoWidth}},{key:"videoHeight",get:function(){return this._video.videoHeight}},{key:"volume",get:function(){return this._video.volume},set:function(e){this._video.volume=e}},{key:"readyState",get:function(){return this._readyState},set:function(e){if(this._readyState!==e&&!(this._video.readyState===Dh&&e>Dh)){var t=this._readyState;this._readyState=e,t>=Bh&&e<=Fh&&(this.fire(mh.WAITING),this._video.paused||(this._ignorePauseEvent=!0,this._video.pause())),t<=Fh&&e===Bh&&(this.fire(mh.CAN_PLAY),this._paused===!1&&this.play()),e===Nh&&(t<=Fh&&(this.fire(mh.CAN_PLAY),this._paused===!1&&this._video.paused&&(this._ignorePlayEvent=!0,this.play())),this.fire(mh.CAN_PLAY_THROUGH))}}}]),t}(Eh),jh="function"==typeof Au&&"symbol"==typeof Au.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Au&&e.constructor===Au&&e!==Au.prototype?"symbol":typeof e},Vh=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},Uh=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),Hh=function(){function e(e,t){var n=[],i=!0,r=!1,o=void 0;try{for(var a,s=e[Au.iterator]();!(i=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);i=!0);}catch(e){r=!0,o=e}finally{try{!i&&s.return&&s.return()}finally{if(r)throw o}}return n}return function(t,n){if(Array.isArray(t))return t;if(Au.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),Wh=[],zh=[],Gh=[],Kh=[],Yh=100,Xh=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.retryCount,r=void 0===i?3:i,o=n.parallel,a=void 0===o?1:o,s=n.includeWithSpeeds,u=void 0===s||s;Vh(this,e),this._queue=[],this._activeXhrRequests=new Set,this._retries=new Bf,this._retryCount=r,this._running=!1,this._processingQueue=!1,this._parallel=a,this._includeWithSpeeds=u,this._pendingFetchMap=new Bf,Sn(this),window.addEventListener("online",function(){t.start()}),window.addEventListener("offline",function(){t.stop(),t.abort()})}return Uh(e,null,[{key:"getPercentileSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.8,n=Wh.slice(-e);return bn(n,t)}},{key:"getAverageSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Wh.slice(-e);return _n(n,t)}},{key:"getMedianSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=Wh.slice(-e);return wn(t)}},{key:"getResponseSpeeds",value:function(){return Wh}},{key:"getProgressSpeeds",value:function(){return Kh}},{key:"getAverageBitrate",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1/0,n=e.getTime()-t,i=[],r=[],o=Kh.length-1;o>=0;o--){var a=Kh[o];if(a.startTime<n)break;i.push(a.bitrate)}for(var s=0;i.length>s;s++)r.push(i.length-s);return _n(i,r)}},{key:"getFailedSegments",value:function(){return zh}},{key:"getSuccessfulSegments",value:function(){return Gh}},{key:"getTime",value:function(){return"undefined"!=typeof performance?performance.now():(new Date).getTime()}},{key:"calculateExponentialBackoff",value:function(e){return 500*Math.pow(2,e)+Math.round(1e3*Math.random())}}]),Uh(e,[{key:"add",value:function(e,t,n){return this._addSegmentToQueue(e,t,n),this._running&&!this._processingQueue&&this._processQueue(),this}},{key:"start",value:function(){return this._running?this:(this._running=!0,this._processQueue(),this)}},{key:"stop",value:function(){return this._running=!1,this}},{key:"abort",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=this._queue.filter(function(e){return!t||t===e[0].stream});n.forEach(function(t){var n=e._getIdentifierFromData(t),i=Hh(n,3),r=i[2];e.fire("downloadabort",r)}),this._queue=this._queue.filter(function(e){return t&&t!==e[0].stream}),this._activeXhrRequests.forEach(function(e){t&&t!==e.stream||e.abort()})}},{key:"_insertAtPosition",value:function(e,t){for(var n=0;n<this._queue.length;n++){var i=this._queue[n][0].priority;if(i>e.priority)break}this._queue.splice(n,0,[e,t])}},{key:"_addSegmentToQueue",value:function(e,t,n){return e.hasOwnProperty("priority")?void this._insertAtPosition(e,t):void this._queue[n?"unshift":"push"]([e,t])}},{key:"_processQueue",value:function(){if(this._running){this._processingQueue=!0;for(var e=this._parallel-this._activeXhrRequests.size,t=0;t<e;t++)this._fetchOne()}}},{key:"_retry",value:function(t,n,i){var r=this,o=n[0],a=n[1];if(this._retries.get(o)||this._retries.set(o,0),this._retries.set(o,this._retries.get(o)+1),this._retries.get(o)>this._retryCount)return void this._handleDownloadError(i,t.status,t.data.url,t.data.duration);var s=e.calculateExponentialBackoff(this._retries.get(o));setTimeout(function(){var e=!0;r.add(o,a,e)},s)}},{key:"_handleXHRResponse",value:function(e,t,n,i){return e.status>=500&&e.status<600?void this._retry(e,t,n):e.status>=400&&e.status<500?void this._handleDownloadError(n,e.status,e.data.url,e.data.duration):(this.fire("downloadend",n,{headers:kn(e.getAllResponseHeaders())}),Gh.push({url:e.data.url,status:e.status,duration:e.data.duration}),void i.call(this,new Uint8Array(e.response)))}},{key:"_handleDownloadError",value:function(e,t,n,i){zh.push({url:n,status:t,duration:i}),this.fire("downloaderror",e,t)}},{key:"_getIdentifierFromData",value:function(e){var t=e[1],n=e[0],i=n;return n.id&&(i=n.id),[n.url,n.byteRange,i,t]}},{key:"_continueProcessingQueue",value:function(){return 0===this._activeXhrRequests.size&&0===this._queue.length?void(this._processingQueue=!1):void(this._activeXhrRequests.size<this._parallel&&this._processQueue())}},{key:"_fetchOne",value:function(){var t=this;if(0===this._queue.length)return void(this._processingQueue=!1);var n=null,i=this._queue.shift(),r=this._getIdentifierFromData(i),o=Hh(r,4),a=o[0],s=o[1],u=o[2],c=o[3],l=i[0].includeWithBandwidthChecks,d=e.getTime(),f=new XMLHttpRequest;f.stream=i[0].stream,f.data={},f.data.url=a;var h=0,v=e.getTime(),p=0;f.addEventListener("progress",function(n){if(n.lengthComputable){var i=8*(n.loaded-h),r=e.getTime(),o=r-v,a=o/1e3,s=i/a,c={startTime:v,length:o,bitrate:s,index:p};p>0&&(Kh.length>=Yh&&Kh.shift(),Kh.push(c)),v=r,h=n.loaded,p+=1,t._pendingFetchMap.set(f,{bytesTotal:n.total,bytesLoaded:n.loaded,percent:n.loaded/n.total,identifier:u}),t.fire("progress",u)}}),f.open("GET",a,!0),f.responseType="arraybuffer",s&&f.setRequestHeader("Range","bytes="+s),f.onload=function(r){var o=Date.now()-n;f.data.duration=o,t._activeXhrRequests.delete(f),t._pendingFetchMap.delete(f);var a=(e.getTime()-d)/1e3,s=r.target.response.byteLength;if(s>40960){var h=8*s,v=h/a;Wh.length>100&&Wh.shift(),t._includeWithSpeeds&&l&&Wh.push(v)}t._handleXHRResponse(f,i,u,c),t._continueProcessingQueue()},f.onerror=function(){var e=Date.now()-n;f.data.duration=e,t._activeXhrRequests.delete(f),t._pendingFetchMap.delete(f),t._retry(f,i,u),t._continueProcessingQueue()},f.onabort=function(){var e=Date.now()-n;f.data.duration=e,zh.push({url:a,status:"abort",duration:e}),t._pendingFetchMap.delete(f),t._activeXhrRequests.delete(f),t.fire("downloadabort",u),0===t._activeXhrRequests.size&&0===t._queue.length&&(t._processingQueue=!1),t._continueProcessingQueue()},this.fire("downloadstart",u),this._activeXhrRequests.add(f),n=Date.now(),f.send()}},{key:"parallel",get:function(){return this._parallel},set:function(e){this._parallel=e}},{key:"pendingFetches",get:function(){var e=this,t=[];return this._activeXhrRequests.forEach(function(n){e._pendingFetchMap.get(n)&&t.push(e._pendingFetchMap.get(n))}),t}}]),e}(),$h=6,Qh=function(){function e(t){Vh(this,e),Sn(this),this._sorcerer=t,this._sourceBuffer=null,this._activeStreamIndex=null,this._needsStreamSwitch=!1,this._needInitSegment=!0,this._lastAppended=null,this._toRemove=[],this._streams=[],this._quotaExceeded=!1,this._quotaExceededTimer=null,this._appendingFinalSegment=!1,this._finalSegmentTime=void 0,this._addingInitSegment=!1,this._isFirstSegment=!0,this._bufferState={},this._sorcerer.on("durationset",this._onDurationSet.bind(this))}return Uh(e,[{key:"addStream",value:function(e){var t=this;e.on("segmentadd",function(){return t._process()});var n=this._streams.push(e)-1;e.index=n,null===this._activeStreamIndex&&(this._setActiveIndex(n),this._needsStreamSwitch=!0)}},{key:"streamIndexAtTime",value:function(e){return this._bufferState[void 0]?{stream:this.activeStreamIndex}:this._bufferState[Math.floor(e/$h)]}},{key:"switchTo",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e;"object"===("undefined"==typeof e?"undefined":jh(e))&&(i=e.index);var r=this._activeStreamIndex!==i,o=r;if(!r&&this._needsStreamSwitch&&(r=!0),r){this._needsStreamSwitch=!1;var a=this._activeStreamIndex,s=this._streams[a];s&&o&&n&&s.abort(),this._switchToIndex=i,this._setActiveIndex(i)}return this._process(),new Vi(function(e){return r?void(t._resolveSwitchComplete=function(){t._switchToIndex===i&&(t._resolveSwitchComplete=null,e(),t.fire("streamchange",i))}):void e()})}},{key:"isTimeInBuffer",value:function(e){for(var t=0;t<this.sourceBuffer.buffered.length;t++){var n=this.sourceBuffer.buffered.start(t),i=this.sourceBuffer.buffered.end(t);if(n<=e&&i>=e)return!0}return!1}},{key:"hasAppendedFinalSegment",value:function(){return void 0!==this._finalSegmentTime&&this.isTimeInBuffer(this._finalSegmentTime)}},{key:"clear",value:function(){this._streams.forEach(function(e){e.clear()})}},{key:"remove",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._sorcerer._mediaSource.duration;return new Vi(function(i,r){t._toRemove.push([e,n,i]),t._process()})}},{key:"_onDurationSet",value:function(){var e=this._sorcerer._mediaSource.duration,t=Math.floor(e/$h);t+=$h%e>1?1:0;for(var n=0;n<t;n++)this._bufferState[n]={stream:null,segment:n,type:"video"}}},{key:"_attachEvents",value:function(){var e=this;this.bound={handleUpdateEnd:this._handleUpdateEnd.bind(this)},this._sourceBuffer.addEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.on("endofstream",function(){e._handleUpdateEnd()}),this._sorcerer.on("ended",this.bound.handleEnded)}},{key:"_handleUpdateEnd",value:function(e){this._appendingFinalSegment&&(this._finalSegmentTime=this._sourceBuffer.buffered.end(this._sourceBuffer.buffered.length-1),this._sorcerer._fireStreamHasEnded(),this._appendingFinalSegment=!1),this._lastAppended&&(this.fire("appendbufferend",this._lastAppended),this._lastAppended=null,this._resolveSwitchComplete&&this._resolveSwitchComplete()),this._process()}},{key:"_removeEventListeners",value:function(){this.bound&&(this._sourceBuffer&&this._sourceBuffer.removeEventListener("updateend",this.bound.handleUpdateEnd),this._sorcerer.off("endofstream",this.bound.handleUpdateEnd),this._sorcerer.off("ended",this.bound.handleEnded))}},{key:"_setActiveIndex",value:function(e){this._needInitSegment=!0,this._activeStreamIndex=e,this._sorcerer._frameDropper.streamIndex=e}},{key:"_process",value:function(){var e=this,t=this._streams[this._activeStreamIndex];if(!this._sourceBuffer)return void this.on("sourcebufferattach",this._process);if(t&&"closed"!==this._sorcerer._mediaSource.readyState){var n=this._sourceBuffer;if(!n.updating){if(this._toRemove.length){var i=this._toRemove.shift(),r=Hh(i,3),o=r[0],a=r[1],s=r[2],u=this;n.addEventListener("updateend",function e(t){n.removeEventListener("updateend",e),s(),clearTimeout(u._quotaExceededTimer),u._quotaExceededTimer=setTimeout(function(){u._quotaExceeded=!1,u._process()},5e3)});var c=o;return void n.remove(c,a)}if(!this._quotaExceeded&&!this._addingInitSegment){if(this._needInitSegment)return this._addingInitSegment=!0,t.getInitSegment().then(function(t){return e._lastAppended=null,n.appendBuffer(t),e._addingInitSegment=!1,t}).catch(function(t){e._addingInitSegment=!1}),void(this._needInitSegment=!1);var l=t.getNextSegment();if(null!==l){var d=t.getIdForSegment(l),f=t.isFinal(l);f&&(this._appendingFinalSegment=!0),this._lastAppended=d,this.fire("appendbufferstart",d);try{n.appendBuffer(l),this._bufferState[d.segment]=d,this._isFirstSegment&&(this._isFirstSegment=!1,this.fire("initialbufferstart"))}catch(e){if("QuotaExceededError"===e.name){this._quotaExceeded=!0;var h=6;if(this._sorcerer._video.currentTime>h){var v=0,p=this._sorcerer._video.currentTime-h;this._sorcerer.removeBuffer(v,p)}t._readyToAppend.unshift(l)}}}}}}}},{key:"streams",get:function(){return this._streams}},{key:"activeStreamIndex",get:function(){return this._activeStreamIndex}},{key:"sourceBuffer",get:function(){return this._sourceBuffer},set:function(e){this._sourceBuffer=e,this._attachEvents(),this.fire("sourcebufferattach")}}]),e}(),Jh=function(){function e(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Xh;Vh(this,e),Sn(this),this._readyToAppend=[],this._initSegment=null,this._index=NaN,this._codec=i,this._fetcher=r,this._fetcher.start(),this._bufferData=new Bf,this._segmentToId={},this._getInitSegmentPromise=new Vi(function(i,r){return e.isValidSegmentUrl(t)?void n._fetcher.add({url:t.url||t,byteRange:t.byteRange,id:null,stream:n},function(e){n._initSegment=e,i(e)}):(n._initSegment=t,void i(t))})}return Uh(e,null,[{key:"isValidSegmentUrl",value:function(e){return"string"==typeof e||"string"==typeof e.url&&"string"==typeof e.byteRange}}]),Uh(e,[{key:"getIdForSegment",value:function(t){return e.isValidSegmentUrl(t)?this._segmentToId[t]:this._bufferData.get(t).id}},{key:"isFinal",value:function(e){return this._bufferData.get(e).final}},{key:"addSegment",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=i.identifier,o=void 0===r?null:r,a=i.isFinalSegment,s=void 0!==a&&a,u=i.loadOnly,c=void 0!==u&&u,l=i.priority,d=void 0===l?0:l,f=i.includeWithBandwidthChecks,h=void 0===f||f;return new Vi(function(i,r){return e.isValidSegmentUrl(t)?(n._segmentToId[t]=o||t,n.fire("queued",n.getIdForSegment(t)),void n._fetcher.add({url:t.url||t,byteRange:t.byteRange,id:n.getIdForSegment(t),stream:n,includeWithBandwidthChecks:h,priority:d},function(e){n._bufferData.set(e,{id:o||t,final:s}),n._readyToAppend.push(e),n.fire("bufferqueueadd",n.getIdForSegment(t)),c||n.fire("segmentadd"),i()})):(n._bufferData.set(t,{id:o,final:s}),n._readyToAppend.push(t),n.fire("bufferqueueadd",o),void i())})}},{key:"clear",value:function(){this._readyToAppend=[]}},{key:"abort",value:function(){var e=this;this._getInitSegmentPromise.then(function(){e._fetcher.abort(e)}).catch(function(e){})}},{key:"getNextSegment",value:function(){return 0===this._readyToAppend.length?null:this._readyToAppend.shift()}},{key:"getInitSegment",value:function(){return this._getInitSegmentPromise}},{key:"codec",get:function(){return this._codec},set:function(e){this._codec=e}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"pendingFetches",get:function(){return this._fetcher.pendingFetches}}]),e}(),Zh=function(){function e(t){Vh(this,e),this._video=t,this._running=!1,this._droppedFramesTimeout=null,this._droppedFrameData={},this._decodedFrameData={},this._droppedFrames=0,this._decodedFrames=0,this._streamIndex="default",this.bound={startCheckingDroppedFrames:this._startCheckingDroppedFrames.bind(this),stopCheckingDroppedFrames:this._stopCheckingDroppedFrames.bind(this)}}return Uh(e,[{key:"start",value:function(){return this._startCheckingDroppedFrames(),this}},{key:"stop",value:function(){return this._stopCheckingDroppedFrames(),this}},{key:"destroy",value:function(){this._stopCheckingDroppedFrames(),this._removeEvents()}},{key:"getDroppedFrameRate",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average",i=this._droppedFrameData[t];if(!i)return 0;if(i.length<e)return 0;var r=i.slice(-e);return"median"===n?wn(r):_n(r)}},{key:"getDroppedFrameTotal",value:function(){return{dropped:this._getTotalDroppedFrames(),total:this._getTotalFrames()}}},{key:"_attachEvents",value:function(){this._video.addEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.addEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.addEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_removeEvents",value:function(){this._video.removeEventListener("playing",this.bound.startCheckingDroppedFrames),this._video.removeEventListener("pause",this.bound.stopCheckingDroppedFrames),this._video.removeEventListener("ended",this.bound.stopCheckingDroppedFrames)}},{key:"_startCheckingDroppedFrames",value:function(){this._running=!0,this._checkDroppedFrames()}},{key:"_stopCheckingDroppedFrames",value:function(){this._running=!1}},{key:"_checkDroppedFrames",value:function(){var e=this;if(this._running&&null!==this._streamIndex){clearTimeout(this._droppedFramesTimeout);var t=this._getTotalDroppedFrames(),n=t-this._droppedFrames;this._droppedFrames=t;var i=this._getTotalDecodedFrames(),r=i-this._decodedFrames;this._decodedFrames=i,this._droppedFrameData[this._streamIndex]||(this._droppedFrameData[this._streamIndex]=[]),this._decodedFrameData[this._streamIndex]||(this._decodedFrameData[this._streamIndex]=[]),this._droppedFrameData[this._streamIndex].length>100&&this._droppedFrameData[this._streamIndex].shift(),this._decodedFrameData[this._streamIndex].length>100&&this._decodedFrameData[this._streamIndex].shift(),this._droppedFrameData[this._streamIndex].push(n),this._decodedFrameData[this._streamIndex].push(r),this._droppedFramesTimeout=setTimeout(function(){e._checkDroppedFrames()},1e3)}}},{key:"_getTotalDroppedFrames",value:function(){return"function"==typeof this._video.getVideoPlaybackQuality?this._video.getVideoPlaybackQuality().droppedVideoFrames:this._video.webkitDroppedFrameCount||0}},{key:"_getTotalFrames",value:function(){return"function"==typeof this._video.getVideoPlaybackQuality?this._video.getVideoPlaybackQuality().totalVideoFrames:this._video.webkitDecodedFrameCount||0}},{key:"_getTotalDecodedFrames",value:function(){if("function"==typeof this._video.getVideoPlaybackQuality){var e=this._video.getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames-e.corruptedVideoFrames}return this._video.webkitDecodedFrameCount||0}},{key:"streamIndex",get:function(){return this._streamIndex},set:function(e){this._streamIndex=e}}]),e}(),ev=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Vh(this,e),this._video=t,this._options=n,Sn(this),this._options.duration&&(this._options.duration=Math.ceil(100*this._options.duration)/100),this._bufferCount=0,this._frameDropper=new Zh(t),this._mediaSource=new MediaSource,this._fetcher=new Xh({parallel:1}),this._video.src=URL.createObjectURL(this._mediaSource),this._buffersForCodec={},this._readyPromiseResolve=null,this._attachEvents()}return Uh(e,[{key:"switchTo",value:function(e){return 1===this._bufferCount&&this.video.switchTo(e)}},{key:"getCurrentSpeed",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.type,n=void 0===t?"average":t,i=e.howMany,r=void 0===i?10:i,o=e.weights,a=void 0===o?[]:o,s=e.percentile,u=void 0===s?null:s;return"average"===n?Xh.getAverageSpeed(r,a):"median"===n?Xh.getMedianSpeed(r):Xh.getPercentileSpeed(r,u)}},{key:"getAverageDownloadBitrate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return Xh.getAverageBitrate(e)}},{key:"getResponseSpeeds",value:function(){return Xh.getResponseSpeeds()}},{key:"getFailedSegments",value:function(){return Xh.getFailedSegments()}},{key:"getSuccessfulSegments",value:function(){return Xh.getSuccessfulSegments()}},{key:"getDroppedFrameRate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeStreamIndex,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"average";return this._frameDropper.getDroppedFrameRate(e,t,n)}},{key:"getDroppedFrameTotal",value:function(){return this._frameDropper.getDroppedFrameTotal()}},{key:"clear",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e].clear()}},{key:"streamIndexAtTime",value:function(e,t){return this._buffersForCodec[t].streamIndexAtTime(e)?this._buffersForCodec[t].streamIndexAtTime(e).stream:null}},{key:"removeBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._video.duration;if(e>t)return Vi.resolve();var n=[];for(var i in this._buffersForCodec)n.push(this._buffersForCodec[i].remove(e,t));return Vi.all(n)}},{key:"addStream",value:function(e,t){var n=this,i=this._getCodecType(e);if(!this._buffersForCodec[i]){this._bufferCount+=1;var r=new Qh(this,i);this._buffersForCodec[i]=r,this.readyPromise.then(function(){var t=void 0;try{t=n._mediaSource.addSourceBuffer(e)}catch(e){if(22!==e.code)return void n.fire("srcnotsupported",e);t=n._buffersForCodec[i]}n._options.duration&&(t.appendWindowEnd=n._options.duration),r.sourceBuffer=t}).catch(function(e){}),["appendbufferstart","appendbufferend","streamchange","initialbufferstart"].forEach(function(e){r.on(e,function(t){n.fire(e,t)})})}var o=new Jh(t,e,this._fetcher);return["queued","bufferqueueadd"].forEach(function(e){o.on(e,function(t){n.fire(e,t)})}),this._buffersForCodec[i].addStream(o),o}},{key:"destroy",value:function(){this.clear(),this._removeEventListeners(),this._frameDropper.destroy(),this._fetcher.abort(),this._video.src&&URL.revokeObjectURL(this._video.src)}},{key:"_attachEvents",value:function(){var e=this;this.bound={handleSourceOpen:this._handleSourceOpen.bind(this)},this.readyPromise=new Vi(function(t,n){e._readyPromiseResolve=t,e._mediaSource.addEventListener("sourceopen",e.bound.handleSourceOpen)}),["downloadstart","downloadend","downloadabort","downloaderror","progress"].forEach(function(t){e._fetcher.on(t,function(){for(var n=arguments.length,i=Array(n),r=0;r<n;r++)i[r]=arguments[r];e.fire.apply(e,[t].concat(i));
})})}},{key:"_sourceBuffersAreUpdating",value:function(){for(var e=0;e<this._mediaSource.sourceBuffers.length;e++)if(this._mediaSource.sourceBuffers[e].updating)return!0;return!1}},{key:"_fireStreamHasEnded",value:function(){for(var e in this._buffersForCodec){var t=this._buffersForCodec[e];if(!t.hasAppendedFinalSegment())return}"open"===this._mediaSource.readyState&&(this._sourceBuffersAreUpdating()||(this._mediaSource.endOfStream(),this.fire("endofstream")))}},{key:"_handleSourceOpen",value:function(){this._options.duration&&(this._mediaSource.duration=this._options.duration,this.fire("durationset")),this._readyPromiseResolve(),this._mediaSource.removeEventListener("sourceopen",this.bound.handleSourceOpen)}},{key:"_removeEventListeners",value:function(){for(var e in this._buffersForCodec)this._buffersForCodec[e]._removeEventListeners()}},{key:"_getCodecType",value:function(e){return 0===e.indexOf("audio")?"audio":"video"}},{key:"mediaSource",get:function(){return this._mediaSource}},{key:"streams",get:function(){return 1===this._bufferCount&&this.video.streams}},{key:"activeStreamIndex",get:function(){return 1===this._bufferCount&&this.video.activeStreamIndex}},{key:"video",get:function(){return!!this._buffersForCodec.video&&this._buffersForCodec.video}},{key:"audio",get:function(){return!!this._buffersForCodec.audio&&this._buffersForCodec.audio}}]),e}(),tv=function(){function e(t){qf(this,e),this.scanner=t}return jf(e,null,[{key:"displayName",get:function(){return"Brain"}}]),jf(e,[{key:"shouldPowerUp",value:function(e,t){return!1}},{key:"shouldPowerDown",value:function(e,t){return!1}},{key:"canPowerUp",value:function(e,t){return 1!==e.length&&t<e.length-1}},{key:"canPowerDown",value:function(e,t){return 1!==e.length&&t>0}},{key:"filterStreams",value:function(e){return e}}]),e}(),nv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._options=n,i.blacklisted=[],i.whitelisted=[],i.MAX_LOADABLE_SEGMENTS_AUTO=3,i.MAX_LOADABLE_SEGMENTS_LOCKED=15,i.BANDWIDTH_THRESHOLD=.85,i.SEGMENT_DURATION=6,i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"Skyfire"}}]),jf(t,[{key:"shouldPowerUp",value:function(e,t,n){n&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_THRESHOLD=this._options.startingBandwidthThreshold);var i=e.indexOf(t);if(i===-1&&(i=0),!this.canPowerUp(e,i))return!1;var r=this.getCurrentSpeed();if(!r)return!1;var o=this._getStreamFromSpeed(r,this.BANDWIDTH_THRESHOLD,e);return o!==i&&o}},{key:"shouldPowerDown",value:function(e,t){var n=e.indexOf(t),i=n===-1;if(i)return e.length-1;if(!this.canPowerDown(e,n))return!1;var r=this.getCurrentSpeed();if(!r)return!1;if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return n-1;var o=this._getStreamFromSpeed(r,.9,e);return o!==n&&o}},{key:"hasTooManyDroppedFrames",value:function(e,t,n){var i=10,r=this.scanner.sorcerer.getDroppedFrameRate(i,e,"median"),o=t.framerate,a=r/o*100;return a>=n&&(this.blacklist(e),!0)}},{key:"isTimeInBuffer",value:function(e){var t=this.scanner._video;return this._timesAreInRange(e,e,t.buffered)}},{key:"getCurrentSpeed",value:function(){if(this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group)return this.scanner.downloadSpeed;var e=3,t=[1,2,5];return this.scanner.sorcerer.getCurrentSpeed({type:"average",howMany:e,weights:t})}},{key:"getDistanceFromBuffer",value:function(e){for(var t=e,n=this.scanner._video,i=0;i<n.buffered.length;i++)if(n.buffered.start(i)<=e&&n.buffered.end(i)>=e){t=n.buffered.end(i);break}return t-e}},{key:"getTimeEstimateToLoad",value:function(e,t){if(null===t)return 3;var n=t.segments[e],i=n.end-n.start,r=this.getCurrentSpeed(),o=i*(t.bitrate+t.audioBitrate)/r;return 1.3*o}},{key:"canPlayFromTimeInStream",value:function(e,t){if(!this.isTimeInBuffer(e))return!1;if(!t)return!1;var n=this.getSegmentsToLoad(!1,"video",t);if(0===n.length)return!0;var i=this.getDistanceFromBuffer(e);return this.getTimeEstimateToLoad(n[0],t)<i}},{key:"getSegmentsToLoad",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",n=arguments[2],i=this.scanner._video,r=this.scanner.currentTime,o=[],a=this._getSecondsToLoadAhead(r,i.duration,n),s=r+a,u=this.scanner.sorcerer[t].activeStreamIndex,c=this.scanner._streams[t][u],l=this.scanner.sorcerer[t].sourceBuffer,d=null;l&&(d=l.buffered);for(var f=0;f<c.segments.length;f++){var h=c.segments[f];if(!(h.end<r||h.start>s)){var v=r>=h.start&&r<h.end,p=this._isSegmentInBuffer(h,d);!e&&p||e&&p&&v||(v?o.push(f):s>=h.start&&o.push(f))}}return o}},{key:"blacklist",value:function(e){this.blacklisted[e]=1}},{key:"lock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this.whitelisted=e}},{key:"filterStreams",value:function(e){for(var t=this.scanner._video.clientWidth,n=this.scanner._video.clientHeight,i=[],r=void 0,o=!1,a=0;a<e.length;a++)if(r&&r[0]===e[a].width&&r[1]===e[a].height)i.push(e[a]);else{if(o)break;if(!(this.blacklisted[a]&&this.whitelisted.indexOf(a)===-1||this.whitelisted.length&&this.whitelisted.indexOf(a)===-1))if(this.whitelisted.length)i.push(e[a]);else{var s=this._getScaleFromDimensions(t,n,e[a].width,e[a].height),u=1e3/(window.devicePixelRatio||1),c=n<u?1.75:1;s>=c&&(o=!0),i.push(e[a]),r=[e[a].width,e[a].height]}}return i}},{key:"_getStreamFromSpeed",value:function(e,t,n){for(var i=0,r=i;r<n.length;r++)e*t>n[r].bitrate+n[r].audioBitrate&&(i=r);return i}},{key:"_getVisibleDimensions",value:function(e,t,n,i){var r=n/i,o=e-t*r,a=t-e/r,s=e-o,u=t-a;return o>0&&(u=t),a>0&&(s=e),[s,u]}},{key:"_getScaleFromDimensions",value:function(e,t,n,i){var r=this._getVisibleDimensions(e,t,n,i),o=n*i;this.scanner.video&&this.scanner.video.metadata.percentShown&&(o*=this.scanner.video.metadata.percentShown);var a=window.devicePixelRatio||1,s=r[0]*r[1]*a*a;return o/s}},{key:"_getSecondsToLoadAhead",value:function(e,t,n){var i=12e3,r=n&&n.bitrate>i;return 1===this.whitelisted.length?r?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this.MAX_LOADABLE_SEGMENTS_AUTO*this.SEGMENT_DURATION}},{key:"_round",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"_timesAreInRange",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!n)return!1;t=Math.min(t,this.scanner._video.duration);for(var r=0;r<n.length;r++){var o=this._round(n.start(r))-i,a=this._round(n.end(r))+i;if(o<=e&&a>=t)return!0}return!1}},{key:"_hasSeparateStreams",value:function(){return this.scanner._streams.video.length>0&&this.scanner._streams.audio.length>0}},{key:"_isSegmentInBuffer",value:function(e,t){var n=1;return this._hasSeparateStreams()&&(n=.05),this._timesAreInRange(e.start,e.end,t,n)}}]),t}(tv),iv=3,rv=6,ov=.85,av=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return i._options=n,i.MAX_LOADABLE_SEGMENTS_AUTO=10,i.inVirginState=!0,i.targetStreamChanged=!1,i._initializeEvents(),i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"BBA"}}]),jf(t,[{key:"_initializeEvents",value:function(){var e=this;this.scanner.on(_h.STREAM_TARGET_CHANGE,function(){e.targetStreamChanged=!0})}},{key:"getSegmentsToLoad",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video",i=arguments[2];return e&&this.targetStreamChanged?this.targetStreamChanged=!1:e=!1,Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"getSegmentsToLoad",this).call(this,e,n,i)}},{key:"shouldPowerUp",value:function(e,t,n){var i=e.indexOf(t);if(i===-1&&(i=0),!this.canPowerUp(e,i))return!1;var r=this.scanner.sorcerer.video._sourceBuffer?this.scanner.sorcerer.video._sourceBuffer.buffered:null,o=this._getStreamFromBuffer(r,e,i);return!(o<=i)&&o}},{key:"shouldPowerDown",value:function(e,t){var n=e.indexOf(t),i=n===-1;if(i)return e.length-1;if(!this.canPowerDown(e,n))return!1;var r=this.getCurrentSpeed();if(!r)return!1;if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return n-1;var o=this.scanner.sorcerer.video._sourceBuffer?this.scanner.sorcerer.video._sourceBuffer.buffered:null,a=this._getStreamFromBuffer(o,e,n);return!(a>=n)&&a}},{key:"_getStreamFromBuffer",value:function(e,t,n){var i=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.SEGMENT_DURATION*rv,a=this.getDistanceFromBuffer(this.scanner.currentTime);if(this.scanner.sorcerer.video.streams[n].pendingFetches.forEach(function(e){a+=e.percent*i.SEGMENT_DURATION}),!r&&this._isVirginBuffer(e,t)||!e){var s=this.getCurrentSpeed();return this._getStreamFromSpeed(s,ov,t)}if(a<=iv*this.SEGMENT_DURATION)return this.scanner.fire("bufferoccupancy",0),0;var u=Math.min(1,(a-iv*this.SEGMENT_DURATION)/o);if(a===this.scanner._video.duration-this.scanner._video.currentTime&&(u=1),this.scanner.fire(_h.BUFFER_OCCUPANCY,Math.round(100*u)/100),1===u)return t.length-1;for(var c=[],l=1;l<t.length;l++)c.push(t[l].bitrate);var d=u*c.slice(-1)[0],f=[];c.forEach(function(e){f.push(Math.abs(d-e))});var h=f.indexOf(Math.min.apply(Math,f))+1,v=Math.max(0,n-1),p=d>c[v-1]&&d<=c[v]||d>=c[v]&&d<c[v+1];return p?n:h}},{key:"_isVirginBuffer",value:function(e,t){return!(!this.inVirginState||this._getStreamFromSpeed(this.getCurrentSpeed(),ov,t)===this._getStreamFromBuffer(e,t,this.scanner.sorcerer.video.activeStreamIndex,!0))||(this.inVirginState&&(this.inVirginState=!1),!1)}}]),t}(nv),sv=1,uv=2,cv=3,lv=4,dv=4,fv="video",hv="audio",vv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.reset(),i.manifestLoadDurations=[],n.mediaSourceScanner&&(i._maxPreloadStreamIndex=n.mediaSourceScanner.maxPreloadStreamIndex,i._shouldUseBBA=n.mediaSourceScanner.shouldUseBBA),i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supported",get:function(){return"undefined"!=typeof MediaSource&&"undefined"!=typeof Set}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json"]}}]),jf(t,[{key:"deactivate",value:function(){Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactivate",this).call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()}},{key:"reset",value:function(){this._waitingOnSet=new Set,this._streamsForSegment={};var e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._shouldUseBBA?this._brain=new av(this,e):this._brain=new nv(this,e),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[hv]=[],this._streams[fv]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._fireEndedTimeout=null,this._firedFakeEndedEvent=!1,this._lastDownloadBitrate=0}},{key:"preloadStream",value:function(){var e=this;return this._preloadStream?this._preloadStream:(this._preloadStream=new Vi(function(t,n){var i=1;e._streams.audio.length&&(i=2);var r=0,o=!1,a=e.sorcerer.video.activeStreamIndex;e._restrictedStreamIndexes.length&&(a=e._streams[fv].indexOf(e._manifest.video[e._restrictedStreamIndexes[0]]));var s=e._brain.getSegmentsToLoad(!1,fv,e._getCurrentStream()),u=0;s.length>0&&(u=s[0]);var c=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(a=e.sorcerer.video.activeStreamIndex);for(var n in e._streams)if(0!==e._streams[n].length){var i=a;n===hv&&(i=e._getAudioIndexFromVideo(a));var s=e._getSegmentUrl(i,u,n),c=e._isFinalSegment(i,u),l=e.sorcerer[n].streams[i],d={stream:i,segment:u,type:n},f=!0,h=s;if(e._useRangeRequests()){var v=e._getRangeForSegment(i,u,n);h={url:h,byteRange:v}}"audio"!==n||i!==o?("audio"===n&&o===!1&&(o=i),l.addSegment(h,{identifier:d,isFinalSegment:c,loadOnly:f,priority:0})):(r+=1,e._handleAppendBufferEnd(d))}},l=function n(o){if(r+=1,!(r<i)&&o.segment===u){if(0===e._restrictedStreamIndexes.length){var s=!0,l=e._getStreamIndexToLoad(s);if(l!==!1&&l>o.stream)return e.sorcerer.video.switchTo(l,!1),e._streams.audio.length&&e.sorcerer.audio.switchTo(e._getAudioIndexFromVideo(l),!1),r=0,void c(!0)}var d=e._getCurrentStream(a),f=d.segments[0].end,h=!0,v=e._getDuration(h);e.currentTime>=v&&(e.currentTime=v),e.currentTime>f&&(e.sorcerer.clear(),e._waitingOnSet=new Set),e.sorcerer.video.switchTo(a,!1),e._streams.audio.length&&e.sorcerer.audio.switchTo(e._getAudioIndexFromVideo(a),!1),e.sorcerer.off("bufferqueueadd",n),e._ready=!0,t()}};e.sorcerer.on("bufferqueueadd",l),c()}),this._preloadStream)}},{key:"loadManifest",value:function(e){var t=this;return new Vi(function(n,i){var r=null,o=new XMLHttpRequest;o.open("GET",e,!0),o.timeout=1e4,o.onload=function(){var a=Date.now()-r;if(o.status>=400)return t.manifestLoadDurations.push({url:e,status:o.status,duration:a}),t.reset(),410===o.status?void t.fire(_h.MEDIA_URL_EXPIRED):void i("JSON manifest failed to load.");"responseURL"in o&&o.responseURL!==e&&o.responseURL.indexOf("live-archive")&&(t._baseUrl=o.responseURL.split("/").slice(0,-2).join("/"));try{n(JSON.parse(o.response)),t.manifestLoadDurations.push({url:e,status:o.status,duration:a}),t.fire(_h.MANIFEST_LOADED)}catch(n){t.manifestLoadDurations.push({url:e,status:o.status,duration:a}),i()}},o.onerror=function(){var n=Date.now()-r;t.manifestLoadDurations.push({url:e,status:o.status,duration:n}),t.reset(),i("JSON manifest failed to load.")},o.ontimeout=function(){var n=Date.now()-r;t.manifestLoadDurations.push({url:e,status:o.status,duration:n}),t.reset(),t.fire(_h.MANIFEST_TIMEOUT),i("JSON manifest "+e+" timed out in "+n+"ms.")},r=Date.now(),o.send()})}},{key:"setVideoSrc",value:function(e,t){var n=this,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(i&&!t&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this._paused)&&!this._ready)return void this._onReady.then(function(){var t=n._paused;n.setVideoSrc(e,t,!1)});if("auto"===this._preload)return void this._onReady.then(function(){n.setVideoSrc(e,!1,!1)})}if(t){this.reset();try{this._video.currentTime=0}catch(e){}}t||!this._paused||this.sorcerer||(t=!0);var r="_initializeManifest";t&&(this._video.preload="",r="_initialize");var o=e.split("/");o.pop();var a=o.join("/")+"/";this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then(function(e){return"string"==typeof n._baseUrl&&n._baseUrl.indexOf("live-archive")!==-1?e:(n._baseUrl=a,e)}).then(this[r].bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)}},{key:"getBitrateAtTime",value:function(e,t){if(!this.sorcerer)return 0;var n=this.sorcerer.streamIndexAtTime(e,t);return this._streams[t][n]?this._streams[t][n].bitrate:0}},{key:"updateReadyState",value:function(){}},{key:"lockStreamIndexes",value:function(){var e=this,t=this._restrictedStreamIndexes.map(function(t){return e._streams[fv].indexOf(e._streams[fv][t])});if(this._video.paused||(this._ignorePauseEvent=!0,this._video.pause()),this._switching[fv]=!1,this._brain.lock(t),this._startedPlaying||"auto"===this._preload){var n=7,i=Math.max(this.currentTime-n,0),r=Math.min(this.currentTime+n,this._video.duration);this.sorcerer.removeBuffer(i,r).then(function(){return!e._startedPlaying&&"auto"===e._preload||e.ended?void e._loadSegments():(e.seekToTime(e.currentTime),void(!e._paused&&e._video.paused&&(e._ignorePlayEvent=!0,e.play())))})}}},{key:"seekToTime",value:function(e){var t=this;if(e===this.currentTime)return Vi.resolve();this._shouldUseBBA&&(this._brain.inVirginState=!0),clearTimeout(this._fireEndedTimeout),this._firedFakeEndedEvent=!1;var n=null===this._timeToSeekTo;if(n||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._ready)for(var i in this._streams)if(this._streams[i].length>0){var r=this.sorcerer[i].activeStreamIndex,o=this.sorcerer[i].streams[r];o.abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Vi.all([this._onReady,this._removeBufferPromise]).then(function(){t._loadSegments()}),this._paused&&0===e&&this.fire(mh.SEEKING),this.readyState=sv,!n&&this._waitingOnPlay&&this.play(),this._onReady.then(function(){return t._seekInProgressPromise}).catch(function(e){})}},{key:"takeSnapshot",value:function(){}},{key:"initDrm",value:function(){}},{key:"onstalled",value:function(){return!1}},{key:"onseeked",value:function(e){this._startedPlaying&&(this._loadSegments(),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onseeked",this).call(this,e))}},{key:"onended",value:function(e){return clearTimeout(this._fireEndedTimeout),!this._firedFakeEndedEvent&&(Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onended",this).call(this,e),!0)}},{key:"onseeking",value:function(e){var t=this;this._startedPlaying&&(clearTimeout(this._seekTimeout),this._seekTimeout=setTimeout(function(){t._loadSegments()},100))}},{key:"onloadeddata",value:function(){var e=this;pn(function(){e.readyState=lv})}},{key:"ontimeupdate",value:function(e){var t=this;if(!this.sorcerer)return!1;if(clearTimeout(this._fireEndedTimeout),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){var n=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-n),this._clearBufferAtTime=!1}this._loadSegments();var i=this.sorcerer.getDroppedFrameTotal();this.fire(_h.DROPPED_FRAMES,i);var r=this.sorcerer.getResponseSpeeds(),o=this._streams[fv][this.sorcerer.video.activeStreamIndex],a=this._options.tests&&this._options.tests.download_bitrate;if((!a||!a.group)&&o){var s={speed:this._brain.getCurrentSpeed(),bitrate:o.bitrate,speeds:r};this.fire(_h.BANDWIDTH,s)}var u=this._video.buffered.length;if(!u)return!0;var c=this._video.buffered.end(u-1);if(!this._firedFakeEndedEvent&&this.currentTime+.5>this._video.duration){var l=500;this._fireEndedTimeout=setTimeout(function(){t.onended(),t._firedFakeEndedEvent=!0,t.fire(mh.ENDED,{simulated:!0})},l)}if(Math.ceil(c)===Math.ceil(this._video.duration))return!0;var d=.2;return Math.abs(this.currentTime-c)<d?!this._ranIntoBuffer&&(this.fire(_h.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer[fv].activeStreamIndex>0}),this._ranIntoBuffer=!0,this.readyState=uv,!1):void 0}},{key:"onprogress",value:function(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&(this.readyState<cv&&(this.readyState=lv),this._ranIntoBuffer&&(this.fire(_h.STREAM_BUFFER_END),this._ranIntoBuffer=!1))}},{key:"onplay",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!1,!0)}},{key:"onpause",value:function(){return"picture-in-picture"===this.presentationMode&&(this._paused=!0,!0)}},{key:"onwaiting",value:function(e){return!1}},{key:"onerror",value:function(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(_h.SCANNER_ERROR,{reason:"encountered media decode error"}),!1):Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"onerror",this).call(this))}},{key:"pause",value:function(){var e=this;pn(function(){e.fire(mh.PAUSE)}),Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pause",this).call(this)}},{key:"play",value:function(){var e=this,t=null;return this._firedFakeEndedEvent&&(this.currentTime=0),pn(function(){e.fire(mh.PLAY)}),this._waitingOnPlay=!0,this._paused=!1,hh.android&&!this._ready&&(this._waitingOnPlay=!1,t=this._video.play(),void 0!==t&&(t=t.catch(function(e){}))),this._resolveStartPreload&&this._resolveStartPreload(),this._reloadingExistingVideo||this._ready||"auto"===this._preload||(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._onReady.then(function(){return Vi.resolve(e._seekInProgressPromise)}).then(function(){return e._waitingOnPlay=!1,e._paused||(t=e._video.play(),void 0!==t&&(t=t.catch(function(e){}))),t})}},{key:"_getAudioIndexFromVideo",value:function(e){return 0!==this._streams.audio.length&&(this._streams.audio.length>1&&this._streams.video[e].bitrate>1e6?1:0)}},{key:"_addCallbackToPromise",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=e.then(t);return n&&(i=this._addCatchToPromise(i)),i}},{key:"_addCatchToPromise",value:function(e){var t=this;return e.catch(function(e){return t.fire(_h.FILE_ERROR,{reason:e}),new Vi(function(e,t){})})}},{key:"_handleBufferForSeek",value:function(){if(this._ready){var e=this._streams[fv][this.sorcerer.video.activeStreamIndex],t=e.bitrate/1e3,n=12e3;t>n&&(this._removeBufferPromise=this.sorcerer.removeBuffer())}}},{key:"_startPreload",value:function(e,t){var n=this;return new Vi(function(i,r){return"none"!==t||n._reloadingExistingVideo&&!n._paused?void i(e):void(n._resolveStartPreload=function(){i(e),n._resolveStartPreload=null})})}},{key:"_getSeekReadyPromiseForTime",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._timeToSeekTo;return new Vi(function(n,i){var r=e._startedPlaying&&0===t;return r||e._brain.canPlayFromTimeInStream(t,e._getCurrentStream())?void n(t):(e._handleBufferForSeek(),void(e._resolveSeek=n))}).then(function(t){e._timeToSeekTo=null,e._seekInProgressPromise=null,e.readyState=lv;var n=new Vi(function(t,n){e._lastSeekReject=n;var i=function n(){t(e._video.currentTime),e._video.removeEventListener("seeked",n)};e._video.addEventListener("seeked",i)});return e._video.currentTime=t,n})}},{key:"_handlePreloadChanged",value:function(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()}},{key:"_avDurationDifference",value:function(e){var t=e.audio.reduce(function(e,t){return e+t.duration},0),n=e.video.reduce(function(e,t){return e+t.duration},0),i=t/e.audio.length,r=n/e.video.length;return i+dv<r?r-i:0}},{key:"_initializeManifest",value:function(e){var t=this;return new Vi(function(n,i){if(t._manifest=e,t._streams[fv]=t._sortStreams(e.video),e.audio){var r=t._avDurationDifference(e);if(r>0)return t.fire(_h.AV_DURATION_MISMATCH,r),t.fire(_h.SCANNER_ERROR,{reason:"Encountered A/V duration mismatch"}),void i();t._streams[hv]=t._sortStreams(e.audio)}for(var o=0;o<t._streams[fv].length;o++){var a=0;if(e.audio){var s=t._streams[hv][t._getAudioIndexFromVideo(o)];s&&(a=s.bitrate)}t._streams[fv][o].audioBitrate=a}t._initDrm(t._streams[fv],t._streams[hv]),n()})}},{key:"_setUpSorcerer",value:function(e,t){this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new ev(e,t),this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments()}},{key:"_getDuration",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=e?1/0:0;for(var n in this._streams)this._streams[n].length&&(t=Math[e?"min":"max"](t,this._streams[n][0].duration));return t}},{key:"_initialize",value:function(e){var t=this;return new Vi(function(n,i){t._initializeManifest(e).then(function(){var i=t._brain.filterStreams(t._streams[fv]),r=i.length-1,o=t._streams[fv][0];if(t._restrictedStreamIndexes.length&&(o=t._streams[fv][t._restrictedStreamIndexes[0]]),void 0!==t._maxPreloadStreamIndex){var a=t._streams[fv].indexOf(e.video[t._maxPreloadStreamIndex]);r<=a&&(o=t._streams[fv][r])}t._setUpSorcerer(t._video,{duration:t._getDuration()}),t.sorcerer.on("srcnotsupported",function(){t.fire(_h.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})});var s=t._streams[fv].indexOf(o),u=function(e){t._streams[e].forEach(function(n,i){var r=t._getSegmentUrl(i,"init",e);if(t._useRangeRequests()&&t._streams[e][i].init_segment_range){var o=t._getRangeForSegment(i,"init",e);r={url:r,byteRange:o}}t.sorcerer.addStream(n.mime_type+'; codecs="'+t._streams[e][i].codecs+'"',r)})};for(var c in t._streams)u(c);t.sorcerer.video.switchTo(s),t.sorcerer.on("queued",t._handleQueued.bind(t)),t.sorcerer.on("downloadabort",t._handleAborted.bind(t)),t.sorcerer.on("appendbufferend",t._handleAppendBufferEnd.bind(t)),t.sorcerer.on("downloadend",t._handleDownloadEnd.bind(t)),t.sorcerer.on("downloaderror",t._handleDownloadError.bind(t)),t.sorcerer.on("progress",t._handleProgress.bind(t)),t.sorcerer.video.on("streamchange",t._handleStreamChange.bind(t)),t.sorcerer.mediaSource.addEventListener("sourceended",function(){t.fire(mh.PROGRESS)}),n()})})}},{key:"_sortStreams",value:function(e){function t(e,t){var n=e.width*e.height*e.bitrate,i=t.width*t.height*t.bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-i}var n=e.slice(0);return n.sort(t),n}},{key:"_useRangeRequests",value:function(){return!!this._manifest.video[0].segments[0].range}},{key:"_getRangeForSegment",value:function(e,t,n){return"init"===t?this._streams[n][e].init_segment_range:this._streams[n][e].segments[t].range}},{key:"_getSegmentPriority",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fv,i="init"===t;if(i)return 0;var r=this._streams[n][e].segments[t].start;return r}},{key:"_getSegmentUrl",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fv,i="init"===t;if(i&&!this._streams[n][e].init_segment_range&&this._streams[n][e].init_segment.indexOf(".")===-1){var r=this._streams[n][e].init_segment;return hn(r)}var o=this._baseUrl,a=this._manifest.base_url&&this._manifest.base_url.indexOf("//")!==-1;return a&&(o=this._manifest.base_url),this._manifest.base_url&&!a&&(o+=this._manifest.base_url),this._streams[n][e].base_url&&(o+=this._streams[n][e].base_url),this._useRangeRequests()?o:"init"===t?o+=this._streams[n][e].init_segment:(this._streams[n][e].segments[t].url&&(o+=this._streams[n][e].segments[t].url),o)}},{key:"_key",value:function(e,t,n){return e+":"+t+":"+n}},{key:"_isFinalSegment",value:function(e,t){return t===this._streams[fv][e].segments.length-1}},{key:"_getCurrentlyLoadingStreamsForSegment",value:function(e,t){var n=[],i=this._streamsForSegment[e];if(!i)return n;for(var r=0;r<i.length;r++)this._waitingOnSet.has(this._key(i[r],e,t))&&n.push(i[r]);return n}},{key:"_getCurrentStream",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fv;return"undefined"!=typeof this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]}},{key:"_getStreamIndexToLoad",value:function(e){var t=this._streams[fv];if(t=this._brain.filterStreams(t),0===t.length)return!1;if(this._switching[fv])return!1;var n=t[t.length-1];if(n.id!==this._lastTargetStreamId){this._lastTargetStreamId=n.id;var i=this._streams[fv].indexOf(n),r={index:i,streams:this._streams[fv]};this.fire(_h.STREAM_TARGET_CHANGE,r)}var o=this._getCurrentStream(),a=this._brain.shouldPowerUp(t,o,e);return a===!1&&(a=this._brain.shouldPowerDown(t,o)),a===!1?a:this._streams[fv].indexOf(t[a])}},{key:"_loadSegmentsForType",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fv,n=this._getStreamIndexToLoad();t===hv&&(n===!1&&(n=this.sorcerer[fv].activeStreamIndex),n=this._getAudioIndexFromVideo(n),this.sorcerer[hv].activeStreamIndex===n&&(n=!1));var i=!1;n!==!1&&(i=n>this.sorcerer[t].activeStreamIndex,this._switching[t]=!0,this.sorcerer[t].switchTo(n).then(function(){e._switching[t]=!1}));for(var r=this._brain.getSegmentsToLoad(i,t,this._getCurrentStream()),o=this.sorcerer[t].activeStreamIndex,a=0;a<r.length;a++){var s=this._getSegmentUrl(o,r[a],t),u=this._getCurrentlyLoadingStreamsForSegment(r[a],t);if(!(u.length>1||1===u.length&&o<=u[0])){var c=this._isFinalSegment(o,r[a],t),l={stream:o,segment:r[a],type:t},d=this.sorcerer[t].streams[o],f=s;if(this._useRangeRequests()){var h=this._getRangeForSegment(o,r[a],t);f={url:f,byteRange:h}}var v=this._getSegmentPriority(o,r[a],t),p=t===fv;d.addSegment(f,{identifier:l,isFinalSegment:c,priority:v,includeWithBandwidthChecks:p})}}}},{key:"_loadSegments",value:function(){var e=this;return this._onReady.then(function(){for(var t in e._streams)e._streams[t].length>0&&e._loadSegmentsForType(t)})}},{key:"_handleQueued",value:function(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),this._streamsForSegment[e.segment].indexOf(e.stream)===-1&&this._streamsForSegment[e.segment].push(e.stream)}},{key:"_clearWaitingOn",value:function(e){var t=this,n=this._streamsForSegment[e.segment];n.forEach(function(n){t._waitingOnSet.delete(t._key(n,e.segment,e.type))})}},{key:"_handleAborted",value:function(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)}},{key:"_handleAppendBufferEnd",value:function(e){this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[fv][e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),null!==this._timeToSeekTo&&this._resolveSeek&&this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)}},{key:"_handleDownloadEnd",value:function(e,t){this.fire(_h.DOWNLOAD_END,{identifier:e,data:t})}},{key:"_handleDownloadError",value:function(e,t){this._clearWaitingOn(e);var n=_h.DOWNLOAD_ERROR;410===t&&(n=_h.MEDIA_URL_EXPIRED),this.fire(n,{identifier:e,status:t})}},{key:"_handleProgress",value:function(){if(this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group){var e=this._streams[fv][this.sorcerer.video.activeStreamIndex],t=this.sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration);if(this._lastDownloadBitrate!==t&&0!==t){this._lastDownloadBitrate=t;var n={speed:t,bitrate:e.bitrate};this.fire(_h.BANDWIDTH,n)}}}},{key:"_handleStreamChange",value:function(e){e>this._lastStreamIndex&&this.currentTime>0&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;var t=this._manifest.video.indexOf(this._streams[fv][e]),n={index:t,streams:this._manifest.video};this.fire(_h.STREAM_CHANGE,n)}},{key:"_initDrm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(this._telecineVideo.drmHandler){var n={audio:t.map(function(e){return e.mime_type+';codecs="'+e.codecs+'"'}),video:e.map(function(e){return e.mime_type+';codecs="'+e.codecs+'"'})};this._telecineVideo.drmHandler.init(this,n)}}},{key:"preload",get:function(){return this._preload},set:function(e){this._handlePreloadChanged(this._preload,e),this._preload=e}},{key:"videoWidth",get:function(){var e=this._getCurrentStream();return e?e.width:this._video.videoWidth}},{key:"videoHeight",get:function(){var e=this._getCurrentStream();return e?e.height:this._video.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._restrictedStreamIndexes.join(",")!==t.join(",")&&(this._restrictedStreamIndexes=t,this._onReady.then(function(){return e.lockStreamIndexes()}))}},{key:"currentTime",get:function(){return this._firedFakeEndedEvent?this._video.duration:null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime;
},set:function(e){(this._startedPlaying||0!==e)&&this.seekToTime(e)}},{key:"downloadSpeed",get:function(){return this._lastDownloadBitrate}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer[fv].activeStreamIndex>0:null}}]),t}(qh),pv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r=document.createElement("canvas");return i._backingCanvas=r.getContext("2d"),i._resizeHandler=function(){return i.onresize()},i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"AsciiEffect"}},{key:"supported",get:function(){return!/iphone|ipod/i.test(navigator.userAgent)}},{key:"supportedScanners",get:function(){return[qh,vv]}}]),jf(t,[{key:"activate",value:function(){return window.addEventListener("resize",this._resizeHandler,!1),this._telecine.paused?void this._renderFrame():void this._startRendering()}},{key:"deactivate",value:function(){this._stopRendering(),window.removeEventListener("resize",this._resizeHandler,!1),this._element.removeChild(this._output)}},{key:"onplay",value:function(){this._startRendering()}},{key:"onpause",value:function(){this._stopRendering()}},{key:"onended",value:function(){this._stopRendering()}},{key:"onseeked",value:function(){this._renderFrame()}},{key:"onresize",value:function(){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._adjustRenderSize(this._output,t),this._telecine.paused&&this._renderFrame()}},{key:"_getRenderProperties",value:function(e,t,n,i){var r=mn(e,t,n,i),o=Math.max(Math.min(Math.floor(r.height/10),60),10);this._options.color&&(o=Math.floor(o/2));var a=document.createElement("pre");a.style.cssText="position:absolute;left:-9001px;top:0;font-size:10px;margin:0;padding:0;line-height:1",a.innerHTML="X",this._element.appendChild(a);var s=t/o/a.clientHeight*10+"px";a.style.fontSize=s;for(var u=a.clientHeight,c=Math.ceil(r.height/u),l=r.height-c*u,d=parseFloat((l/c+u)/u),f=a.clientWidth,h=Math.ceil(r.width/f),v=[],p=0;p<h;p++)v.push("X");a.innerHTML=v.join("");var m=r.width-a.clientWidth,g=m/h+"px";return this._element.removeChild(a),{fontSize:s,lineHeight:d,letterSpacing:g,horizontalResolution:h,verticalResolution:c,top:r.top}}},{key:"_createOutputElement",value:function(e){var t=document.createElement("pre");return t.style.cssText="position:absolute;left:0;top:0;margin:0;padding:0;background:#000;width:100%;height:100%;text-align:center",t.style.color=this._options.color?"#fff":"#0f0",this._adjustRenderSize(t,e),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),t}},{key:"_adjustRenderSize",value:function(e,t){var n=t.fontSize,i=t.lineHeight,r=t.letterSpacing,o=t.horizontalResolution,a=t.verticalResolution,s=t.top;this._backingCanvas.width=o,this._backingCanvas.height=a,this._renderWidth=o,this._renderHeight=a,e.style.fontSize=n,e.style.lineHeight=i,e.style.letterSpacing=r,e.style.paddingTop=s+"px"}},{key:"_getFrame",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._backingCanvas.drawImage(e,0,0,this._renderWidth,this._renderHeight);var n=null;try{n=this._backingCanvas.getImageData(0,0,this._renderWidth,this._renderHeight).data}catch(e){this._stopRendering()}for(var i=[],r=0;r<this._renderHeight;r++){for(var o=0;o<this._renderWidth;o++){var a=4*(r*this._renderWidth+o),s=n[a],u=n[a+1],c=n[a+2],l=3*s+4*u+c>>>3;if(t){var d=" CGO08@"[Math.floor(l/256*7)];if(" "===d||s>=250&&u>=250&&c>=250){i.push(d);continue}i.push('<span style="color:rgb('+s+","+u+","+c+')">'+d+"</span>")}else{var f="  .,:;iltfLG@"[Math.floor(l/256*13)];i.push(f)}}i.push("\n")}return i.join("")}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame),this._content&&(this._animationFrame=window.requestAnimationFrame(function(){e._output.innerHTML=e._content,e._content=null}))}},{key:"_renderFrame",value:function(){if(!this._output){var e=this._telecine._currentScanner._video,t=this._getRenderProperties(e.clientWidth,e.clientHeight,this._telecine.videoWidth,this._telecine.videoHeight);this._output=this._createOutputElement(t),this._element.appendChild(this._output)}this._content=this._getFrame(this._telecine._currentScanner._video,this._options.color),this._requestRenderAnimationFrame()}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval);var t=Math.min(Math.max(this._options.fps,15),30);this._interval=window.setInterval(function(){e._renderFrame()},1/t)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null)}}]),t}(Yf),mv=["width","height","bandwidth","duration","timescale","presentationTimeOffset"],gv=function(){function e(t,n){qf(this,e);var i=new DOMParser;this.manifest=i.parseFromString(t,"application/xml"),this.url=n,this.mpd=this.manifest.getElementsByTagName("MPD")[0]}return jf(e,[{key:"_attrsToObj",value:function(e){for(var t={},n=0;n<e.length;n++){var i=e[n].nodeName,r=e[n].nodeValue;mv.indexOf(i)!==-1&&(r=parseInt(r,10)),t[i]=r}return t}},{key:"_getAttribute",value:function(e,t){var n=e.attributes.getNamedItem(t);return n?n.nodeValue:null}},{key:"_constructAdaptationSets",value:function(e){for(var t=this,n=[],i=function(i){var r=t._attrsToObj(e[i].attributes),o=e[i].getElementsByTagName("Representation");r.representations=t._constructRepresentations(o),r.frameRate&&r.representations.forEach(function(e){e.framerate=parseInt(r.frameRate,10)}),1===r.representations.length&&(r.width&&(r.representations[0].width=r.width),r.height&&(r.representations[0].height=r.height)),n.push(r)},r=0;r<e.length;r++)i(r);return n}},{key:"_constructRepresentations",value:function(e){for(var t=[],n=0;n<e.length;n++){var i=this._attrsToObj(e[n].attributes),r=e[n].getElementsByTagName("SegmentList")[0];i.segmentList=this._constructSegmentList(r),t.push(i)}return t}},{key:"_constructSegmentList",value:function(e){var t=e.getElementsByTagName("Initialization")[0],n=e.getElementsByTagName("SegmentURL"),i=this._attrsToObj(e.attributes);i.startNumber=parseInt(i.startNumber,10),i.initSegment=this.baseURL+this._getAttribute(t,"sourceURL"),i.segments=[];for(var r=0;r<n.length;r++){var o=this._getAttribute(n[r],"media"),a=o.match(/cn(\d*)/);if(null===a)throw new Error("Error parsing segment index from segment URL");i.segments.push({index:parseInt(a[1],10),url:this.baseURL+o})}return i}},{key:"profiles",get:function(){return this._getAttribute(this.mpd,"profiles")}},{key:"type",get:function(){return this._getAttribute(this.mpd,"type")}},{key:"minimumUpdatePeriod",get:function(){var e=this._getAttribute(this.mpd,"minimumUpdatePeriod");return gn(e)}},{key:"publishTime",get:function(){return this._getAttribute(this.mpd,"publishTime")}},{key:"availabilityStartTime",get:function(){return this._getAttribute(this.mpd,"availabilityStartTime")}},{key:"timeShiftBufferDepth",get:function(){var e=this._getAttribute(this.mpd,"timeShiftBufferDepth");return gn(e)}},{key:"suggestedPresentationDelay",get:function(){var e=this._getAttribute(this.mpd,"suggestedPresentationDelay");return gn(e)}},{key:"minBufferTime",get:function(){var e=this._getAttribute(this.mpd,"minBufferTime");return gn(e)}},{key:"baseURL",get:function(){return this.url.substr(0,this.url.lastIndexOf("/")+1)}},{key:"periods",get:function(){for(var e=[],t=this.mpd.getElementsByTagName("Period"),n=0;n<t.length;n++){var i=this._attrsToObj(t[n].attributes),r=t[n].getElementsByTagName("AdaptationSet");i.adaptationSets=this._constructAdaptationSets(r),e.push(i)}return e}},{key:"audioAdaptationSet",get:function(){return this.periods[0].adaptationSets.find(function(e){return 0===e.mimeType.search(/audio/)})}},{key:"videoAdaptationSet",get:function(){return this.periods[0].adaptationSets.find(function(e){return 0===e.mimeType.search(/video/)})}},{key:"representations",get:function(){return this.periods[0].adaptationSets[0].representations}},{key:"audioRepresentations",get:function(){return this.audioAdaptationSet?this.audioAdaptationSet.representations:null}},{key:"videoRepresentations",get:function(){return this.videoAdaptationSet.representations}}]),e}(),yv="average",_v=5,bv=[1,2,5],wv=2,kv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i.BANDWIDTH_THRESHOLD=.8,i.consecutiveStreamIndex={},i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"Live"}}]),jf(t,[{key:"optimalStreamIndex",value:function(e,t){if(1===e.length)return e[0].index;e=this.filterStreams(e);var n=0;n=this._options.tests&&this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group?this.scanner.sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration):this.scanner.sorcerer.getCurrentSpeed({type:yv,howMany:_v,weights:bv});for(var i=t,r=0;r<e.length;r++)n*this.BANDWIDTH_THRESHOLD>e[r].bandwidth&&(i=e[r].index);this._clearConsecutiveStreamIndexes(i),this.consecutiveStreamIndex[i]++;var o=1.5*this.scanner.segmentLength;return this.scanner.duration-this.scanner.currentTime<o?0:this.consecutiveStreamIndex[i]>wv&&i!==t?i:t}},{key:"_clearConsecutiveStreamIndexes",value:function(e){this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0);for(var t in this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)}}]),t}(nv),Sv="video",Ev="audio",Tv=3e3,xv=5e3,Av=1500,Lv=12,Pv=.5,Cv=3,Ov=3,Rv=3,Iv=5e3,Mv=3e4,Dv="video/vnd.mpeg.dash.mpd",Fv="application/x-mpegURL",Bv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._manifestUrl=null,i._apiManifestUrl=null,i._hasPlayed=!1,i.STREAM_SWITCH_CHECK_INTERVAL=2e3,i._livePoller=n.livePoller,i._setUpLivePoller(),i.reset(),window.addEventListener("online",function(){i._pauseReset(),i.play()}),i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"LiveScanner"}},{key:"supportedVideoTypes",get:function(){return hh.iOS?[Fv]:[Dv,Fv]}},{key:"supportsPlaybackRate",get:function(){return!1}}]),jf(t,[{key:"deactivate",value:function(){Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"deactivate",this).call(this),this.reset()}},{key:"reset",value:function(){this._manifestTimeout&&clearTimeout(this._manifestTimeout),this._sorcerer&&this._sorcerer.destroy(),this._sorcerer=null,this._hasAudioRepresentation=!1,this._streams={},this._streams[Sv]=[],this._streams[Ev]=[],this._lastStreamIndex=0,this._manifest=null,this._manifestTimeout=null,this._lastSegmentAppended={audio:-1,video:-1},this._noSegmentsLoadedCount={audio:0,video:0},this._seenBufferLength=!1,this._hasLoadedManifest=!1,this._isOnline=!1,this._hasEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._bufferedIndex=0,this._streamChanging=!1,this._timeSinceLastStreamSwitchCheck=0,this._forcePlayOnManifestLoad=!1,this._abr=new kv(this,this._options),this._restrictedStreamIndexes=[],this._lastDownloadBitrate=0}},{key:"_pauseReset",value:function(){this._manifestTimeout&&clearTimeout(this._manifestTimeout),this._manifestTimeout=null,isNaN(this.duration)||(this.currentTime=this.duration)}},{key:"_setUpLivePoller",value:function(){var e=this;this._livePoller.on("liveeventended",function(t){e._hasEnded=!0,e._sorcerer.destroy(),e.deactivate()})}},{key:"_requestJSON",value:function(e){return new Vi(function(t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(){200!==i.status&&n("Failed to load JSON url: "+e+" "+i.status);var r=void 0;try{r=JSON.parse(i.response)}catch(t){n("Failed to parse JSON url: "+t+" "+e+" "+i.response)}t(r)},i.onerror=function(){n("Failed to load JSON url: "+e)},i.send()})}},{key:"_refreshLiveApiPlaylistUrl",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return new Vi(function(n,i){var r=e._livePoller.liveEvent.playlistRefreshUrl;e._requestJSON(r).then(function(o){if(!("url"in o))return void i("Error parsing 'url' key from player live API refresh endpoint: "+r+" "+o);var a=o.url;e._loadManifestFromExplcitRedirect(a,t).then(n).catch(i)}).catch(i)})}},{key:"_loadManifestFromExplcitRedirect",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Vi(function(i,r){t._apiManifestUrl=e,t._requestJSON(t._apiManifestUrl).then(function(e){return"url"in e?(t._manifestUrl=e.url,void t._loadManifest(t._manifestUrl,n).then(i).catch(r)):void r("Error parsing 'url' key from Live API manifest endpoint: "+t._apiManifestUrl+" "+e)}).catch(r)})}},{key:"_loadManifest",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Vi(function(i,r){var o=new XMLHttpRequest;o.open("GET",e,!0),o.onload=function(){if(410===o.status)return n>=Rv?void r("Manifest load responded with a 410. Giving up refreshing after "+n+" attempts"):(r("Manifest load responded with a 410. Attempting to refresh manifest URL"),void t._refreshLiveApiPlaylistUrl(++n).then(function(){t._manifestRefresh(t._manifestUrl,Math.max(1e3*t._manifest.minimumUpdatePeriod,Tv))}));if(200!==o.status){if(t._hasEnded)return void r("Live stream has ended");if(!t._hasLoadedManifest&&n<Lv)return void setTimeout(function(){t._loadManifest(e,++n).then(i).catch(r)},Av);t._livePoller.isForcePolling||t._livePoller.forcePolling(),(t._atDurationEnd()&&t._isOnline||!t._hasLoadedManifest)&&(t._isOnline=!1,t.fire(bh.STREAM_OFFLINE));var a=Math.min(1e3*Math.pow(2,n)+1e3*Math.random(),xv);return void setTimeout(function(){t._loadManifest(e,++n).then(i).catch(r)},a)}try{t._manifest=new gv(o.response,e),t._hasLoadedManifest||(t._hasLoadedManifest=!0),t._livePoller.isForcePolling&&t._livePoller.unforcePolling();var s=t._noSegmentsLoadedCount[Ev]>Ov||t._noSegmentsLoadedCount[Sv]>Ov;t._isOnline||s||(t._isOnline=!0,t.fire(bh.STREAM_ONLINE)),t._isOnline&&s&&t._atDurationEnd()&&(t._isOnline=!1,t.fire(bh.STREAM_OFFLINE)),i()}catch(e){r(e)}},o.onerror=function(){return n>=Rv?void r("DASH manifest failed to load. Giving up refreshing after "+n+" attempts."):(r("DASH manifest failed to load. Attempting to refresh manifest URL."),void t._refreshLiveApiPlaylistUrl(++n).then(function(){t._manifestRefresh(t._manifestUrl,Math.max(1e3*t._manifest.minimumUpdatePeriod,Tv))}))},o.send()})}},{key:"_loadMpd",value:function(e){var t=this;return new Vi(function(n,i){t._loadManifestFromExplcitRedirect(e).then(function(){t._setUpSorcerer(t._video),t._streams[Sv]=t._sortStreams(t._manifest.videoRepresentations);var e=t._manifest.videoAdaptationSet.mimeType;if(t._streams[Sv].forEach(function(n,i){t._sorcerer.addStream(e+'; codecs="'+t._streams[Sv][i].codecs+'"',t._streams[Sv][i].segmentList.initSegment)}),t._appendSegments(Sv),t._manifest.audioRepresentations){t._hasAudioRepresentation=!0,t._streams[Ev]=t._sortStreams(t._manifest.audioRepresentations);var i=t._manifest.audioAdaptationSet.mimeType;t._streams[Ev].forEach(function(e,n){t._sorcerer.addStream(i+'; codecs="'+t._streams[Ev][n].codecs+'"',t._streams[Ev][n].segmentList.initSegment)}),t._appendSegments(Ev)}return t.fire(bh.REPRESENTATIONS_AVAILABLE,t._streams),t._setupSorcererEvents(),t._checkForStreamSwitch(),t._manifestRefresh(t._manifestUrl,Math.max(1e3*t._manifest.minimumUpdatePeriod,Tv)),t._forcePlayOnManifestLoad&&(t._forcePlayOnManifestLoad=!1,t.play()),n()}).catch(function(e){i(e)})})}},{key:"_setUpSorcerer",value:function(e){this._sorcerer&&this._sorcerer.destroy(),this._sorcerer=new ev(e)}},{key:"_setupSorcererEvents",value:function(){var e=this;this._sorcerer.video.on("streamchange",function(t){e._streamChanging=!1;var n=e._streams[Sv];n[t].bitrate=n[t].bandwidth;var i={index:t,streams:n};e.fire(_h.STREAM_CHANGE,i)}),this.sorcerer.on("progress",this._handleProgress.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this))}},{key:"setVideoSrc",value:function(e,t){switch(this._telecineVideo.currentFile.mime){case Dv:this._loadMpd(e);break;case Fv:this._video.src=e,this._loadHls()}}},{key:"_handleDownloadEnd",value:function(e){if("string"==typeof e){var t=e.split("_");this._lastSegmentAppended[t[0]]=Number(t[2])}}},{key:"_handleStreamChange",value:function(e){this._streamChanging=!1;var t=this._streams[Sv];t[e].bitrate=t[e].bandwidth;var n={index:e,streams:t};this.fire(_h.STREAM_CHANGE,n)}},{key:"_handleProgress",value:function(){if(this._options.tests.download_bitrate&&this._options.tests.download_bitrate.group){var e=this._streams[Sv][this._sorcerer.video.activeStreamIndex],t=this._sorcerer.getAverageDownloadBitrate(this._options.tests.download_bitrate.data.duration);if(this._lastDownloadBitrate!==t&&0!==t){this._lastDownloadBitrate=t;var n={speed:t,bitrate:e.bitrate};this.fire(_h.BANDWIDTH,n)}}}},{key:"_isPlaybackHLS",value:function(){return this._telecineVideo.currentFile.mime===Fv}},{key:"_loadHls",value:function(){this.fire(bh.STREAM_ONLINE),this._checkHlsAvailability(Iv)}},{key:"_checkHlsAvailability",value:function(e){var t=this,n=function(){t.fire(bh.STREAM_OFFLINE),t._livePoller.forcePolling()};this._hlsAvailabilityCheckTimeout=setTimeout(function(){var e=new XMLHttpRequest;e.open("GET",t._video.src),e.onload=function(){200!==e.status&&n(),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&n()},e.onerror=function(){n()},e.send()},e)}},{key:"_manifestRefresh",value:function(e,t){var n=this;this._manifestTimeout=setTimeout(function(){return n.paused&&n._hasPlayed?void n._pauseReset():void n._loadManifest(e).then(function(){return n._streams[Sv]=n._sortStreams(n._manifest.videoRepresentations),n._appendSegments(Sv),n._hasAudioRepresentation&&(n._streams[Ev]=n._sortStreams(n._manifest.audioRepresentations),n._appendSegments(Ev)),n._manifestRefresh(e,Math.max(1e3*n._manifest.minimumUpdatePeriod,Tv))}).catch(function(e){})},t)}},{key:"_segmentIndexCompare",value:function(e,t){return e.index<t.index?-1:e.index>t.index?1:0}},{key:"_appendSegments",value:function(e){if(this._sorcerer&&this._sorcerer[e]){for(var t=this._sorcerer[e].activeStreamIndex,n=this._sorcerer[e].streams[t],i=e===Sv?this._streams[Sv][t].segmentList:this._streams[Ev][t].segmentList,r=i.segments.sort(this._segmentIndexCompare),o=0,a=0;a<r.length;a++){var s=r[a];if(!(s.index<i.startNumber||s.index<=this._lastSegmentAppended[e])){var u=e+"_"+t+"_"+s.index;n.addSegment(s.url,{identifier:u}),o++}}0===o?this._noSegmentsLoadedCount[e]++:this._noSegmentsLoadedCount[e]=0}}},{key:"_checkForStreamSwitch",value:function(){if(!this._streamChanging){var e=this._abr.filterStreams(this._streams[Sv]),t=this._abr.optimalStreamIndex(e,this._lastStreamIndex);if(t!==this._lastStreamIndex){var n=e.find(function(e){return e.index===t}),i=this._streams[Sv];i[t].bitrate=i[t].bandwidth;var r={index:t,streams:i};this.fire(_h.STREAM_TARGET_CHANGE,r),this._streamChanging=!0,this._sorcerer[Sv].switchTo(n,!0),this._lastStreamIndex=t}}}},{key:"_checkForPlaybackGap",value:function(){if(this._video.buffered.length)return this._bufferedIndex>this.buffered.length-1&&(this._bufferedIndex=this.buffered.length-1),this._video.currentTime<this._video.buffered.start(this._bufferedIndex)?void(this._video.currentTime=this._video.buffered.start(this._bufferedIndex)):void(Math.floor(this._video.currentTime)+Cv<Math.floor(this._video.buffered.end(this._bufferedIndex))||this._video.buffered.length-1>this._bufferedIndex&&(this._bufferedIndex++,this._video.currentTime=this._video.buffered.start(this._bufferedIndex)))}},{key:"_atDurationEnd",value:function(){return this._video.currentTime+Pv>this._video.duration}},{key:"getBitrateAtTime",value:function(e,t){if(!this._sorcerer)return 0;var n=this._sorcerer.streamIndexAtTime(e,t);return this._streams[t][n]?this._streams[t][n].bandwidth:0}},{key:"_timeSince",value:function(e){return Date.now()-e}},{key:"_sortStreams",value:function(e){function t(e,t){var n=e.width*e.height*e.bandwidth,i=t.width*t.height*t.bandwidth;return n-i}var n=e.slice(0);return n.sort(t),n.forEach(function(e,t){e.index=t}),n}},{key:"onprogress",value:function(){this._checkForPlaybackGap(),this._isPlaybackHLS()&&this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null,this._livePoller.unforcePolling())}},{key:"ondurationchange",value:function(){this._checkForPlaybackGap()}},{key:"ontimeupdate",value:function(){if(this._sorcerer){if(this.fire(_h.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal()),!this._options.tests.download_bitrate||this._options.tests.download_bitrate&&!this._options.tests.download_bitrate.group){var e=this._sorcerer[Sv].activeStreamIndex;if(e){var t={speed:this._sorcerer.getCurrentSpeed({type:"average",howMany:3,weights:[1,2,5]}),bitrate:this._streams[Sv][e].bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(_h.BANDWIDTH,t)}}!this._isOnline&&this._atDurationEnd()&&this.fire(_h.STREAM_OFFLINE),this._timeSince(this._timeSinceLastStreamSwitchCheck)>this.STREAM_SWITCH_CHECK_INTERVAL&&(this._checkForStreamSwitch(),this._timeSinceLastStreamSwitchCheck=Date.now())}}},{key:"onstalled",value:function(){this._isPlaybackHLS()&&this._checkHlsAvailability(Mv)}},{key:"onwaiting",value:function(){}},{key:"seekToTime",value:function(){}},{key:"pause",value:function(){Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"pause",this).call(this),this._isPlaybackHLS()||this._pauseReset()}},{key:"play",value:function(){var e=this;return new Vi(function(n,i){if(!e._manifestUrl)return void(e._forcePlayOnManifestLoad=!0);e._manifestTimeout||e._isPlaybackHLS()||e._manifestRefresh(e._manifestUrl,Tv);var r=function(){e._sorcerer&&e._hasPlayed&&e._sorcerer.removeBuffer(),e._hasPlayed=!0,n(Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"play",e).call(e))};if(e._video.readyState||hh.android||hh.iOS)return void r();var o=function t(){e._video.removeEventListener("canplay",t),r()};e._video.addEventListener("canplay",o)})}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}},{key:"videoWidth",get:function(){return this._stream?this._stream.width:this._video.videoWidth}},{key:"videoHeight",get:function(){return this._stream?this._stream.height:this._video.videoHeight}},{key:"duration",get:function(){return this._video.duration}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this._video.currentTime=e}},{key:"isLowerProfileAvailable",get:function(){return this._sorcerer?this._sorcerer[Sv].activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this._sorcerer}},{key:"segmentLength",get:function(){return Cv}}]),t}(qh),Nv=function(){var e="Shockwave Flash",t="application/x-shockwave-flash",n="ShockwaveFlash.ShockwaveFlash",i=window.navigator,r=0,o=!1,a=null;if("undefined"!=typeof i.plugins&&"object"===Nf(i.plugins[e])){if(a=i.plugins[e].description,a&&("undefined"==typeof i.mimeTypes||!i.mimeTypes[t]||i.mimeTypes[t].enabledPlugin)){o=!0,a=a.replace(/^.*\s+(\S+\s+\S+$)/,"$1");var s=parseInt(a.replace(/^(.*)\..*$/,"$1"),10),u=parseInt(a.replace(/^.*\.(.*)\s.*$/,"$1"),10);r=parseFloat(s+"."+u)}}else if("undefined"!=typeof window.ActiveXObject)try{var c=new ActiveXObject(n);c&&(a=c.GetVariable("$version"),a&&(o=!0,a=a.split(" ")[1].split(","),r=parseFloat(parseInt(a[0],10)+"."+parseInt(a[1],10))))}catch(e){}return{installed:o,version:r}}(),qv=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(qf(this,t),!n.swfScanner||!n.swfScanner.swfUrl)throw new Error("The url to the swf is required to use the SWFScanner.");var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),r="flideo_"+dn().replace(/-/g,"_");return window[r]={onFlashEvent:function(e){return i.onEvent(e)}},i._swf=i.createSwf(i._options.swfScanner.swfUrl,r+".onFlashReady"),i._element.appendChild(i._swf),i._loaded=!1,i._volume=1,i._muted=!1,i._loadedPromise=new Vi(function(e,t){window[r].onFlashReady=function(){i._loaded=!0,i.attachVideoEvents(r+".onFlashEvent"),e()},setTimeout(t,1e4)}),i}return Hf(t,e),jf(t,null,[{key:"displayName",get:function(){return"SWFScanner"}},{key:"supported",get:function(){return Nv.installed&&Nv.version>=10.1}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4","video/x-flv"]}}]),jf(t,[{key:"deactivate",value:function(){this._swf.parentElement.removeChild(this._swf)}},{key:"play",value:function(){var e=this;return this._loadedPromise.then(function(){return e._swf._play()})}},{key:"pause",value:function(){var e=this;this.onLoaded(function(){return e._swf._pause()})}},{key:"attachVideoEvents",value:function(e){var t=this;Object.keys(mh).forEach(function(n){var i=mh[n];t._swf.api_addEventListener(i,e)})}},{key:"createSwf",value:function(e,t){var n=document.createElement("object");n.setAttribute("type","application/x-shockwave-flash"),n.setAttribute("width","100%"),n.setAttribute("height","100%"),n.setAttribute("data",e);var i={flashvars:"ready="+t,movie:e,allowfullscreen:"true",allowscriptaccess:"always",bgcolor:"#000000",wmode:"opaque",quality:"high",scalemode:"noscale"};for(var r in i){var o=document.createElement("param");o.setAttribute("name",r),o.setAttribute("value",i[r]),n.appendChild(o)}return n}},{key:"onEvent",value:function(e){"function"==typeof this["on"+e.type]&&this["on"+e.type](e)===!1||this.fire(e.type,e)}},{key:"onLoaded",value:function(e){this._loadedPromise=this._loadedPromise.then(e)}},{key:"onerror",value:function(){var e=this._swf.getError(),t=e.code;switch(t){case 1:return this.fire(mh.ERROR,new TelecineError("MediaAbortedError","The user agent aborted the fetching of the media.")),!1;case 2:return this.fire(mh.ERROR,new TelecineError("MediaNetworkError","A network error ocurred while fetching the media.")),!1;case 3:return this.fire(mh.ERROR,new TelecineError("MediaDecodeError","The media could not be decoded.")),this._switchToNextFile(),!1;case 4:return this.fire(mh.ERROR,new TelecineError("MediaSrcNotSupportedError","The media was not suitable.")),this._switchToNextFile(),!1;default:return this.fire(mh.ERROR,new TelecineError("MediaUnknownError","An unknown error occurred.")),!1}}},{key:"buffered",get:function(){if(!this._loaded)return Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"buffered",this);var e=this._swf.getBuffered(),n=e.start,i=e.end;return yn(n,i)}},{key:"currentFile",get:function(){return Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",this)},set:function(e){var n=this,i=this._currentFile;zf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentFile",e,this),this.onLoaded(function(){var t=!n._swf.getPaused(),r=n._swf.getCurrentTime();n._swf.setSrc(e.src),n.fire(_h.CURRENT_FILE_CHANGE,e),i&&(n._swf.setCurrentTime(r),t&&n._swf._play())})}},{key:"currentTime",get:function(){return this._loaded?this._swf.getCurrentTime():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"currentTime",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setCurrentTime(e)})}},{key:"duration",get:function(){return this._loaded?this._swf.getDuration():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"duration",this)}},{key:"ended",get:function(){return this._loaded?this._swf.getEnded():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ended",this)}},{key:"loop",get:function(){return this._loaded?this._swf.getLoop():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"loop",this)},set:function(e){var t=this;this.onLoaded(function(){return t._swf.setLoop(e)})}},{key:"muted",get:function(){return this._muted},set:function(e){var t=this;this._muted=e;var n=e===!0?0:this._volume;this.onLoaded(function(){return t._swf.setVolume(n)})}},{key:"paused",get:function(){return this._loaded?this._swf.getPaused():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"paused",this)}},{key:"videoWidth",get:function(){return this._loaded?this._swf.getVideoWidth():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"videoWidth",this)}},{key:"videoHeight",get:function(){return this._loaded?this._swf.getVideoHeight():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"videoHeight",this)}},{key:"volume",get:function(){return this._loaded?this._swf.getVolume():Uf(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"volume",this)},set:function(e){var t=this;this._volume=e,this.onLoaded(function(){return t._swf.setVolume(e)})}}]),t}(Eh),jv=new Bf,Vv=new Bf,TelecineFile=function(){function TelecineFile(e,t){var n=e.src,i=e.mime,r=e.id,o=void 0===r?dn():r,a=e.priority,s=void 0===a?0:a,u=e.metadata,c=void 0===u?{}:u;if(qf(this,TelecineFile),!n)throw new TypeError("Must provide a src for the file.");if(!i)throw new TypeError("Must provide a mime type for the file.");"application/x-mpegURL"===i&&(i="application/vnd.apple.mpegurl"),Object.defineProperties(this,{mime:{value:i,enumerable:!0},id:{value:""+o,enumerable:!0},metadata:{value:c,enumerable:!0}}),this.video=t,this.priority=s,this.src=n}return jf(TelecineFile,[{key:"priority",get:function(){return jv.get(this)},set:function(e){if(e=parseInt(e,10),"number"==typeof e&&isFinite(e)&&Math.floor(e)===e&&e>=0)return void jv.set(this,e);throw new TypeError("The file priority must be an integer greater than or equal to 0.")}},{key:"src",get:function(){return Vv.get(this)},set:function(e){Vv.set(this,e),this.video.fire(_h.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}]),TelecineFile}(),Uv=["disabled","hidden","showing"],Hv=["subtitles","captions","descriptions","chapters","metadata"],Wv=["ar","fa","he","iw","ku","ps","sd","ur","yi"],zv=new Bf,Gv=new Bf,TelecineTextTrack=function(){function TelecineTextTrack(e,t){var n=e.kind,i=e.src,r=void 0===i?null:i,o=e.label,a=void 0===o?"":o,s=e.language,u=void 0===s?"":s,c=e.id,l=void 0===c?dn():c;if(qf(this,TelecineTextTrack),Hv.indexOf(n)===-1)throw on(12,"SYNTAX_ERR","Syntax Error");rn(this),Object.defineProperties(this,{kind:{value:n,enumerable:!0},label:{value:a,enumerable:!0},language:{value:u,enumerable:!0},id:{value:""+l,enumerable:!0},rtl:{value:Wv.indexOf(u.substr(0,2))!==-1,enumerable:!0}}),this.video=t,this.src=r,this._modeHasBeenSet=!1,zv.set(this,"disabled")}return jf(TelecineTextTrack,[{key:"dispatchEvent",value:function(e){this.fire(e,{target:this})}},{key:"mode",get:function(){return zv.get(this)},set:function(e){if(Uv.indexOf(e)>-1){if(this._modeHasBeenSet=!0,zv.get(this)===e)return;zv.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Gv.get(this)},set:function(e){Gv.set(this,e),this.video.fire(_h.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[];
}}]),TelecineTextTrack}(),Kv=function(){function e(t,n){qf(this,e),this._cdms=t.cdms,this._lrToken=t.lr_token,this._userId=t.user,this._assetId=t.asset,this._useHls=n,this._licenseUrl=null,this._keySession=null,this._preferredKeySystem=null,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this)}return jf(e,[{key:"init",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this._video=e._video,this._scanner=e,this._canHandleEME()?(this._licenseRequestMetadata=this._getLicenseRequestHeader(),this._getKeySystems(n).then(function(e){if(e.forEach(function(e){e.keySystem&&(t._preferredKeySystem=e)}),!t._preferredKeySystem)return t._scanner.fire(_h.EME_UNSUPPORTED),!1;var n=t._getCdmFromSystem(t._preferredKeySystem);return t._encryptedEventName="encrypted",t._licenseUrl=n.license_url,t._useHls&&(t._certificateUrl=n.certificate_url,t._encryptedEventName="webkitneedkey"),t._video.addEventListener(t._encryptedEventName,t._boundGenerateRequest),t._useHls?(t._video.webkitSetMediaKeys(t._preferredKeySystem.keySystem),!0):t._video.mediaKeys?(t._keySession=t._video.mediaKeys.createSession(),t._keySession.addEventListener("message",function(e){return t._getLicense(e)}),!0):(t._keySession=t._preferredKeySystem.keySystem.createSession(),t._keySession.addEventListener("message",function(e){return t._getLicense(e)}),t._video.setMediaKeys(t._preferredKeySystem.keySystem),!0)})):(this._scanner.fire(_h.EME_UNSUPPORTED),!1)}},{key:"destroy",value:function(){this._keySession&&this._keySession.sessionId&&this._keySession.close(),this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)}},{key:"_generateRequest",value:function(e){var t=this;return"com.apple.fps.1_0"===this._preferredKeySystem.name?(this._loadFairPlayCertificate().then(function(n){t._contentId="assetId="+t._assetId;var i=t._concatInitDataIdAndCertificate(e.initData,t._contentId,n);return t._keySession=t._preferredKeySystem.keySystem.createSession("video/mp4",i),t._keySession.addEventListener("webkitkeymessage",function(e){return t._getLicense(e)},!1),n}).catch(function(e){t._scanner.fire(e.error,e.payload)}),!0):!this._keySession.sessionId&&!this._activeKeySession&&(this._activeKeySession=this._keySession.generateRequest(e.initDataType,e.initData).catch(function(){t._scanner.fire(_h.DRM_FAILURE)}),!0)}},{key:"_getLicense",value:function(e){var t=this;return new Vi(function(n,i){t._activeKeySession=null;var r=new XMLHttpRequest;r.keySession=e.target,r.responseType="arraybuffer",r.open("POST",t._licenseUrl),r.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(t._licenseRequestMetadata)));var o=e.message;if("com.microsoft.playready"===t._preferredKeySystem.name){var a=t._unpackPlayReadyRequest(e.message),s=a[0];Object.keys(s).forEach(function(e){r.setRequestHeader([e],s[e])}),o=a[1]}if("com.apple.fps.1_0"===t._preferredKeySystem.name){var u=btoa(String.fromCharCode.apply(null,o));u=encodeURIComponent(u),o="spc="+u+"&"+t._contentId,r.setRequestHeader("Content-type","application/x-www-form-urlencoded")}r.onload=function(){if(403===r.status){var e=JSON.parse(r.getResponseHeader("x-dt-error-message"));return void i({error:"drmauthfailure",payload:{text:e.error,code:e.error_code}})}if(r.status>=400)return void i({error:"drmfailure"});try{t._scanner.fire(_h.DRM_AUTH_SUCCESS);var o=new Uint8Array(r.response),a=o.buffer;"com.apple.fps.1_0"===t._preferredKeySystem.name&&(a=t._unpackFairPlayLicenseResponse(btoa(String.fromCharCode.apply(null,o)))),r.keySession.update(a),n()}catch(e){i("Error updating key session: "+e)}},r.onerror=i,r.send(o)}).catch(function(e){t._scanner.fire(e.error,e.payload)})}},{key:"_canHandleEME",value:function(){var e=!!(window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys);return e}},{key:"_concatInitDataIdAndCertificate",value:function(e,t,n){"string"==typeof t&&(t=vn(t));var i=0,r=new ArrayBuffer(e.byteLength+4+t.byteLength+4+n.byteLength),o=new DataView(r),a=new Uint8Array(r,i,e.byteLength);a.set(e),i+=e.byteLength,o.setUint32(i,t.byteLength,!0),i+=4;var s=new Uint8Array(r,i,t.byteLength);s.set(t),i+=s.byteLength,o.setUint32(i,n.byteLength,!0),i+=4;var u=new Uint8Array(r,i,n.byteLength);return u.set(n),new Uint8Array(r,0,r.byteLength)}},{key:"_loadFairPlayCertificate",value:function(){var e=this;return new Vi(function(t,n){var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e._certificateUrl),i.setRequestHeader("dt-custom-data",window.btoa(JSON.stringify(e._licenseRequestMetadata))),i.onload=function(){if(403===i.status){var e=JSON.parse(i.getResponseHeader("x-dt-error-message"));return void n({error:"drmauthfailure",payload:{text:e.error,code:e.error_code}})}if(i.status>=400)return void n({error:"drmfailure"});try{t(new Uint8Array(i.response))}catch(e){n(e)}},i.onerror=n,i.send()})}},{key:"_getCdmFromSystem",value:function(e){var t=this,n=null;return Object.keys(this._cdms).forEach(function(i){e.name===t._cdms[i].id&&(n=t._cdms[i])}),n}},{key:"_unpackFairPlayLicenseResponse",value:function(e){var t=window.atob(e.trim());return"<ckc>"===t.substr(0,5)&&"</ckc>"===t.substr(-6)&&(t=t.slice(5,-6)),new Uint8Array(atob(t).split("").map(function(e){return e.charCodeAt(0)}))}},{key:"_unpackPlayReadyRequest",value:function(e){for(var t=String.fromCharCode.apply(null,new Uint16Array(e)),n=(new DOMParser).parseFromString(t,"application/xml"),i={},r=n.getElementsByTagName("HttpHeader"),o=0;o<r.length;++o){var a=r[o].querySelector("name"),s=r[o].querySelector("value");i[a.textContent]=s.textContent}var u=n.querySelector("Challenge");return e=new Uint8Array(atob(u.textContent).split("").map(function(e){return e.charCodeAt(0)})),[i,e]}},{key:"_getLicenseRequestHeader",value:function(){var e={},t=window.screen.availWidth+"x"+window.screen.availHeight,n=window.devicePixelRatio;return e.merchant="vimeo",e.sessionId=JSON.stringify({ua:navigator.userAgent,token:this._lrToken,resolution:t,pixelRatio:n}),e.userId=this._userId,e}},{key:"_getKeySystems",value:function(e){var t=this,n=e.audio||[],i=e.video||[],r={persistentState:"optional",sessionTypes:["temporary"]};i.length&&(r.videoCapabilities=i.map(function(e){return{contentType:e}})),n.length&&(r.audioCapabilities=n.map(function(e){return{contentType:e}}));var o=Object.keys(this._cdms).map(function(e){var n=t._cdms[e].id;if(t._useHls){var i=null;try{i=new window.WebKitMediaKeys(n)}catch(e){}return Vi.resolve({name:n,keySystem:i})}return navigator.requestMediaKeySystemAccess(n,[r,{}]).then(function(e){return e.createMediaKeys()}).catch(function(e){}).then(function(e){return{name:n,keySystem:e}})});return Vi.all(o)}}]),e}(),Yv=new Bf,TelecineVideo=function(){function TelecineVideo(e){var t=this,n=e.files,i=e.id,r=void 0===i?dn():i,o=e.title,a=void 0===o?null:o,s=e.subtitle,u=void 0===s?null:s,c=e.metadata,l=void 0===c?{}:c,d=e.textTracks,f=void 0===d?un():d,h=e.externalDisplayFiles,v=void 0===h?{}:h;if(qf(this,TelecineVideo),!n||!Array.isArray(n))throw new TypeError("Must provide files for the video.");rn(this);var p=sn(n.map(function(e){return e instanceof TelecineFile?(e.video=t,e):new TelecineFile(e,t)})),m=un(f.map(function(e){return e instanceof TelecineTextTrack?(e.video=t,e):new TelecineTextTrack(e,t)}));Object.keys(v).forEach(function(e){!v[e]||v[e]instanceof TelecineFile||(v[e]=new TelecineFile(v[e],t))}),Object.defineProperties(this,{id:{value:""+r,enumerable:!0},title:{value:a,enumerable:!0},subtitle:{value:u,enumerable:!0},metadata:{value:l,enumerable:!0},files:{value:p,enumerable:!0},textTracks:{value:m,enumerable:!0},externalDisplayFiles:{value:v,enumerable:!0}}),l.drm&&(this._drmHandler=new Kv(l.drm,l.useHls))}return jf(TelecineVideo,[{key:"deactivate",value:function(){var e=this;this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach(function(t){return e.currentScanner.removeTextTrack(t)})}},{key:"drmHandler",get:function(){return this._drmHandler||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(e){this.currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return Yv.get(this)},set:function(e){var t=this;this.currentScanner&&this.currentScanner.constructor.supportsTextTracks&&this.textTracks.forEach(function(e){return t.currentScanner.removeTextTrack(e)}),e.constructor.supportsTextTracks&&this.textTracks.forEach(function(t){return e.addTextTrack(t)}),Yv.set(this,e)}}]),TelecineVideo}(),Xv={pending:"pending",active:"active",started:"started",ended:"ended"},$v={started:"started",done:"done",error:"error"},Qv=5e3,Jv=3,Zv=function(){function e(t){qf(this,e),rn(this),this.liveEvent=t,this._forcedPoll=!1,this._setupPolling()}return jf(e,[{key:"forcePolling",value:function(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())}},{key:"unforcePolling",value:function(){this._forcedPoll=!1}},{key:"_setupPolling",value:function(){return this._shouldPollApp()?void this._pollApp():void(this._shouldPoll()&&this._pollLiveApi())}},{key:"_shouldPoll",value:function(){return(this.liveEvent.status!==Xv.ended||!this.liveEvent.archive||this.liveEvent.archive.status===$v.started)&&(!!this.isForcePolling||this.liveEvent.status!==Xv.started)}},{key:"_shouldPollApp",value:function(){return!this.liveEvent.sessionUrl||this.liveEvent.status===Xv.pending&&null===this.liveEvent.id}},{key:"_request",value:function(e){return new Vi(function(t,n){var i=new XMLHttpRequest;i.open("GET",e,!0),i.onload=function(){if(200!==i.status)return n(i.status);try{var r=JSON.parse(i.response);return t(r)}catch(t){return n(new Error("Failed to parse request response: "+e+" "+t))}},i.onerror=function(){return n(new Error("Request error: "+e))},i.send()})}},{key:"_getSessionUrl",value:function(){var e=this;return new Vi(function(t,n){e._request(e.liveEvent.sessionRefreshUrl).then(function(n){e.liveEvent.sessionUrl=n.url,t(n.url)}).catch(n)})}},{key:"_pollLiveApi",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!(t>Jv))return this._request(this.liveEvent.sessionUrl).then(function(t){if(t.status!==e.liveEvent.status){var n="liveevent"+t.status;try{e.fire(n,t)}catch(e){}}if(t.archive&&(!e.liveEvent.archive||t.archive.status!==e.liveEvent.archive.status)){var i="livearchive"+t.archive.status;e.fire(i,t)}e.liveEvent=Object.assign(e.liveEvent,t),e._shouldPoll()&&setTimeout(e._pollLiveApi.bind(e),Qv)}).catch(function(n){if("number"==typeof n&&410===n)return e._getSessionUrl.then(function(){setTimeout(e._pollLiveApi.bind(e,++t),Qv)})})}},{key:"_pollApp",value:function(){var e=this;return this._request(this.liveEvent.appPollUrl).then(function(t){return null!==t.ingest.session_id?(e.liveEvent.id=t.ingest.session_id,e._getSessionUrl().then(e._pollLiveApi.bind(e))):setTimeout(e._pollApp.bind(e),Qv)})}},{key:"isForcePolling",get:function(){return this._forcedPoll}}]),e}(),ep=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};qf(this,e),this._element=t,this._scanners=n,this._options=i,this._video=null,this._textTracks=un(),this._properties={},this._currentScanner=new Eh,this._blacklistedScanners=[],this._activeEffects=[],this._options.liveEvent&&this.initLiveEvent(this._options.liveEvent),rn(this)}return jf(e,[{key:"supportsEffect",value:function(e){var t=this;return!!e.supported&&e.supportedScanners.some(function(e){return t._getScannerName(t._currentScanner)===e.displayName})}},{key:"getEffectByName",value:function(e){var t=this,n=null;return this._activeEffects.forEach(function(i){e===t._getEffectName(i)&&(n=i)}),n}},{key:"activateEffect",value:function(e,t){var n=new e(this,t);return n.activate(),this._activeEffects.push(n),n}},{key:"deactivateEffect",value:function(e){var t=this;this._activeEffects.some(function(n,i){return n.constructor===e&&(n.deactivate(),t._activeEffects.splice(i,1),!0)})}},{key:"deactivateEffects",value:function(){var e=this;this._activeEffects.forEach(function(t){return e.deactivateEffect(t.constructor)})}},{key:"play",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");var e=this._currentScanner.play();return this._properties.paused=!1,e}},{key:"pause",value:function(){if(!this._video||this._video.files.length<1)throw new TelecineError("NoFiles","There are no files to play.");return this._currentScanner.pause(),this._properties.paused=!0,this}},{key:"getBitrateAtTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"video";return"MediaSourceScanner"!==this._getScannerName(this._currentScanner)&&"LiveScanner"!==this._getScannerName(this._currentScanner)?0:"audio"===t&&this._currentScanner._streams[t].length<=1?0:this._currentScanner.getBitrateAtTime(e,t)}},{key:"showExternalDisplayPicker",value:function(e){return this._currentScanner.showExternalDisplayPicker(e)}},{key:"supportsPresentationMode",value:function(e){return this.supportedPresentationModes.indexOf(e)!==-1}},{key:"addCuePoint",value:function(e,t){return this._currentScanner.addCuePoint(e,t)}},{key:"removeCuePoint",value:function(e){return this._currentScanner.removeCuePoint(e)}},{key:"removeAllCuePoints",value:function(){return this._currentScanner.removeAllCuePoints()}},{key:"_findScanner",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.textTrackSupport,n=void 0!==t&&t,i=this._video.files.map(function(e){return e.mime}),r=this._scanners,o=r,a=Array.isArray(o),s=0,o=a?o:o[Au.iterator]();;){var u;if(a){if(s>=o.length)break;u=o[s++]}else{if(s=o.next(),s.done)break;u=s.value}var c=u;if(c.supported&&(!n||c.supportsTextTracks)&&this._blacklistedScanners.indexOf(this._getScannerName(c))===-1){var l=c.supportedVideoTypes;if(l.some(function(e){return i.indexOf(e)!==-1}))return c}}return n?(this.fire(mh.ERROR,new TelecineError("TextTracksNotSupported","None of the scanners support text tracks in this browser.")),this._blacklistedScanners=[],this._findScanner()):null}},{key:"_initScanner",value:function(e,t){var n=this;if(this._currentScanner.constructor!==e||this._currentScanner.video!==t){this._currentScanner.deactivate();var i=new e(this._element,this._options);Object.keys(Sh).forEach(function(e){var t=Sh[e];i.on(t,function(e){return n._handleEvent(t,e,i)})}),this._currentScanner=i,t.currentScanner=i,this._currentScanner.video=t;for(var r=Object.keys(this._properties),o=0;o<r.length;o++){var a=r[o];"paused"!==a?"currentTime"!==a&&(this._currentScanner[a]=this._properties[a]):this._properties.paused===!1&&this._currentScanner.play()}this.fire(_h.SCANNER_CHANGE,this._getScannerName(this._currentScanner))}}},{key:"_updateScanner",value:function(){if(null!==this._video){var e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});return e?void this._initScanner(e,this._video):void this.fire(mh.ERROR,new TelecineError("FilesNotPlayable","None of the files could be played in this browser."))}}},{key:"_handleEvent",value:function(e,t,n){if(n===this._currentScanner){switch(e){case mh.ERROR:return void(t instanceof TelecineError&&this.fire(mh.ERROR,t));case _h.SCANNER_ERROR:this.fire(mh.ERROR,new TelecineError("ScannerError","The current scanner can no longer be used because "+t.reason)),this._blacklistedScanners.push(this._getScannerName(this._currentScanner)),this._updateScanner([]);break;case _h.FILE_ERROR:this.fire(mh.ERROR,new TelecineError("FileError","The current file can no longer be used because "+t.reason)),this._currentScanner._switchToNextFile();break;case _h.DOWNLOAD_ERROR:this.fire(mh.ERROR,new TelecineError("DownloadError",t)),this._currentScanner._switchToNextFile();break;case _h.EME_UNSUPPORTED:this.fire(mh.ERROR,new TelecineError("DRMFailure",{text:null,code:"emeunsupported"}));break;case _h.DRM_FAILURE:this.fire(mh.ERROR,new TelecineError("DRMFailure",{text:null,code:null}));break;case _h.DRM_AUTH_FAILURE:this.fire(mh.ERROR,new TelecineError("DRMFailure",{text:t.text,code:t.code}));break;case _h.DRM_AUTH_SUCCESS:this.fire(_h.DRM_AUTH_SUCCESS);break;case mh.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case _h.MEDIA_URL_EXPIRED:this.fire(mh.ERROR,new TelecineError("MediaUrlExpired",t));break;case wh.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case mh.ENDED:this._properties.paused=!0;break;case mh.WAITING:this.fire(mh.WAITING)}this._activeEffects.forEach(function(t){"function"==typeof t["on"+e]&&t["on"+e]()}),this.fire(e,t)}}},{key:"_getScannerName",value:function(e){return e instanceof Eh?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"_getEffectName",value:function(e){return e instanceof Yf?e.constructor.displayName:e.prototype.constructor.displayName}},{key:"initLiveEvent",value:function(e){var t=this;this._options.livePoller&&(this._options.livePoller=null);var n=new Zv(e);Object.keys(bh).forEach(function(e){var i=bh[e];n.on(i,function(e){t.fire(i,e)})}),this._options.livePoller=n}},{key:"supportsSettingVolume",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsSettingVolume})}},{key:"supportsPlaybackRate",get:function(){return this._currentScanner.constructor.supportsPlaybackRate}},{key:"supportsTextTracks",get:function(){return this._scanners.some(function(e){return e.supported&&e.supportsTextTracks})}},{key:"activeEffects",get:function(){return this._activeEffects}},{key:"isLowerProfileAvailable",get:function(){return this._currentScanner.isLowerProfileAvailable}},{key:"buffered",get:function(){return this._currentScanner.buffered}},{key:"manifestLoadDurations",get:function(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}},{key:"failedSegments",get:function(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}},{key:"cuePoints",get:function(){return this._currentScanner.cuePoints}},{key:"currentFile",get:function(){return this._currentScanner.currentFile},set:function(e){if("string"==typeof e&&(e=this._files.filter(function(t){return t.id===e})[0]),!e)throw new TelecineError("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return this._getScannerName(this._currentScanner)}},{key:"currentTime",get:function(){return this._currentScanner.currentTime},set:function(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}},{key:"duration",get:function(){return this._currentScanner.duration}},{key:"ended",get:function(){return this._currentScanner.ended}},{key:"externalDisplayAvailable",get:function(){return this._currentScanner.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this._currentScanner.externalDisplayActive}},{key:"loop",get:function(){return this._currentScanner.loop},set:function(e){this._properties.loop=e,this._currentScanner.loop=e}},{key:"muted",get:function(){return this._currentScanner.muted},set:function(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}},{key:"playsinline",get:function(){return this._currentScanner.playsinline},set:function(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}},{key:"paused",get:function(){return this._currentScanner.paused}},{key:"defaultPlaybackRate",get:function(){return this._currentScanner.defaultPlaybackRate},set:function(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._currentScanner.playbackRate},set:function(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}},{key:"preload",get:function(){return this._currentScanner.preload},set:function(e){this._properties.preload=e,this._currentScanner.preload=e}},{key:"presentationMode",get:function(){return this._currentScanner.presentationMode},set:function(e){this._currentScanner.presentationMode=e}},{key:"supportedPresentationModes",get:function(){return this._currentScanner.supportedPresentationModes}},{key:"video",get:function(){return this._video},set:function(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._video=new TelecineVideo(e),this._updateScanner()}},{key:"videoWidth",get:function(){return this._currentScanner.videoWidth}},{key:"videoHeight",get:function(){return this._currentScanner.videoHeight}},{key:"volume",get:function(){return this._currentScanner.volume},set:function(e){if(e<0||e>1)throw new TelecineError("IndexSizeError","Failed to set the 'volume' property: The volume provided ("+e+") is outside of the range [0, 1].");this._properties.volume=e,this._currentScanner.volume=e}}]),e}(),tp=50,np=2,ip=20,rp=85,op=60,ap=500,sp=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};qf(this,t);var i=Wf(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return i._activated=!1,i._camera=null,i._scene=null,i._renderer=null,i._animationFrame=null,i.isUserInteracting=!1,i._onMouseDownMouseX=0,i._onMouseDownMouseY=0,i._coordinates={lat:0,long:0},i._previousCoordinates={lat:0,long:0},i._onMouseDownCoordinates={lat:0,long:0},i._phi=0,i._theta=0,i._distance=ap,i._video=i._telecine._currentScanner._video,i._rotation=0,i._gyroVector={x:0,y:0},i._offset={lat:0,long:0},i._writeSpeeds={videoFps:i._options.fps,motionRenderSpeed:op},i._maxTimeBetweenWrites=1e3/i._writeSpeeds.videoFps,i._motionTimeouts=[],i._movingAutomatically=!1,i._deviceMotionHasOccurred=!1,i._updateFromGyroscopePending=!1,i._keysPressed={up:!1,down:!1,left:!1,right:!1},i}return Hf(t,e),jf(t,[{key:"isUserInteracting",set:function(e){if(e!==this._isUserInteracting)return this._isUserInteracting=e,e?void(this._options.isMobile||this._telecine.fire(wh.MOTION_START)):void(this._options.isMobile||this._telecine.fire(wh.MOTION_END))},get:function(){return this._isUserInteracting}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[qh,vv]}}]),jf(t,[{key:"activate",value:function(){var e=this;return new Vi(function(t,n){if(window.THREE)return void t();var i=document.createElement("script");i.src=e._options.threeUrl,document.body.appendChild(i),i.onload=function(){t()}}).then(function(){return e._initialize()})}},{key:"_initialize",value:function(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*ap),this._camera.target=new THREE.Vector3(0,0,0),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene;var e=new THREE.SphereBufferGeometry(ap,120,80);e.scale(-1,1,1),this._texture=new THREE.VideoTexture(this._video),this._texture.minFilter=THREE.LinearFilter,this._texture.format=THREE.RGBFormat,"top-bottom"===this._options.stereoMode&&(this._texture.offset.y=.5,this._texture.repeat.set(1,.5)),"left-right"===this._options.stereoMode&&(this._texture.offset.x=.5,this._texture.repeat.set(.5,1));var t=new THREE.MeshBasicMaterial({map:this._texture}),n=new THREE.Mesh(e,t);this._scene.add(n);try{this._renderer=new THREE.WebGLRenderer}catch(e){return void this._telecine._currentScanner.fire(wh.SPATIAL_UNSUPPORTED)}this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput()}},{key:"onplay",value:function(){this._activated&&(this._showOutput(),this.adjustRenderSize())}},{key:"deactivate",value:function(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1}},{key:"snapToCenter",value:function(){var e=this;this._motionTimeouts.forEach(function(e){return clearTimeout(e)});var t=50,n=this._coordinates.long>=180?360:0,i=0,r={long:(n-this._coordinates.long)/11,lat:(i-this._coordinates.lat)/11};this._rotation=0;for(var o=function(n){e._motionTimeouts.push(setTimeout(function(){0===n&&(e._movingAutomatically=!0,e._options.isMobile||(e._maxTimeBetweenWrites=1e3/e._writeSpeeds.motionRenderSpeed)),n===t-1&&(e._movingAutomatically=!1,e._options.isMobile||(e._maxTimeBetweenWrites=1e3/e._writeSpeeds.videoFps)),e._updateViewpoint(e._coordinates.lat+r.lat/Math.pow(1.1,n),e._coordinates.long+r.long/Math.pow(1.1,n)),e._offset.lat=THREE.Math.radToDeg(e._gyroVector.x)+e._coordinates.lat+r.lat/Math.pow(1.1,n),e._offset.long=THREE.Math.radToDeg(e._gyroVector.y)+e._coordinates.long+r.lat/Math.pow(1.1,n)},n*e._maxTimeBetweenWrites))},a=0;a<t;a++)o(a)}},{key:"activateStereoRendering",value:function(){this._stereo||(this._stereo=new THREE.StereoCamera,this._stereo.aspect=.5,this._renderer.setSize(this._video.clientWidth,this._video.clientHeight),this.adjustRenderSize(),"mono"!==this._options.stereoMode&&this._buildStereoAssets(),this._renderStereoScene())}},{key:"deactivateStereoRendering",value:function(){this._renderer.render(this._scene,this._camera),this._stereo=null,this.adjustRenderSize(),this._update()}},{key:"toggleStereoRendering",value:function(){return this._stereo?void this.deactivateStereo():void this.activateStereo()}},{key:"isStereo",value:function(){return!!this._stereo}},{key:"_buildStereoAssets",value:function(){this._stereoAssets={left:{scene:new THREE.Scene,geometry:new THREE.SphereBufferGeometry(ap,120,80),texture:new THREE.VideoTexture(this._video)},right:{scene:new THREE.Scene,geometry:new THREE.SphereBufferGeometry(ap,120,80),texture:new THREE.VideoTexture(this._video)}};for(var e in this._stereoAssets)this._stereoAssets[e].texture.minFilter=THREE.LinearFilter,this._stereoAssets[e].texture.format=THREE.RGBFormat,this._stereoAssets[e].texture.offset.y=.5,this._stereoAssets[e].texture.repeat.set(1,.5),this._stereoAssets[e].material=new THREE.MeshBasicMaterial({map:this._stereoAssets[e].texture}),this._stereoAssets[e].mesh=new THREE.Mesh(this._stereoAssets[e].geometry,this._stereoAssets[e].material),this._stereoAssets[e].geometry.scale(-1,1,1),this._stereoAssets[e].scene.add(this._stereoAssets[e].mesh)}},{key:"_initializeAutoMovement",value:function(e){e&&e[0]&&"undefined"!=typeof e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)}},{key:"_renderStereoScene",value:function(){this._scene.updateMatrixWorld(),null===this._camera.parent&&this._camera.updateMatrixWorld(),this._stereo.update(this._camera);var e=this._renderer.getSize();this._renderer.autoClear&&this._renderer.clear(),this._renderer.setScissorTest(!0);var t=this._stereoAssets?{right:this._stereoAssets.right.scene,left:this._stereoAssets.left.scene}:{right:this._scene,left:this._scene};this._renderer.setScissor(0,0,e.width/2,e.height),this._renderer.setViewport(0,0,e.width/2,e.height),this._renderer.render(t.right,this._stereo.cameraR),this._renderer.setScissor(e.width/2,0,e.width/2,e.height),this._renderer.setViewport(e.width/2,0,e.width/2,e.height),this._renderer.render(t.left,this._stereo.cameraL),this._renderer.setScissorTest(!1)}},{key:"_updateViewpoint",value:function(e,t){this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-rp,Math.min(rp,e)),t%=360,t=t>=0?t:360+t,this._coordinates.long=t}},{key:"makeContact",value:function(e){this.isUserInteracting=!0,this._motionTimeouts.forEach(function(e){return clearTimeout(e)}),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)}},{key:"move",value:function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;var t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),n=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,n)}},{key:"moveWheel",value:function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;var t=this._coordinates.lat-.1*e.y,n=this._coordinates.long+.1*e.x;this._updateViewpoint(t,n)}},{key:"moveDevice",value:function(e,t,n,i){this._updateFromGyroscopePending=!0;var r=new THREE.Quaternion,o=window.orientation;null===o&&(o=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0;var a=o?THREE.Math.degToRad(o):0,s=new THREE.Vector3(0,0,1),u=new THREE.Euler,c=new THREE.Quaternion,l=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));u.set(t,e,-n,"YXZ"),r.setFromEuler(u),r.multiply(l),r.multiply(c.setFromAxisAngle(s,-a)),this._gyroVector=(new THREE.Euler).setFromQuaternion(r,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(wh.MOTION_START),this._deviceMotionHasOccurred=!0)}},{key:"releaseContact",value:function(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){var t=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(t)}}},{key:"abandonMotion",value:function(){this.isUserInteracting=!1,this._motionStart=null}},{key:"keyPress",value:function(e){this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach(function(e){return clearTimeout(e)})),this._keysPressed[e]||(this._keysPressed[e]=!0)}},{key:"keyUp",value:function(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))}},{key:"_moveFromKeyPress",value:function(){var e=this;Object.keys(this._keysPressed).forEach(function(t){if(e._keysPressed[t])switch(t){case"up":e._updateViewpoint(e._coordinates.lat+np,e._coordinates.long);break;case"down":e._updateViewpoint(e._coordinates.lat-np,e._coordinates.long);break;case"left":e._updateViewpoint(e._coordinates.lat,e._coordinates.long-np);break;case"right":e._updateViewpoint(e._coordinates.lat,e._coordinates.long+np)}})}},{key:"_keyIsDown",value:function(){var e=this;return Object.keys(this._keysPressed).map(function(t){return e._keysPressed[t]}).some(function(e){return e})}},{key:"_moveDueToMomentum",value:function(e){var t=this;e>=ip&&!function(){var n={long:t._coordinates.long-t._previousCoordinates.long,lat:t._coordinates.lat-t._previousCoordinates.lat};e===1/0&&(n.long/=2,n.lat/=2);for(var i=function(e){t._motionTimeouts.push(setTimeout(function(){1===e&&(t._movingAutomatically=!0),e===tp-1&&(t._movingAutomatically=!1,t._maxTimeBetweenWrites=1e3/t._writeSpeeds.videoFps);var i=2/Math.pow(e,1.5);t._offset.lat=THREE.Math.radToDeg(t._gyroVector.x)+t._coordinates.lat+n.lat,t._offset.long=THREE.Math.radToDeg(t._gyroVector.y)+t._coordinates.long+n.long,t._updateViewpoint(t._coordinates.lat+n.lat*i,t._coordinates.long+n.long*i)},e*t._maxTimeBetweenWrites))},r=1;r<tp;r++)i(r)}()}},{key:"onseeked",value:function(){this._activated&&this._update()}},{key:"onresize",value:function(){this.adjustRenderSize(),this.isUserInteracting=!1;
}},{key:"_update",value:function(){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.x=this._distance*Math.sin(this._phi)*Math.cos(this._theta),this._camera.position.y=this._distance*Math.cos(this._phi),this._camera.position.z=this._distance*Math.sin(this._phi)*Math.sin(this._theta),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation,this._stereo?this._renderStereoScene():this._renderer.render(this._scene,this._camera),this._telecine.fire(wh.CAMERA_UPDATE,{lon:this._coordinates.long,lat:this._coordinates.lat})}},{key:"adjustRenderSize",value:function(){this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._distance=Math.min(ap/2,this._options.dimensions.width/this._options.dimensions.height/this._camera.aspect*ap/2);var e=mn(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._camera.aspect=e.width/e.height,this._camera.updateProjectionMatrix(),this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=e.top+"px",this._renderer.render(this._scene,this._camera)}},{key:"getRendererSize",value:function(){return{height:this._renderer.domElement.clientHeight,width:this._renderer.domElement.clientWidth}}},{key:"_startRendering",value:function(){var e=this;this._interval&&window.clearInterval(this._interval),this.adjustRenderSize();var t=1e3/op;this._interval=window.setInterval(function(){e._renderFrame(),e._keyIsDown()&&e._moveFromKeyPress()},t)}},{key:"_stopRendering",value:function(){this._interval&&(window.clearInterval(this._interval),this._interval=null),this._motionTimeouts&&this._motionTimeouts.forEach(function(e){return clearTimeout(e)})}},{key:"_renderFrame",value:function(){this._requestRenderAnimationFrame()}},{key:"_requestRenderAnimationFrame",value:function(){var e=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var t=this._movingAutomatically||this.isUserInteracting||this._updateFromGyroscopePending||this._keyIsDown();this._animationFrame=window.requestAnimationFrame(function(){(!e._telecine._currentScanner.paused&&!e._telecine._currentScanner._ranIntoBuffer||t)&&(e._update(),e._updateFromGyroscopePending=!1)})}},{key:"_showOutput",value:function(){this._styleOutput({backgroundColor:"#000",display:"block"})}},{key:"_hideOutput",value:function(){this._styleOutput({backgroundColor:"#000",display:"none"})}},{key:"_styleOutput",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.backgroundColor,n=e.display;this._output.style.cssText="position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:"+t+";width:100%;height:100%;text-align:center;display:"+n}},{key:"currentCoordinates",get:function(){return this._coordinates},set:function(e){var t=Gf(e,2),n=t[0],i=t[1];if(n>90||n<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(i<0||i>360)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(n,i),this._update()}},{key:"fieldOfView",get:function(){return this._camera.fov},set:function(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}}],[{key:"frustumSurfaceArea",value:function(e,t,n){var i=2*ap*2*Math.sin(Math.PI/180*(e/2)),r=i*t/n,o=i*r,a=4*Math.PI*Math.pow(ap,2),s=o/a;return s}}]),t}(Yf),up="LIVE_SET_STATUS",cp="LIVE_ARCHIVE_SET_STATUS",lp="LIVE_UPDATE",dp=function(e){return{type:up,payload:e}},fp=function(e){return{type:lp,payload:e}},hp="CONFIG_LOAD",vp=function(e){return{type:hp,payload:ic({},xn(e))}},pp=function(e){return!!e.ui.liveEvent.liveStatus&&null!==e.ui.liveEvent.liveStatus},mp=function(e){return pp(e)&&e.ui.liveEvent.liveStatus===vc.pending},gp=function(e){return pp(e)&&e.ui.liveEvent.liveStatus===vc.active},yp=function(e){return pp(e)&&e.ui.liveEvent.liveStatus===vc.started},_p=function(e){return pp(e)&&e.ui.liveEvent.liveStatus===vc.ended},bp=function(e){return pp(e)&&!_p(e)},wp=function(e){return pp(e)&&e.ui.liveEvent.liveArchiveStatus===pc.done},kp=Object.freeze({default:An,liveExists:pp,isLivePending:mp,isLiveActive:gp,isLiveStarted:yp,isLiveEnded:_p,liveInProgress:bp,isLiveArchived:wp}),Sp=function(e){return pp(e)&&e.liveEvent.playback?e.liveEvent.playback.dash_noredirect:null},Ep=function(e){return pp(e)&&e.liveEvent.playback?e.liveEvent.playback.hls:null},Tp=function(e){return pp(e)&&e.liveEvent.ingest?e.liveEvent.ingest.scheduledStartTime:null},xp=Object.freeze({default:Ln,dashLiveUrl:Sp,hlsLiveUrl:Ep,scheduledLiveStartTime:Tp}),Ap={},Lp="en",Pp=function(){return{id:"not-supported",title:"Unsupported viewing environment",message:'Your system is having trouble playing this video. For more information, see our <a href="https://help.vimeo.com/hc/en-us/articles/115015677227-Troubleshoot-player-error-messages" target="_blank" rel="noopener">Help Center</a>.',deferred:!0,final:!0}},Cp=function(){return{id:"drm-failure",title:"Rights issue",message:"We’re having trouble authorizing playback for this video. ",final:!0}},Op=function(){return{id:"not-supported",title:"Unsupported viewing environment",message:'Your system is having trouble playing this video. For more information, see our <a href="https://help.vimeo.com/hc/en-us/articles/115015677227-Troubleshoot-player-error-messages" target="_blank" rel="noopener">Help Center</a>.',deferred:!0,final:!0}},Rp=function(){return{id:"not-supported",final:!1}},Ip=function(){return{id:"decode",final:!1}},Mp=function(){return{id:"network",title:"Network error",message:'A network hiccup interrupted playback. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!0}},Dp=function(){return{id:"unknown",title:"Browser error",message:'We’re having trouble playing this video file. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!0}},Fp=function(){return{id:"telecine-file-error",final:!1}},Bp=function(){return{id:"telecine-download-error",final:!1}},Np=function(){return{id:"media-url-expired",title:"Playback error",message:'We’re having trouble playing this video. Please <a href="javascript:window.location.reload()" rel="noopener">reload the player</a> and try again.',final:!1}},qp=function(){return{id:"scanner-error",final:!1}},jp=function(){return{id:"error",title:"Player error",message:"The player is having trouble. We’ll have it back up and running as soon as possible.",modal:!0,final:!0}},Vp=Object.freeze({BrowserNotSupported:Pp,DRMFailure:Cp,FilesNotPlayable:Op,MediaSrcNotSupportedError:Rp,MediaDecodeError:Ip,MediaNetworkError:Mp,MediaUnknownError:Dp,FileError:Fp,DownloadError:Bp,MediaUrlExpired:Np,ScannerError:qp,PlayerError:jp}),Up="app.vimeo.com/",Hp="key_live_jpj6Duy53e6MhounkriNljdgsBhGbf0d",Wp=e(function(e){!function(){function t(e,t,n){var i="blur"==t||"focus"==t;e.element.addEventListener(t,n,i)}function n(e){e.preventDefault(),e.stopPropagation()}function i(e){return l?l:l=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:c.matchesSelector}function r(e,t,n){if("_root"==t)return n;if(e!==n)return i(e).call(e,t)?e:e.parentNode?(d++,r(e.parentNode,t,n)):void 0}function o(e,t,n,i){h[e.id]||(h[e.id]={}),h[e.id][t]||(h[e.id][t]={}),h[e.id][t][n]||(h[e.id][t][n]=[]),h[e.id][t][n].push(i)}function a(e,t,n,i){if(h[e.id])if(t){if(!i&&!n)return void(h[e.id][t]={});if(!i)return void delete h[e.id][t][n];if(h[e.id][t][n])for(var r=0;r<h[e.id][t][n].length;r++)if(h[e.id][t][n][r]===i){h[e.id][t][n].splice(r,1);break}}else for(var o in h[e.id])h[e.id].hasOwnProperty(o)&&(h[e.id][o]={})}function s(e,t,n){if(h[e][n]){var i,o,a=t.target||t.srcElement,s={},u=0,l=0;d=0;for(i in h[e][n])h[e][n].hasOwnProperty(i)&&(o=r(a,i,v[e].element),o&&c.matchesEvent(n,v[e].element,o,"_root"==i,t)&&(d++,h[e][n][i].match=o,s[d]=h[e][n][i]));for(t.stopPropagation=function(){t.cancelBubble=!0},u=0;u<=d;u++)if(s[u])for(l=0;l<s[u].length;l++){if(s[u][l].call(s[u].match,t)===!1)return void c.cancel(t);if(t.cancelBubble)return}}}function u(e,t,n,i){function r(e){return function(t){s(l,t,e)}}if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var u,l=this.id;for(u=0;u<e.length;u++)i?a(this,e[u],t,n):(h[l]&&h[l][e[u]]||c.addEvent(this,e[u],r(e[u])),o(this,e[u],t,n));return this}}function c(e,t){if(!(this instanceof c)){for(var n in v)if(v[n].element===e)return v[n];return f++,v[f]=new c(e,f),v[f]}this.element=e,this.id=t}var l,d=0,f=0,h={},v={};c.prototype.on=function(e,t,n){return u.call(this,e,t,n)},c.prototype.off=function(e,t,n){return u.call(this,e,t,n,!0)},c.matchesSelector=function(){},c.cancel=n,c.addEvent=t,c.matchesEvent=function(){return!0},e.exports&&(e.exports=c),window.Gator=c}()}),zp=Wp.addEvent,Gp="undefined"==typeof window.PointerEvent&&"undefined"!=typeof window.MSPointerEvent,Kp={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},Yp="onmspointerenter"in document,Xp="onmspointerleave"in document;Wp.addEvent=function(e,t,n){Gp&&Kp[t]&&(t=Kp[t]),"transitionend"===t&&(zp(e,"webkitTransitionEnd",n),zp(e,"otransitionend",n)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||Yp||(t="MSPointerOver"),"MSPointerLeave"!==t||Xp||(t="MSPointerOut"),zp(e,t,n)},Wp.matchesEvent=function(e,t,n,i,r){return!("mouseenter"===e||"mouseleave"===e||!Yp&&"MSPointerEnter"===e||!Xp&&"MSPointerLeave"===e)||Hn(t,n,i,r)};var $p,Qp={ALERT_DISPLAYED:"alert-displayed",ALERT_HIDDEN:"alert-hidden",CAPTIONS_ENABLED:"captions-enabled",CAPTIONS_DISABLED:"captions-disabled",ERROR_LINK_PRESSED:"error-link-pressed",MEDIASESSION_PLAY:"mediasession-play",MEDIASESSION_PAUSE:"mediasession-pause",MEDIASESSION_SEEK_FORWARD:"mediasession-seekforward",MEDIASESSION_SEEK_BACKWARD:"mediasession-seekbackward",SLATE_DISPLAYED:"slate-displayed",VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_CAN_START:"video-can-start",VIDEO_DURATION_MISMATCH:"video-duration-mismatch",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_FULLSCREEN_CHANGE:"video-fullscreen-change",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MANIFEST_LOADED:"video-manifest-loaded",VIDEO_MANIFEST_TIMEOUT:"video-manifest-timeout",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_PLAYBACK_RATE_CHANGED:"video-playback-rate-changed",VIDEO_PLAYBACK_RESUMED:"video-playback-resumed",VIDEO_RAN_INTO_BUFFER:"video-ran-into-buffer",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_STREAM_CHANGE:"video-stream-change",VIDEO_SWITCH_BACK_TO_AUTO:"video-switch-back-to-auto",VIDEO_SWITCH_FROM_AUTO:"video-switch-from-auto",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked"},Jp=function(){function e(t){ec(this,e),this.player=t,this._reset(),this._setUpPlayerEvents()}return tc(e,[{key:"_reset",value:function(){this.rebufferCount=0,this.rebufferDuration=0,this.rebufferPercent=0,this.playbackFailure=!1,this.sessionLength=0,this.playerStartupTime=-1,this.startupRequestTime=null,this._lastScaleCheck=null,this._lastScale=null,this._scaleDurations={satisfied:0,tolerable:0,frustrated:0}}},{key:"_setUpPlayerEvents",value:function(){var e=this;this.player.events.on(kc.playInitiated,function(){e.playerStartupTime===-1&&(e.startupRequestTime=Date.now())}),this.player.events.on(kc.playProgress,function(){e.playerStartupTime===-1&&(e.playbackInitTime=Date.now(),e.playerStartupTime=Wn(e.startupRequestTime)),e._trackScaling()}),this.player.events.on(kc.bufferStarted,function(){e.playerStartupTime!==-1&&(e.rebufferCount++,e.rebufferStartTime=Date.now())}),this.player.events.on(kc.bufferEnded,function(){e.playerStartupTime!==-1&&(e.rebufferDuration+=Wn(e.rebufferStartTime))}),this.player.events.on(kc.error,function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{final:!0};n.final&&(e.playbackFailure=!0)}),this.player.events.on(kc.configChanged,function(){e._reset()})}},{key:"_trackScaling",value:function(){var e=this.player.element.querySelector(".vp-video").getBoundingClientRect(),t=this.player.telecine.videoWidth,n=this.player.telecine.videoHeight;if(0!==t||0!==n){var i={satisfied:"satisfied",tolerable:"tolerable",frustrated:"frustrated"},r=i.satisfied;if(e.width>t&&e.height>n&&(t/e.width<.4?r=i.satisfied:t/e.width<1?r=i.tolerable:t/e.width>1&&(r=i.frustrated)),this._lastScaleCheck){var o=Wn(this._lastScaleCheck);this._scaleDurations[this._lastScale]+=o}this._lastScale=r,this._lastScaleCheck=Date.now()}}},{key:"overallScore",get:function(){return Math.min(this.failureScore,this.startupTimeScore,this.rebufferScore,this.videoQualityScore)}},{key:"failureScore",get:function(){return this.playbackFailure?0:1}},{key:"startupTimeScore",get:function(){return this.playerStartupTime===-1?null:this.playerStartupTime>8e3||this.playerStartupTime===-1?0:this.playerStartupTime>2e3?.5:1}},{key:"rebufferScore",get:function(){return this.playbackInitTime?(this.rebufferPercent=this.rebufferDuration/Wn(this.playbackInitTime),this.rebufferCount>=4||this.rebufferPercent>=.12?0:this.rebufferCount<4&&0!==this.rebufferCount?this.rebufferPercent<.12?.5:0:1):null}},{key:"videoQualityScore",get:function(){var e=this;if(this.playerStartupTime===-1)return null;this._trackScaling();var t=Object.keys(this._scaleDurations).reduce(function(t,n){return e._scaleDurations[t]>e._scaleDurations[n]?t:n});switch(t){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}}]),e}(),Zp=500,em=500,tm=function(){function e(t,n){ec(this,e),t.doNotTrackEnabled||(this.player=t,this.store=n,this.playerLoadTime=Gn(),this.endpoint=this._getFresnelEndpoint(),this.startAttemptLogged=!1,this.startupTimeLogged=!1,this.startPlayTime=null,this.currentlyBuffering=!1,this.lastBufferTime=null,this.totalBufferDuration=0,this.qualityPickedLogged=!1,this.backToAutoLogged=!1,this.lastVideoBitrate=null,this.lastAudioBitrate=null,this.currentQuality="auto",this.currentStream={},this.lastProfileId=null,this.lastTargetProfileId=null,this.currentlyPlaying=!1,this.playedTo=0,this.autoplayType=this.player.config.embed.autoplay,this.akamaiEdgeIp=null,this.quicVersion=null,this.akamaiCacheDebug=null,this.lastIntervalTime=Date.now(),this.bufferCount=0,this.isScrubbing=!1,this.currentMinuteWatchedTime=0,this.totalMinutesWatched=0,this.hasEnded=!1,this.droppedFramePercent=0,this.droppedFrames=0,this.forcedEmbedQuality="none",this.sessionPlaybackDuration=0,this.fullscreen=!1,this.qualityUpSwitchCount=0,this.qualityDownSwitchCount=0,this.stayedOnAuto=!0,this.livestreamOnline=!1,this.playedProfiles={},this.profiles={},this.speeds=[],this.bufferOccupancies=[],this.targetProfiles={},this.targetProfileId={},this.previousCaptionsID=null,this.score=new Jp(this.player),this.endpoint&&(setInterval(this._updatePlaybackDuration.bind(this),Zp),this._initializeEvents(),this._initMinuteWatchedTimer()))}return tc(e,[{key:"_initializeEvents",value:function(){var e=this;this.player.events.on(kc.playInitiated,this._onPlayInitiated.bind(this)),this.player.events.on(kc.playProgress,this._onPlayProgress.bind(this)),this.player.events.on(kc.played,this._onPlayed.bind(this)),this.player.events.on(kc.bufferStarted,this._onBufferStarted.bind(this)),this.player.events.on(kc.bufferEnded,this._onBufferEnded.bind(this)),this.player.events.on(kc.ranIntoBuffer,this._onRanIntoBuffer.bind(this)),this.player.events.on(kc.playbackResumed,this._onPlaybackResumed.bind(this)),this.player.events.on(kc.error,this._onError.bind(this)),this.player.events.on(kc.errorLinkPressed,this._onErrorLinkPressed.bind(this)),this.player.events.on(kc.didEnterFullscreen,this._onEnterFullscreen.bind(this)),this.player.events.on(kc.didExitFullscreen,this._onExitFullscreen.bind(this)),this.player.events.on(kc.droppedFrames,this._onDroppedFrames.bind(this)),this.player.events.on(kc.ended,this._onEnded.bind(this)),this.player.events.on(kc.liveEventEnded,this._onLiveEventEnded.bind(this)),this.player.events.on(kc.adaptiveBandwidth,this._onAdaptiveBandwidth.bind(this)),this.player.events.on(kc.streamChanged,this._onStreamChanged.bind(this)),this.player.events.on(kc.streamTargetChange,this._onStreamTargetChange.bind(this)),this.player.events.on(kc.forcedQuality,this._onForcedQuality.bind(this)),this.player.events.on(kc.alertVisibilityChanged,this._onAlertVisibilityChanged.bind(this)),this.player.events.on(kc.configChanged,this._resetMetrics.bind(this)),this.player.events.on(kc.segmentDownloaded,this._onSegmentDownloaded.bind(this)),this.player.events.on(kc.overlayOpened,this._onOverlayOpened.bind(this)),this.player.events.on(kc.scrubbingStarted,this._onScrubbingStarted.bind(this)),this.player.events.on(kc.scrubbingEnded,this._onScrubbingEnded.bind(this)),this.player.events.on(kc.playbackRateChanged,this._onPlaybackRateChanged.bind(this)),this.player.events.on(kc.videoDurationMismatch,this._onVideoDurationMismatch.bind(this)),this.player.events.on(wc.changeQuality,this._onChangeQuality.bind(this)),this.player.events.on(wc.seek,this._onSeek.bind(this)),this.player.events.on(wc.turnCaptionsOn,this._onCaptionsEnabled.bind(this)),this.player.events.on(wc.turnCaptionsOff,this._onCaptionsDisabled.bind(this));var t=new Vi(function(t,n){e.player.telecine&&t(),e.player.events.on(kc.telecineReady,function(){t()})});t.then(function(){e._send(Qp.VIDEO_READY),e.player.telecine.on(_h.MANIFEST_TIMEOUT,e._onManifestTimeout.bind(e)),e.player.telecine.on(mh.CAN_PLAY,e._onCanPlay.bind(e)),e.player.telecine.on(_h.MANIFEST_LOADED,e._onManifestLoaded.bind(e)),e.player.telecine.on(_h.BUFFER_OCCUPANCY,e._onBufferOccupancyChange.bind(e)),e.player.telecine.on(mh.PAUSE,e._onPaused.bind(e)),e.player.telecine.on(bh.STREAM_ONLINE,e._onLivestreamOnline.bind(e)),e.player.telecine.on(bh.STREAM_OFFLINE,e._onLivestreamOffline.bind(e)),e.player.telecine.on(kh.MEDIASESSION_PLAY,e._onMediaSessionPlay.bind(e)),e.player.telecine.on(kh.MEDIASESSION_PAUSE,e._onMediaSessionPause.bind(e)),e.player.telecine.on(kh.MEDIASESSION_SEEK_FORWARD,e._onMediaSessionSeekForward.bind(e)),e.player.telecine.on(kh.MEDIASESSION_SEEK_BACKWARD,e._onMediaSessionSeekBackward.bind(e))}).catch(function(){}),pt(function(t){e._onVideoExit()})}},{key:"_initMinuteWatchedTimer",value:function(){var e=this,t=Math.floor(60*Math.random());setInterval(function(){if(e.currentlyPlaying&&(!e.store.get(pp)||e.store.get(bp)||e.livestreamOnline))return e.currentMinuteWatchedTime++,0===e.totalMinutesWatched?void(e.currentMinuteWatchedTime===t&&(e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e._send(Qp.VIDEO_MINUTE_WATCHED))):void(e.currentMinuteWatchedTime>=60&&(e.currentMinuteWatchedTime=0,e.totalMinutesWatched++,e._send(Qp.VIDEO_MINUTE_WATCHED)))},1e3)}},{key:"_onLivestreamOnline",value:function(){this.livestreamOnline=!0}},{key:"_onLivestreamOffline",value:function(){this.livestreamOnline=!1}},{key:"_onMediaSessionPlay",value:function(){this._send(Qp.MEDIASESSION_PLAY)}},{key:"_onMediaSessionPause",value:function(){this._send(Qp.MEDIASESSION_PAUSE)}},{key:"_onMediaSessionSeekForward",value:function(){this._send(Qp.MEDIASESSION_SEEK_FORWARD)}},{key:"_onMediaSessionSeekBackward",value:function(){this._send(Qp.MEDIASESSION_SEEK_BACKWARD)}},{key:"_getBufferState",value:function(){var e=[];if(this.player.telecine)for(var t=this.player.telecine.buffered,n=0;n<t.length;n++)e.push([t.start(n),t.end(n)]);return e}},{key:"_updatePlaybackDuration",value:function(){this.currentlyPlaying&&(this.sessionPlaybackDuration+=Wn(this.lastIntervalTime)/1e3),this.lastIntervalTime=Date.now()}},{key:"_onPaused",value:function(){this.currentlyPlaying&&(this.currentlyPlaying=!1,this._send(Qp.VIDEO_PAUSED))}},{key:"_isVOD",value:function(){return!!this.player.config.video.vod&&0!==this.player.config.video.vod}},{key:"_getOrigin",value:function(){var e=document.createElement("a");return e.href=this.player.config.request.referrer,e.origin||e.protocol.replace(":","")+"://"+e.host}},{key:"_getFresnelEndpoint",value:function(){var e="?session-id="+this.player.config.request.session,t=this.player.config.request.flags.log_to_es||this.player.config.user.mod?"&es=1":"";return this.player.config.request.urls.fresnel+e+t}},{key:"_onVideoExit",value:function(){this.currentlyBuffering&&(this.totalBufferDuration+=Wn(this.lastBufferTime)/1e3);var e={startup:this.score.startupTimeScore,rebuffer:this.score.rebufferScore,failure:this.score.failureScore,quality:this.score.videoQualityScore,overall:this.score.overallScore};this.startAttemptLogged&&this._send(Qp.VIDEO_EXIT,{vxs:e},!1)}},{key:"_getGlobalProperties",value:function(){var e=this.player.telecine.video?this.player.telecine.video.currentFile:{},t=e.id,n=void 0===t?0:t,i=e.mime,r=void 0===i?fc.h264:i,o=e.metadata;o=void 0===o?{}:o;var a=o.profile,s=void 0===a?null:a,u=!1,c=!1,l=this._getProfileUsage(),d=this._getBufferOccupancy();switch(r){case fc.dash:0===e.restrictedStreamIndexes.length&&(u=!0),vs(this.player.config,"request.files.dash.separate_av")&&(c=!0);var f=this.currentStream,h=f.id;n=void 0===h?0:h;var v=f.profile;s=void 0===v?null:v;break;case fc.hls:u=!0}var p={account_type:this.player.config.video.owner?this.player.config.video.owner.account_type:null,app_id:this.player.config.embed.app_id?this.player.config.embed.app_id:null,audio_bitrate:this.player.telecine.getBitrateAtTime(this.player.telecine.currentTime,"audio"),auto:u,autoplay:!!this.autoplayType,average_buffer_occupancy:d.average||0,average_speed:l.average_speed||0,background:!!this.player.config.embed.settings.background,buffer_count:this.bufferCount,buffer_duration:Math.round(100*this.totalBufferDuration)/100,buffer_ratio:this._getBufferRatio(),cdn:e.metadata?e.metadata.cdn:"akamai",client_time:Date.now(),clip_id:this.player.config.video.id,context:this.player.config.embed.context,current_buffer_occupancy:this.bufferOccupancies[this.bufferOccupancies.length-1],delivery:"live"!==dc[r]?dc[r]:"dash",device_pixel_ratio:window.devicePixelRatio||1,drm:this.player.config.request.drm||!1,dropped_frames:this.droppedFrames,dropped_frame_percent:this.droppedFramePercent,embed:!this.player.config.embed.on_site,ended:this.hasEnded,forced_embed_quality:this.forcedEmbedQuality,fullscreen:this.fullscreen,highest_available_profile:l.highest_available_profile?String(l.highest_available_profile):null,highest_profile:l.highest_profile?String(l.highest_profile):null,is_beta:this.player.config.request.build.player.indexOf("beta")>=0,is_buffering:this.currentlyBuffering,is_mod:!!this.player.config.user.mod,is_spatial:!(!$i.spatialPlayback||!this.player.config.video.spatial),is_stereo:$i.spatialPlayback&&this.player.config.video.stereo_mode&&"mono"!==this.player.config.video.stereo_mode,live:this.store.get(bp)||!1,logged_in:!!this.player.config.user.logged_in,looping:!!this.player.config.embed.loop,max_buffer_occupancy:isFinite(d.max)?d.max:0,max_speed:isFinite(l.max_speed)?l.max_speed:0,min_buffer_occupancy:isFinite(d.min)?d.min:0,min_speed:isFinite(l.min_speed)?l.min_speed:0,minutes_watched:this.totalMinutesWatched,most_used_profile:l.most_used_profile?String(l.most_used_profile):null,origin:e.metadata?e.metadata.origin:"",playback_rate:this.player.telecine.playbackRate,player_width:this.player.element.querySelector(".vp-video").getBoundingClientRect().width,player_height:this.player.element.querySelector(".vp-video").getBoundingClientRect().height,profile_id:s?String(s):null,quality:this.currentStream?this.currentStream.quality:null,quality_downswitch_count:this.qualityDownSwitchCount,quality_upswitch_count:this.qualityUpSwitchCount,quality_switch_count:this.qualityUpSwitchCount+this.qualityDownSwitchCount,referrer:this._getOrigin(),resume_time:this.player.config.user.progress||null,separate_av:c,session_id:this.player.config.request.session,session_playback_duration:Math.round(100*this.sessionPlaybackDuration)/100,stayed_on_auto:this.stayedOnAuto,ttfb:this._getTimeToFirstByte(),version:this.player.config.request.build.js,video_bitrate:this.player.telecine.getBitrateAtTime(this.player.telecine.currentTime,"video"),video_duration:this.player.config.video.duration,video_file_id:Number.isInteger(Number(n))?parseInt(n,10):null,video_time:this.player.telecine.currentTime,vod:this._isVOD(),vuid:Gt("vuid")};if(this.player.config.request.ab_tests)for(var m in this.player.config.request.ab_tests){var g=this.player.config.request.ab_tests[m];p[m+"_test"]=1,p[m+"_group"]=g.group;for(var y in g.data)p[m+"_data_"+y]=g.data[y]}return p}},{key:"_send",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this._getGlobalProperties();for(var r in t)t.hasOwnProperty(r)&&(i[r]=t[r]);i.name=e,i.event_time=this.player.config.request.timestamp+zn(this.playerLoadTime);var o=[i],a=JSON.stringify(o);if(!navigator.sendBeacon||!navigator.sendBeacon(this.endpoint,a)){var s=new XMLHttpRequest;s.open("POST",this.endpoint,n),s.setRequestHeader("Content-Type","text/plain"),s.send(a)}}},{key:"_getProfileUsage",value:function(){var e=this,t={},n=Date.now(),i=Bn("asc"),r="MediaSourceScanner"===this.player.telecine.currentScanner,o="HTMLScanner"===this.player.telecine.currentScanner,a=[];o&&(a=vs(this.player.config,"request.files.progressive")||vs(this.player.config,"request.files.hls")||[]),r&&(a=vs(this.player.config,"request.files.dash.streams",[]));var s=Ws(a).sort(i).map(function(e){return e.profile}),u=-1,c=0,l=null;if(Object.keys(this.profiles).forEach(function(t){var i=s.indexOf(parseInt(t,10));i>u&&(u=i);var r=e.profiles[t].reduce(function(e,t){var i=t.end||n;return(i-t.start)/1e3+e},0);r>c&&(c=r,l=t)}),t.highest_profile=s[u],t.highest_available_profile=s[s.length-1],t.most_used_profile=l,r){t.max_speed=Math.round(Math.max.apply(Math,this.speeds))/1e3,t.min_speed=Math.round(Math.min.apply(Math,this.speeds))/1e3;var d=this.speeds.reduce(function(e,t){return e+t},0);t.average_speed=Math.round(d/this.speeds.length)/1e3}return t}},{key:"_getBufferOccupancy",value:function(){var e={};if(this.bufferOccupancies.length>0){e.max=Math.max.apply(Math,this.bufferOccupancies),e.min=Math.min.apply(Math,this.bufferOccupancies);var t=this.bufferOccupancies.reduce(function(e,t){return e+t},0);e.average=Math.round(t/this.bufferOccupancies.length*100)/100}return e}},{key:"_getTimeToFirstByte",value:function(){var e=-1;if("undefined"!=typeof window.performance&&"function"==typeof window.performance.getEntriesByType){var t=window.performance.getEntriesByType("resource");if(t){var n=t.filter(function(e){return".m4s"===e.name.split("?")[0].substr(-4)});e=n.map(function(e){return e.responseStart-e.connectStart}).reduce(function(e,t){return e+t},0)/(n.length||1)}}return e}},{key:"_getBufferRatio",value:function(){var e=this.totalBufferDuration/(this.totalBufferDuration+this.sessionPlaybackDuration)*100;return isNaN(e)?0:Math.round(100*e)/100}},{key:"_onPlayInitiated",value:function(){var e=this;this.startAttemptLogged||this.player.performDelegateAction(lc.playLog,function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.autoplayType=n.continuous?1:e.player.config.embed.autoplay;var i=$i.iOS||$i.iPhone||$i.windowsPhone||$i.browser.bb10||$i.mobileAndroid||$i.android;e.autoplayType=e.livestreamOnline&&!i?1:e.player.config.embed.autoplay,e._send(Qp.VIDEO_START_ATTEMPT),e.startAttemptLogged=!0,e.startPlayTime=Date.now()})}},{key:"_onPlayed",value:function(e){this.currentlyPlaying=!0,this.isScrubbing||this._send(Qp.VIDEO_PLAYED)}},{key:"_onPlayProgress",value:function(e){if(this.playedTo=e,!this.startupTimeLogged){this.startupTimeLogged=!0;var t=Wn(this.startPlayTime)/1e3,n={time:t};this.akamaiEdgeIp&&(n.akamai_edge_ip=this.akamaiEdgeIp),this.quicVersion&&(n.quic_version=this.quicVersion),this.akamaiCacheDebug&&(n.akamai_cache_debug=this.akamaiCacheDebug),n.manifest_load_durations=this.player.telecine.manifestLoadDurations,n.successful_segment_count=this.player.telecine.successfulSegments.length,n.failed_segment_count=this.player.telecine.failedSegments.length,this._send(Qp.VIDEO_START_TIME,n),this._captionsInitCheck()}}},{key:"_onCanPlay",value:function(){this.isScrubbing||this._send(Qp.VIDEO_CAN_START)}},{key:"_onManifestLoaded",value:function(){this._send(Qp.VIDEO_MANIFEST_LOADED)}},{key:"_onBufferOccupancyChange",value:function(e){this.bufferOccupancies.push(e)}},{key:"_onBufferStarted",value:function(){this.startupTimeLogged&&!this.isScrubbing&&(this.lastBufferTime||(this.bufferCount++,this.lastBufferTime=Date.now(),this._send(Qp.VIDEO_BUFFER_START,{lower_profile_available:this.player.telecine.isLowerProfileAvailable})),this.currentlyBuffering=!0)}},{key:"_onBufferEnded",value:function(){if(!this.lastBufferTime||!this.startupTimeLogged||this.isScrubbing&&!this.currentlyBuffering)return void(this.lastBufferTime=null);var e=Wn(this.lastBufferTime)/1e3;this.totalBufferDuration+=e,this._send(Qp.VIDEO_BUFFER_END,{duration:e}),this.currentlyBuffering=!1,this.lastBufferTime=null}},{key:"_onRanIntoBuffer",value:function(e){this._send(Qp.VIDEO_RAN_INTO_BUFFER,{lower_profile_available:e})}},{key:"_onPlaybackResumed",value:function(){this._send(Qp.VIDEO_PLAYBACK_RESUMED)}},{key:"_onEnterFullscreen",value:function(){this.fullscreen=!0,this._send(Qp.VIDEO_FULLSCREEN_CHANGE)}},{key:"_onExitFullscreen",value:function(){this.fullscreen=!1,this._send(Qp.VIDEO_FULLSCREEN_CHANGE)}},{key:"_onDroppedFrames",value:function(e){var t=e.dropped/e.total*100;this.droppedFramePercent=Math.round(100*t)/100,this.droppedFrames=e.dropped}},{key:"_onChangeQuality",value:function(e){"auto"!==e&&(this.stayedOnAuto=!1),this.player.telecine.video.currentFile.mime===fc.dash&&("auto"===e||this.qualityPickedLogged?"auto"===e&&this.qualityPickedLogged&&!this.backToAutoLogged&&(this._send(Qp.VIDEO_SWITCH_BACK_TO_AUTO,{quality:this.currentQuality,auto:1}),this.backToAutoLogged=!0):(this._send(Qp.VIDEO_SWITCH_FROM_AUTO,{quality:e,auto:0}),this.qualityPickedLogged=!0),this.currentQuality=e)}},{key:"_onStreamChanged",value:function(e,t,n){this.currentStream=e;var i=e.profile?e.profile:e.id,r=Date.now();if(this.profiles[i]=this.profiles[i]||[],this.lastProfileId){var o=this.profiles[this.lastProfileId].length-1;this.profiles[this.lastProfileId][o]&&(this.profiles[this.lastProfileId][o].end=r)}this.lastVideoBitrate&&(n[t].bitrate>this.lastVideoBitrate?this.qualityUpSwitchCount+=1:this.qualityDownSwitchCount+=1),this.profiles[i].push({start:r}),this.playedProfiles[i]={bitrate:n[t].bitrate,width:n[t].width,height:n[t].height},this._send(Qp.VIDEO_STREAM_CHANGE,{previous_audio_bitrate:this.lastAudioBitrate,previous_video_bitrate:this.lastVideoBitrate,previous_profile_id:String(this.lastProfileId)}),this.lastProfileId=i,this.lastVideoBitrate=n[t].bitrate,this.lastAudioBitrate=n[t].audioBitrate}},{key:"_onSeek",value:function(){this.currentlyPlaying=!1}},{key:"_captionsInitCheck",value:function(){this.previousCaptionsID||null!==this.player.config.request.cookie.captions&&"null"!==this.player.config.request.cookie.captions&&this._onCaptionsEnabled(this.player.config.request.cookie.captions)}},{key:"_onCaptionsEnabled",value:function(e){this.previousCaptionsID!==e&&(this.previousCaptionsID=e,this._send(Qp.CAPTIONS_ENABLED,{captions_id:String(e)}))}},{key:"_onCaptionsDisabled",value:function(){this.previousCaptionsID&&(this.previousCaptionsID=null,this._send(Qp.CAPTIONS_DISABLED))}},{key:"_onScrubbingStarted",value:function(){this._send(Qp.VIDEO_SEEK),this.isScrubbing=!0}},{key:"_onScrubbingEnded",value:function(){this.isScrubbing=!1,this._send(Qp.VIDEO_SEEKED)}},{key:"_onEnded",value:function(e){
this.currentlyPlaying=!1,this.hasEnded=!0,this._send(Qp.VIDEO_ENDED)}},{key:"_onLiveEventEnded",value:function(){this.currentlyBuffering&&(this.currentlyBuffering=!1,this.lastBufferTime=null,this._send(Qp.VIDEO_BUFFER_END,{duration:0}))}},{key:"_onAlertVisibilityChanged",value:function(e,t){return e?void this._send(Qp.ALERT_DISPLAYED):void this._send(Qp.ALERT_HIDDEN)}},{key:"_onError",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{final:!0},arguments.length>2&&void 0!==arguments[2]?arguments[2]:null),n={error_type:e,error_reason:t};return this.startupTimeLogged?void this._send(Qp.VIDEO_PLAYBACK_ERROR,n):this.startAttemptLogged?void this._send(Qp.VIDEO_START_FAILURE,n):void this._send(Qp.VIDEO_LOAD_FAILURE,n)}},{key:"_onErrorLinkPressed",value:function(e,t){this._send(Qp.ERROR_LINK_PRESSED,{error_type:t,error_url:e})}},{key:"_onStreamTargetChange",value:function(e,t,n){var i=e.profile?e.profile:e.id,r=n[t].bitrate,o=Date.now();if(this.targetProfileId[i]=this.targetProfileId[i]||[],this.lastTargetProfileId){var a=this.targetProfileId[this.lastTargetProfileId].length-1;this.targetProfileId[this.lastTargetProfileId][a]&&(this.targetProfileId[this.lastTargetProfileId][a].end=o)}this.targetProfileId[i].push({start:o}),this.targetProfiles[i]={bitrate:r,width:n[t].width,height:n[t].height},this.lastTargetProfileId=i}},{key:"_onForcedQuality",value:function(e){this.forcedEmbedQuality=e}},{key:"_onAdaptiveBandwidth",value:function(e){var t=e.speed;this.speeds.push(t),this.speeds.length>em&&this.speeds.shift()}},{key:"_onSegmentDownloaded",value:function(e){var t=(e.identifier,e.data.headers);"akamai-edge-ip"in t&&(this.akamaiEdgeIp=t["akamai-edge-ip"]),"quic-version"in t&&(this.quicVersion=t["quic-version"]),"x-vim-cachebc"in t&&(this.akamaiCacheDebug=t["x-vim-cachebc"])}},{key:"_onVideoDurationMismatch",value:function(e){this._send(Qp.VIDEO_DURATION_MISMATCH,{duration_difference:Math.round(100*e)/100})}},{key:"_onOverlayOpened",value:function(e){"email-capture"===e&&this._send(Qp.SLATE_DISPLAYED,{slate_type:"email"})}},{key:"_onPlaybackRateChanged",value:function(e,t){this._send(Qp.VIDEO_PLAYBACK_RATE_CHANGED,{previous_playback_rate:t})}},{key:"_onManifestTimeout",value:function(){this._send(Qp.VIDEO_MANIFEST_TIMEOUT)}},{key:"_resetMetrics",value:function(){this.startAttemptLogged=!1,this.startupTimeLogged=!1,this.qualityPickedLogged=!1,this.backToAutoLogged=!1,this.lastProfileId=null,this.lastTargetProfileId=null,this.lastAudioBitrate=null,this.lastVideoBitrate=null,this.currentlyPlaying=!1,this.playedTo=0,this.autoplayType=this.player.config.embed.autoplay,this.playerLoadTime=Gn(),this.endpoint=this._getFresnelEndpoint(),this.currentQuality="auto",this.akamaiEdgeIp=null,this.quicVersion=null,this.akamaiCacheDebug=null,this.bufferCount=0,this.currentMinuteWatchedTime=0,this.totalMinutesWatched=0,this.hasEnded=!1,this.droppedFramePercent=0,this.droppedFrames=0,this.currentlyBuffering=!1,this.fullscreen=!1,this.qualityUpSwitchCount=0,this.qualityDownSwitchCount=0,this.playedProfiles={},this.profiles={},this.speeds=[],this.bufferOccupancies=[],this.targetProfiles={},this.targetProfileId={},this.forcedEmbedQuality="none",this.sessionPlaybackDuration=0,this.stayedOnAuto=!0}}]),e}(),nm="kghblrf3bb9uk33lv58ompm3k",im="md0ig7ssl8unl2kpl0h6p0drn",rm=function(){function e(t,n,i){ec(this,e),this.player=t,this.element=n,this.store=i,this.muxClient=null,this._canTrack()&&this._loadMuxEmbed()}return tc(e,[{key:"_canTrack",value:function(){return!this.player.doNotTrackEnabled&&this.store.get(bp)}},{key:"_loadMuxEmbed",value:function(){var e=this,t="vp-mux-client";if(!document.getElementById(t)){var n=document.createElement("script");n.setAttribute("id",t),n.setAttribute("src",this.player.config.request.urls.mux_url),n.onreadystatechange=n.onload=function(){e.store.get("ui.liveEvent.isLiveStarted")&&e._monitor(),e._setUpPlayerEvents()},document.getElementsByTagName("head")[0].appendChild(n)}}},{key:"_setUpPlayerEvents",value:function(){var e=this;this.player.events.on(kc.configChanged,function(){e._canTrack()&&e._monitor()}),this.store.watch("ui.liveEvent.isLiveStarted",function(t){t&&e._monitor()})}},{key:"_monitor",value:function(){if("undefined"!=typeof mux){var e=this.player.telecine.video?this.player.telecine.video.currentFile:{},t=this.element.querySelector(".vp-telecine").getElementsByTagName("video")[0];null!==this.muxClient&&mux.destroyMonitor(t),this.muxClient=mux.monitor(t,{debug:!1,data:{property_key:"dev"===this.player.config.request.build.js?nm:im,player_name:"Vimeo Player",player_init_time:Date.now(),player_version:this.player.config.request.build.js,video_title:this.player.config.video.title,video_id:this.player.config.video.id,video_duration:1e3*this.player.config.video.duration,video_cdn:e.metadata?e.metadata.cdn:"akamai",video_stream_type:this.store.get(bp)?"live":"vod"}})}}}]),e}(),om=Pl,am=(om(Object.getPrototypeOf,Object),Function.prototype),sm=am.toString,um=(sm.call(Object),$n),cm={settings:{}},lm=ri(ni),dm=function(e){return e.video.width},fm=function(e){return e.video.height},hm=lm(dm,fm,function(e,t){return t/e}),vm=Object.freeze({default:oi,width:dm,height:fm,ratio:hm}),pm="PLAYER_RESIZE",mm=function(e,t){return{type:pm,payload:{width:e,height:t}}},gm=300,ym=169,_m=338,bm=190,wm=375,km=450,Sm={xxs:0,xs:390,sm:600,md:960,lg:1280,xl:1600,xxl:1920},Em=function(e){return eg(e)},Tm=function(e){return e.embed.transparent?Math.round(Math.min((e.ui.player.height-Em(e))/hm(e),e.ui.player.width)):e.ui.player.width},xm=function(e){return e.embed.transparent?Math.round(Math.min(e.ui.player.width*hm(e)+Em(e),e.ui.player.height)):e.ui.player.height},Am=function(e){return Tm(e)},Lm=function(e){return xm(e)-Em(e)},Pm=function(e){return(e.ui.player.width-Tm(e))/2},Cm=function(e){return(e.ui.player.height-xm(e))/2},Om=lm(Tm,xm,Pm,Cm,function(e,t,n,i){return{width:e,height:t,x:n,y:i}}),Rm=function(e){var t=Am(e),n=Lm(e),i=Mf(e.embed.settings.customLogo)&&t<gm||n<ym,r=!Mf(e.embed.settings.customLogo)&&(t<_m||n<bm);return i||r},Im=function(e){var t=Am(e),n=Mf(e.embed.settings.customLogo)&&t<wm,i=!Mf(e.embed.settings.customLogo)&&t<km;return n||i},Mm=function(e){return Rm(e)?"tiny":Im(e)?"mini":"normal"},Dm=function(e){var t=Am(e);return t>=Sm.xxs&&t<Sm.xs},Fm=function(e){var t=Am(e);return t>=Sm.xs&&t<Sm.sm},Bm=function(e){var t=Am(e);return t>=Sm.sm&&t<Sm.md},Nm=function(e){var t=Am(e);return t>=Sm.md&&t<Sm.lg},qm=function(e){var t=Am(e);return t>=Sm.lg&&t<Sm.xl},jm=function(e){var t=Am(e);return t>=Sm.xl&&t<Sm.xxl},Vm=function(e){var t=Am(e);return t>=Sm.xxl},Um=function(e){var t={xxs:Dm,xs:Fm,sm:Bm,md:Nm,lg:qm,xl:jm,xxl:Vm};return Object.keys(Sm).find(function(n){return t[n](e)})},Hm=Object.freeze({breakpoints:Sm,default:ai,innerBottom:Em,layoutWidth:Tm,layoutHeight:xm,innerWidth:Am,innerHeight:Lm,layoutX:Pm,layoutY:Cm,layout:Om,isTinyMode:Rm,isMiniMode:Im,mode:Mm,xxs:Dm,xs:Fm,sm:Bm,md:Nm,lg:qm,xl:jm,xxl:Vm,breakpoint:Um}),Wm=function(e){return Le({width:e.ui.preview.width,height:e.ui.preview.height,elementWidth:Am(e),elementHeight:Lm(e)}).scaleFactor},zm=Object.freeze({default:si,scaleFactor:Wm}),Gm="CARDS_SET_SIZE",Km=function(e){return{type:Gm,payload:e}},Ym=200,Xm=415,$m=300,Qm=60,Jm=function(e){return e.ui.cards.size>0&&e.ui.player.width>=Ym&&e.ui.player.width<Xm},Zm=function(e){return e.ui.cards.size>0&&e.ui.player.width>=$m},eg=function(e){return Jm(e)?Qm:0},tg=Object.freeze({default:ui,isCarouselVisible:Jm,isCardsThumbVisible:Zm,getCarouselHeight:eg}),ng=function(e){return Le({width:e.video.width,height:e.video.height,elementWidth:Am(e),elementHeight:Lm(e)}).scaleFactor},ig=Object.freeze({scaleFactor:ng}),rg=.045,og=function(e){return Math.max(10,Math.round(Lm(e)*rg))},ag=Object.freeze({size:og}),sg=360,ug=203,cg=415,lg=360,dg=340,fg=415,hg=234,vg=function(e){var t=e.ui;return t.player.width>=sg&&t.player.height>=ug||t.player.width>=cg},pg=function(e){var t=e.ui;return t.player.width>=lg&&t.player.height>=dg||t.player.width>=fg&&t.player.height>=hg},mg=Object.freeze({isLinkTitleVisible:vg,isLinkDescriptionVisible:pg}),gg=300,yg=169,_g=function(e){var t=e.ui;return t.player.width>=gg&&t.player.height>=yg},bg=Object.freeze({isEmailCaptureVisible:_g}),wg=415,kg=function(e){return Am(e)<wg},Sg=function(e){return kg(e)||$i.touch},Eg=Object.freeze({isPrefsMenuCentered:kg,hasPrefsMenuCarousel:Sg}),Tg=Object.freeze({default:ci,player:Hm,preview:zm,video:ig,liveEvent:kp,cards:tg,outro:mg,overlay:bg,controlbar:Eg,captions:ag}),xg=Object.freeze({default:li,video:vm,liveEvent:xp,ui:Tg}),Ag=e(function(e){!function(){var t={};t.templates={},t.render=function(e,n){return t.templates[e]?t.templates[e].call(t,n||{}):""},t.map={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"},t.escape=function(e){return e.replace(/[&<>"'\/]/g,function(e){return t.map[e]})},t.helpers={},t.templates.stream_studder=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=' <span>Having issues? <button type="button" class="player-alert-button-link button-link" aria-label="Switch to auto" data-alert-autofocus data-close data-context="suggestion">Switch to Auto</button> for smoother streaming.</span></h3>'},t.templates.warning_alert=function(e){var t="<h3> ";return t+=this.render("icon_warning")||"",t+=" <span>"+e.strings.text+"<span></h3>"},t.templates.buffer_pattern=function(e){var t='<pattern id="'+e.id+'" patternUnits="userSpaceOnUse" x="0" y="0" width="10" height="10" viewBox="0 0 10 10"><line x1="5" y1="-1" x2="-5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="10" y1="-1" x2="0" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /><line x1="15" y1="-1" x2="5" y2="10" stroke-width="2" stroke="#666" stroke-linecap="butt" /></pattern>';return t},t.templates.card=function(e){var t='<div class="card';return e.className&&(t+=" "+e.className),e.teaser&&(t+=" card-hasDetail"),t+='"> ',e.url&&(t+='<a class="card-link" href="'+e.url+'" target="_blank" rel="noopener">'),t+=' <div class="card-inner"> ',e.image&&(t+=' <div class="card-imageWrap js-cardImageWrap"><img class="card-image" src="'+e.image+'" alt=""></div> '),t+=' <div class="card-body"><h3 class="card-text card-text--title"><span>',t+=this.escape(e.headline)||"",t+="</span> ",e.url&&(t+=this.render("icon_card_arrow")||""),t+=" </h3> ",e.teaser&&(t+=' <p class="card-text card-text--detail"> ',t+=this.escape(e.teaser)||"",t+=" </p> "),t+=" </div></div> ",e.url&&(t+="</a>"),t+="</div>"},t.templates.compass=function(e){var t='<svg viewBox="0 0 36 36"> ';return t+=1==e.version?' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-45, 18, 18)" d="M0,0 m18,18 l12,0 A12,12 0 0,0 18,6 z"/><circle fill="none" class="compass-ring" stoke-width="3" r="14.5" cx="18" cy="18"></circle><polygon class="compass-dimple" points="16,3.5 18,1 20,3.5"/> ':' <circle class="compass-background" r="18" cx="18" cy="18"></circle><path class="compass-slice" transform="rotate(-30, 18, 18)" d="M0,0 m18,18 l13,0 A13,13 0 0,0 11.500000000000004,6.741669750802297 z"/><circle class="compass-centercircle" r="3" cx="18" cy="18"></circle><path class="compass-line" stroke-linecap="round" d="M0,18 L36,18 z" /> ',t+="</svg>"},t.templates.controlbar_trailer=function(e){var t='<button type="button" class="play trailer rounded-box" title="'+e.strings.playTrailer+'" aria-label="'+e.strings.playTrailer+'"><div><span class="play-icon">';return t+=this.render("icon_play")||"",t+="</span><p>"+e.text+"</p></div></button>",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div>"),t+="",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank" rel="noopener">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=""},t.templates.controlbar=function(e){var t='<button type="button" class="play rounded-box state-'+e.playState+'" title="'+e.strings.play+'" data-title-play="'+e.strings.play+'" data-title-pause="'+e.strings.pause+'" data-title-replay="'+e.strings.replay+'" aria-label="'+e.strings.play+'"><div class="tiny-bars"><svg width="100%" height="100%" viewBox="0 0 65 40"><defs><clipPath id="rounded-border"><rect height="100%" width="100%" x="0" y="0" rx="5"/></clipPath> ';return t+=this.render("buffer_pattern",{id:"tiny-buffer"})||"",t+=' </defs><g clip-path="url(#rounded-border)"><rect class="buffer hidden" height="3" width="110%" x="0" y="37" fill="url(#tiny-buffer)"/><rect class="loaded" height="3" width="0" x="0" y="37" fill="#666"/><rect class="played fill" height="3" width="0" x="0" y="37"/></g></svg></div><div class="play-icon">',t+=this.render("icon_play")||"",t+='</div><div class="pause-icon">',t+=this.render("icon_pause")||"",t+='</div><div class="replay-icon">',t+=this.render("icon_replay")||"",t+='</div></button><div class="play-bar rounded-box"><div class="live"><div class="circle offline"></div> LIVE </div><div class="vp-progress"><div class="loaded',e.rawDuration<60&&(t+=" short-video"),t+='" role="progressbar" aria-label="'+e.strings.loadedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="played" role="progressbar" aria-label="'+e.strings.playedBar+'" aria-valuemin="0" aria-valuemax="'+e.rawDuration+'" aria-valuenow="0"></div><div class="cuepoints"></div><div class="thumb-preview invisible hidden" role="presentation" aria-hidden="true"><div class="thumb"></div></div><div class="ghost-timecode invisible hidden" role="presentation" aria-hidden="true"><div class="box">00:00</div></div><div class="timecode" role="presentation" aria-hidden="true"><div class="box">'+e.duration+"</div></div></div> ",e.volume&&(t+=' <div class="volume" role="slider" title="'+e.strings.volume+'" aria-label="'+e.strings.volume+'" aria-valuemin="0" aria-valuemax="1" tabindex="0"><div></div><div></div><div></div><div></div><div></div></div> '),e.ccButton&&(t+=' <button type="button" class="toggle cc '+(e.ccOn?"on":"off")+'" title="'+e.strings.captions+'"> ',t+=this.render("icon_cc")||"",t+=" </button> "),e.prefsButton&&(t+=' <button type="button" class="vp-prefs js-prefs" title="'+e.strings.prefs+'" aria-label="'+e.strings.prefs+'"> ',t+=this.render("icon_gear")||"",t+=" </button> "),t+=' <button type="button" class="hidden toggle effect off" title="'+e.strings.effect+'"><svg viewBox="0 0 210 200" version="1.1"><g fill="none" fill-rule="evenodd"><circle class="red" fill="#f00" cx="63.5" cy="136.5" r="63.5"/><circle class="blue" fill="#2653ff" cx="146.5" cy="136.5" r="63.5"/><circle class="green" fill="#0f0" cx="104.5" cy="63.5" r="63.5"/></g></svg></button> ',e.airplayButton&&(t+=' <button type="button" class="toggle airplay off hidden" title="'+e.strings.airPlay+'" data-title-off="'+e.strings.airPlay+'" data-title-on="'+e.strings.airPlayOff+'" hidden> ',t+=this.render("icon_airplay")||"",t+=" </button> "),e.stereoscopicButton&&(t+=' <button type="button" class="toggle stereoscopic off" title="'+e.strings.stereoscopic+'" data-title-off="'+e.strings.stereoscopic+'" data-title-on="'+e.strings.stereoscopicOff+'"> ',t+=this.render("icon_stereoscopic")||"",t+=" </button> "),t+=' <button type="button" class="pip hidden enter" title="'+e.strings.pipEnter+'" data-title-enter="'+e.strings.pipEnter+'" data-title-return="'+e.strings.pipReturn+'" hidden> ',t+=this.render("icon_pip")||"",t+=' </button><button type="button" class="fullscreen',e.fullscreenButton||(t+=" only-in-fullscreen"),t+='" title="'+e.strings.enterFullscreen+'" data-title-fullscreen="'+e.strings.enterFullscreen+'" data-title-unfullscreen="'+e.strings.exitFullscreen+'" aria-label="'+e.strings.fullscreen+'"><div class="fullscreen-icon">',t+=this.render("icon_fullscreen")||"",t+='</div><div class="unfullscreen-icon">',t+=this.render("icon_unfullscreen")||"",t+="</div></button> ",e.vimeoLogo.show&&(t+=' <div class="logo"> ',e.vimeoLogo.showLink&&(t+=' <a href="'+e.vimeoLogo.url+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=' title="'+e.strings.watchOnVimeo+'" aria-label="'+e.strings.watchOnVimeo+'" data-clip-link> '),t+=this.render("logo")||"",e.vimeoLogo.showLink&&(t+=" </a> "),t+=" </div> "),t+="</div> ",e.customLogo&&(t+=' <div class="custom-logo',e.customLogo.sticky&&(t+=" sticky"),t+='" style="max-width:'+e.customLogo.width+"px;height:"+e.customLogo.height+'px"> ',e.customLogo.showLink&&(t+='<a href="'+e.customLogo.url+'" target="_blank" rel="noopener">'),t+=' <img src="'+e.customLogo.img+'" alt=""> ',e.customLogo.showLink&&(t+="</a>"),t+=" </div>"),t+=' <div class="vp-menubar js-menubar"></div>'},t.templates.debug_panel=function(e){var t="<div class='vp-stats-debug-values'> ";return t+=this.render("debug_values",e)||"",t+="</div>",e.hideCloseButton||(t+='<button type="button" class="stats-debug-close" aria-label="Close stats debug panel">',t+=this.render("icon_close")||"",t+="</button>"),t+='<input type="text" class="stats-debug-code">',e.isCopyDisabled||(t+='<button type="button" class="vp-copy-session vp-copy-session-hidden js-copySessionButton"><span class="vp-copy-label">Copy Debug Key</span></button>'),t+=""},t.templates.debug_values=function(e){var t='<p><span class="stats-debug-label">Clip ID:</span><span class="stats-debug-value stats-debug-clip-id">'+e.clipId+"</span></p>";return e.isDash&&e.profileId&&(t+='<p><span class="stats-debug-label">Profile ID:</span><span class="stats-debug-value stats-debug-profile-id">'+e.profileId+"</span></p>"),t+='<p><span class="stats-debug-label">Delivery:</span><span class="stats-debug-value stats-debug-delivery">'+e.delivery+"</span></p>",e.resolution&&(t+='<p><span class="stats-debug-label">Playing:</span><span class="stats-debug-value stats-debug-resolution">'+e.resolution+"</span></p>"),t+='<p><span class="stats-debug-label">Embed size:</span><span class="stats-debug-value stats-debug-dimensions">'+e.embedSize+"</span></p>",e.isDash&&(t+='<p><span class="stats-debug-label">Separate AV:</span><span class="stats-debug-value stats-debug-test-group">'+e.separateAudioVideo+"</span></p>"),t+="",e.testGroup&&(t+='<p><span class="stats-debug-label">Tests:</span><span class="stats-debug-value stats-debug-test-group">'+e.testGroup+"</span></p>"),t+="",(e.isDash||e.isLive)&&(t+='<p><span class="stats-debug-label">Dropped frames:</span><span class="stats-debug-value stats-debug-dropped-frames">'+e.droppedFrames+" / "+e.totalFrames+" - "+e.droppedFramesPercent+"</span></p>"),t+="",e.isLive&&(t+='<p><span class="stats-debug-label">Live Latency:</span><span class="stats-debug-value stats-debug-live-latency">'+e.liveLatency+"</span></p>"),t+="",(e.isDash||e.isLive)&&(t+='<p><span class="stats-debug-label">Bandwidth:</span><span class="stats-debug-value stats-debug-bandwidth">'+e.bandwidthKbps+'</span><span class="stats-debug-bandwidth-minmax"> (<span class="stats-debug-value stats-debug-bandwidth-min">'+e.bandwidthMinKbps+'</span><span class="stats-debug-value stats-debug-bandwidth-max">'+e.bandwidthMaxKbps+'</span>) </span></p><div class="stats-debug-time-series"> '+e.bandwidthSeriesSvg+"</div>"),t+="",e.displayBufferOccupancy&&(t+='<p><span class="stats-debug-label">Buffer Occupancy:</span><span class="stats-debug-value stats-debug-buffer-percent">'+e.bufferOccupancyPercent+'</span></p><div class="stats-debug-buffer-occupancy"> '+e.bufferOccupancySvg+"</div>"),t+="",e.sessionId&&(t+='<p><span class="stats-debug-label">Debug Key:</span><br><span class="stats-debug-value stats-debug-session-id">'+e.sessionId+"</span></p>"),t},t.templates.icon_airplay=function(e){var t='<svg class="airplay-icon" viewBox="0 0 44 36" tabindex="-1"><polygon class="fill" points="0,0 44,0 44,27 34.5,27 31,23 40,23 40,4 4,4 4,23 13,23 9.5,27 0,27"/><polygon class="fill" points="7,36 22,18 37,36"/></svg>';return t},t.templates.icon_back=function(e){var t='<svg class="icon-back" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M0 32l32 32v-20h32l0-24h-32v-20z"/></svg>';return t},t.templates.icon_broken_heart=function(e){var t='<svg class="unlike-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.594 0-23.198 10.043-25.948 14.48l-6.77 10.727 13.661 8.543-13.661 12.535 5.695 15.348-9.686-15.348 11.389-11.975-11.969-7.402s4.22-14.27 4.621-15.521c.782-2.438.782-2.438-.813-3.289-5.516-2.944-12.608-8.098-21.509-8.098-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.753-24.523 9.684-5.034 22.247-14.797 22.247-27.592 0-12.848-11.208-27.885-27.504-27.885z"/></svg>';return t},t.templates.icon_card_arrow=function(e){var t='<svg class="card-arrow" viewBox="0 0 10 10" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="10 8.337 10 0 1.663 0 1.663 1.603 7.263 1.603 0 8.866 1.134 10 8.397 2.737 8.397 8.337"/></svg>';return t},t.templates.icon_cc=function(e){var t='<svg viewBox="0 0 20 14" tabindex="-1"><path class="fill" fill-rule="evenodd" clip-rule="evenodd" d="M17 0h-14c-1.657 0-3 1.343-3 3v8c0 1.656 1.343 3 3 3h14c1.657 0 3-1.344 3-3v-8c0-1.657-1.343-3-3-3zm-7.271 8.282c-.145.923-.516 1.686-1.105 2.268-.597.591-1.369.89-2.294.89-1.138 0-2.049-.402-2.706-1.195-.647-.786-.975-1.866-.975-3.215 0-1.458.372-2.603 1.105-3.403.65-.708 1.487-1.067 2.487-1.067 1.33 0 2.321.482 2.947 1.435.34.53.526 1.072.553 1.611l.013.236h-1.984l-.044-.169c-.092-.355-.207-.622-.343-.793-.239-.298-.591-.443-1.076-.443-.483 0-.856.209-1.14.641-.298.455-.449 1.12-.449 1.977 0 .851.156 1.49.466 1.898.298.395.666.588 1.122.588.469 0 .814-.16 1.058-.491.138-.183.255-.472.351-.856l.042-.17h2.013l-.041.258zm7.582 0c-.145.923-.516 1.686-1.104 2.268-.598.591-1.369.89-2.294.89-1.139 0-2.049-.402-2.707-1.195-.646-.785-.975-1.865-.975-3.214 0-1.458.372-2.603 1.106-3.403.649-.708 1.485-1.067 2.486-1.067 1.33 0 2.32.482 2.946 1.435.34.53.526 1.072.554 1.611l.012.236h-1.9829999999999999l-.043-.169c-.092-.355-.208-.623-.344-.793-.238-.298-.591-.443-1.076-.443-.483 0-.856.209-1.139.641-.299.455-.45 1.12-.45 1.977 0 .851.157 1.49.467 1.898.299.395.666.588 1.121.588.469 0 .814-.16 1.058-.491.138-.183.256-.472.352-.856l.042-.17h2.012l-.041.257z"/></svg>';return t},t.templates.icon_check=function(e){var t='<svg class="check-icon" viewBox="0 0 12 12"><path class="fill" d="M10.9 2.9l-.7-.7c-.2-.2-.6-.2-.8-.1L5 6.6 2.6 4.1c-.2-.1-.6-.1-.7 0l-.8.8c-.1.1-.1.5 0 .7l3.1 3.1c.4.4 1 .4 1.4 0l5.1-5.1c.3-.2.3-.6.2-.7z"/></svg>';return t},t.templates.icon_clock=function(e){var t='<svg class="watch-later-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill hour-hand" points="9.64,4.68 10.56,4.68 11.28,11.21 8.93,11.21 9.64,4.68" /><polyline class="fill minute-hand" points="14.19,13.65 13.7,14.14 8.58,10.4 10.44,8.5 14.19,13.65" /><circle class="stroke" cx="10" cy="10" r="8" stroke-width="2" /></svg>';return t},t.templates.icon_close_new=function(e){var t='<svg class="icon-close-new" viewBox="0 0 16 16" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M8.001 9.416l6.437 6.437a.497.497 0 0 0 .713-.001l.7-.7a.503.503 0 0 0 .002-.714L9.416 8.001l6.437-6.436a.497.497 0 0 0-.001-.713l-.7-.7a.503.503 0 0 0-.714-.002L8.001 6.587 1.565.15a.497.497 0 0 0-.713.001l-.7.7a.503.503 0 0 0-.002.714L6.587 8 .15 14.438a.497.497 0 0 0 .001.713l.7.7a.503.503 0 0 0 .714.002L8 9.416z"/></svg>';return t},t.templates.icon_close=function(e){var t='<svg class="icon-close" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M60 48.796l-16.812-16.796 16.812-16.796-11.204-11.204-16.796 16.804-16.804-16.804-11.196 11.204 16.796 16.796-16.796 16.796 11.196 11.204 16.804-16.804 16.796 16.804z"/></svg>';return t},t.templates.icon_collections=function(e){var t='<svg class="collections-icon" viewBox="0 0 24 24" tabindex="-1"><path class="fill" d="M24 12c0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9 0-.3-.1-.6-.4-.8l-7-6c-.1-.1-.4-.2-.6-.2-.1 0-.3 0-.4.1l-15 6c-.3.1-.6.5-.6.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l2.7 2.3-2.4 1c-.4.1-.7.5-.7.9 0 .3.1.6.4.8l7 6c.1.1.4.2.6.2.1 0 .3 0 .4-.1l15-6c.4-.1.6-.5.6-.9 0-.3-.1-.6-.4-.8l-2.7-2.3 2.4-1c.4-.1.7-.5.7-.9zm-8.2-9.8l5.3 4.5-12.9 5.1-5.3-4.5 12.9-5.1zm5.3 14.5L8.2 21.8l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.2 2zm-12.9.1l-5.3-4.5 1.9-.8 2.6 2.2c.1.2.4.3.6.3.1 0 .3 0 .4-.1l10.5-4.2 2.3 1.9-13 5.2z"/></svg>';return t},t.templates.icon_embed=function(e){var t='<svg class="embed-icon" viewBox="0 0 55 48" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="16.019,16.385 11.968,13.131 0,24.543 12.082,35.955 16.132,32.703 7.439,24.543"/><polygon class="fill" points="42.92,13.131 38.868,16.384 47.561,24.542 38.981,32.701 43.033,35.955 55,24.542"/><polygon class="fill" points="24.083,39.221 28.76,39.221 36.243,8.351 31.566,8.351"/></svg>';return t},t.templates.icon_facebook=function(e){var t='<svg class="facebook-icon" viewBox="0 0 64 64" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M35.992 64h-11.992v-32h-8v-11.028l8-0.004-0.013-6.497c0-8.997 2.44-14.471 13.037-14.471h8.824v11.030h-5.514c-4.127 0-4.325 1.541-4.325 4.418l-0.016 5.52h9.918l-1.169 11.028-8.741 0.004-0.008 32z"/></svg>';return t},t.templates.icon_follow=function(e){var t='<svg class="icon icon-follow" viewBox="0 0 24 24" preserveAspectRatio="xMidYMid" tabindex="-1"><defs><clipPath id="icon-mask--check"><rect x="0" y="0" width="24" height="24" /></clipPath></defs><path class="icon-path icon-path--plus fill" d="M24 10h-10v-10h-4v10h-10v4h10v10h4v-10h10z"/><path class="icon-path icon-path--check fill" d="M9 21.035l-9-8.638 2.791-2.87 6.156 5.874 12.21-12.436 2.843 2.817z" clip-path="url(#icon-mask--check)"/><path class="icon-path icon-path--close fill" d="M23.954 21.03l-9.184-9.095 9.092-9.174-2.832-2.807-9.09 9.179-9.176-9.088-2.81 2.81 9.186 9.105-9.095 9.184 2.81 2.81 9.112-9.192 9.18 9.1z"/></svg>';return t},t.templates.icon_fullscreen=function(e){var t='<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="6,6 5.9,2 4.9,3 2.9,1 1,2.9 3,4.9 2,5.9" transform="translate(6,6) rotate(270)" /></svg>';return t},t.templates.icon_gear=function(e){var t='<svg class="icon-gear" viewBox="0 0 19 16" preserveAspectRatio="xMidYMid" tabindex="-1"><defs><clipPath id="icon-gear-mask-hd"><polygon points="19 9.422 19 0 0 0 0 16 4.996 16 6 9.422 19 9.422"/></clipPath><clipPath id="icon-gear-mask-4k"><polygon points="19 0 0 0 0 16 .656 16 7.641 9.422 19 9.422"/></clipPath></defs><g class="icon-gear-group"><path class="icon-gear-cog fill" d="M8.75,0 L7.25,0 C6.69771525,0 6.25,0.44771525 6.25,1 L6.25,1.71 C6.24203899,2.03670262 6.03616565,2.32571712 5.73,2.44 C5.22486505,2.64787629 4.75048268,2.92375823 4.32,3.26 C4.06726048,3.46530794 3.71530155,3.4969447 3.43,3.34 L2.81,3 C2.57947626,2.86645499 2.30519371,2.83041629 2.04799634,2.89987835 C1.79079898,2.96934041 1.57195122,3.13856029 1.44,3.37 L1.44,3.37 L0.69,4.67 C0.438460777,5.14101477 0.601355467,5.72655514 1.06,6 L1.06,6 L1.68,6.36 C1.95609578,6.53006064 2.1022252,6.84996558 2.05,7.17 C1.97585362,7.71080372 1.97585362,8.25919628 2.05,8.8 C2.1022252,9.12003442 1.95609578,9.43993936 1.68,9.61 L1.06,10 C0.828560291,10.1319512 0.65934041,10.350799 0.589878348,10.6079963 C0.520416285,10.8651937 0.556454987,11.1394763 0.69,11.37 L0.69,11.37 L1.44,12.67 C1.72842942,13.137733 2.34023095,13.2851012 2.81,13 L2.81,13 L3.43,12.64 C3.71530155,12.4830553 4.06726048,12.5146921 4.32,12.72 C4.75048268,13.0562418 5.22486505,13.3321237 5.73,13.54 C6.03616565,13.6542829 6.24203899,13.9432974 6.25,14.27 L6.25,15 C6.25,15.5522847 6.69771525,16 7.25,16 L8.75,16 C9.30228475,16 9.75,15.5522847 9.75,15 L9.75,14.29 C9.75796101,13.9632974 9.96383435,13.6742829 10.27,13.56 C10.7751349,13.3521237 11.2495173,13.0762418 11.68,12.74 C11.9327395,12.5346921 12.2846984,12.5030553 12.57,12.66 L13.19,13.02 C13.4205237,13.153545 13.6948063,13.1895837 13.9520037,13.1201217 C14.209201,13.0506596 14.4280488,12.8814397 14.56,12.65 L14.56,12.65 L15.31,11.35 C15.5746773,10.8743026 15.4102265,10.2742794 14.94,10 L14.94,10 L14.32,9.64 C14.0439042,9.46993936 13.8977748,9.15003442 13.95,8.83 C14.0241464,8.28919628 14.0241464,7.74080372 13.95,7.2 C13.8977748,6.87996558 14.0439042,6.56006064 14.32,6.39 L14.94,6.03 C15.1714397,5.89804878 15.3406596,5.67920102 15.4101217,5.42200366 C15.4795837,5.16480629 15.443545,4.89052374 15.31,4.66 L15.31,4.66 L14.56,3.36 C14.426372,3.13025585 14.2067828,2.96315821 13.9497298,2.89561144 C13.6926768,2.82806466 13.4193087,2.86562606 13.19,3 L13.19,3 L12.57,3.36 C12.2846984,3.5169447 11.9327395,3.48530794 11.68,3.28 C11.2495173,2.94375823 10.7751349,2.66787629 10.27,2.46 C9.96383435,2.34571712 9.75796101,2.05670262 9.75,1.73 L9.75,1 C9.75,0.73478351 9.64464316,0.480429597 9.45710678,0.292893219 C9.2695704,0.10535684 9.01521649,-8.8817842e-16 8.75,0 Z M10.5,8 C10.5,9.38071187 9.38071187,10.5 8,10.5 C6.61928813,10.5 5.5,9.38071187 5.5,8 C5.5,6.61928813 6.61928813,5.5 8,5.5 C9.38071187,5.5 10.5,6.61928813 10.5,8 Z" /></g><g class="icon-gear-text icon-gear-text-hd"><polygon class="fill" points="10.17 12.38 10.46 10.43 12.22 10.43 11.36 16 9.6 16 9.95 13.76 8.09 13.76 7.77 16 6.01 16 6.85 10.43 8.61 10.43 8.32 12.38"/><path class="fill" d="M17.82,11.23 C17.65,10.98 17.32,10.43 15.93,10.43 L13.37,10.43 L12.51,16 L15.09,16 C16.1538092,16.0719871 17.159097,15.5065128 17.65,14.56 C18.1567595,13.5192032 18.2181336,12.3169925 17.82,11.23 Z M15.9,14.42 C15.6125419,14.6349311 15.2582986,14.7412041 14.9,14.72 L14.48,14.72 L14.9,11.72 L15.35,11.72 C15.6806309,11.6794538 16.0108877,11.7981978 16.24,12.04 C16.4818058,12.8447587 16.357466,13.7151373 15.9,14.42 Z"/></g><g class="icon-gear-text icon-gear-text-4k"><polygon class="fill" points="11.82 10.29 13.58 10.29 13.19 12.17 13.19 12.17 15.19 10.27 17.48 10.27 14.75 12.62 16.36 16 14.36 16 13.36 13.78 12.76 14.32 12.39 16 10.63 16"/><path class="fill" d="M7.86,14.9 L5.31,14.9 L5.61,13.41 L8.78,10.41 L10.36,10.41 L9.72,13.51 L10.44,13.51 L10.18,14.87 L9.45,14.87 L9.22,16 L7.63,16 L7.86,14.9 Z M8.19,13.54 L8.54,12 L8.54,12 L6.94,13.58 L8.19,13.54 Z"/></g></svg>';return t},t.templates.icon_heart=function(e){var t='<svg class="like-icon" viewBox="0 0 110 81" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M82.496 1c-14.698 0-25.969 11.785-27.496 13.457-1.526-1.672-12.798-13.457-27.494-13.457-16.299 0-27.506 15.037-27.506 27.885 0 12.795 12.562 22.558 22.245 27.592 9.186 4.771 30.601 18.349 32.755 24.523 2.154-6.174 23.57-19.752 32.755-24.523 9.684-5.034 22.245-14.797 22.245-27.592 0-12.848-11.206-27.885-27.504-27.885z"/></svg>';return t},t.templates.icon_line_arrow=function(e){var t='<svg class="icon-lineArrow" viewBox="0 0 24 15"><polygon class="fill" points="21 0 24 3.057 12 15 0 3.057 3 0 12 9"/></svg>';return t},t.templates.icon_lock=function(e){var t='<svg viewBox="0 0 46 76" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill bolt" d="M5,42v-15C8,5 39,5 42,27v30h-7v-30C32,14 15,14 12,27v15z"/><rect class="fill" x="0" y="41" height="35" width="46" rx="4" ry="4"/></svg>';return t},t.templates.icon_mail=function(e){var t='<svg class="mail-icon" viewBox="0 0 72 72" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M71.754,57.6C71.9,57.169,72,56.718,72,56.241V16.759c0-0.453-0.092-0.881-0.225-1.291l-23.487,19.86L71.754,57.6z"/><path class="fill" d="M35.999,40.118l6.187-4.971l3.131-2.516L68.9,12.693c-0.387-0.113-0.789-0.193-1.213-0.193H4.312c-0.424,0-0.827,0.08-1.215,0.194l23.599,19.949l3.132,2.517L35.999,40.118z"/><path class="fill" d="M67.688,60.5c0.405,0,0.791-0.074,1.164-0.18L45.157,37.843l-9.159,7.361l-9.145-7.351L3.15,60.322C3.522,60.426,3.907,60.5,4.312,60.5H67.688z"/><path class="fill" d="M0.226,15.468C0.092,15.878,0,16.307,0,16.759v39.482c0,0.478,0.099,0.929,0.247,1.356l23.476-22.261L0.226,15.468z"/></svg>';
return t},t.templates.icon_pause=function(e){var t='<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><rect class="fill" width="6" height="20" x="0" y="0" /><rect class="fill" width="6" height="20" x="12" y="0" /></svg>';return t},t.templates.icon_pip=function(e){var t='<svg class="pip-icon" viewBox="0 0 16 12"><polygon class="fill" points="6 8 1 8 1 1 14 1 14 6 15 6 15 0 0 0 0 9 6 9 6 8"/><rect class="fill" x="7" y="7" width="9" height="5"/><polyline class="fill enter" transform="translate(4, 4) rotate(180) translate(-4, -4)" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/><polyline class="fill return" points="5.33 2 5.33 3 3.67 3 5.67 5 5 5.67 3 3.67 3 5.33 2 5.33 2 2"/></svg>';return t},t.templates.icon_play=function(e){var t='<svg viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="1,0 20,10 1,20" /></svg>';return t},t.templates.icon_prev=function(e){var t='<svg class="icon-prev" viewBox="0 0 27 48" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M7.243,24L26.414,4.828c0.781-0.781,0.781-2.047,0-2.828L25,0.586 c-0.781-0.781-2.047-0.781-2.828,0L0.879,21.879c-1.172,1.172-1.172,3.071,0,4.243l21.293,21.293c0.781,0.781,2.047,0.781,2.828,0 L26.414,46c0.781-0.781,0.781-2.047,0-2.828L7.243,24z"/></svg>';return t},t.templates.icon_replay=function(e){var t='<svg viewBox="-387 605 16 16" preserveAspectRatio="xMidYMid"><path class="fill" d="M-387 606v4c0 .6.4 1 1 1h4c.6 0 1-.4 1-1s-.4-1-1-1h-1.5c1.1-1.2 2.7-2 4.5-2 3.3 0 6 2.7 6 6s-2.7 6-6 6c-2.3 0-4.4-1.3-5.4-3.4-.2-.5-.8-.7-1.3-.5-.5.2-.7.8-.5 1.3 1.3 2.8 4.2 4.6 7.2 4.6 4.4 0 8-3.6 8-8s-3.6-8-8-8c-2.3 0-4.5 1-6 2.7V606c0-.6-.4-1-1-1s-1 .4-1 1z"></path></svg>';return t},t.templates.icon_share=function(e){var t='<svg class="share-icon" viewBox="0 0 20 20" preserveAspectRatio="xMidYMid" tabindex="-1"><polygon class="fill" points="20,0 0,12 5,15 17,4 7,16 7,19 9,17 14,20"/></svg>';return t},t.templates.icon_spin=function(e){var t='<svg class="vp-spin-trace" viewBox="0 0 50 50"><circle cx="50%" cy="50%" r="20"></circle></svg><svg class="vp-spin-circle" viewBox="0 0 50 50"><circle cx="50%" cy="50%" r="20"></circle></svg>';return t},t.templates.icon_stereoscopic=function(e){var t='<svg viewBox="0 0 20 13" tabindex="-1"><path class="fill" d="M 18.74,0 1.2,0 C 0.55,0 0,0.57 0,1.27 L 0,11.73 C 0,12.43 0.55,13 1.23,13 L 6,13 c 0.54,0 1,-0.32 1.16,-0.79 L 8.55,8.74 C 8.79,8.16 9.35,7.75 10,7.75 c 0.65,0 1.21,0.41 1.45,0.99 l 1.39,3.47 c 0.19,0.47 0.62,0.79 1.11,0.79 l 4.79,0 C 19.45,13 20,12.43 20,11.73 L 20,1.27 C 20,0.57 19.45,0 18.74,0 M 5.22,8.58 C 4,8.58 3,7.55 3,6.29 3,5 4,4 5.22,4 6.44,4 7.43,5 7.43,6.29 7.43,7.55 6.44,8.58 5.22,8.58 m 9.56,0 C 13.56,8.58 12.57,7.55 12.57,6.29 12.57,5.03 13.56,4 14.78,4 16,4 17,5.03 17,6.29 17,7.55 16,8.58 14.78,8.58 Z" /></svg>';return t},t.templates.icon_tumblr=function(e){var t='<svg class="tumblr-icon" viewBox="0 0 12 20" tabindex="-1"><path class="fill" d="M7.865,19.958 C3.629,19.958 2.02,16.834 2.02,14.627 L2.02,8.105 L0,8.105 L0,5.527 C3.027,4.436 3.756,1.705 3.927,0.149 C3.938,0.042 4.022,0 4.07,0 L6.994,0 L6.994,5.084 L10.987,5.084 L10.987,8.105 L6.979,8.105 L6.979,14.318 C6.993,15.149 7.291,16.287 8.815,16.287 C8.843,16.287 8.872,16.287 8.9,16.286 C9.43,16.272 10.14,16.118 10.511,15.941 L11.471,18.788 C11.11,19.317 9.481,19.932 8.015,19.957 C7.964,19.958 7.915,19.958 7.865,19.958"/></svg>';return t},t.templates.icon_twitter=function(e){var t='<svg class="twitter-icon" viewBox="0 0 274 223" preserveAspectRatio="xMidYMid" tabindex="-1"><path class="fill" d="M85.98,222 C54.305,222 24.822,212.715 0,196.801 C4.388,197.319 8.853,197.584 13.38,197.584 C39.658,197.584 63.843,188.617 83.039,173.574 C58.495,173.121 37.781,156.905 30.644,134.621 C34.068,135.276 37.582,135.627 41.196,135.627 C46.312,135.627 51.267,134.942 55.974,133.66 C30.314,128.508 10.981,105.838 10.981,78.662 C10.981,78.426 10.981,78.191 10.985,77.957 C18.548,82.158 27.196,84.681 36.391,84.972 C21.341,74.914 11.438,57.746 11.438,38.287 C11.438,28.008 14.204,18.373 19.032,10.089 C46.696,44.023 88.025,66.353 134.641,68.692 C133.685,64.587 133.188,60.306 133.188,55.91 C133.188,24.935 158.302,-0.178 189.279,-0.178 C205.411,-0.178 219.988,6.634 230.22,17.535 C242.996,15.019 255,10.351 265.837,3.924 C261.649,17.021 252.756,28.013 241.175,34.955 C252.521,33.599 263.331,30.584 273.39,26.123 C265.87,37.371 256.36,47.25 245.402,55.158 C245.51,57.563 245.564,59.982 245.564,62.414 C245.564,136.533 189.148,222 85.98,222"/></svg>';return t},t.templates.icon_unfullscreen=function(e){var t='<svg viewBox="0 0 12 12" preserveAspectRatio="xMidYMid" tabindex="-1"><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) "/><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(90)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(180)" /><polyline class="fill" points="-1,-1 -1.1,-5 -2.1,-4 -4.1,-6 -6,-4.1 -4,-2.1 -5,-1.1" transform="translate(6,6) rotate(270)" /></svg>';return t},t.templates.icon_vod_download=function(e){var t='<svg class="vod-download-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M21.707 24.707l-5 5c-.39.39-1.024.39-1.414 0l-5-5c-.39-.39-.39-1.024 0-1.414l1.06-1.06c.392-.392 1.025-.392 1.415 0L14 23.462V15c0-.552.448-1 1-1h2c.552 0 1 .448 1 1v8.464l1.232-1.232c.39-.39 1.024-.39 1.414 0l1.06 1.06c.392.39.392 1.025 0 1.415z"/><path class="fill" d="M27.894 12.31c.063-.43.106-.864.106-1.31 0-4.97-4.03-9-9-9-3.6 0-6.7 2.12-8.138 5.175C10.175 6.75 9.368 6.5 8.5 6.5 6.015 6.5 4 8.515 4 11c0 .445.067.874.187 1.28C1.76 13.05 0 15.318 0 18c0 3.314 2.686 6 6 6h1c0-2.42 1.718-4.436 4-4.9V15c0-2.21 1.79-4 4-4h2c2.21 0 4 1.79 4 4v4.1c2.282.464 4 2.48 4 4.9h1c3.314 0 6-2.686 6-6 0-2.65-1.72-4.896-4.106-5.69z"/></svg>';return t},t.templates.icon_vod_rent=function(e){var t='<svg class="vod-rent-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M23 11H9c-.552 0-1 .448-1 1v8c0 .552.448 1 1 1h14c.552 0 1-.448 1-1v-8c0-.552-.448-1-1-1z"/><path class="fill" d="M32 22V10c-2.76 0-5-2.24-5-5H5c0 2.76-2.24 5-5 5v12c2.76 0 5 2.24 5 5h22c0-2.76 2.24-5 5-5zm-6-1c0 1.105-.895 2-2 2H8c-1.105 0-2-.895-2-2V11c0-1.105.895-2 2-2h16c1.105 0 2 .895 2 2v10z"/></svg>';return t},t.templates.icon_vod_subscribe=function(e){var t='<svg class="vod-subscribe-icon" viewBox="0 0 32 32" tabindex="-1"><path class="fill" d="M20 9v2c0 .552.448 1 1 1h10c.552 0 1-.448 1-1V1c0-.552-.448-1-1-1h-2c-.552 0-1 .448-1 1v4.445C24.98 2.01 20.523-.128 15.558.005 7.293.23.413 6.96.018 15.216-.42 24.41 6.905 32 16 32c8.47 0 15.404-6.583 15.964-14.912.04-.585-.413-1.088-1-1.088H28.96c-.514 0-.956.388-.994.9C27.506 23.107 22.326 28 16 28 9.217 28 3.748 22.37 4.01 15.53 4.246 9.284 9.47 4.147 15.72 4.003 19.38 3.92 22.674 5.483 24.926 8H21c-.552 0-1 .448-1 1z"/><path class="fill" d="M13 20v-8l8 4"/></svg>';return t},t.templates.icon_vod=function(e){var t='<svg class="vod-icon" viewBox="0 0 21 23" tabindex="-1"><path class="fill" d="M19.602,4.716l-7.665-4.385C11.169-0.108,9.91-0.111,9.139,0.327L1.4,4.721C0.63,5.158,0,6.234,0,7.112v8.776c0,0.878,0.63,1.955,1.398,2.393l0.526,0.3l7.176,4.09c0.77,0.438,2.028,0.438,2.798,0l7.702-4.39c0.77-0.438,1.4-1.516,1.4-2.393V7.112C21,6.234,20.37,5.156,19.602,4.716z M7.336,15.761L7.337,7.24l8.008,4.26L7.336,15.761z"/></svg>';return t},t.templates.icon_warning=function(e){var t='<svg class="warning-icon" tabindex="-1" width="36" height="32.326" viewBox="287.915 380.297 36 32.326"><path d="M309.646 382.963c-2.052-3.555-5.41-3.555-7.462 0L288.79 406.16c-2.05 3.555-.372 6.463 3.732 6.463h26.786c4.104 0 5.783-2.908 3.73-6.463l-13.392-23.197zm-2 23.224c0 .983-.804 1.788-1.788 1.788-.983 0-1.788-.805-1.788-1.788 0-.984.805-1.79 1.788-1.79s1.79.805 1.788 1.79zm-.317-7.76c-.254 2.604-.916 4.735-1.472 4.735-.557 0-1.22-2.13-1.477-4.735-.255-2.604-.464-5.72-.464-6.925 0-1.204.87-2.19 1.935-2.19 1.066 0 1.936.986 1.936 2.19s-.205 4.32-.457 6.925z"/></svg>';return t},t.templates.logo=function(e){var t='<svg viewBox="0 0 140 40" preserveAspectRatio="xMidYMid" role="img" aria-label="Vimeo" tabindex="-1"><title>Vimeo</title><g><path class="fill logo-v" d="M31.277 18.832c-.14 3.052-2.27 7.229-6.39 12.531-4.259 5.536-7.863 8.306-10.811 8.306-1.825 0-3.371-1.687-4.633-5.059l-2.529-9.275c-.938-3.372-1.943-5.06-3.019-5.06-.234 0-1.054.494-2.458 1.477l-1.474-1.901c1.546-1.358 3.071-2.717 4.572-4.078 2.062-1.783 3.609-2.72 4.642-2.814 2.438-.234 3.938 1.433 4.502 5.001.608 3.851 1.03 6.246 1.266 7.182.704 3.195 1.476 4.791 2.321 4.791.657 0 1.641-1.037 2.954-3.108 1.312-2.072 2.015-3.649 2.109-4.732.188-1.789-.516-2.686-2.109-2.686-.75 0-1.522.173-2.318.514 1.54-5.044 4.481-7.495 8.823-7.355 3.22.095 4.737 2.184 4.552 6.266z"/><path class="fill logo-i" d="M50.613 28.713c-1.313 2.484-3.119 4.733-5.417 6.748-3.143 2.718-6.285 4.076-9.425 4.076-1.456 0-2.57-.469-3.343-1.406-.773-.938-1.137-2.153-1.09-3.653.045-1.548.526-3.938 1.441-7.173.914-3.232 1.373-4.967 1.373-5.201 0-1.218-.423-1.828-1.266-1.828-.282 0-1.079.494-2.393 1.477l-1.618-1.901c1.501-1.358 3.001-2.717 4.502-4.078 2.017-1.783 3.518-2.72 4.504-2.814 1.546-.14 2.684.314 3.411 1.367.726 1.052.996 2.417.81 4.098-.61 2.852-1.268 6.472-1.972 10.864-.046 2.01.681 3.014 2.182 3.014.656 0 1.827-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.336 1.755zm-6.12-25.016c-.047 1.168-.633 2.288-1.76 3.361-1.266 1.212-2.767 1.82-4.501 1.82-2.672 0-3.963-1.166-3.869-3.499.045-1.213.76-2.381 2.144-3.501 1.384-1.119 2.919-1.68 4.609-1.68.984 0 1.805.387 2.462 1.155.656.772.961 1.553.915 2.344z"/><path class="fill logo-m" d="M94.543 28.713c-1.314 2.484-3.117 4.733-5.416 6.748-3.145 2.718-6.285 4.076-9.426 4.076-3.051 0-4.527-1.687-4.432-5.06.045-1.501.338-3.306.877-5.415.539-2.108.832-3.748.879-4.921.049-1.779-.492-2.673-1.623-2.673-1.223 0-2.682 1.456-4.375 4.362-1.788 3.05-2.754 6.003-2.894 8.861-.095 2.02.103 3.568.592 4.645-3.272.096-5.565-.444-6.873-1.617-1.171-1.032-1.708-2.742-1.614-5.135.045-1.501.276-3.001.69-4.502.414-1.5.644-2.837.69-4.011.095-1.734-.54-2.604-1.9-2.604-1.177 0-2.444 1.339-3.806 4.011-1.361 2.673-2.113 5.465-2.253 8.371-.094 2.627.074 4.456.503 5.486-3.219.096-5.505-.582-6.857-2.035-1.122-1.214-1.634-3.06-1.539-5.54.044-1.214.258-2.911.645-5.084.386-2.175.603-3.87.647-5.087.093-.841-.119-1.263-.633-1.263-.281 0-1.079.475-2.393 1.424l-1.687-1.901c.234-.184 1.71-1.545 4.432-4.078 1.969-1.828 3.306-2.766 4.009-2.812 1.219-.095 2.204.409 2.954 1.511s1.126 2.38 1.126 3.834c0 .469-.047.915-.14 1.336.703-1.077 1.523-2.017 2.463-2.814 2.156-1.874 4.572-2.931 7.245-3.166 2.298-.187 3.938.352 4.925 1.617.795 1.033 1.17 2.511 1.125 4.433.329-.28.681-.586 1.056-.915 1.078-1.267 2.133-2.273 3.164-3.023 1.736-1.267 3.541-1.97 5.418-2.112 2.25-.187 3.867.35 4.852 1.611.844 1.028 1.219 2.5 1.127 4.415-.047 1.309-.363 3.213-.949 5.712-.588 2.501-.879 3.936-.879 4.31-.049.982.047 1.659.279 2.034.236.373.797.559 1.689.559.656 0 1.826-.693 3.518-2.083 1.406-1.156 2.555-2.243 3.447-3.262l1.337 1.757z"/><path class="fill logo-e" d="M120.922 28.642c-1.361 2.249-4.033 4.495-8.02 6.743-4.971 2.856-10.012 4.284-15.125 4.284-3.797 0-6.52-1.267-8.16-3.797-1.172-1.735-1.734-3.797-1.688-6.189.045-3.797 1.736-7.407 5.064-10.832 3.658-3.75 7.973-5.627 12.945-5.627 4.596 0 7.033 1.873 7.314 5.615.188 2.384-1.125 4.842-3.938 7.368-3.004 2.76-6.781 4.515-11.328 5.263.842 1.169 2.109 1.752 3.799 1.752 3.375 0 7.059-.855 11.045-2.574 2.859-1.207 5.111-2.461 6.754-3.76l1.338 1.754zm-15.969-7.345c.045-1.259-.469-1.89-1.547-1.89-1.406 0-2.83.969-4.283 2.906-1.451 1.936-2.201 3.789-2.248 5.562-.025 0-.025.305 0 .911 2.295-.839 4.287-2.122 5.971-3.849 1.357-1.491 2.06-2.707 2.107-3.64z"/><path class="fill logo-o" d="M140.018 23.926c-.189 4.31-1.781 8.031-4.783 11.169-3.002 3.137-6.73 4.706-11.186 4.706-3.705 0-6.52-1.195-8.441-3.585-1.404-1.777-2.182-4.001-2.32-6.668-.236-4.029 1.217-7.729 4.361-11.101 3.377-3.746 7.619-5.618 12.732-5.618 3.281 0 5.766 1.102 7.457 3.301 1.594 2.015 2.32 4.614 2.18 7.796zm-7.95-.264c.047-1.269-.129-2.434-.527-3.49-.4-1.057-.975-1.587-1.725-1.587-2.391 0-4.361 1.293-5.906 3.877-1.316 2.115-2.02 4.371-2.111 6.766-.049 1.176.164 2.21.633 3.104.514 1.032 1.242 1.549 2.182 1.549 2.109 0 3.914-1.244 5.416-3.735 1.267-2.068 1.945-4.23 2.038-6.484z"/></g></svg>';return t},t.templates.menu_list_panel=function(e){var t='<div class="vp-panel vp-panel-open vp-panel--'+e.id+'"><div class="vp-panel-title"><button type="button" class="vp-panel-button js-panelTitleButton" tabindex="0"><span class="vp-panel-button-text">'+e.title+'</span><span class="vp-panel-stat"><span class="vp-panel-stat-text js-panelStatText">'+e.active+"</span> ";t+=this.render("icon_line_arrow")||"",t+=' </span></button></div><div class="vp-panel-itemsWrap"><ul class="vp-panel-items js-panelItems"> ';for(var n=0;n<e.items.length;n++)t+=' <li class="vp-panel-item',e.items[n].active&&(t+=" vp-panel-item-on"),t+='" tabindex="0" role="menuitemradio" aria-checked="',t+=e.items[n].active?"true":"false",t+='"> '+e.items[n].label+" </li> ";return t+=' </ul><div class="vp-indicator"></div></div></div>'},t.templates.menu=function(e){var t='<div class="vp-menu vp-menu-hidden vp-menu-invisible" role="menu" hidden><button type="button" class="vp-menu-close js-menuClose" aria-label="'+e.strings.close+'">';return t+=this.render("icon_close_new")||"",t+="</button></div>"},t.templates.outer=function(e){var t='<div class="vp-player-layout"><div class="vp-player-inner"><div class="vp-video-wrapper"><div class="vp-video"><div class="vp-telecine"></div></div><div class="vp-preview"></div><div class="vp-shade vp-shade-invisible"></div><div class="vp-spin vp-spin-invisible"> ';return t+=this.render("icon_spin")||"",t+=' </div></div><div class="vp-text-alert-wrapper hidden"><div class="vp-alert-text"></div><div class="vp-alert-time"><div class="vp-live-start-time-title"></div><div class="vp-live-start-time-body"></div><div class="vp-live-start-time-footer"></div></div></div><div class="vp-target"></div><div class="vp-captions hidden with-controls" hidden aria-live="assertive"><span></span></div><div class="vp-cards-wrapper"><div class="vp-cards"></div></div><div class="vp-outro-wrapper hidden" hidden><div class="vp-outro" role="dialog" aria-live="assertive"></div></div><div class="vp-controls-wrapper"><div class="vp-title" role="contentinfo"></div><div class="vp-controls"></div><div class="vp-sidedock hidden" role="toolbar" hidden></div></div><div class="vp-overlay-wrapper hidden" hidden><div class="vp-overlay-bg"></div><div class="vp-overlay-cell"><div class="vp-overlay" role="dialog" aria-live="assertive"></div><div class="vp-overlay-icon-wrapper hidden"><div class="vp-overlay-icon"></div></div><div class="vp-overlay-logo logo"></div></div><nav><button type="button" class="vp-nav-prevButton js-back cloaked" aria-label="'+e.strings.back+'">',t+=this.render("icon_prev")||"",t+='</button><button type="button" class="vp-nav-closeButton js-close" aria-label="'+e.strings.close+'">',t+=this.render("icon_close_new")||"",t+='</button></nav></div><div class="notification-wrapper hidden" hidden><div class="notification-cell"><div class="notification" role="dialog" aria-live="assertive"></div></div></div><div class="stats-debug rounded-box hidden" aria-hidden="true" hidden></div></div></div>'},t.templates.sidedock=function(e){var t="";return e.vodButton&&(t+=' <div class="box" data-vod-expiring="'+e.vodPurchaseInfo.expiring+'" data-vod-purchased="'+e.purchased+'"><button type="button" class="vod-button rounded-box',e.purchased&&(t+=" on"),e.vodPurchaseInfo.expiring&&(t+=" expiring"),t+='" data-product-id="'+e.vodPurchaseInfo.product_id+'"><div class="vod-button-inner"><span class="vod-label">'+e.vodDisplayLabel+"</span> ",t+=this.render("icon_vod")||"",t+=' </div></button></div><div class="sidedock-inner">'),e.likeButton&&(t+=' <div class="box"><label class="rounded-box hidden like-label" role="presentation"><span>'+(e.liked?e.strings.unlike:e.strings.like)+'</span></label><button type="button" class="like-button rounded-box',e.liked&&(t+=" on"),t+='" aria-label="',t+=e.loggedOut?""+e.strings.likeLoggedOut:""+(e.liked?e.strings.unlike:e.strings.like),t+='" data-label-add="'+e.strings.like+'" data-label-add-logged-out="'+e.strings.likeLoggedOut+'" data-label-remove="'+e.strings.unlike+'"> ',t+=this.render("icon_heart")||"",t+=" </button></div>"),e.watchLaterButton&&(t+=' <div class="box"><label class="rounded-box hidden watch-later-label" role="presentation"><span>'+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd)+'</span></label><button type="button" class="watch-later-button rounded-box',e.addedToWatchLater&&(t+=" on"),t+='" aria-label="',t+=e.loggedOut?""+e.strings.watchLaterLoggedOut:""+(e.addedToWatchLater?e.strings.watchLaterRemove:e.strings.watchLaterAdd),t+='" data-label-add="'+e.strings.watchLaterAdd+'" data-label-add-logged-out="'+e.strings.watchLaterAddLoggedOut+'" data-label-remove="'+e.strings.watchLaterRemove+'"> ',t+=this.render("icon_clock")||"",t+=" </button></div>"),e.collectionsButton&&(t+=' <div class="box"><label class="rounded-box hidden collections-label" role="presentation"><span>'+e.strings.collections+'</span></label><button type="button" class="collections-button rounded-box" aria-label="'+e.strings.collections+'"> ',t+=this.render("icon_collections")||"",t+=" </button></div>"),e.shareButton&&(t+=' <div class="box"><label class="rounded-box hidden share-label" role="presentation"><span>'+e.strings.share+'</span></label><button type="button" class="share-button rounded-box" aria-label="'+e.strings.share+'"> ',t+=this.render("icon_share")||"",t+=" </button></div>"),e.vodButton&&(t+=" </div>"),t+=""},t.templates.app_redirect=function(e){var t='<div class="vp-overlay-content"> ';return e.strings.title&&(t+=' <div class="app-redirect-title">'+e.strings.title+"</div> "),t+=' <div class="'+(e.strings.title?"":"app-redirect--topspace")+'"><a class="app-redirect-button" href="'+e.redirectUrl+'" role="button"',e.newWindow&&(t+=' data-new-window="1" target="_blank" rel="noopener"'),t+=">"+e.strings.buttonText+"</a></div> ",e.strings.ignoreText&&(t+=' <div class="app-redirect-ignore">'+e.strings.ignoreText+"</div> "),e.strings.bottomText&&(t+=' <div class="app-redirect-bottom-text">'+e.strings.bottomText+"</div> "),t+="</div>"},t.templates.email_capture=function(e){var t='<div class="vp-email-capture-wrapper"><div class="vp-email-capture"> ';return e.customLogo&&(t+=' <div class="vp-email-capture-logoWrap"><img src="',t+=this.escape(e.customLogo)||"",t+='" alt="" class="vp-email-capture-logo"></div> '),t+=' <h1 class="vp-email-capture-title">',t+=this.escape(e.text)||"",t+="</h1> ",e.subtitle&&(t+=' <p class="vp-email-capture-subtitle">',t+=this.escape(e.subtitle)||"",t+="</p> "),t+=' <form class="vp-email-capture-form" action="'+e.action+'" method="post" novalidate><div class="vp-validation-bubble hidden"><div class="vp-validation-bubble-arrowClipper"><div class="vp-validation-bubble-arrow"></div></div><div class="vp-validation-bubble-message"></div></div><input class="vp-email-capture-form-input vp-email-capture-form-input--email" type="email" name="email" placeholder="'+e.strings.email+'" aria-label="'+e.strings.email+'" required aria-required="true"><input class="vp-email-capture-form-input" type="text" name="name" placeholder="'+e.strings.fullName+'" aria-label="'+e.strings.fullName+'" pattern="^[^!@#$%^*+=?<>]+$" maxlength="180"><input type="hidden" name="referrer" value="'+e.referrer+'"><input type="hidden" name="signature" value=""><input type="hidden" name="time" value=""><input type="hidden" name="expires" value=""><div class="vp-email-capture-form-buttons"><input class="vp-email-capture-form-button vp-email-capture-form-button--reset" type="button" value="'+e.strings.nothanks+'"> ',e.allowSkip&&(t+=' <input class="vp-email-capture-form-button vp-email-capture-form-button--cancel" type="button" value="'+e.strings.nothanks+'"> '),t+=' <input class="vp-email-capture-form-button vp-email-capture-form-button--submit" type="submit" value="'+e.strings.submit+'"></div></form></div><div class="vp-email-capture-confirm vp-email-capture-confirm-hidden"><div class="vp-email-capture-confirm-box"><h1 class="vp-email-capture-confirm-title">',t+=this.escape(e.confirmation)||"",t+="</h1></div></div></div>"},t.templates.error=function(e){var t='<div class="vp-overlay-content error"> ';return e.title&&(t+=" <h1>"+e.title+"</h1> "),e.message&&(t+=" <p>"+e.message+"</p> "),t+="</div>"},t.templates.help=function(e){var t='<div class="vp-overlay-content help"><h1>'+e.strings.title+'</h1><dl><div class="volume-up secondary"><dt class="arrow">↑</dt><dd>'+e.strings.volumeUp+'</dd></div><div class="volume-down secondary"><dt class="arrow">↓</dt><dd>'+e.strings.volumeDown+'</dd></div><div class="scrub-forward secondary"><dt class="arrow">→</dt><dd>'+e.strings.scrubForward+'</dd></div><div class="scrub-backwards secondary"><dt class="arrow">←</dt><dd>'+e.strings.scrubBackwards+'</dd></div><div class="like"><dt>L</dt><dd>'+e.strings.like+'</dd></div><div class="share"><dt>S</dt><dd>'+e.strings.share+'</dd></div><div class="watch-later"><dt>W</dt><dd>'+e.strings.watchLater+'</dd></div><div class="toggle-captions"><dt>C</dt><dd>'+e.strings.captions+'</dd></div><div class="toggle-prefs"><dt>H</dt><dd>'+e.strings.prefs+'</dd></div><div class="fullscreen"><dt>F</dt><dd>'+e.strings.fullscreen+"</dd></div> ";return e.onSite||(t+='<div class="view-on-vimeo"><dt>V</dt><dd>'+e.strings.viewOnVimeo+"</dd></div>"),t+=" </dl></div>"},t.templates.outro_email=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--email outro-shade js-outro-content"></div>'},t.templates.outro_image=function(e){var t='<div class="outro-content outro-content--image js-outro-content"> ';return e.url&&(t+='<a class="outro-imageLink js-imageLink" href="'+e.url+'" target="_blank" rel="noopener">'),e.bgimage&&(t+='<div class="outro-image" style="background-image: url('+e.bgimage+');"',e.alt_text&&(t+=' aria-label="',t+=this.escape(e.alt_text)||"",t+='" role="img"'),t+="></div>"),e.url&&(t+="</a>"),t+="</div>"},t.templates.outro_link=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--link outro-shade js-outro-content"><div class="outro-linkWrapper js-outro-linkWrapper"> ',e.title&&(t+='<h1 class="outro-textTitle js-outro-title">',t+=this.escape(e.title)||"",t+="</h1>"),e.description&&(t+='<p class="outro-textDescription js-outro-text">',t+=this.escape(e.description)||"",t+="</p>"),e.text&&e.url&&(t+=' <div class="outro-buttonWrap"><a class="outro-button js-cta" href="'+e.url+'" target="_blank" rel="noopener" title="',t+=this.escape(e.text)||"",t+='"><span>',t+=this.escape(e.text)||"",t+="</span></a></div> "),e.text2&&e.url2&&(t+=' <div class="outro-linkWrap js-outro-linkWrap"><a class="outro-link js-link" href="'+e.url2+'" target="_blank" rel="noopener" title="',t+=this.escape(e.text2)||"",t+='">',t+=this.escape(e.text2)||"",t+="</a></div> "),t+=" </div></div>"},t.templates.outro_nothing=function(e){var t='<div class="outro-bg"></div><div class="outro-content outro-content--nothing outro-shade js-outro-content"></div>';return t},t.templates.outro_share=function(e){var t='<div class="outro-bg"';return e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--share outro-shade js-outro-content"></div><nav class="panel-nav"><button type="button" class="vp-nav-prevButton js-back cloaked" aria-label="'+e.strings.back+'">',t+=this.render("icon_prev")||"",t+="</button></nav>"},t.templates.outro_staticimage=function(e){var t='<div class="outro-content outro-content--staticImage js-outro-content"><div class="outro-staticImageWrapper"> ';return e.url&&(t+='<a class="outro-staticImageLink" href="'+e.url+'" target="_blank" rel="noopener">'),t+=' <img class="outro-staticImage" src="'+e.svg_url+'"> ',e.url&&(t+="</a>"),t+=" </div></div>"},t.templates.outro_text=function(e){var t='<div class="outro-content outro-content--text outro-shade js-outro-content"><div class="outro-textWrapper"><div class="outro-text">'+e.text+"</div></div></div>";return t},t.templates.outro_videos=function(e){var t='<div class="outro-bg"';e.bgimage&&(t+=' style="background-image: url('+e.bgimage+');"'),t+='></div><div class="outro-content outro-content--videos outro-shade js-outro-content"> ';for(var n=0,i=e.contexts.length;n<i;n++){var r=e.contexts[n];t+=' <div class="outro-videosSection outro-videosSection--'+r.videos.length,r.promoted&&(t+=" outro-videosSection--promoted"),t+='"><div class="outro-videosHeaderWrapper"><header class="outro-videosHeader"><h1 class="outro-videosTitle">'+r.context+"</h1> ",e.showFollowButton&&!r.promoted&&(t+=' <div class="outro-followWrap js-outro-followWrap"><button type="button" class="outro-follow js-outro-follow" aria-label="'+e.strings.follow+'" aria-pressed="',t+=e.following?"true":"false",t+='"> ',t+=this.render("icon_follow")||"",t+=' <span class="outro-follow-text" data-label-follow="'+e.strings.follow+'" data-label-following="'+e.strings.following+'" data-label-unfollow="'+e.strings.unfollow+'"></span></button></div> '),t+=' </header></div><ul class="outro-videos outro-videos--'+r.videos.length+'"> ';for(var o=0,a=r.videos.length;o<a;o++)t+=' <li><a class="outro-videoLink js-videoLink',1==n&&(t+=" hovered"),t+='" href="'+r.videos[o].url+'"',e.target&&(t+=' target="_blank" rel="noopener"'),t+=' data-video-id="'+r.videos[o].id+'" aria-label="',t+=this.escape(r.videos[o].fullTitle)||"",t+='" title="',t+=this.escape(r.videos[o].fullTitle)||"",t+='"><div class="outro-imgWrapper"><img src="'+r.videos[o].thumbnail+'" alt="" width="295" height="166"></div><header class="outro-videoHeader"><h1 class="outro-videoTitle">',t+=this.escape(r.videos[o].title)||"",t+="</h1> ",r.videos[o].byline&&(t+=' <h2 class="outro-videoByline">',t+=this.escape(r.videos[o].byline)||"",t+="</h2> "),t+=" </header></a> ";t+=" </ul></div> "}return t+="</div>"},t.templates.outro_vod=function(e){var t='<div class="outro-content outro-content--vod outro-shade js-outro-content"><div class="outro-vodWrapper"><h1 class="outro-vodHeader"><a href="'+e.url+'" target="_blank" rel="noopener">';t+=this.escape(e.title)||"",t+="</a></h1> ";var n=e.countries,i=e.country;if(this.helpers.isAvailableInCountry(n,i))if(e.purchased)t+=' <a class="outro-vodButton outro-vodButton--watch js-vod-watch" role="button" href="'+e.url+'" target="_blank" rel="noopener">'+e.strings.watch+"</a> ";else{if(!e.isComingSoon){t+=' <ul class="outro-vod"> ';for(var r=0,o=e.buttons.length;r<o;r++){t+=' <li class="outro-vod-item"><a class="outro-vodButton outro-vodButton--'+e.buttons[r].type+' js-vod-button" role="button" href="'+e.url+"#buy="+e.buttons[r].product_id+'" target="_blank" rel="noopener" data-product-id="'+e.buttons[r].product_id+'" role="button"><div class="outro-vodIcon"> ',t+="buy"===e.buttons[r].type?this.render("icon_vod_download")||"":"rent"===e.buttons[r].type?this.render("icon_vod_rent")||"":"subscribe"===e.buttons[r].type?this.render("icon_vod_subscribe")||"":this.render("icon_vod")||"",t+=" </div> ";var a=e.currency,s=e.buttons[r];t+=" <p>"+this.helpers.formatVodLabel(e.translationMap,"outro_string",a,s)+"</p></a></li> "}t+=" </ul> "}(e.isPreorder||e.isComingSoon)&&(t+=" <p>"+e.strings.preRelease+"</p> ")}return t+=" </div></div>"},t.templates.password=function(e){var t='<div class="vp-overlay-content password form"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><form action="'+e.action+'" method="post" novalidate><div class="vp-validation-bubble hidden"><div class="vp-validation-bubble-arrow-clipper"><div class="vp-validation-bubble-arrow"></div></div><div class="vp-validation-bubble-message"></div></div><input type="password" name="password" placeholder="'+e.strings.password+'" required aria-required="true" aria-label="'+e.strings.password+'"><input type="submit" value="'+e.strings.watch+'"></form></div>';return t},t.templates.private_locked=function(e){var t='<div class="vp-overlay-content login"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><a href="'+e.action+'" class="popup" target="_blank" rel="noopener" role="button" aria-label="'+e.strings.logInLabel+'">'+e.strings.logIn+"</a></div>";return t},t.templates.private_unlocked=function(e){var t='<div class="vp-overlay-content form unlocked"><h1>'+e.strings.title+'</h1><p class="subtitle">'+e.strings.subtitle+'</p><button type="button">'+e.strings.watch+"</button></div>";return t},t.templates.share=function(e){var t='<div class="vp-share-wrapper js-share"><section class="vp-share-screen vp-share-screen--share'+(e.embedOnly?" cloaked":"")+' js-share-screen"><h1 class="vp-share-title vp-share-title--share">'+e.strings.share+'</h1><ul class="vp-share-buttons"><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--facebook js-facebook" href="'+e.playerShareUrl+'/facebook" target="_blank" rel="noopener" title="'+e.strings.facebook+'" role="button" aria-label="'+e.strings.facebook+'">';return t+=this.render("icon_facebook")||"",t+='</a><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--twitter js-twitter" href="'+e.playerShareUrl+'/twitter" target="_blank" rel="noopener" title="'+e.strings.twitter+'" role="button" aria-label="'+e.strings.twitter+'">',t+=this.render("icon_twitter")||"",t+='</a><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--tumblr js-tumblr" href="'+e.playerShareUrl+'/tumblr" target="_blank" rel="noopener" title="'+e.strings.tumblr+'" role="button" aria-label="'+e.strings.tumblr+'">',t+=this.render("icon_tumblr")||"",t+="</a> ",e.url&&(t+=' <li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--email js-email" href="mailto:?subject=',t+=encodeURIComponent(e.strings.emailSubject)||"",t+="&amp;body=",t+=encodeURIComponent(e.strings.emailBody)||"",t+='" title="'+e.strings.email+'" role="button" aria-label="'+e.strings.email+'">',t+=this.render("icon_mail")||"",t+="</a> "),t+=" </ul> ",e.embed&&(t+=' <ul class="vp-share-buttons"><li class="vp-share-buttons-item"><a class="vp-share-button vp-share-button--embed js-embed" href="'+e.url+'#share" target="_blank" rel="noopener" title="'+e.strings.embedCode+'" role="button" aria-label="'+e.strings.embedCode+'">',t+=this.render("icon_embed")||"",t+="</a></li></ul> "),e.url&&(t+=' <p class="vp-share-footnote vp-share-footnote--share"><a class="clip_url" href="'+e.shareUrl+'" target="_blank" rel="noopener">'+e.shareUrl+"</a></p> "),t+=" </section> ",e.embed&&(t+=' <section class="vp-share-screen vp-share-screen--embed'+(e.embedOnly?"":" cloaked")+' js-embed-screen"><div class="vp-share-embedWrapper"><h1 class="vp-share-title vp-share-title--embed">'+e.strings.embedTitle+'</h1><p class="vp-share-subtitle vp-share-subtitle--embed">'+e.strings.embedSubtitle+'</p><div class="vp-share-embedCode form"><div><input class="vp-share-embedInput" type="text" name="embed_code" title="Embed code" value="'+e.embedCode+'" spellcheck="false" aria-readonly="true"',e.readOnly&&(t+=" readonly"),t+="></div> ",e.copyButton&&(t+=' <button type="button" class="vp-share-embedCopy js-embedCopy" data-clipboard-text=\''+e.embedCode+"' data-label=\""+e.strings.copy+'" data-success-label="'+e.strings.copySuccess+'">'+e.strings.copy+"</button> "),t+=" </div> ",e.customizeEmbed&&(t+=' <p class="vp-share-footnote vp-share-footnote--embed">'+e.strings.customize+"</p> "),t+=" </div></section> "),t+="</div>"},t.templates.threesixty_reminder=function(e){var t='<div class="intro-wrap text-only"><div> ';
return e.showArrows&&(t+=' <div class="key-wrapper"><div class="key-row"><div class="key"><div class="arrow arrow-top"></div></div></div><div class="key-row"><div class="key"><div class="arrow arrow-left"></div></div><div class="key"><div class="arrow arrow-down"></div></div><div class="key"><div class="arrow arrow-right"></div></div></div></div> '),t+=" <div>"+e.text+"</div></div></div>"},t.templates.time_series_graph=function(e){var t='<svg width="'+e.width+'" height="'+e.height+'" viewBox="0 0 '+e.width+" "+e.height+'"><g><polyline stroke="white" fill="none" points="'+e.points+'"></polyline></g><g> '+e.markers+" </g></svg>";return t},t.templates.title_byline_badge=function(e){var t="&nbsp;";return e.link&&(t+='<a tabindex="-1" href="'+e.link+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <span class="byline-badge '+e.cssClass+'">'+e.cssClass+"</span>",e.link&&(t+="</a>"),t+=""},t.templates.title_owner_byline=function(e){var t="";return e.linkToOwner?(t+='<a href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">",t+=this.escape(e.owner)||"",t+="</a>"):(t+='<span class="user">',t+=this.escape(e.owner)||"",t+="</span>"),t+=""},t.templates.title=function(e){var t='<header class="vp-title-header"> ';return e.badge&&(t+=' <div class="badge',e.badge.shadow&&(t+=" shadow"),t+='"> ',e.badge.link&&(t+='<a href="'+e.badge.link+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <img src="'+e.badge.img+'"',e.badge.offset&&(t+=' style="margin-top:'+e.badge.offset.y+"px;margin-left:"+e.badge.offset.x+'px"'),t+=' width="'+e.badge.width+'" height="'+e.badge.height+'" alt="'+e.badge.name+' Badge"> ',e.badge.link&&(t+="</a>"),t+=" </div> "),e.showPortrait&&(t+=' <div class="portrait" aria-hidden="true"> ',e.linkToOwner&&(t+='<a tabindex="-1" href="'+e.ownerLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=">"),t+=' <img src="'+e.portraitImg+'" alt="" width="60" height="60"> ',e.linkToOwner&&(t+="</a>"),t+=" </div> "),t+=' <div class="headers"> ',e.showTitle&&(t+=" <h1> ",e.showTitleLink&&(t+='<a href="'+e.titleLink+'"',e.targetBlank&&(t+=' target="_blank" rel="noopener"'),t+=" data-clip-link>"),t+=this.escape(e.title)||"",e.showTitleLink&&(t+="</a>"),e.is360&&(t+='<div class="threesix-badge-title">360</div>'),e.hasHDR&&(t+='<div class="hashdr-badge-title">HDR</div>'),t+=" </h1> "),e.showByline&&(t+=' <div class="sub-title"><h2 class="byline-from">'+e.strings.byline+"</h2> ",e.is360&&!e.showTitle&&(t+=' <div class="threesix-badge-byline">360</div> '),e.hasHDR&&!e.showTitle&&(t+=' <div class="hashdr-badge-byline">HDR</div> '),t+=" </div> "),!e.is360||e.showByline||e.showTitle||(t+=' <div class="threesix-badge-loner">360</div> '),!e.hasHDR||e.showByline||e.showTitle||(t+=' <div class="hashdr-badge-loner">HDR</div> '),t+=" </div></header>"},e.exports?e.exports=t:window.Aftershave=t}()}),Lg=El,Pg=Nr,Cg="Expected a function",Og=fi,Rg=e(function(e){!function(t,n,i){function r(){var e=Array.prototype.slice.apply(arguments),t=e.shift();p[t].forEach(function(t){"function"==typeof t&&t.apply(t,e)})}function o(e){return function(t,n){v.indexOf(t)!==-1&&e.call(this,t,n)}}function a(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var n=e.getElementsByTagName("video");n[0]&&(t=n[0])}return t}function s(e){var t=a(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_METADATA?(t.addEventListener("loadedmetadata",function n(){t.removeEventListener("loadedmetadata",n,!1);try{t.webkitEnterFullscreen(),y=!!t.getAttribute("controls")}catch(t){return x("cannot_enter_fullscreen",e)}},!1),t.load()):(t.webkitEnterFullscreen(),y=!!t.getAttribute("controls")),g=t}catch(t){return x("not_supported",e)}return!0}return x(void 0===f.request?"not_supported":"not_enabled",e)}function u(){A.element||(T(),l())}function c(){i&&"webkitfullscreenchange"===f.change&&t.addEventListener("resize",u,!1)}function l(){i&&"webkitfullscreenchange"===f.change&&t.removeEventListener("resize",u,!1)}var d=/i(Pad|Phone|Pod)/.test(navigator.userAgent)&&parseInt(navigator.userAgent.replace(/^.*OS (\d+)_(\d+).*$/,"$1.$2"),10)>=7,f=function(){var e=n.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},i={};for(var r in t)for(var o=0,a=t[r].length;o<a;o++)if(t[r][o]in e||t[r][o]in n||"on"+t[r][o].toLowerCase()in n){i[r]=t[r][o];break}return i}(),h={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},v=[],p={},m=null;Object.keys(h).forEach(function(e){v.push(h[e]),p[h[e]]=[]});var g=null,y=null,_=function(){},b=[],w=!1,k=!1,S={chrome:navigator.userAgent.indexOf("Chrome")!==-1,android:navigator.userAgent.indexOf("Android")!==-1,safari:navigator.userAgent.indexOf("Safari")!==-1,apple:navigator.userAgent.indexOf("Apple")!==-1};S.chrome&&S.android&&(w=parseInt(navigator.userAgent.replace(/^.*Chrome\/(\d+).*$/,"$1"),10)||!0),S.safari&&S.apple&&!S.chrome&&!S.android&&(k=parseFloat(navigator.userAgent.replace(/^.*Version\/(\d+)\.(\d+).*$/,"$1.$2"))||!0);var E=function(e){var t=b[b.length-1];t&&(e!==t.element&&e!==g||!t.hasEntered)&&("VIDEO"===e.tagName&&(g=e),1===b.length&&A.onenter(A.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,r(h.ENTER,A.element))},T=function(){!g||y||d||(g.setAttribute("controls","controls"),g.removeAttribute("controls")),g=null,y=null;var e=b.pop();e&&(e.exit.call(e.element),r(h.EXIT,e.element),!i&&m&&0===t.scrollY&&t.scrollTo(0,m),A.element||(b.forEach(function(e){e.exit.call(e.element),r(h.EXIT,e.element)}),b=[],A.onexit()))},x=function(e,t){if(b.length>0){var n=b.pop();t=t||n.element,n.error.call(t,e),A.onerror(t,e),r(h.ERROR,t,e)}},A={request:function(e,r,o,a){if(e=e||n.body,b.push({element:e,enter:r||_,exit:o||_,error:a||_}),void 0===f.request)return s(e);if(i&&n[f.enabled]===!1)return s(e);if(w!==!1&&w<32)return s(e);if(i&&void 0===f.enabled)return f.enabled="webkitFullscreenEnabled",e[f.request](),void setTimeout(function(){n[f.element]?n[f.enabled]=!0:(n[f.enabled]=!1,s(e))},250);try{!i&&t&&(m=t.scrollY),e[f.request](),k>=5.1&&setTimeout(function(){n[f.element]||x(i?"not_enabled":"not_allowed",e)},100)}catch(t){x("not_enabled",e)}},exit:function(){l(),!n[f.exit]&&A.element?A.element[f.exit]():n[f.exit]()},toggle:function(e,t,n,i){A.element?A.exit():A.request(e,t,n,i)},videoEnabled:function(e){if(A.enabled)return!0;e=e||n.body;var t=a(e);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:o(function(e,t){p[e].push(t)}),off:o(function(e,t){var n=p[e].indexOf(t);n>-1&&p[e].splice(n,1)}),onenter:_,onexit:_,onchange:_,onerror:_};try{Object.defineProperties(A,{element:{enumerable:!0,get:function(){return g&&g.webkitDisplayingFullscreen?g:n[f.element]||null}},enabled:{enumerable:!0,get:function(){return"webkitCancelFullScreen"===f.exit&&!i||!(w!==!1&&w<32)&&(n[f.enabled]||!1)}}})}catch(e){A.element=null,A.enabled=!1}f.change&&n.addEventListener(f.change,function(e){if(A.onchange(A.element),r(h.CHANGE,A.element),A.element){var t=b[b.length-2];t&&t.element===A.element?T():(E(A.element),c())}else T()},!1),n.addEventListener("webkitbeginfullscreen",function(e){var t=!0;if(b.length>0)for(var n=0,i=b.length;n<i;n++){var o=a(b[n].element);if(o===e.srcElement){t=!1;break}}t&&b.push({element:e.srcElement,enter:_,exit:_,error:_}),A.onchange(e.srcElement),r(h.CHANGE,A.srcElement),E(e.srcElement)},!0),n.addEventListener("webkitendfullscreen",function(e){A.onchange(e.srcElement),r(h.CHANGE,e.srcElement),T(e.srcElement)},!0),f.error&&n.addEventListener(f.error,function(e){x("not_allowed")},!1),e.exports?e.exports=A:t.BigScreen=A}(window,document,self!==top)}),Ig=function(){function e(t,n){var i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;ec(this,e),he(this),this.version=r,this.visible=!1;var o=this._wrap=document.createElement("div");o.classList.add("compass-wrapper"),o.innerHTML=Ag.render("compass",{version:r}),o.classList.add("cloaked"),t.appendChild(o),n&&o.addEventListener("click",n),this._layerSlice=o.querySelector(".compass-slice"),this._lineSlice=o.querySelector(".compass-line");var a=function(){i._mouseIn=!0},s=function(e){return function(){setTimeout(function(){i._mouseIn||(i.fade(),i._mouseIn=!1)},e)}};Wp(this._wrap).on("mousein",a).on("pointerin",a).on("mouseout",s(1e3)).on("pointerout",s(1e3)),s(2500)()}return tc(e,[{key:"setAngle",value:function(e,t){var n=this;this._animationFrame&&window.cancelAnimationFrame(this._animationFrame);var i=0;1===this.version?i=-45:2===this.version&&(i=-30);var r=""+(i+t),o=(e+85)/170,a=18;this._animationFrame=window.requestAnimationFrame(function(){n._layerSlice.setAttribute("transform","rotate("+r+", "+a+", "+a+")"),n._lineSlice&&n._lineSlice.setAttribute("d",n._getLinePath(o,a))})}},{key:"_getLinePath",value:function(e,t){var n=5,i=2*t-Math.round(2*t*e),r=2*Math.sqrt(2*i*t-Math.pow(i,2)),o=(2*t-r)/2,a=o+n,s=2*t-o-n;return"M"+a+","+i+" L"+s+","+i+" z"}},{key:"reveal",value:function(){var e=this;this._wrap.classList.remove("cloaked"),window.requestAnimationFrame(function(){e._wrap.classList.add("in")}),this.visible=!0}},{key:"fade",value:function(){this._wrap.classList.add("fade"),this.visible=!0}},{key:"hide",value:function(){var e=this;this._wrap.classList.remove("in"),this._wrap.classList.remove("fade"),this._wrap.classList.add("leaving");var t=function t(){"opacity"===event.propertyName&&(e._wrap.classList.remove("leaving"),e._wrap.classList.add("cloaked"),e.visible=!1),Wp(e._wrap).off("transitionend",t)};Wp(this._wrap).on("transitionend",t)}},{key:"updatePosition",value:function(e){if(e){var t=xe(e),n=265,i=336;if(t.height<n)return this._wrap.classList.remove("align-bottom"),void this._wrap.classList.add("hidden");if(t.height<i)return this._wrap.classList.remove("hidden"),void this._wrap.classList.add("align-bottom");this._wrap.classList.remove("hidden"),this._wrap.classList.remove("align-bottom")}}},{key:"getWrapper",value:function(){return this._wrap}}]),e}(),Mg=55,Dg=45,Fg="markers",Bg="clip_id",Ng="profile_id",qg="player_size",jg="dropped_frames",Vg="total_frames",Ug="bandwidth",Hg="streams",Wg="files",zg="video_dims",Gg="min_bandwidth",Kg="max_badwidth",Yg="buffer_occupancy",Xg="scanner",$g=[Bg,Ng,qg,jg,Vg,Ug,Fg,Hg,Wg,zg,Gg,Kg,Yg,Xg],Qg="seeked",Jg="ended",Zg="upswitch",ey="downswitch",ty="resize",ny="scannerchange",iy="filechange",ry="bufferstart",oy="stalled",ay=500,sy=function(){return Date.now?Date.now():(new Date).getTime()},uy=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};ec(this,e),this.player=t,this.seriesStore={},this.telecineHandlers={},this.onDataChange=n}return tc(e,[{key:"init",value:function(){this._clearAllFields(),this._attachTelecineEventHandlers(),this._watchPlayerSize(),this._setDefaults()}},{key:"reset",value:function(){this._clearAllFields(),this._setDefaults(),this.onDataChange()}},{key:"setToSeries",value:function(e,t){return this.seriesStore[e]=[t],this.onDataChange(),this.seriesStore[e]}},{key:"addToSeries",value:function(e,t){this.seriesStore[e].push(t);var n=25,i=this.seriesStore[e].length;return i>ay&&this.seriesStore[e].splice(0,n),this.onDataChange(),this.seriesStore[e]}},{key:"getCurrent",value:function(e){return this.seriesStore[e].slice(-1)[0]}},{key:"getFirst",value:function(e){return this.seriesStore[e][0]}},{key:"getSeries",value:function(e){return this.seriesStore[e]}},{key:"addMarker",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.videoTime=this.player.telecine.currentTime,n.time=Date.now(),this.addToSeries(Fg,{type:e,title:t,data:n})}},{key:"_attachTelecineEventHandlers",value:function(){var e=this,t=new Vi(function(t,n){e.player.telecine&&t(),e.player.events.on(kc.telecineReady,function(){t()})});t.then(function(){e.player.telecine.on(_h.BANDWIDTH,e._onBandwidthChange.bind(e)),e.player.telecine.on(_h.BUFFER_OCCUPANCY,e._onBufferOccupancyChange.bind(e)),e.player.telecine.on(_h.CURRENT_FILE_CHANGE,e._onFileChange.bind(e)),e.player.telecine.on(_h.DROPPED_FRAMES,e._onDroppedFrames.bind(e)),e.player.telecine.on(mh.ENDED,e._onEnded.bind(e)),e.player.telecine.on(_h.SCANNER_CHANGE,e._onScannerChange.bind(e)),e.player.telecine.on(mh.SEEKED,e._onSeeked.bind(e)),e.player.telecine.on(mh.STALLED,e._onStalled.bind(e)),e.player.telecine.on(_h.STREAM_BUFFER_START,e._onStreamBufferStart.bind(e)),e.player.telecine.on(_h.STREAM_CHANGE,e._onStreamChange.bind(e))}).catch(function(){})}},{key:"_watchPlayerSize",value:function(){var e=this;this.player.store.watch("ui.player.layout",function(t){var n=e.getCurrent(zg),i=e._getVideoDimensionsString(t);e.addToSeries(zg,i);var r=n?"Resized from "+n+" to "+i:"Resized to "+i;e.addMarker(ty,r)})}},{key:"_getVideoDimensionsString",value:function(e){var t=Math.round(e.width)+"px",n=Math.round(e.height)+"px",i=window.devicePixelRatio&&window.devicePixelRatio>1?"@"+window.devicePixelRatio+"x":"";return t&&n?parseInt(t,10)+"×"+parseInt(n,10)+" "+i:""}},{key:"_clearAllFields",value:function(){this.seriesStore=$g.reduce(function(e,t){return e[t]=[],e},{})}},{key:"_setDefaults",value:function(){var e=this.player.telecine.currentFile;this.addToSeries(Wg,e);var t=this.player.telecine.currentScanner;this.addToSeries(Xg,t),this.setToSeries(Gg,0),this.setToSeries(Kg,0);var n=this.player.store.get("ui.player.layout"),i=this._getVideoDimensionsString(n);this.addToSeries(zg,i)}},{key:"_onBandwidthChange",value:function(e){var t=Math.round(100*e.speed)/100;this.addToSeries(Ug,{videoTime:this.player.telecine.currentTime,time:Date.now(),value:t});var n=this.getCurrent(Kg),i=this.getCurrent(Gg);(!i||t<i)&&this.setToSeries(Gg,t),(!n||t>n)&&this.setToSeries(Kg,t)}},{key:"_onDroppedFrames",value:function(e){var t=e.dropped,n=e.total;this.setToSeries(Vg,n),this.setToSeries(jg,t)}},{key:"_onSeeked",value:function(){this.addMarker(Qg,"Seeked to "+this.player.telecine.currentTime)}},{key:"_onEnded",value:function(){this.addMarker(Jg,"Ended")}},{key:"_onStreamChange",value:function(e){var t=e.index,n=e.streams,i=n[t],r=this.player.config.request.files.dash.streams,o=r.find(function(e){return e.id===parseInt(i.id,10)}),a={profile:"undefined"!=typeof o?o.profile:null,quality:"undefined"!=typeof o?o.quality:i.height+"p",bitrate:i.bitrate,framerate:i.framerate,height:i.height,width:i.width},s=this.getCurrent(Hg),u=s?s.bitrate:null;if(u!==a.bitrate&&null!==u){var c=this._getResolutionString(s),l=this._getResolutionString(a);a.bitrate<u?this.addMarker(ey,"Downswitch from "+c+" to "+l):a.bitrate>u&&this.addMarker(Zg,"Upswitch from "+c+" to "+l)}this.addToSeries(Hg,a)}},{key:"_onFileChange",value:function(){var e=this.getCurrent(Wg),t=this.player.telecine.currentFile;this.addToSeries(Wg,t);var n=t.metadata.cdn,i=e?e.metadata.cdn:null,r=e?dc[e.mime]:null,o=dc[t.mime],a="CDN to "+n+"/"+o;i&&(a="CDN from "+i+"/"+r+" to "+n+"/"+o),this.addMarker(iy,a)}},{key:"_onBufferOccupancyChange",value:function(e){var t=Math.round(1e3*e)/1e3;this.addToSeries(Yg,{videoTime:this.player.telecine.currentTime,time:sy(),value:t})}},{key:"_onScannerChange",value:function(){var e=this.getCurrent(Xg),t=this.player.telecine.currentScanner;this.setToSeries(Xg,t),e&&this.addMarker(ny,"Scanner change to "+t)}},{key:"_onStreamBufferStart",value:function(){this.addMarker(ry,"Buffering")}},{key:"_onStalled",value:function(){this.addMarker(oy,"Stalled")}},{key:"_getResolutionString",value:function(e){return e.width+"×"+e.height+"@"+Math.round(e.framerate)+" "+Math.round(e.bitrate/1e3).toLocaleString()+" Kbps"}}]),e}(),cy=14,ly=250,dy=($p={},nc($p,Qg,"#0088cc"),nc($p,Jg,"#503873"),nc($p,Zg,"#5a9e02"),nc($p,ey,"#d93636"),nc($p,ty,"#FF8A00"),nc($p,ny,"#e9ff00"),nc($p,iy,"#b5d3e2"),nc($p,ry,"#e812e0"),nc($p,oy,"#f44283"),$p),fy=function(e,t,n){return Math.min(Math.max(e,t),n)},hy=function(){function e(t,n){var i=this;ec(this,e),this.element=t,this.player=n,this.initTime=new Date,this.templateExtra={openLinkText:"Open Link",openLinkDisabled:!1,openLinkHref:null};var r=function(){i.updateDebugValues()};this.debugcollect=new uy(n,r),this.debugcollect.init(),this.attachEvents(),this.openLinkNum=0,this.active=!1,this.hiddenInTinyMode=!1,this.copied=!1,this.sessionId=null}return tc(e,[{key:"render",value:function(){if(this.active){var e=this._getTemplateData();this.element.innerHTML=Ag.render("debug_panel",e)}}},{key:"updateDebugValues",value:function(){if(this.active){var e=this._getTemplateData(),t=this.element.querySelector(".vp-stats-debug-values");t.innerHTML=Ag.render("debug_values",e)}}},{key:"resetData",value:function(){this.debugcollect.reset(),this.render()}},{key:"attachEvents",value:function(){var e=this;this.player.events.on(kc.debugButtonPressed,function(){return e.element.classList.contains("hidden")?void e.showPanel():void e.hidePanel()}),pi(this.element,".js-copySessionButton",this._copySessionId.bind(this)),this.player.events.on(kc.configChanged,function(){e.resetData()}),pi(this.element,".stats-debug-close",function(){e.hidePanel()}),this.player.store.watch("ui.player.mode",this.toggleVisibility.bind(this))}},{key:"hidePanel",value:function(){this.element.classList.add("hidden"),this.element.setAttribute("hidden",""),this.element.setAttribute("aria-hidden","true"),this.player.events.fire(kc.hudHidden),this.active=!1}},{key:"showPanel",value:function(){this.element.classList.remove("hidden"),this.element.removeAttribute("hidden"),this.element.setAttribute("aria-hidden","false"),this.player.events.fire(kc.hudDisplayed),this.active=!0,this.render()}},{key:"toggleVisibility",value:function(e){return"tiny"===e&&this.active?(this.hiddenInTinyMode=!0,void this.hidePanel()):void(this.hiddenInTinyMode&&(this.showPanel(),this.hiddenInTinyMode=!1))}},{key:"_getTemplateData",value:function(){var e=this.debugcollect.getCurrent(Wg);if(!e)return{};var t=e.metadata,n=this.debugcollect.getCurrent(Xg),i="MediaSourceScanner"===n,r="LiveScanner"===n,o=this.debugcollect.getCurrent(Hg),a=this.debugcollect.getCurrent(Ug),s=new Date(1e3*this.player.config.request.timestamp),u=new Date(new Date-this.initTime+1e3*this.player.config.request.timestamp),c=this.debugcollect.getCurrent(zg),l=o?o.profile+", "+Nn(o):null,d=dc[e.mime]+", cdn: "+t.cdn,f=o?o.width+"×"+o.height+"@"+Math.round(o.framerate)+" "+Math.round(o.bitrate/1e3).toLocaleString()+" Kbps":null,h=!(!this.player.config.request.files||!this.player.config.request.files.dash)&&this.player.config.request.files.dash.separate_av,v=this._getTestGroups(),p=this.debugcollect.getCurrent(Vg)||0,m=this.debugcollect.getCurrent(jg)||0,g=0!==p?(m/p*100).toFixed(2)+"%":0,y=(this.player.telecine.duration-this.player.telecine.currentTime).toFixed(2)+" seconds",_=a?Math.floor(a.value/1e3).toLocaleString()+" Kbps":0,b=Math.floor(this.debugcollect.getCurrent(Gg)/1e3).toLocaleString()+" Kbps",w=Math.floor(this.debugcollect.getCurrent(Kg)/1e3).toLocaleString()+" Kbps",k=i||r?this._getBandwidthSeries():null,S=i||r?this._getGraphSVG(k):null,E=i&&this.player.config.request.ab_tests&&this.player.config.request.ab_tests.bba&&this.player.config.request.ab_tests.bba.group,T=this.debugcollect.getCurrent(Yg),x=T?Math.floor(100*T.value).toLocaleString()+"%":0,A=E?this._getBufferOccupancySeries():null,L=E?this._getGraphSVG(A):null;return{sessionId:this.sessionId,clipId:this.player.config.video.id,isCopyDisabled:!!this.player.doNotTrackEnabled||this.player.config.embed.settings.background,hideCloseButton:!!this.player.config.embed.settings.background,delivery:d,resolution:f,embedSize:c,isDash:i,isLive:r,profileId:l,separateAudioVideo:h,testGroup:v,totalFrames:p,droppedFrames:m,droppedFramesPercent:g,liveLatency:y,bandwidthKbps:_,bandwidthMinKbps:b,bandwidthMaxKbps:w,startTime:s,debugTime:u,displayBufferOccupancy:E,bufferOccupancyPercent:x,bandwidthSeriesSvg:S,bufferOccupancySvg:L,openLinkText:this.templateExtra.openLinkText,openLinkDisabled:this.templateExtra.openLinkDisabled,openLinkHref:this.templateExtra.openLinkHref}}},{key:"_getTestGroups",value:function(){var e=this;return Object.keys(this.player.config.request.ab_tests).map(function(t){return t+": "+e.player.config.request.ab_tests[t].group}).join(", ")}},{key:"_getBandwidthSeries",value:function(){var e=this.debugcollect.getSeries(Ug),t=this.debugcollect.getCurrent(Kg);return{timeSeries:e,max:t}}},{key:"_getBufferOccupancySeries",value:function(){var e=this.debugcollect.getSeries(Yg);return{timeSeries:e}}},{key:"_getGraphSVG",value:function(e){for(var t=ly,n=cy,i=e.timeSeries,r=e.max||1,o=i.length,a=100,s=o<a?0:o-a,u=i[s],c=i[o-1],l=u?u.time:0,d=c?c.time:0,f=[],h=s;h<o;h++){var v=i[h],p=(v.time-l)/(d-l)*t,m=n-n*v.value/r;isNaN(m)&&(m=0),isNaN(p)&&(p=0),f.push(p+","+fy(m,0,n))}var g={height:n,width:t,points:f.join(" "),markers:this._getMarkerSvgPart(l,d)};return Ag.render("time_series_graph",g)}},{key:"_getMarkerSvgPart",value:function(e,t){var n=cy,i=ly,r=this.debugcollect.getSeries(Fg)||[];return 0===r.length?null:r.map(function(r){var o=r.data.time;if(o<e||o>t)return"";var a=(o-e)/(t-e)*i;return isNaN(a)&&(a=0),"<g>\n                <title>"+r.title+'</title>\n                <line class="stats-debug-marker" x1="'+a+'" y1="0" x2="'+a+'" y2="'+n+'" stroke-width="1" stroke="'+dy[r.type]+'" />\n            </g>'}).join("")}},{key:"_copySessionId",value:function(){var e=this;if(!this.isCopied){var t=this.element.querySelector(".vp-copy-label"),n=document.createElement("textarea");n.value=this.player.config.request.session,this.element.appendChild(n),n.select(),document.execCommand("copy")?!function(){t.innerHTML="Copied",e.element.removeChild(n),e.isCopied=!0;var i=setTimeout(function(){t.innerHTML="Copy Debug Key",clearTimeout(i),e.isCopied=!1},2e3)}():(this.element.querySelector(".js-copySessionButton").style.display="none",this.element.removeChild(n),this.sessionId=this.player.config.request.session,this.updateDebugValues())}}}]),e}(),vy=function(){function e(t){ec(this,e),this.alertTextElement=t.querySelector(".vp-text-alert-wrapper"),this.alertContentElement=this.alertTextElement.querySelector(".vp-alert-text")}return tc(e,[{key:"show",value:function(e){this.alertContentElement.innerHTML=e,this.alertContentElement.classList.remove("hidden"),this.alertTextElement.classList.remove("hidden")}},{key:"hide",value:function(){this.alertContentElement.classList.add("hidden"),this.alertTextElement.classList.add("hidden")}}]),e}(),py=function(){function e(t){ec(this,e),this.alertTextElement=t.querySelector(".vp-text-alert-wrapper"),this.alertContentTitle=this.alertTextElement.querySelector(".vp-live-start-time-title"),this.alertContentTime=this.alertTextElement.querySelector(".vp-live-start-time-body"),this.alertContentFooter=this.alertTextElement.querySelector(".vp-live-start-time-footer")}return tc(e,[{key:"show",value:function(e,t,n){this.alertContentTitle.innerHTML=e,this.alertContentTime.innerHTML=t,this.alertContentFooter.innerHTML=n,this.alertContentTitle.classList.remove("hidden"),this.alertContentTime.classList.remove("hidden"),this.alertContentFooter.classList.remove("hidden"),this.alertTextElement.classList.remove("hidden")}},{key:"hide",value:function(){this.alertContentTitle.classList.add("hidden"),this.alertContentTime.classList.add("hidden"),this.alertContentFooter.classList.add("hidden"),this.alertTextElement.classList.add("hidden")}}]),e}(),my=3e4,gy=6e4,yy=function(){function e(t,n,i){ec(this,e),this.textAlert=new vy(t),this.timeAlert=new py(t),this.player=n,this.store=i,this.startTime=new Date(this.store.get(Tp,null)),this._setUpLiveEvents(),this._checkStatus()}return tc(e,[{key:"hide",value:function(){this.textAlert.hide(),this.timeAlert.hide()}},{key:"_checkStatus",value:function(){(this.store.get(mp)||this.store.get(gp))&&this._onLiveEventActive(),this.store.get(_p)&&this._onLiveStreamEnded()}},{key:"_setUpLiveEvents",value:function(){this.player.events.on(kc.liveEventActive,this._onLiveEventActive.bind(this)),this.player.events.on(kc.liveStreamOnline,this._onLiveStreamOnline.bind(this)),this.player.events.on(kc.liveStreamOffline,this._onLiveStreamOffline.bind(this)),this.player.events.once(kc.liveEventEnded,this._onLiveStreamEnded.bind(this))}},{key:"_onLiveEventActive",value:function(){this._timeToEventStart()>gy?(this.textAlert.hide(),this._displayTimeAlert()):(this.timeAlert.hide(),this.textAlert.show("Эта трансляция еще не началась"))}},{key:"_displayTimeAlert",value:function(){var e=this._timeToDisplayText();this.timeAlert.show(e[0],e[1],e[2]),(this.store.get(mp)||this.store.get(gp))&&setTimeout(this._checkStatus.bind(this),my)}},{key:"_timeToEventStart",value:function(){return this.startTime-new Date}},{key:"_timeToDisplayText",value:function(){var e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=this._timeToEventStart(),n=(t/6e4).toFixed(0),i=(t/36e5).toFixed(0),r=(t/864e5).toFixed(0),o=new Date,a=o.toDateString()===this.startTime.toDateString();if(r>1||!a)return["This event is scheduled for",e[this.startTime.getMonth()]+" "+this.startTime.getDate(),"at "+Kn(this.startTime)];if(i>1&&a)return["This event is scheduled for","Today","at "+Kn(this.startTime)];var s=n>1?"minutes":"minute";return["This event will start in",n+" "+s,""]}},{key:"_onLiveStreamOnline",value:function(){this.hide()}},{key:"_onLiveStreamOffline",value:function(){this.textAlert.show("Live stream offline"),$i.iOS&&Rg.element&&(this.player.events.fire(kc.willExitFullscreen),Rg.exit())}},{key:"_onLiveStreamEnded",value:function(){this.textAlert.show("Live event ended")}}]),e}(),_y=Nu,by={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},wy=_y(by),ky=wy,Sy=ky,Ey=ts,Ty=/[&<>"']/g,xy=RegExp(Ty.source),Ay=Ei,Ly=[".vp-title a"],Py=[".vp-title a:hover"],Cy=["a",".button-link",".vp-overlay-wrapper .footnote.share a:hover",".vp-title h1",".vp-title span.user",".menu li:hover",".menu li.active",".outro-link:hover",".outro-videosTitle a:hover","li.vp-panel-item:hover","li.vp-panel-item-on",".vp-share-footnote a:hover",".card-link span",".vp-panel-collapsible .vp-panel-button:hover"],Oy=["a:hover",".button-link:hover"],Ry=[".vp-overlay-wrapper .close:hover .fill",".vp-overlay-wrapper .back:hover .fill",".stats-debug-close:hover .fill",".stats-debug-copy:hover",".card-link:hover .fill"],Iy=[".play-bar .on .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill",".tiny-bars .fill",".vp-sidedock .on .fill",".controls-outro a:hover .fill",".card-link .fill",".vp-panel-collapsible .vp-panel-button:hover .fill"],My=[".vp-sidedock .on:hover .fill"],Dy=[".play-bar .on .stroke",".vp-sidedock .on .stroke"],Fy=[".vp-sidedock .on:hover .stroke"],By=[".vp-sidedock button:hover",".vp-sidedock button.selected","&.touch-support .vp-sidedock button:active",".vp-controls .play:hover",".vp-controls .play-bar .played","&.no-playbar .play-bar button:not(.toggle):hover",".vp-controls.tiny .play-bar button:not(.toggle):hover",".vp-controls .volume div",".vp-overlay .buttons li",".vp-overlay .vp-overlay-content button",'.vp-overlay .vp-overlay-content input[type="submit"]','.vp-overlay .vp-overlay-content a[role="button"]',"li.vp-panel-item-on:before",".vp-controls .replay:hover",".vp-share-buttons li","button.vp-share-embedCopy",".outro-button","a.outro-vodButton",".vp-email-capture-form-button--submit",".vp-email-capture-checkIconWrapper"],Ny=["li.vp-panel-item-on:before"],qy=[".vp-overlay .vp-overlay-content button",'.vp-overlay .vp-overlay-content input[type="submit"]','.vp-overlay .vp-overlay-content a[role="button"]',".vp-sidedock button:hover",".vp-sidedock button.selected",".vp-sidedock button:hover .vod-label",".vp-sidedock button.selected .vod-label",".play:hover",".vp-share-footnote--embed a",".outro-button",".outro-button:hover",".vp-outro-wrapper .outro-link:hover","button.vp-share-embedCopy",".outro-vodWrapper a.outro-vodButton",".outro-vodWrapper a.outro-vodButton:hover"],jy=[".vp-controls .play:hover .fill",".vp-sidedock button:hover .fill",".vp-sidedock button.selected .fill",".play-bar a:hover .fill",".play-bar button:not(.toggle):hover .fill","&.no-playbar .play-bar button:not(.toggle):hover .fill",".vp-controls.tiny .play-bar button:not(.toggle):hover .fill",".vp-sidedock .on .fill",'.vp-overlay .vp-share-wrapper a[role="button"] .fill',".outro-vodButton .fill",".vp-email-capture-checkIconWrapper .fill"],Vy=[".vp-controls .play:hover .stroke",".vp-sidedock button:hover .stroke",".vp-sidedock button.selected .stroke",".vp-sidedock .on .stroke"],Uy=['.vp-overlay-wrapper .vp-overlay a[role="button"]',".vp-sidedock button:hover",".vp-sidedock button.selected",".play:hover","button.vp-share-embedCopy",".outro-button",".outro-button:hover",".outro-vodWrapper a.outro-vodButton",".outro-vodWrapper a.outro-vodButton:hover","input.vp-email-capture-form-button--submit"],Hy=[".vp-controls .play:hover .fill",".vp-sidedock button:hover .fill",".vp-sidedock button.selected .fill",".vp-controls .play-bar .fullscreen.tiny:hover .fill",".vp-share-button .fill",".outro-vodButton .fill"],Wy=[".vp-sidedock button:hover .stroke",".vp-sidedock button.selected .stroke"],zy=["li.vp-panel-item-on:before"],Gy=['.vp-overlay .vp-overlay-content input[type="submit"]:active',".vp-overlay .embed-copy.zeroclipboard-is-active",'.vp-overlay a[role="button"]:active',".vp-sidedock button:active",".outro-vodWrapper a.outro-vodButton:active"],Ky=Object.freeze({formatVodLabel:Oi,getDisplayPrice:Ri,isAvailableInCountry:Ii,translateFromRequest:Mi}),Yy=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ec(this,e);var i=6,r=76,o=parseInt(r*$i.devicePixelRatio,10),a=parseFloat(n.timecode);if(isNaN(a))throw new TypeError("Time must be a number.");if(a<0)throw new TypeError("Time must be a positive number.");this.time=a,this.data=n,this.id=n.id,this.displayTime=n.display_time||i,n.url&&(this.data.url=Tt(n.url)),n.image_url&&(n.image=Ut({width:o,height:o,baseUrl:Tt(n.image_url),webpSupport:t.config.request.flags.webp,crop:!0})),this.renderTemplate()}return tc(e,[{key:"renderTemplate",value:function(){var e=this,t=document.createElement("div");t.innerHTML=Ag.render("card",this.data),this.element=t.children[0],this.data.image&&Ht(this.data.image).catch(function(t){e.element.querySelector(".js-cardImageWrap").style.display="none"})}},{key:"isActive",value:function(e){return e>=this.time&&e<this.end}},{key:"end",get:function(){return this.time+this.displayTime}}]),e}(),Xy=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e,t){return e<t};ec(this,e),this._data={},this._sortedKeys=[],this._sort=t}return tc(e,[{key:"_insert",value:function(e){var t=this._sortedKeys.length;if(0===t)this._sortedKeys.push(e);else{for(var n=0;n<t;n++)if(this._sort(e,this._sortedKeys[n])){this._sortedKeys[n-1]!==e&&this._sortedKeys.splice(n,0,e);break}n===t&&this._sortedKeys[n-1]!==e&&this._sortedKeys.splice(n,0,e)}}},{key:"_binarySearch",value:function(e,t,n,i){if(i<n)return-1;var r=parseInt(n+(i-n)/2,10);return e[r]>t?this._binarySearch(e,t,n,r-1):e[r]<t?this._binarySearch(e,t,r+1,i):r}},{key:"delete",value:function(e){var t=this._binarySearch(this._sortedKeys,e,0,this._sortedKeys.length);if(t===-1)throw new Error("key does not exist");this._sortedKeys.splice(t,1),delete this._data[e]}},{key:"set",value:function(e,t){return this._data[e]=t,this._insert(e),this}},{key:"get",value:function(e){return this._data[e]}},{key:"keys",value:function(){return this._sortedKeys.slice();
}},{key:"values",value:function(){var e=this;return this.keys().map(function(t){return e._data[t]})}},{key:"forEach",value:function(e){for(var t=this._sortedKeys.length,n=0;n<t&&e(this._data[this._sortedKeys[n]],this._sortedKeys[n],this)!==!1;n++);}},{key:"size",get:function(){return this._sortedKeys.length}}]),e}(),$y=.05,Qy={16:"shift",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"},Jy=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=n.displayTimeout,r=void 0===i?0:i,o=n.label,a=void 0===o?"Alert":o;ec(this,e),he(this),this._container=t,this._visible=!1,this._message=null,this._alert=null,this._alertLabel=a;var s=Math.round(r/1e3);0!==s&&(this._alertLabel=a+" Will be dismissed in "+s+" seconds"),this._displayTimer=null,this._displayTimeout=r,this._renderTemplate(),this._attachEvents()}return tc(e,[{key:"show",value:function(e){var t=this;if(this._visible!==!0){clearTimeout(this._displayTimer),this._alert.classList.remove("hidden"),this._alert.removeAttribute("hidden"),window.requestAnimationFrame(function(){t._alert.classList.add("in")});var n=this._alert.querySelector("[data-alert-autofocus]")||this._alert;n.focus(),this._visible=!0,this.fire("show",e),0!==this._displayTimeout&&(this._displayTimer=setTimeout(function(){t.hide("timeout")},this._displayTimeout))}}},{key:"hide",value:function(e){var t=this;this._visible!==!1&&(clearTimeout(this._displayTimer),this._alert.classList.add("leaving"),window.requestAnimationFrame(function(){var e=t;t._setHideAttributes(),Wp(t._alert).on("transitionend",function t(n){"opacity"===n.propertyName&&(e._alert.classList.remove("leaving"),e._alert.classList.add("hidden"),e._alert.setAttribute("hidden",""),Wp(e._alert).off("transitionend",t))})}),this._visible=!1,this.fire("hide",e))}},{key:"_setHideAttributes",value:function(){this._alert.classList.remove("in")}},{key:"_renderTemplate",value:function(){this._alert||(this._alert=document.createElement("div"),this._alert.setAttribute("role","alertdialog"),this._alert.setAttribute("aria-label",this._alertLabel),this._alert.setAttribute("aria-atomic","true"),this._alert.classList.add("player-alert"),this._alert.classList.add("hidden"),this._alert.setAttribute("hidden",""),this._container.appendChild(this._alert),this._setHideAttributes()),this._message instanceof HTMLElement?(this._alert.innerHTML="",this._alert.appendChild(this._message)):(this._alert.textContent=this._message,this._alert.innerHTML=this._message);var e=document.createElement("button");e.setAttribute("data-close",""),e.setAttribute("aria-label","Close alert"),e.classList.add("close"),e.innerHTML=Ag.render("icon_close"),this._alert.appendChild(e)}},{key:"_attachEvents",value:function(){var e=this;Wp(this._alert).on("click","[data-close]",function(t){e.hide(t)})}},{key:"visible",get:function(){return this._visible}},{key:"message",get:function(){return this._message},set:function(e){e instanceof HTMLElement&&this._message&&e.textContent===this._message.textContent||e!==this._message&&(this._message=e,this._renderTemplate())}}]),e}(),Zy=function(){function e(t,n,i){ec(this,e),this.player=t,this.telecine=n,this.isBufferingTooLong=!1,this.isBufferingTooFrequent=!1,this.autoAlertWasDismissed=!1,this.bufferCount=-1,this.badPlaybackTimer=null,this._setUpAlertUI(i),this._attachEventHandlers()}return tc(e,[{key:"handleBufferStarted",value:function(){this.bufferCount+=1,this.bufferCount>_c.maxFrequency&&(this.isBufferingTooFrequent=!0,this._notifyBadPlayback()),this._startBadPlaybackTimer()}},{key:"handleBufferEnded",value:function(){clearTimeout(this.badPlaybackTimer),this.badPlaybackTimer=null,this.isBufferingTooLong=!1}},{key:"_attachEventHandlers",value:function(){var e=this;this.player.events.on(bc.spatialUnsupported,function(t){e._showSpatialUnsupportedAlert(t)}),this.player.events.on(bc.spatialFailure,function(t){e._showSpatialFailureAlert(t)}),this.player.events.on(bc.bufferStarted,this.handleBufferStarted.bind(this)),this.player.events.on(kc.bufferEnded,this.handleBufferEnded.bind(this)),this.player.events.on(bc.badPlayback,function(){e.autoAlertWasDismissed||(e.showAlert("stream_studder"),el.captureBreadcrumb("Alert shown",{message:"stream_studder"},"video"))}),this.player.events.on(kc.qualityChanged,function(t){"auto"===t&&e.alertUI.hide("qualitymenuauto")})}},{key:"_showSpatialUnsupportedAlert",value:function(e){if(!e){var t={strings:{text:'See a <a href="https://help.vimeo.com/hc/en-us/articles/115001878167#browsers" target="_blank" rel="noopener">list of browsers</a> that support 360 viewing.'}};this.showAlert("warning_alert",t)}}},{key:"_showSpatialFailureAlert",value:function(e){if(!e){var t={strings:{text:'Looking to watch a 360 video? See <a href="https://help.vimeo.com/hc/en-us/articles/115001878167#browsers" target="_blank" rel="noopener">supported browsers and settings</a>.'}};this.showAlert("warning_alert",t)}}},{key:"showAlert",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.alertUI&&!this.player.config.embed.settings.background&&(this.alertUI.message=Ag.render(e,t),this.alertUI.show())}},{key:"_setUpAlertUI",value:function(e){var t=this;this.alertUI=new Jy(e),this.alertUI.on("show",function(e){t.player.events.fire(kc.alertVisibilityChanged,!0,e)}),this.alertUI.on("hide",function(e){var n=e.target,i=n&&"function"==typeof n.getAttribute;if(i)switch(n.getAttribute("data-context")){case"suggestion":t.player.events.fire(wc.changeQuality,"auto"),e="suggestion";break;default:e="close"}(i||"qualitymenuauto"===e)&&(t.autoAlertWasDismissed=!0),t.player.events.fire(kc.alertVisibilityChanged,!1,e)})}},{key:"_startBadPlaybackTimer",value:function(){var e=this;null===this.badPlaybackTimer&&0!==this.bufferCount&&(this.badPlaybackTimer=setTimeout(function(){e.isBufferingTooLong=!0,e._notifyBadPlayback()},_c.maxDuration))}},{key:"_notifyBadPlayback",value:function(){"MediaSourceScanner"===this.telecine.currentScanner&&(this.isBufferingTooLong||this.isBufferingTooFrequent)&&(this.telecine.video.currentFile.restrictedStreamIndexes.length<=0||(this.isBufferingTooLong,this.isBufferingTooFrequent,this.player.events.fire(bc.badPlayback),this.bufferCount=0,this.badPlaybackTimer=null,this.isBufferingTooFrequent=!1,this.isBufferingTooLong=!1))}}]),e}();return window.BigScreen=Rg,qi}();
